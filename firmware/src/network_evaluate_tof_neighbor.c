#include "network_evaluate_tof.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

#define D_SELF 16 // self_structure[1][1]
#define D_NBR 8 // self_structure[1][1]

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.08493788540363312,-0.09784640371799469,0.08391503989696503,-0.020907286554574966,-0.22316178679466248,-0.2223142683506012,0.2114260345697403,-0.3138669431209564,-0.10036490112543106,-0.013662169687449932,-0.08543341606855392,0.3903311491012573,-0.3078068494796753,0.2174626886844635,0.36066609621047974,-0.3905165493488312},{-0.048675939440727234,-0.04513179510831833,0.32598942518234253,-0.34415560960769653,0.10822580009698868,-0.2983623445034027,-0.020129764452576637,-0.06198998540639877,0.06465957313776016,0.16771601140499115,0.11295804381370544,0.09865567833185196,0.22366203367710114,-0.006563517265021801,-0.1271636188030243,-0.2553573250770569},{-0.11744068562984467,0.03676339611411095,0.36550766229629517,-0.3785620629787445,-0.0282495878636837,0.5821179747581482,0.14732582867145538,-0.2440919429063797,-0.24413320422172546,-0.7545101046562195,-0.07004185020923615,0.08742187917232513,-0.007875190116465092,0.3576275706291199,0.18121415376663208,-0.06981394439935684},{-0.19719535112380981,-0.06396719813346863,0.1478421837091446,-0.027305539697408676,0.23902632296085358,0.09727455675601959,-0.29581740498542786,-0.2590300440788269,0.14807698130607605,-0.10474911332130432,0.1357177048921585,0.4092830419540405,-0.15584751963615417,-0.03876626864075661,0.09358799457550049,-0.0054168435744941235},{-0.27646270394325256,0.23149511218070984,-0.028425216674804688,-0.3373347222805023,0.21390821039676666,-0.31891223788261414,-0.4320712685585022,-0.0656290277838707,-0.18162372708320618,0.3040061295032501,0.1700274795293808,-0.008809399791061878,0.31681790947914124,-0.050328776240348816,-0.0026563683059066534,0.19610431790351868},{0.22601602971553802,-0.12254733592271805,0.17411766946315765,0.0607345812022686,-0.3409307897090912,0.050827521830797195,-0.3163546919822693,-0.3295222222805023,0.13797348737716675,-0.3281221091747284,-0.2660444378852844,0.0009920238517224789,0.03471829742193222,0.2418694794178009,-0.24281352758407593,0.1318979114294052},{-0.042341507971286774,0.46289199590682983,-0.03499067947268486,-0.297929048538208,0.47024497389793396,-0.2669423818588257,-0.3226584792137146,-0.1289392113685608,-0.06082655489444733,-0.049798958003520966,0.4671359658241272,0.4679298996925354,-0.561636745929718,0.19444166123867035,-0.4685063660144806,-0.25567835569381714},{-0.03326130658388138,0.2629493474960327,-0.23707528412342072,-0.16976502537727356,-0.29788094758987427,-0.05526411160826683,0.1112988293170929,-0.1916850060224533,0.16247519850730896,-0.162231907248497,-0.56499183177948,0.06697706878185272,-0.2819199562072754,-0.1697404980659485,0.05451767146587372,-0.028104959055781364},{-0.07808899134397507,0.3286653459072113,0.08367919921875,0.07204454392194748,0.1853320300579071,-0.03536634519696236,-0.12410320341587067,-0.1340210884809494,0.369684100151062,-0.27060461044311523,-0.13864454627037048,0.6438195705413818,0.09622761607170105,-0.08407866954803467,0.5127052664756775,0.259948194026947},{0.3589273989200592,0.2706288695335388,0.15716035664081573,0.5398618578910828,0.21372419595718384,-0.03929172828793526,-0.14986976981163025,-0.20264728367328644,0.13286429643630981,-0.17980392277240753,-0.15121936798095703,-0.037365444004535675,0.3234701454639435,0.36705124378204346,0.16180679202079773,-0.10752938687801361},{0.6738712787628174,0.44530826807022095,0.01455680187791586,0.18696503341197968,-0.17769485712051392,-0.41416072845458984,0.162212073802948,0.3582630157470703,0.24485591053962708,0.18566972017288208,0.21648377180099487,0.2207176685333252,-0.33532488346099854,0.039072588086128235,-0.21920990943908691,0.21509046852588654},{-0.18820641934871674,0.09995632618665695,0.1068527102470398,-0.4305708408355713,-0.15911412239074707,0.2364373654127121,-0.3137100636959076,0.18065689504146576,-0.2745773196220398,0.05197826027870178,0.0464228056371212,0.017486443743109703,0.2809157967567444,0.07161059975624084,-0.3640454411506653,-0.5163429379463196},{0.2790538966655731,0.4905330240726471,0.1164088323712349,-0.26858893036842346,0.04048746079206467,-0.02572561614215374,-0.32467007637023926,-0.10807622224092484,0.7069227695465088,-0.011185681447386742,0.19187191128730774,0.6657007932662964,0.591239333152771,-0.20529423654079437,0.7484731078147888,-0.3879033029079437},{-0.07512524724006653,-0.11502934247255325,0.13036631047725677,-0.23580914735794067,-0.0387805700302124,-0.3546568751335144,-0.2532251179218292,0.7219030857086182,-0.5072493553161621,-0.2078687995672226,-0.3836413323879242,-0.3792901933193207,0.2607206404209137,-0.21205011010169983,-0.3887365758419037,-0.36064907908439636},{0.4983243942260742,-0.19246836006641388,0.3034425377845764,0.23524600267410278,0.4359889328479767,0.16122238337993622,0.016834454610943794,-0.0812232568860054,-0.3367159068584442,0.15820883214473724,0.24940355122089386,0.09962276369333267,-0.011569476686418056,-0.2615688145160675,0.1572105884552002,-0.17770864069461823},{-0.10784874856472015,0.2789701819419861,0.18289296329021454,0.02620253898203373,0.2581290304660797,-0.09157564491033554,-0.15654969215393066,0.2560330629348755,-0.18395474553108215,-0.10181213170289993,-0.3387237787246704,-0.13303980231285095,-0.08522097766399384,-0.20100396871566772,-0.18756736814975739,-0.0883025974035263},{0.14985854923725128,-0.14306074380874634,-0.328311562538147,0.010255800560116768,-0.10371247678995132,-0.17826607823371887,0.36663535237312317,-0.049256205558776855,-0.18652760982513428,0.03332342579960823,0.031049897894263268,-0.20218655467033386,-0.13988757133483887,0.10621705651283264,-0.1498938500881195,0.021010221913456917},{0.300672322511673,0.07856639474630356,-0.17057786881923676,-0.3073529899120331,0.3493102490901947,0.4749213457107544,0.08322089165449142,0.12405882775783539,0.10314985364675522,-0.005807599518448114,0.17253440618515015,-0.31015440821647644,-0.24748390913009644,0.2510155141353607,0.18961171805858612,-0.4276711642742157}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.17032992839813232,0.05957288295030594,-0.33629289269447327,0.10051657259464264,0.42559319734573364,-0.3513040542602539,0.5971845984458923,-0.27940666675567627,-0.3568292260169983,0.019618289545178413,0.12627343833446503,-0.00995014701038599,-0.22868020832538605,-0.51300048828125,0.13300666213035583,0.4539402723312378},{0.12388946861028671,0.13230818510055542,-0.07923883199691772,-0.054564908146858215,0.24823296070098877,-0.26109182834625244,-0.3852151930332184,-0.2745521068572998,0.04585881158709526,0.1772744357585907,0.2513241767883301,-0.06410132348537445,-0.12776784598827362,-0.261997789144516,-0.01890563778579235,0.3604107201099396},{0.22462600469589233,-0.3386382758617401,-0.35555562376976013,-0.10477903485298157,0.14142702519893646,-0.09176713973283768,0.16402938961982727,-0.14612407982349396,0.17786818742752075,-0.4993339478969574,0.043688151985406876,0.1411401927471161,-0.04818335548043251,-0.25642842054367065,0.3056309223175049,-0.05667514353990555},{0.14437264204025269,0.38028791546821594,0.3823689818382263,-0.3063202500343323,0.14034877717494965,0.3205834925174713,0.1429460346698761,0.4880960285663605,0.11190493404865265,-0.23166398704051971,-0.1314457505941391,0.20876936614513397,-0.49226129055023193,0.5283287167549133,0.11983141303062439,-0.27129822969436646},{0.35508593916893005,0.1747252196073532,-0.16974687576293945,0.040868278592824936,0.2979739010334015,0.1434168517589569,0.08246248215436935,0.1051391214132309,-0.12006937712430954,-0.24617834389209747,0.12349903583526611,-0.17931301891803741,-0.034611474722623825,0.13568608462810516,-0.0009128808160312474,-0.07523607462644577},{-0.19295360147953033,-0.19337724149227142,-0.09271909296512604,0.2693846523761749,-0.35995376110076904,-0.06863255798816681,0.2804098129272461,0.09223067760467529,0.04404353350400925,0.38603150844573975,0.22288814187049866,-0.2760234773159027,0.10841282457113266,0.20564134418964386,-0.3180336654186249,-0.37191224098205566},{-0.11124606430530548,0.2494751662015915,-0.21339958906173706,-0.02980380691587925,-0.16788029670715332,0.10688526928424835,-0.1028028205037117,0.16225062310695648,0.24977906048297882,0.08141397684812546,-0.1990145444869995,0.3245857357978821,0.14914709329605103,0.18250758945941925,-0.1904730498790741,-0.3127041459083557},{-0.19593743979930878,0.5915465354919434,0.2909529507160187,-0.01788104511797428,-0.37388211488723755,-0.2683735191822052,-0.10658665001392365,-0.1687636375427246,0.19824770092964172,0.13972994685173035,0.21344837546348572,-0.11519000679254532,0.20227323472499847,-0.19674897193908691,0.43602442741394043,0.06159494072198868},{-0.1692025363445282,0.2554776668548584,0.18561506271362305,-0.19483144581317902,-0.46090027689933777,0.012515157461166382,0.0579039566218853,0.4450322687625885,-0.16793496906757355,0.3261862099170685,0.1543753743171692,0.2047010213136673,0.27827686071395874,-0.15207929909229279,-0.12382370978593826,0.49530544877052307},{0.6416599154472351,0.4332783818244934,-0.293250173330307,0.24826283752918243,-0.41052794456481934,0.2472107708454132,-0.20214293897151947,-0.013982495293021202,0.3091179430484772,-0.43579426407814026,0.4745185375213623,-0.06591856479644775,-0.2949381172657013,0.2965799868106842,0.4202982187271118,0.39842280745506287},{0.25044795870780945,-0.28002214431762695,-0.3684517443180084,0.5260593295097351,-0.06856244057416916,0.3065747916698456,0.137680783867836,0.10692625492811203,0.18348214030265808,-0.06537376344203949,0.11558189988136292,0.2833195626735687,-0.06045302376151085,-0.2178792953491211,-0.17387418448925018,0.3157654404640198},{0.36261868476867676,-0.43844491243362427,-0.16039161384105682,-0.31788554787635803,-0.13178333640098572,-0.06453486531972885,0.13510817289352417,-0.26886749267578125,-0.0065688868053257465,0.16348125040531158,-0.004127834923565388,0.007638188078999519,0.42675521969795227,-0.001955740386620164,-0.33111169934272766,0.25905588269233704},{0.018777556717395782,-0.057070035487413406,0.12683093547821045,-0.35717999935150146,0.25588151812553406,-0.4601317346096039,-0.28208065032958984,0.18395571410655975,0.0016565691912546754,-0.5523704290390015,0.5590193271636963,0.22197501361370087,0.29830777645111084,-0.3348188102245331,0.27557823061943054,-0.20498552918434143},{0.0016127205453813076,-0.2397911548614502,-0.4235721230506897,-0.2041231095790863,0.29377758502960205,0.23319615423679352,-0.050319474190473557,0.22555962204933167,-0.18931205570697784,0.2668076455593109,-0.48891156911849976,-0.26118674874305725,0.1991727203130722,0.2750398814678192,0.22000752389431,-0.41294583678245544},{-0.15563331544399261,-0.22450414299964905,-0.12179651111364365,0.07213705033063889,-0.10823775082826614,-0.12264294177293777,-0.3231981098651886,0.05545993894338608,-0.27913033962249756,-0.3820749819278717,-0.28038927912712097,0.25190824270248413,-0.2680405080318451,0.22339202463626862,-0.22939807176589966,0.34207117557525635},{0.35122445225715637,-0.03741176798939705,-0.2230520248413086,-0.3521867096424103,0.26105907559394836,0.4551759362220764,0.0008972418145276606,-0.1391448974609375,0.3139994740486145,-0.07105816155672073,0.4288691282272339,-0.12528900802135468,0.28808990120887756,0.2544589042663574,-0.41696053743362427,-0.3018217384815216}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.15203043818473816,-0.25127094984054565,0.16371992230415344,0.31896716356277466,0.11591743677854538,0.009610760025680065,0.2297990769147873,-0.03763305023312569,-0.1817234605550766,0.21651603281497955,0.04486348107457161,0.19766701757907867,-0.27938300371170044,0.22232764959335327,-0.19651974737644196,0.21756471693515778,0.016297919675707817,0.00870611984282732,0.16525687277317047,-0.1789078563451767,0.3388154208660126,0.3235923945903778,-0.040668509900569916,-0.14765973389148712,-0.009185854345560074,0.32504284381866455,-0.037095338106155396,-0.07565822452306747,-0.0806354209780693,0.164345383644104,-0.25423771142959595,-0.2622913420200348},{-0.07186869531869888,-0.21026988327503204,-0.20549175143241882,0.03389516472816467,-0.21119149029254913,0.13157300651073456,0.025903308764100075,0.13036492466926575,0.10689608752727509,0.15799067914485931,-0.18208937346935272,0.3559752106666565,-0.10608115047216415,0.1269153207540512,-0.31578612327575684,0.31385931372642517,0.2981024384498596,-0.2201925814151764,0.20250263810157776,-0.3172122836112976,0.34428608417510986,-0.17612506449222565,0.22392594814300537,-0.09488502889871597,0.07251594960689545,-0.20435287058353424,0.046665679663419724,0.05220269411802292,0.15475092828273773,0.08201082795858383,-0.3276512622833252,-0.21523331105709076},{-0.2012597620487213,0.09995044022798538,-0.12054582685232162,-0.04886316508054733,0.0011209462536498904,0.25091949105262756,-0.008696346543729305,-0.08240245282649994,-0.2685704231262207,0.13438092172145844,0.185899019241333,-0.01396328117698431,0.23730261623859406,0.27490466833114624,-0.23744383454322815,-0.22249887883663177,-0.13113704323768616,0.2708202004432678,0.03283838927745819,-0.1074678972363472,-0.1478414535522461,-0.027577875182032585,0.2266983836889267,-0.03982725739479065,0.09347037971019745,-0.19038468599319458,-0.30417874455451965,0.11868695914745331,0.12149782478809357,-0.16371549665927887,0.11154035478830338,-0.30324918031692505},{-0.1552259773015976,0.08340123295783997,-0.0731164887547493,-0.206417515873909,-0.3146553039550781,0.20309209823608398,-0.28312334418296814,-0.2452695071697235,-0.09580922871828079,-0.014127353206276894,-0.321829617023468,0.06126616895198822,0.03162494674324989,0.04227317124605179,-0.15202710032463074,0.061311300843954086,-0.31145399808883667,-0.13371394574642181,-0.08138071745634079,-0.24622796475887299,0.251117467880249,-0.095005102455616,0.10353731364011765,-0.11291944980621338,-0.08287650346755981,0.10692337155342102,0.12719660997390747,0.012281249277293682,-0.1941405087709427,-0.11646725982427597,-0.19643759727478027,0.0895933210849762},{0.04945654049515724,0.013362246565520763,-0.2162606567144394,-0.2252347320318222,-0.21184790134429932,-0.1593109667301178,-0.1793408989906311,-0.04739406332373619,0.2340630143880844,0.31047549843788147,0.22569820284843445,-0.3805050849914551,0.07893597334623337,-0.11919073015451431,-0.07547865062952042,-0.23201213777065277,-0.06124892830848694,-0.05696898326277733,0.20664934813976288,0.43128445744514465,0.02568189799785614,-0.2343820482492447,0.11636430770158768,0.19449390470981598,0.2943546175956726,0.20046144723892212,0.08721446990966797,-0.29016613960266113,0.15487101674079895,0.15533530712127686,-0.13766059279441833,0.08987973630428314},{0.25597262382507324,0.16500818729400635,-0.35014140605926514,0.25931161642074585,0.21982645988464355,-0.023368673399090767,0.1124311238527298,-0.30707716941833496,-0.09656044840812683,-0.28700608015060425,-0.12305721640586853,0.06147255748510361,0.23286837339401245,-0.17128191888332367,-0.37290969491004944,0.2272433489561081,0.3501015901565552,0.07244279235601425,-0.0880805030465126,0.0008054230711422861,-0.19694776833057404,0.0715622678399086,0.2939154803752899,-0.09123940765857697,0.39971643686294556,-0.09427899122238159,-0.08936388790607452,0.3312346339225769,0.120353102684021,-0.1343008279800415,-0.33181074261665344,0.24108976125717163},{0.1265455186367035,0.1971440613269806,-0.1889243721961975,-0.07442618161439896,0.2472926825284958,-0.004520996939390898,0.06965826451778412,-0.19328486919403076,0.26125743985176086,0.22835037112236023,-0.05644847825169563,0.10103540122509003,0.018794212490320206,0.049731992185115814,0.07467029988765717,0.22704529762268066,0.13104507327079773,-0.11360175907611847,0.07608851045370102,-0.2823353409767151,-0.09126618504524231,-0.11254116892814636,0.025593582540750504,-0.1966409683227539,0.25117287039756775,-0.2553641200065613,0.07223118841648102,-0.23326049745082855,0.10017931461334229,-0.01471751555800438,-0.05391212925314903,0.10883641988039017},{-0.19712099432945251,0.21403273940086365,-0.21058228611946106,-0.2742735743522644,-0.07464607805013657,0.060291439294815063,0.036807816475629807,-0.00058992940466851,0.20245079696178436,-0.25935038924217224,-0.14079070091247559,-0.207699254155159,0.015346212312579155,0.19016768038272858,0.25781697034835815,-0.2895432412624359,0.2367755025625229,0.33408671617507935,0.1921977549791336,-0.16400183737277985,-0.11791977286338806,0.21576979756355286,-0.2005673497915268,0.18405194580554962,0.23874658346176147,0.2194267213344574,0.01808578334748745,-0.05090807005763054,-0.20832446217536926,-0.09842455387115479,0.048763543367385864,-0.2889444828033447},{0.21296700835227966,0.261366069316864,0.01037184614688158,0.42204731702804565,0.24232347309589386,-0.1991131454706192,-0.3098248243331909,0.05227978527545929,-0.08361882716417313,-0.32507339119911194,-0.01959291845560074,-0.0001986635325010866,-0.044517990201711655,-0.04980979859828949,-0.26220446825027466,-0.21954531967639923,0.2910149395465851,0.15660016238689423,0.36211371421813965,0.22379513084888458,-0.16999684274196625,0.15962131321430206,-0.25728490948677063,0.023791488260030746,0.07708129286766052,0.1859375536441803,-0.035308148711919785,0.24748846888542175,0.1977064311504364,0.17129626870155334,0.27723339200019836,-0.1080811396241188},{0.1872337907552719,-0.1837473064661026,-0.01810223050415516,0.15138807892799377,0.072407066822052,0.06299998611211777,-0.21750472486019135,0.13132137060165405,-0.13076850771903992,-0.009939745999872684,-0.2653331160545349,0.1455652415752411,0.18385633826255798,0.2675187885761261,-0.06649988144636154,-0.14317187666893005,0.20161718130111694,0.08603207767009735,-0.312724232673645,0.04745577648282051,0.21896685659885406,0.292087584733963,-0.09335460513830185,-0.23631669580936432,0.1908232867717743,-0.011945456266403198,-0.32728928327560425,-0.1855461299419403,-0.2673954367637634,0.22220578789710999,-0.2536836266517639,0.39013445377349854},{0.2224082350730896,-0.1592675745487213,-0.26601362228393555,0.17521487176418304,0.013958880677819252,-0.2343071699142456,-0.15783727169036865,0.32537615299224854,-0.2622351348400116,-0.02433871477842331,-0.04721842706203461,-0.28311264514923096,-0.2470262199640274,0.024981722235679626,-0.14922213554382324,0.28813064098358154,-0.25138863921165466,0.2414483278989792,0.1567768007516861,-0.2157672643661499,0.02580573409795761,0.04183968901634216,0.2629578709602356,-0.07394958287477493,0.13259273767471313,-0.022992577403783798,-0.06259684264659882,0.24412901699543,0.14676602184772491,-0.018347634002566338,0.15502749383449554,0.3413943350315094},{0.25682204961776733,-0.14460691809654236,-0.008091633208096027,-0.18107476830482483,-0.19571785628795624,0.1830439567565918,0.2166648954153061,0.2867216169834137,-0.18035373091697693,0.036476507782936096,0.011269022710621357,-0.00761351827532053,-0.27363431453704834,-0.22524581849575043,-0.3092251121997833,-0.15590867400169373,0.0666731670498848,0.1002393513917923,0.2876403033733368,0.20959539711475372,0.2143523395061493,-0.10368067026138306,0.27284201979637146,-0.07970520853996277,-0.2048475295305252,0.06308053433895111,0.19104568660259247,-0.14261314272880554,-0.15077689290046692,0.22507251799106598,0.11737632006406784,-0.24699856340885162},{-0.13843975961208344,0.30713993310928345,-0.02282135561108589,-0.13858015835285187,0.2250741571187973,0.10403798520565033,-0.27580317854881287,-0.2753366529941559,-0.26259708404541016,0.019591065123677254,-0.27776816487312317,-0.12518717348575592,-0.04842408001422882,-0.19404388964176178,0.2893162667751312,-0.23123206198215485,-0.14836111664772034,-0.1558559238910675,-0.1719539761543274,0.27961358428001404,0.191733717918396,0.11662156134843826,0.37408843636512756,0.10323520004749298,-0.18323425948619843,0.17532870173454285,0.20942917466163635,-0.10705868899822235,-0.06670613586902618,0.0506356880068779,-0.11027645319700241,-0.25197628140449524},{-0.04887606203556061,0.1770348697900772,-0.02685730718076229,-0.05662858858704567,-0.18258540332317352,0.34626877307891846,-0.02786514349281788,0.23383349180221558,0.06614807993173599,-0.21736513078212738,-0.11804814636707306,0.045961834490299225,-0.024301905184984207,0.301286518573761,0.045840274542570114,0.03281285986304283,-0.20861560106277466,0.04116426035761833,0.05336282029747963,-0.2606368958950043,0.008162686601281166,0.17666152119636536,-0.009994575753808022,-0.2697184979915619,-0.022297468036413193,-0.005465484224259853,0.3687971532344818,-0.09777606278657913,0.15890224277973175,0.08290249854326248,-0.021337969228625298,0.07618581503629684},{-0.082109734416008,0.17168685793876648,-0.06218752637505531,0.3101980984210968,0.2943735420703888,-0.15481162071228027,-0.19629916548728943,0.1488771140575409,-0.1104816198348999,-0.1559848040342331,-0.06861580908298492,0.05302174761891365,0.011988898739218712,0.03771527484059334,-0.3440954387187958,0.23992356657981873,0.1647324413061142,-0.13911141455173492,0.2706585228443146,-0.26117414236068726,0.23048283159732819,-0.28101545572280884,0.0964052751660347,-0.3469173312187195,-0.1407521516084671,0.10090123116970062,-0.14948615431785583,0.01657785102725029,-0.13891315460205078,0.16132953763008118,-0.054238006472587585,-0.24412120878696442},{-0.1556042730808258,0.11443320661783218,0.2291766107082367,0.38608112931251526,0.08770857751369476,0.1276121586561203,0.1276267021894455,-0.27625688910484314,0.15846042335033417,0.19059263169765472,0.08623481541872025,0.16888830065727234,0.06236088648438454,-0.18401619791984558,0.08443699032068253,0.21970917284488678,0.4632190465927124,-0.12405381351709366,0.35351476073265076,0.14267583191394806,0.4123578667640686,0.40539801120758057,-0.11903112381696701,0.2336272895336151,0.07757197320461273,-0.04609968513250351,0.09678653627634048,-0.03782298043370247,0.2659192681312561,-0.11059016734361649,-0.35281628370285034,-0.3750266432762146},{-0.07033146917819977,-0.08290965855121613,-0.13539311289787292,-0.21357133984565735,0.40891650319099426,-0.2676021158695221,0.28655365109443665,-0.021246250718832016,-0.039569590240716934,0.06589359045028687,0.19952814280986786,-0.3810848295688629,0.21722330152988434,0.2550143003463745,-0.14988774061203003,0.25507408380508423,-0.20756882429122925,-0.39989787340164185,-0.07396666705608368,-0.19357815384864807,-0.044158607721328735,0.2520567774772644,-0.032817356288433075,0.28357815742492676,-0.09674200415611267,0.17611584067344666,0.12624198198318481,-0.3725915551185608,-0.09665673226118088,-0.054524362087249756,-0.1786770075559616,0.15371884405612946},{0.15749655663967133,-0.241813063621521,-0.05287429317831993,-0.2978106737136841,0.15297356247901917,0.011900173500180244,0.0005669279489666224,0.14796818792819977,-0.03849955275654793,-0.16760383546352386,-0.14609040319919586,-0.02009139396250248,-0.45096147060394287,0.059332434087991714,-0.40125349164009094,-0.20572689175605774,0.20457784831523895,-0.3267419636249542,-0.09217114746570587,0.11612831801176071,-0.08070458471775055,0.17062290012836456,0.21012260019779205,0.017927944660186768,-0.03370782732963562,0.07428650557994843,-0.10905968397855759,0.09108252078294754,0.010224729776382446,0.054511889815330505,0.3248601257801056,-0.511683464050293},{0.189797505736351,-0.37232017517089844,0.11459703743457794,0.05905047431588173,-0.2163383662700653,-0.23602288961410522,-0.13035842776298523,-0.17589840292930603,0.0018268600106239319,0.010670242831110954,-0.14819428324699402,-0.24299879372119904,0.015634793788194656,-0.32082197070121765,0.2461411952972412,0.08682001382112503,-0.3150296211242676,-0.14625057578086853,-0.0754830539226532,-0.07711168378591537,-0.25516578555107117,0.13698650896549225,0.20886456966400146,-0.017047639936208725,-0.2008325308561325,-0.18902254104614258,0.04003036394715309,-0.18663029372692108,0.10663305222988129,0.020069103688001633,0.07046636193990707,0.18524396419525146},{-0.27524450421333313,0.2941593825817108,0.15003257989883423,0.13240700960159302,-0.1382676064968109,-0.060334786772727966,-0.041811905801296234,0.22042813897132874,-0.12016669660806656,0.13827131688594818,-0.27755847573280334,-0.2652663588523865,-0.2655848264694214,0.23613348603248596,0.03869782015681267,-0.1766068935394287,0.23915202915668488,0.1498747617006302,-0.12206723541021347,-0.0835970863699913,0.07261818647384644,0.14490750432014465,0.06387867033481598,0.3186529576778412,0.1511247456073761,-0.1473207175731659,-0.08325107395648956,-0.22177796065807343,-0.07252677530050278,-0.0032757020089775324,0.16207952797412872,-0.2882100045681},{-0.2734881639480591,-0.1737673133611679,-0.32663053274154663,0.011767390184104443,-0.09026423841714859,0.057462844997644424,0.05594349652528763,0.056985318660736084,0.03618079423904419,0.02334165759384632,0.3013748824596405,0.28913968801498413,-0.02955777570605278,-0.039763569831848145,0.07772651314735413,-0.05032036826014519,0.31804531812667847,0.21420076489448547,-0.27110907435417175,0.06846359372138977,0.19791220128536224,0.2854798436164856,0.3024793267250061,-0.2514204680919647,0.32729649543762207,0.06365461647510529,-0.18612009286880493,-0.10002318024635315,-0.08353084325790405,-0.09366531670093536,0.3436650335788727,0.08668804168701172},{0.07257197052240372,0.1812928318977356,-0.015383395366370678,0.2637922167778015,0.0202318225055933,0.16789023578166962,0.23331698775291443,0.2210356742143631,-0.2835446298122406,-0.010114120319485664,-0.39840203523635864,0.22936157882213593,0.3076225519180298,-0.12834757566452026,0.2478732317686081,0.3451053202152252,-0.31970149278640747,-0.24887001514434814,0.055435843765735626,-0.2488558143377304,-0.10570212453603745,-0.24832621216773987,0.04114808514714241,-0.3059971034526825,0.07944384962320328,-0.2698541283607483,0.20591875910758972,0.26253464818000793,0.17984913289546967,0.256640762090683,0.038828250020742416,0.2545212209224701},{-0.09994611144065857,0.1237778589129448,-0.09636927396059036,-0.12408889085054398,-0.15599887073040009,-0.14943671226501465,-0.2438570261001587,-0.32344529032707214,-0.09352681785821915,0.19414053857326508,0.09045868366956711,-0.12598788738250732,0.08378969132900238,-0.3227720856666565,0.2223726361989975,-0.4146948456764221,-0.12302225828170776,-0.18358679115772247,0.007347448263317347,0.02905532717704773,-0.18107256293296814,-0.03318339213728905,-0.14716866612434387,0.16769324243068695,-0.28283748030662537,0.13642987608909607,0.13552914559841156,0.2627045214176178,-0.22264637053012848,-0.21722374856472015,0.14780375361442566,-0.049284566193819046},{-0.07657486200332642,-0.405246764421463,-0.058408115059137344,0.010423817671835423,0.09927894920110703,-0.0827169120311737,-0.053752463310956955,0.09956663846969604,-0.053231000900268555,-0.003956276457756758,0.1483706682920456,0.02181493490934372,-0.06602118909358978,0.29139474034309387,-0.0840117335319519,0.3703177273273468,-0.23849189281463623,0.2567538022994995,-0.10121380537748337,0.081545390188694,-0.03953595086932182,-0.14649103581905365,-0.3136083781719208,0.0639568343758583,-0.25918158888816833,-0.1808491200208664,-0.11061905324459076,0.24720202386379242,-0.3085215091705322,-0.16378441452980042,0.15303035080432892,0.2493238002061844}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.07717427611351013,-0.18364867568016052,0.06738854944705963,0.07708059996366501},{-0.14012446999549866,0.05361306294798851,0.1354486495256424,0.05713136866688728},{-0.20812977850437164,-0.23095086216926575,0.2798252999782562,-0.17387863993644714},{0.3377102017402649,-0.00913348887115717,0.023046646267175674,-0.09280622750520706},{-0.20422683656215668,0.3328720033168793,0.014784027822315693,-0.10746443271636963},{-0.2369297444820404,-0.25938400626182556,-0.15195833146572113,0.36486953496932983},{-0.22706124186515808,0.18946509063243866,0.10766696184873581,0.21602922677993774},{-0.056822389364242554,0.3263608515262604,-0.27324941754341125,-0.1274579018354416},{0.025065075606107712,-0.3254444897174835,-0.054318733513355255,0.19689099490642548},{-0.033466555178165436,-0.16382604837417603,0.13637283444404602,-0.1899614781141281},{-0.2260454148054123,-0.28005489706993103,0.28810736536979675,0.18565252423286438},{0.19882118701934814,0.07340463995933533,0.2136685997247696,0.3451153635978699},{0.15573936700820923,-0.06098931282758713,-0.07941513508558273,-0.14676527678966522},{0.17802828550338745,0.35095539689064026,0.12109138071537018,0.13178075850009918},{-0.06982439756393433,0.19287173449993134,-0.20356126129627228,-0.33416295051574707},{0.2345677614212036,0.05462581664323807,0.06814830005168915,-0.04681295529007912},{0.24737456440925598,-0.12730970978736877,0.24593199789524078,0.2508891820907593},{-0.013817357830703259,-0.018252501264214516,-0.18862394988536835,0.22945718467235565},{0.2523060739040375,0.14667640626430511,0.058491673320531845,-0.2366604506969452},{-0.12111140787601471,-0.26280370354652405,-0.22711019217967987,-0.02669619955122471},{0.16200438141822815,0.2803325653076172,0.4523724317550659,-0.21532660722732544},{-0.15120403468608856,0.10036993026733398,0.37182340025901794,0.18141470849514008},{-0.027339939028024673,0.0008120984421111643,0.008161978796124458,0.09591203182935715},{-0.2641580402851105,-0.11703044176101685,0.2351049780845642,0.02261648140847683},{0.0024131617974489927,-0.28715482354164124,0.08272363245487213,0.20538322627544403},{-0.31776300072669983,0.15590499341487885,-0.17311185598373413,0.02861165814101696},{-0.15406647324562073,-0.29308953881263733,0.26234036684036255,0.20125310122966766},{-0.06279466301202774,0.10717956721782684,-0.04739244282245636,0.327396959066391},{-0.052239593118429184,0.3036651015281677,-0.09829487651586533,0.16751497983932495},{0.1335316151380539,-0.26686057448387146,-0.17868958413600922,-0.003427131101489067},{-0.23861633241176605,0.1811848133802414,-0.008236318826675415,0.0008430780144408345},{-0.020004671066999435,-0.45747774839401245,-0.37474071979522705,-0.3869103491306305}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.11573956161737442,0.12526200711727142,0.02678540349006653,0.0848158597946167,0.053903497755527496,-0.09712415188550949,-0.10159000754356384,-0.03424961492419243,-0.0645211711525917,-0.0528765544295311,-0.09811324626207352,0.149861142039299,0.1631694734096527,-0.04048077017068863,-0.14002320170402527,0.08056766539812088};
static const float actor_encoder_self_encoder_2_bias[16] = {0.09205847233533859,0.043387435376644135,-0.03673548623919487,-0.15489526093006134,0.035595305263996124,0.007923685014247894,0.04246056079864502,-0.0324355810880661,0.021704090759158134,0.07037407159805298,0.08909820765256882,-0.07520009577274323,-0.049794647842645645,0.013409406878054142,0.014390036463737488,0.034377772361040115};
static const float actor_encoder_feed_forward_0_bias[32] = {0.026896938681602478,0.0018297522328794003,-0.035028353333473206,0.06568653881549835,-0.02277008630335331,-0.03672505170106888,-0.0117186913266778,-0.026988044381141663,0.026678800582885742,-0.0369870699942112,0.026791581884026527,0.05781848728656769,0.013687324710190296,0.06060091778635979,-0.0970306247472763,0.012805970385670662,0.10159178823232651,-0.01569320820271969,0.037294600158929825,-0.04384488984942436,0.027689054608345032,0.056316714733839035,-0.010876690968871117,-0.02310362085700035,0.00902603194117546,-0.048608556389808655,0.05529351532459259,-0.01264627929776907,-0.012535267509520054,0.003796340897679329,-0.04523159936070442,-0.001062289928086102};
static const float action_parameterization_distribution_linear_bias[4] = {0.05596431344747543,0.00710395397618413,0.03619218245148659,0.04717904329299927};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-0.7881232500076294,-1.0812374353408813,0.030848124995827675,-1.121492624282837,-1.6126993894577026,0.49510928988456726,-0.4456028640270233,-0.4672601819038391},{-0.48371854424476624,-0.05138525739312172,-0.6014546155929565,0.26386556029319763,-0.6657735705375671,-1.3894877433776855,1.035526156425476,-0.701246440410614},{0.5235249400138855,-0.6497324109077454,0.004430543165653944,-0.38748544454574585,0.6142091155052185,-0.8903476595878601,0.780093252658844,1.4978985786437988}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.4629582464694977,0.575077474117279,0.4768590033054352,-0.6926975846290588,-0.15016552805900574,-0.2531966269016266,-0.16828621923923492,-0.05062061548233032},{0.5476931929588318,0.29561299085617065,-0.5463390350341797,-0.5135325193405151,-0.1669112741947174,-0.4503619372844696,-0.9803260564804077,0.6227338910102844},{0.4018644392490387,0.19132940471172333,-0.1399044394493103,-0.4387802481651306,-0.2641337513923645,0.3632349669933319,-0.012055881321430206,0.14304491877555847},{0.11929333209991455,-0.46760275959968567,-0.3897818922996521,0.36303383111953735,0.021198803558945656,-0.09997272491455078,-1.1205590963363647,0.764266312122345},{-0.30031120777130127,0.0149466497823596,0.33568212389945984,-0.5767855048179626,0.035258498042821884,0.046427831053733826,-0.5393713712692261,0.7932375073432922},{-0.14218659698963165,-0.12752865254878998,-0.7627925872802734,-0.8165137767791748,-0.28333780169487,-0.22571614384651184,-0.10370767116546631,-0.5874191522598267},{-0.21131224930286407,0.47306904196739197,0.859104573726654,0.1750219166278839,-0.1358577013015747,-0.5643035769462585,-0.255085289478302,0.7528947591781616},{0.17174039781093597,0.10223855078220367,1.0569431781768799,-0.675919234752655,0.34680798649787903,-0.32687515020370483,0.5072546005249023,0.12805341184139252}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {0.007887824438512325,0.028721213340759277,0.005477195605635643,0.0011278536403551698,-0.005920328199863434,-0.006877824664115906,-0.02854553796350956,-0.02082870341837406};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {0.07179693132638931,-0.022612744942307472,-0.060035426169633865,0.05954407528042793,0.014552264474332333,-0.01553021464496851,-0.03956807032227516,-0.0011116481618955731};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
