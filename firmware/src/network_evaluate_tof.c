#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2788079082965851,0.009993592277169228,-0.028934147208929062,0.20256972312927246,0.4226747453212738,-0.3499787151813507,-0.2530774772167206,0.1311400979757309,0.2919115424156189,-0.4618384838104248,0.4165177345275879,-0.026181738823652267,0.36648988723754883,0.11550156027078629,-0.14944151043891907,0.09165489673614502},{-0.3836292028427124,-0.2622472643852234,-0.09720159322023392,-0.1764110028743744,0.24766477942466736,0.5363410711288452,0.1839127093553543,0.014678253792226315,0.08669152855873108,0.17396435141563416,-0.13799381256103516,-0.05048893019556999,-0.023423342034220695,0.17506736516952515,0.31135621666908264,-0.19041185081005096},{0.08829125761985779,0.23459435999393463,0.30002954602241516,0.5123478174209595,0.01567458175122738,0.050429414957761765,0.7411583662033081,-0.15286065638065338,-0.21191921830177307,0.047206297516822815,-0.0028647470753639936,-0.10490195453166962,0.08113650977611542,0.623439610004425,-0.47178223729133606,0.07145388424396515},{0.23727884888648987,-0.17990532517433167,-0.14080415666103363,-0.09278418868780136,0.03558686748147011,0.04343067482113838,0.07527963072061539,-0.19573591649532318,-0.0769127681851387,-0.029092948883771896,0.5287958979606628,-0.24543288350105286,-0.19272811710834503,-0.07763190567493439,0.23670685291290283,0.050901781767606735},{-0.13532720506191254,0.03246767818927765,0.15789248049259186,-0.2935294806957245,0.3131892681121826,0.2509346604347229,0.19673596322536469,-0.20780038833618164,-0.27925682067871094,0.29786553978919983,-0.25540655851364136,-0.3255974054336548,0.03995026648044586,-0.15638287365436554,0.307492733001709,0.014043571427464485},{-0.008965013548731804,-0.06991548091173172,0.04264264926314354,0.0691232979297638,0.22116944193840027,-0.09102220833301544,0.4996244013309479,-0.17712390422821045,-0.1534549593925476,-0.05776313319802284,0.27795034646987915,0.08228548616170883,0.23213015496730804,0.02205548994243145,0.3014954626560211,0.25467732548713684},{-0.25200310349464417,0.20747630298137665,-0.1033555194735527,0.06176888942718506,-0.24285826086997986,-0.15338198840618134,-0.021729500964283943,-0.10885544121265411,0.1728244572877884,0.5165190696716309,-0.44216713309288025,-0.10901769250631332,0.26007843017578125,0.18269076943397522,-0.04514072835445404,0.378605455160141},{-0.38415783643722534,0.3722749948501587,-0.1986800730228424,-0.3051699995994568,0.2877563238143921,-0.20145687460899353,-0.36763885617256165,-0.6849994659423828,-0.10714519768953323,-0.30955544114112854,0.5182873606681824,0.10582351684570312,0.0688009187579155,0.483235239982605,-0.02506016567349434,0.6665918231010437},{0.22874490916728973,0.14308300614356995,-0.329703688621521,0.06268008053302765,-0.30971693992614746,-0.38220304250717163,0.2634691298007965,-0.7208109498023987,-0.16413897275924683,-0.043210066854953766,0.3284800946712494,-0.7840192914009094,-0.35164159536361694,0.37778881192207336,0.1582556813955307,-0.16870594024658203},{0.709031879901886,-0.9649927020072937,-0.07646742463111877,0.21256504952907562,0.2081695795059204,-0.28250765800476074,-0.1233847364783287,-0.005080989561975002,-0.3591141998767853,0.06357388943433762,-0.2254866361618042,-0.289263516664505,0.6773298978805542,-0.2829653322696686,-0.7609862685203552,-0.3504621684551239},{0.19244810938835144,0.19480319321155548,-0.2610976994037628,0.07541713863611221,-0.008034074679017067,-0.3238958418369293,-0.060273464769124985,0.06766706705093384,-0.14844338595867157,0.3069106936454773,-0.04909699037671089,0.20621195435523987,-0.04021906852722168,0.35561078786849976,0.2333376407623291,-0.22982382774353027},{-0.22306935489177704,0.20914025604724884,0.5407215356826782,-0.6174885630607605,0.22862708568572998,0.15687590837478638,0.06449439376592636,0.38858240842819214,0.12168635427951813,0.5908421277999878,0.05755526199936867,-0.21695297956466675,0.3308742046356201,0.053667452186346054,0.2312907874584198,-0.30580562353134155},{0.2469046413898468,-0.23743781447410583,0.0014854685869067907,0.267499178647995,-0.17627741396427155,-0.36275142431259155,-0.08494555205106735,0.43074920773506165,0.1471460461616516,-0.10392835736274719,-0.2148887813091278,0.4313336908817291,0.6008501052856445,0.19314932823181152,-0.18547356128692627,0.6593198776245117},{0.3519718050956726,0.08978316187858582,-0.35209226608276367,0.2548304498195648,-0.1608523428440094,-0.13948793709278107,-0.21829251945018768,0.12343205511569977,-0.5100792646408081,-0.43693068623542786,0.0014596307883039117,0.2238408774137497,-0.564293622970581,-0.30832985043525696,-0.4501040279865265,-0.03879851847887039},{-0.030506376177072525,0.310284823179245,0.3514108955860138,-0.3312114179134369,-0.37646418809890747,0.1349048912525177,0.24316750466823578,0.0995628833770752,0.3821970820426941,0.25984230637550354,-0.32659149169921875,0.04516199976205826,0.0601542666554451,-0.23398207128047943,0.1377890259027481,-0.21690495312213898},{-0.3280768096446991,-0.016107525676488876,-0.014866454526782036,0.2620970904827118,-0.1118658259510994,-0.06800886988639832,-0.1441318392753601,-0.09063472598791122,-0.3318910598754883,-0.042332664132118225,0.29050323367118835,0.11682790517807007,-0.2598057985305786,-0.16637460887432098,-0.452841579914093,-0.036467865109443665},{-0.3859715163707733,0.14246685802936554,-0.11848364025354385,0.04386407881975174,-0.15301766991615295,0.17391125857830048,0.2888250946998596,0.1314479112625122,0.33264321088790894,-0.2364920675754547,-0.06323009729385376,-0.1334323287010193,-0.01744619943201542,0.035877108573913574,-0.08835387229919434,-0.1873980611562729},{0.12642940878868103,-0.4475214183330536,0.18210318684577942,0.22570034861564636,0.03625886142253876,0.33290067315101624,0.30008041858673096,0.1820719838142395,-0.09967906773090363,-0.26371848583221436,-0.1825711578130722,-0.0764809101819992,-0.11249132454395294,-0.33151301741600037,0.19362972676753998,-0.005342029966413975}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.16654463112354279,0.2568461298942566,0.3016633689403534,-0.045135293155908585,-0.212370365858078,0.03762703016400337,0.02698485180735588,0.24387288093566895,-0.042104724794626236,0.28845351934432983,0.393494188785553,-0.36926335096359253,-0.033361632376909256,0.09179861843585968,0.04690283536911011,-0.06249072030186653},{-0.39805281162261963,0.13028377294540405,-0.20507211983203888,0.2957460284233093,0.22189673781394958,-0.18856759369373322,-0.33439114689826965,-0.2128305435180664,0.28369706869125366,0.23117800056934357,0.03913665935397148,0.23941853642463684,-0.5372694730758667,0.23855964839458466,-0.24595977365970612,0.4290754199028015},{-0.31040436029434204,0.16213291883468628,-0.29930025339126587,-0.024426665157079697,-0.4311431348323822,-0.29674261808395386,-0.08871521055698395,0.028901919722557068,-0.1687447428703308,0.3862117528915405,0.35003265738487244,-0.04268491640686989,0.08729344606399536,-0.28449419140815735,-0.09122013300657272,0.010826838202774525},{0.25256240367889404,-0.22310929000377655,0.13311436772346497,0.28995180130004883,-0.47278687357902527,-0.3492116332054138,0.18319737911224365,0.04263497143983841,0.35293540358543396,-0.07142077386379242,0.27427756786346436,0.15147218108177185,-0.2833411395549774,-0.08604148775339127,0.01930144988000393,-0.3159676492214203},{-0.26213109493255615,0.03638673946261406,0.27257391810417175,-0.30313897132873535,0.14612311124801636,0.3757781386375427,-0.2652341425418854,0.20026086270809174,-0.13747794926166534,0.17903348803520203,0.0032204301096498966,0.024328719824552536,-0.1629692018032074,0.037677567452192307,-0.15915022790431976,-0.1586470752954483},{0.01255998108536005,-0.2507374584674835,-0.0471721850335598,-0.35475558042526245,0.2800120413303375,0.1118820533156395,-0.07993302494287491,-0.03187909349799156,-0.18822145462036133,0.3630303740501404,0.278309166431427,-0.07655853033065796,-0.17183823883533478,0.17690879106521606,-0.03970613330602646,-0.2862236499786377},{0.26698073744773865,-0.2704910337924957,0.31371456384658813,-0.24583709239959717,-0.49961498379707336,-0.14531457424163818,-0.40311023592948914,0.4411631226539612,-0.2026120275259018,-0.23348982632160187,-0.15946386754512787,-0.016993140801787376,-0.18763655424118042,0.01913093402981758,0.4635531008243561,-0.439998060464859},{-0.2527817189693451,0.4492391049861908,-0.07145637273788452,0.3153136372566223,0.035054922103881836,-0.2894384562969208,-0.13639135658740997,0.19703233242034912,-0.03712504357099533,0.4957069456577301,0.0514475554227829,-0.2288932055234909,0.0949128270149231,-0.1295921802520752,0.07944109290838242,0.13358545303344727},{0.1291102021932602,0.26855048537254333,-0.17880567908287048,-0.321743905544281,0.3476818799972534,-0.2433013916015625,0.12372823804616928,-0.30069321393966675,0.10484907031059265,0.0041623786091804504,0.05458686500787735,0.12185275554656982,0.03507787734270096,-0.261953204870224,-0.0037006151396781206,0.21331383287906647},{-0.31191664934158325,-0.05071553215384483,-0.39739885926246643,-0.3157888352870941,0.2448635697364807,-0.3618130385875702,-0.21712163090705872,0.24657368659973145,-0.14743565022945404,0.2048550546169281,-0.05846919119358063,-0.07306700199842453,-0.4108935296535492,0.0033045958261936903,-0.26657745242118835,-0.36727654933929443},{-0.14599640667438507,-0.1467997282743454,-0.05487828329205513,-0.25197556614875793,-0.3996032476425171,0.04273997247219086,0.1502378135919571,-0.4474952518939972,-0.04096665978431702,0.025191552937030792,0.32701653242111206,-0.018348850309848785,0.28744006156921387,0.02729192189872265,0.14689335227012634,0.21587324142456055},{-0.06806677579879761,-0.0855170413851738,-0.34320908784866333,0.40693819522857666,0.10278986394405365,-0.155739426612854,0.16559937596321106,0.07569257915019989,-0.4163263738155365,0.16118504106998444,-0.29719680547714233,-0.16152659058570862,-0.3744198977947235,0.41785791516304016,-0.2954799234867096,0.03561734780669212},{-0.1922655999660492,-0.37755435705184937,-0.07836148887872696,0.17649337649345398,-0.161986842751503,-0.13727803528308868,-0.08043569326400757,0.3832312524318695,0.4396783709526062,0.05695205181837082,-0.0004789895028807223,-0.20058336853981018,0.20067857205867767,-0.26335403323173523,0.12454870343208313,-0.18496829271316528},{-0.2998018264770508,-0.5202273726463318,-0.16586266458034515,-0.15031518042087555,-0.5216265916824341,0.43236592411994934,-0.20587290823459625,0.16108672320842743,-0.19697368144989014,-0.27422067523002625,-0.317386269569397,0.4348130226135254,-0.23317381739616394,0.04278052970767021,-0.17330707609653473,0.3376486301422119},{-0.3555309772491455,0.3194744884967804,-0.1595889776945114,0.14579160511493683,-0.34866011142730713,0.20112396776676178,-0.006474663503468037,-0.37494468688964844,0.15843302011489868,0.15398617088794708,-0.16622519493103027,0.0795619934797287,0.3057185411453247,-0.23238761723041534,-0.3113114535808563,-0.11895093321800232},{-0.15913589298725128,-0.3416702151298523,-0.45532581210136414,0.26436248421669006,0.11757287383079529,0.04881785064935684,-0.23910056054592133,0.16596078872680664,-0.33255288004875183,-0.2578427791595459,-0.28756630420684814,0.228049635887146,-0.18396919965744019,0.17376966774463654,0.017915967851877213,0.3636731207370758}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.08523232489824295,-0.03724987804889679,0.16852357983589172,-0.11487860232591629,-0.08945366740226746,0.11106830090284348,0.17837615311145782,-0.2769469916820526,-0.2030317187309265,0.2432984858751297,0.1505870372056961,0.13351920247077942,0.0740579292178154,0.16725584864616394,-0.1488693356513977,0.1882636398077011,0.09280841797590256,-0.33851972222328186,-0.18304646015167236,-0.08467333763837814,-0.1422548145055771,0.04657672345638275,-0.19460107386112213,0.27673086524009705,-0.18080084025859833,-0.07164110243320465,0.08823797106742859,0.21894732117652893,-0.2343394160270691,-0.17050260305404663,0.17547093331813812,0.24717892706394196},{0.19666914641857147,-0.06853882968425751,0.20053131878376007,-0.13263683021068573,-0.06480084359645844,0.25808021426200867,0.029406141489744186,-0.0183110348880291,-0.054906293749809265,-0.005569209810346365,-0.08777504414319992,-0.030499227344989777,0.2690553665161133,0.2190951555967331,0.1541045904159546,0.03213298320770264,-0.1682824045419693,-0.3091864287853241,0.09993349015712738,0.03950140252709389,0.08711516857147217,0.3189959228038788,0.24673134088516235,-0.1806664764881134,0.025011632591485977,0.26411503553390503,-0.34939301013946533,0.1854824274778366,0.08187536150217056,-0.2290833741426468,-0.06011131778359413,-0.01818242110311985},{-0.06416022032499313,-0.06515926122665405,0.22490067780017853,-0.21006090939044952,-0.14369237422943115,0.08360760658979416,-0.19723564386367798,0.20154964923858643,0.17439192533493042,0.04214010760188103,-0.18304502964019775,0.034211043268442154,0.311696857213974,-0.2624204158782959,0.12909862399101257,-0.013731792569160461,-0.37463098764419556,0.25020715594291687,-0.2828591763973236,-0.03719782456755638,-0.04841572791337967,-0.09622492641210556,-0.0460444875061512,-0.08504945039749146,-0.05203482136130333,0.30057069659233093,-0.08084867894649506,0.09118282049894333,0.24095597863197327,-0.30056503415107727,-0.16260908544063568,-0.03098846599459648},{0.14637209475040436,-0.1500178873538971,0.007946336641907692,-0.30464333295822144,0.13937434554100037,-0.15529660880565643,-0.10799366235733032,0.1896989494562149,0.0528411939740181,0.15537592768669128,0.05755758285522461,-0.09307023882865906,-0.143620103597641,-0.07498183101415634,0.30139458179473877,-0.19816286861896515,-0.03361649438738823,-0.1426478773355484,-0.19723166525363922,0.08628121763467789,-0.14539062976837158,0.09350518882274628,-0.2647395431995392,0.19967754185199738,-0.27797171473503113,0.11388945579528809,-0.05655527114868164,-0.17561635375022888,0.0703253448009491,-0.04577239602804184,0.2574436664581299,-0.16937832534313202},{0.28143104910850525,0.004898542538285255,0.0754965990781784,0.3168679475784302,-0.20872452855110168,-0.042737435549497604,0.1205010637640953,-0.09157127887010574,0.10533002763986588,-0.16666479408740997,-0.03486694023013115,-0.05238265171647072,-0.1368541568517685,-0.1124587133526802,0.3771766126155853,0.3168429732322693,-0.1162395030260086,-0.3150160014629364,0.17535528540611267,-0.07597034424543381,-0.17237526178359985,0.2977522611618042,0.2941857576370239,0.07864627242088318,-0.08239513635635376,-0.14156579971313477,-0.07019984722137451,0.2897484600543976,0.19616080820560455,0.1215604692697525,0.1291583627462387,-0.2794361114501953},{0.2982157766819,-0.14013615250587463,0.05202791467308998,0.11874976754188538,-0.11780335009098053,-0.320737361907959,-0.2518891394138336,-0.3288230895996094,-0.2342836707830429,0.02618229389190674,-0.024582592770457268,0.03124949336051941,-0.10177621990442276,-0.0715320035815239,-0.17916545271873474,-0.2126225382089615,0.13541443645954132,-0.030253246426582336,-0.27954134345054626,0.241232231259346,-0.06436587125062943,-0.20757533609867096,0.25112372636795044,-0.12517595291137695,-0.14411543309688568,-0.24374832212924957,-0.1624453365802765,0.09363413602113724,0.08012085407972336,0.25284507870674133,-0.23701664805412292,0.20066118240356445},{0.19698692858219147,0.13596880435943604,0.28318682312965393,-0.1222444400191307,0.2762627899646759,-0.2219974249601364,-0.29478341341018677,-0.03419182449579239,0.19535616040229797,0.0811183899641037,-0.10104712098836899,0.1250985711812973,0.03341606631875038,0.29619300365448,0.17478607594966888,0.017592012882232666,-0.2579820454120636,0.07249543070793152,0.03439885005354881,-0.06117446348071098,-0.03528511896729469,0.12651003897190094,0.18467001616954803,0.05472053214907646,-0.29732826352119446,-0.19513346254825592,-0.3002193868160248,-0.2782738506793976,0.0762810930609703,-0.09865149110555649,0.2581174373626709,0.15014497935771942},{0.26553142070770264,-0.31015774607658386,0.10094206780195236,-0.372151255607605,-0.3101174533367157,0.26322826743125916,0.4101124703884125,0.21420300006866455,-0.08064648509025574,0.03424456715583801,0.18953990936279297,-0.13814711570739746,0.13940685987472534,0.29878634214401245,-0.03874573856592178,0.18171249330043793,0.40310797095298767,-0.23637710511684418,-0.028836967423558235,-0.3362407088279724,0.20324203372001648,0.19754527509212494,0.22335386276245117,0.10659366101026535,0.150374636054039,0.078640878200531,0.2112531065940857,0.250753253698349,-0.1206211969256401,-0.295628160238266,0.2549745440483093,1.955506559170317e-05},{0.043992601335048676,-0.06451117247343063,0.2568097710609436,0.24189358949661255,-0.1833035945892334,-0.280662477016449,-0.06185397133231163,0.2703871726989746,-0.22077089548110962,-0.23815400898456573,0.05036826431751251,0.09432262927293777,0.1940377801656723,-0.29357028007507324,0.1703254133462906,-0.16174523532390594,-0.22721980512142181,0.19170020520687103,-0.24910187721252441,0.3158571124076843,-0.3154171407222748,-0.2893252968788147,-0.2930149734020233,0.23123595118522644,0.11200644075870514,0.07462724298238754,0.3061186671257019,0.22161057591438293,-0.13653849065303802,-0.30624911189079285,-0.16077373921871185,0.11321699619293213},{0.29374057054519653,0.006260822061449289,0.02789141610264778,0.19859592616558075,0.023075826466083527,0.20096562802791595,-0.041132211685180664,0.23368938267230988,-0.027180606499314308,0.03222082182765007,0.17958210408687592,0.07833380997180939,-0.12611475586891174,-0.2782832086086273,0.13557033240795135,0.12536776065826416,0.1058223620057106,-0.11262247711420059,-0.07447100430727005,0.02214125543832779,0.11136488616466522,-0.24483591318130493,0.3087288439273834,0.08996214717626572,0.04777674376964569,0.1255171000957489,-0.3375852406024933,-0.23358377814292908,-0.04690480977296829,-0.02128571830689907,0.1198001354932785,0.16937321424484253},{-0.07149506360292435,0.08306694775819778,-0.0039466083981096745,0.19485528767108917,-0.06775572150945663,0.287138432264328,0.12654733657836914,-0.06956944614648819,0.1900765299797058,-0.3316410779953003,-0.11649428308010101,0.126689612865448,-0.09583358466625214,0.04457372799515724,-0.26652613282203674,0.05259140953421593,0.07326622307300568,0.1539493203163147,0.1165308803319931,-0.12447267025709152,-0.2471977323293686,0.14769844710826874,0.2741323411464691,0.19916991889476776,-0.33794105052948,0.34688231348991394,-0.1825169324874878,-0.0028155893087387085,-0.08218227326869965,0.1609247922897339,0.14687399566173553,0.20994514226913452},{-0.18487246334552765,0.28450843691825867,-0.09477851539850235,-0.03674815222620964,-0.21918919682502747,-0.12306692451238632,0.16924846172332764,-0.2615838646888733,-0.012544986791908741,-0.22228547930717468,-0.24033832550048828,-0.06099589169025421,0.18691062927246094,-0.3373332917690277,-0.14981421828269958,-0.335850328207016,-0.18021972477436066,-0.04583732411265373,0.2772904336452484,-0.30832409858703613,0.0711524486541748,-0.1703193038702011,-0.01214207150042057,0.2788887619972229,-0.13817909359931946,0.17909471690654755,0.35474303364753723,-0.07969803363084793,-0.0036324774846434593,0.31074589490890503,-0.15717995166778564,-0.2513025104999542},{-0.0010378732113167644,0.25808823108673096,0.23579342663288116,-0.25140297412872314,0.257701575756073,-0.0029138661921024323,-0.19830657541751862,-0.06317193806171417,0.11460112780332565,-0.28341662883758545,-0.08236150443553925,0.06572375446557999,0.2535390853881836,0.053657274693250656,0.09738809615373611,-0.00019052819698117673,0.14868773519992828,-0.3115437924861908,0.3434496521949768,0.09659474343061447,-0.23014920949935913,0.2362181395292282,-0.024734294041991234,-0.26417550444602966,0.2095312923192978,-0.08068634569644928,-0.11849159747362137,-0.12104860693216324,0.07884889096021652,-0.1140306368470192,0.3246365487575531,0.232651025056839},{0.13357941806316376,-0.19210302829742432,-0.1762697398662567,0.09688744693994522,0.13607454299926758,0.3001915514469147,-0.11603856086730957,-0.22666902840137482,0.28815367817878723,0.08744079619646072,0.032972052693367004,0.08806686103343964,-0.28910231590270996,0.014757206663489342,-0.18099181354045868,-0.24365635216236115,0.0484473779797554,-0.08908284455537796,0.18863500654697418,0.24661169946193695,-0.2076420933008194,0.05860089883208275,-0.13993847370147705,0.04267358034849167,0.0154897915199399,-0.24211792647838593,-0.16305412352085114,-0.18384544551372528,-0.03388228267431259,-0.14880891144275665,0.23060135543346405,-0.19106553494930267},{0.05691290646791458,0.24302899837493896,0.18190991878509521,-0.22816263139247894,-0.07124615460634232,-0.06707699596881866,0.17329302430152893,-0.03758585825562477,0.19256117939949036,0.08500868827104568,0.13673551380634308,0.10021853446960449,0.08646249026060104,0.0028225358109921217,-0.08289778977632523,0.21542631089687347,-0.2527766525745392,-0.35076427459716797,-0.20175375044345856,0.1445370465517044,0.017913151532411575,-0.17193163931369781,-0.21458400785923004,-0.1764928549528122,-0.31953567266464233,-0.042832374572753906,0.2399253398180008,0.013128530234098434,-0.10527408123016357,0.19271153211593628,-0.1606120467185974,0.044519778341054916},{-0.15544098615646362,-0.18999165296554565,-0.19222596287727356,0.06744234263896942,-0.20476588606834412,-0.08601977676153183,-0.10014475136995316,-0.06356062740087509,-0.3082977831363678,-0.16396209597587585,0.09170365333557129,0.16257329285144806,-0.2535364329814911,0.20102599263191223,-0.005268888548016548,0.20348875224590302,0.0063963462598621845,-0.010086830705404282,0.006442264188081026,0.0918855369091034,0.16350018978118896,0.3220332860946655,0.08436670154333115,0.23776808381080627,0.06757017970085144,-0.20136651396751404,-0.12145627290010452,0.3078370988368988,-0.012663082219660282,-0.19966980814933777,-0.10435043275356293,-0.16331322491168976},{-0.29891663789749146,-0.19234900176525116,-0.28916358947753906,0.07603957504034042,-0.06536507606506348,-0.029861822724342346,-0.06995245814323425,0.1328088492155075,-0.0797625184059143,0.07693548500537872,-0.20997652411460876,-0.013764029368758202,0.10237621515989304,-0.12005145847797394,0.039832256734371185,0.1969875544309616,-0.09603133797645569,-0.11340533941984177,0.2163085639476776,0.08578932285308838,0.2345219999551773,-0.046042513102293015,-0.2113269567489624,0.038264013826847076,0.22019119560718536,-0.32736408710479736,0.12324590235948563,0.0213124081492424,0.08095188438892365,-0.09564194828271866,0.20853649079799652,-0.07264977693557739},{0.2595604360103607,-0.048128560185432434,0.07638552039861679,0.13069726526737213,-0.2872736155986786,0.013504120521247387,0.1551814079284668,0.2052905112504959,-0.06645398586988449,-0.1098884716629982,0.3122321665287018,-0.1548764556646347,0.025087829679250717,-0.07002952694892883,-0.1374535709619522,0.2116200476884842,-0.0026490294840186834,-0.058251190930604935,0.12196186184883118,-0.2874421775341034,0.01100575178861618,-0.283225953578949,-0.21072202920913696,0.27656444907188416,-0.14514252543449402,-0.14603382349014282,0.13375017046928406,0.007048620376735926,-0.21976932883262634,-0.022864248603582382,-0.06884624063968658,-0.051882460713386536},{0.3274390995502472,0.05584852024912834,0.14402909576892853,0.0790281593799591,0.04213617369532585,-0.14073942601680756,0.22203755378723145,-0.1414371281862259,0.06904624402523041,0.19600002467632294,0.13998468220233917,0.19247989356517792,0.07184427976608276,0.2707737386226654,-0.28672629594802856,-0.21550554037094116,-0.24787703156471252,-0.057485517114400864,-0.04119531810283661,-0.4478267729282379,-0.0452912300825119,0.05083635821938515,0.09181192517280579,-0.05578089505434036,-0.17083708941936493,0.0037993399892002344,-0.09800125658512115,-0.06880936026573181,0.46036744117736816,0.16414782404899597,-0.2809740900993347,-0.018505750223994255},{-0.10184448212385178,0.19293968379497528,0.35859614610671997,-0.04975062236189842,-0.01429983414709568,0.049730829894542694,0.023978229612112045,-0.31304284930229187,0.12898585200309753,0.2019338607788086,0.2121129333972931,0.21346597373485565,-0.26152923703193665,0.14305485785007477,-0.23600928485393524,0.31712743639945984,0.1592913419008255,-0.2586669325828552,0.317771852016449,0.12391926348209381,-0.2687070071697235,0.2183963805437088,-0.27131184935569763,0.1058291643857956,0.16635774075984955,0.21921801567077637,0.06333435326814651,0.14368057250976562,-0.15240980684757233,0.2383762151002884,-0.08776787668466568,0.12173370271921158},{-0.1678740233182907,-0.07138920575380325,0.1327502727508545,0.2186930775642395,0.048781201243400574,0.2531574070453644,-0.21411235630512238,-0.10321900993585587,-0.2325451821088791,-0.12785972654819489,-0.11251131445169449,-0.22008609771728516,0.0013596578501164913,-0.17304305732250214,0.13485217094421387,-0.22313466668128967,0.2299903780221939,0.03619680553674698,-0.18725736439228058,-0.20040325820446014,0.17484715580940247,0.08547254651784897,-0.14966227114200592,0.29677262902259827,-0.33108294010162354,-0.02552166022360325,0.07178893685340881,-0.11535578221082687,0.1339835673570633,-0.13538514077663422,0.21868406236171722,0.07675410807132721},{0.3159429132938385,0.11619491130113602,0.10177266597747803,0.2734431326389313,-0.2689008116722107,0.12873217463493347,-0.12330357730388641,0.11431841552257538,0.1252676248550415,0.014315654523670673,0.08398444950580597,-0.26223936676979065,-0.20570848882198334,-0.007586398161947727,0.16559851169586182,-0.058031052350997925,0.1825157105922699,0.12100528180599213,-0.18637514114379883,-0.1963205486536026,0.32357168197631836,0.1818968504667282,0.24015302956104279,0.04352084547281265,-0.07389362156391144,0.06953181326389313,-0.06609027832746506,-0.13390737771987915,0.3046029210090637,-0.004144943319261074,-0.18623562157154083,0.0992855355143547},{-0.048896919935941696,0.03478318080306053,-0.02845883183181286,-0.258269727230072,-0.09977909177541733,-0.22788077592849731,-0.17565563321113586,-0.14137312769889832,-0.0007087166886776686,-0.03682420402765274,-0.20840370655059814,0.03151972219347954,-0.2712787687778473,-0.17592614889144897,-0.002798680914565921,0.075379878282547,0.29085588455200195,-0.16326843202114105,-0.3223358988761902,0.23256902396678925,-0.11772849410772324,0.20835164189338684,-0.013559352606534958,-0.05682925507426262,0.0428086556494236,0.11970231682062149,-0.05638139694929123,-0.24704265594482422,0.18399052321910858,0.25665393471717834,-0.1534419059753418,0.2068495750427246},{-0.26007339358329773,-0.045079555362463,0.018453329801559448,-0.007901251316070557,0.058576684445142746,0.0924583375453949,-0.2051367312669754,0.0720769464969635,-0.18919962644577026,-0.21185985207557678,0.0988808199763298,-0.1477145552635193,-0.1474435031414032,0.28009232878685,-0.019389262422919273,0.01169563364237547,0.20877397060394287,-0.2533119022846222,-0.17253127694129944,0.29920944571495056,0.012028706260025501,0.24449405074119568,-0.010210834443569183,0.044428709894418716,-0.25134122371673584,-0.16081014275550842,-0.017476318404078484,0.2559364140033722,-0.0005169661017134786,-0.01878010481595993,0.24168822169303894,0.25196367502212524}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.1196131780743599,0.1203257367014885,0.28429895639419556,0.011776255443692207},{0.07037568837404251,-0.046804189682006836,0.030172986909747124,0.11817678064107895},{-0.11895564198493958,0.13603565096855164,0.08353323489427567,0.1649218499660492},{0.28259313106536865,0.06962713599205017,0.055129747837781906,0.37862470746040344},{-0.04719061031937599,0.10098879039287567,0.2644040882587433,0.015440236777067184},{-0.10595060139894485,0.20688208937644958,0.15563976764678955,-0.08001403510570526},{-0.26757392287254333,-0.015561842359602451,-0.0009937004651874304,-0.12527312338352203},{-0.30346250534057617,-0.08967442065477371,0.268523633480072,-0.2802005708217621},{0.2586061358451843,-0.16534370183944702,-0.19035299122333527,-0.28569334745407104},{0.043268896639347076,0.1716599464416504,0.26165351271629333,-0.33361154794692993},{-0.07808595895767212,-0.09198352694511414,-0.09495565295219421,0.0817028135061264},{0.17619997262954712,-0.1112964004278183,0.06333225965499878,0.11157403886318207},{0.23378661274909973,0.27746134996414185,-0.05302773788571358,0.1028929278254509},{-0.015440759249031544,0.02192774787545204,-0.24472787976264954,0.08219251036643982},{0.1546320915222168,0.3260327875614166,0.33743414282798767,0.3268373906612396},{0.12021371722221375,0.03971543908119202,0.21585974097251892,0.2155579924583435},{-0.22079411149024963,-0.1200082004070282,-0.12713289260864258,-0.18650799989700317},{-0.11825407296419144,0.07365044951438904,-0.08741715550422668,-0.11447624117136002},{-0.22194993495941162,0.19161592423915863,0.1460917890071869,0.24824051558971405},{-0.0340145044028759,0.24311676621437073,-0.09374622255563736,0.020407645031809807},{-0.1596427708864212,-0.2793290913105011,-0.1293339729309082,-0.0045477463863790035},{0.26816001534461975,0.32773101329803467,0.040871761739254,-0.22562088072299957},{0.010547404177486897,0.16720405220985413,0.15479682385921478,0.14954470098018646},{-0.09951389580965042,0.3149302899837494,-0.04093772545456886,-0.12987801432609558},{0.02568976953625679,-0.05946451053023338,-0.06580998003482819,-0.03188525512814522},{0.20483338832855225,-0.37702518701553345,-0.06311820447444916,0.029076237231492996},{-0.041476763784885406,-0.3381325900554657,-0.1680164337158203,-0.2692005932331085},{0.1096920520067215,-0.08024775981903076,0.18200792372226715,0.12758959829807281},{0.0038008319679647684,-0.03155255317687988,0.02909151464700699,0.030247602611780167},{-0.3647741973400116,0.31048861145973206,0.1847456842660904,-0.03693411499261856},{0.30738377571105957,-0.11778032034635544,0.14184916019439697,-0.018055079504847527},{0.04172176495194435,-0.32676777243614197,0.30864766240119934,-0.168252095580101}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.04459815472364426,0.012552079744637012,0.0354640893638134,0.07841318845748901,-0.02194814197719097,-0.01721077412366867,0.06761758029460907,-0.05047153681516647,-0.008424704894423485,-0.04355942830443382,0.06355439126491547,-0.005459340289235115,0.0790075957775116,0.022248538210988045,-0.06028226763010025,0.006595944985747337};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0002254736900795251,0.005664656404405832,-0.017235733568668365,0.041871123015880585,-0.017527319490909576,0.01607993245124817,0.036203354597091675,0.03867807984352112,0.009505210444331169,-0.014190916903316975,-0.0040275114588439465,-0.007919374853372574,0.04730735719203949,0.005294539500027895,-0.05616316944360733,-0.0603557787835598};
static const float actor_encoder_feed_forward_0_bias[32] = {0.04281873628497124,-0.013258088380098343,-0.01619793474674225,-0.006828399375081062,0.02567511983215809,0.0023822318762540817,-0.024796200916171074,0.0062232716009020805,-0.02526133693754673,0.01798563078045845,-0.04849577695131302,-0.021265016868710518,0.015312056988477707,0.0023596324026584625,0.0020414507016539574,0.0398796908557415,0.0016307170735672116,-0.027397863566875458,0.0009898444404825568,0.01877996139228344,-0.05018804222345352,0.036713309586048126,0.035627562552690506,0.019428325816988945,0.002180414507165551,0.018274759873747826,-0.020213885232806206,0.002583026187494397,0.0417206846177578,0.011219671927392483,0.01650204136967659,0.007732529658824205};
static const float action_parameterization_distribution_linear_bias[4] = {0.005647656973451376,0.023249926045536995,0.013055331073701382,-0.01625511422753334};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.12609194219112396,0.11719274520874023,-0.14259259402751923,0.10767017304897308,0.22829973697662354,0.097385935485363,0.38295185565948486,-0.057310014963150024},{-0.3792983889579773,-0.18408134579658508,-0.27052250504493713,-0.26810169219970703,-0.303782194852829,-0.20726390182971954,-0.009083002805709839,-0.27313584089279175},{-0.3824162781238556,-0.11100008338689804,0.26701489090919495,0.2016250193119049,0.2608620822429657,-0.04152735695242882,0.4611465334892273,-0.23432576656341553},{-0.06474576145410538,-0.005310351960361004,-0.15616536140441895,-0.030560890212655067,0.05841303616762161,-0.0729258805513382,0.40651950240135193,-0.3255985677242279},{-0.4752850830554962,-0.21778777241706848,-0.2203022539615631,-0.18381944298744202,0.049504995346069336,0.18758699297904968,0.24298857152462006,-0.21012434363365173},{-0.44011667370796204,-0.11137592047452927,0.5052475929260254,0.15654990077018738,0.3027070462703705,-0.06801635026931763,0.008944441564381123,-0.31357696652412415},{-0.3727760314941406,-0.03438447788357735,0.5026113390922546,-0.3167572319507599,0.07241887599229813,-0.3121904730796814,0.017828939482569695,-0.3206135630607605},{-0.3654543459415436,-0.4211162328720093,0.5805593132972717,-0.23038983345031738,0.035474494099617004,0.36935287714004517,0.30716386437416077,-0.41366493701934814},{-0.4827088415622711,0.16411486268043518,-0.09588311612606049,0.191740483045578,0.3209282457828522,-0.09841128438711166,0.15575279295444489,0.05539167299866676},{-0.5425823330879211,-0.4760757386684418,-0.07181961834430695,-0.3577597737312317,-0.3666711747646332,0.3026280701160431,0.11593571305274963,0.10334194451570511},{0.016969965770840645,0.18644876778125763,0.3845950961112976,-0.13859866559505463,0.3064078092575073,0.20773755013942719,-0.06621740758419037,0.1773342788219452},{0.06102435663342476,-0.07921482622623444,0.4337085783481598,0.14951002597808838,-0.25316745042800903,0.3315834105014801,0.14745505154132843,-0.2992892563343048},{-0.03003763034939766,-0.5424939393997192,0.481994092464447,-0.10479450225830078,-0.3352257311344147,-0.10219771414995193,-0.020049748942255974,-0.17723381519317627},{-0.3214046359062195,-0.417858749628067,0.5588889122009277,0.27626144886016846,-0.22430434823036194,-0.04478343576192856,-0.1445203572511673,0.15244077146053314},{-0.021777626127004623,-0.31246140599250793,0.24726906418800354,-0.3046792149543762,-0.2262895703315735,-0.06457902491092682,0.45439574122428894,-0.08271049708127975},{0.1198476031422615,-0.20881375670433044,0.019141865894198418,-0.3315035402774811,0.14310641586780548,0.13335560262203217,0.3667806088924408,0.2594810426235199},{-0.10759417712688446,-0.34786292910575867,-0.05996061861515045,0.018888600170612335,-0.10034145414829254,-0.10748688131570816,0.02093374729156494,0.031223956495523453},{-0.263100266456604,-0.3408719599246979,0.12490715086460114,-0.04533767327666283,0.2313775271177292,-0.1558234840631485,0.47793951630592346,0.12091106176376343},{-0.08525978028774261,0.12072194367647171,-0.17058873176574707,0.03323757275938988,0.35894060134887695,0.2795778512954712,-0.1295619159936905,0.3394613564014435},{0.05446510389447212,-0.03557570278644562,-0.27841219305992126,0.002911873860284686,0.1639576107263565,0.10906001180410385,-0.21124251186847687,-0.01080015767365694},{-0.023253096267580986,-0.10937107354402542,0.15941756963729858,-0.19424962997436523,0.5133910775184631,0.16680152714252472,0.110373854637146,0.3924673795700073},{-0.057202741503715515,0.15267907083034515,-0.13522782921791077,0.22125796973705292,0.46330970525741577,0.41298699378967285,0.3601853847503662,-0.3646760880947113},{-0.5068032741546631,-0.1315186619758606,0.3024827241897583,-0.09914908558130264,0.17966938018798828,-0.2817225456237793,0.38500043749809265,-0.33376798033714294},{-0.29535770416259766,0.019468819722533226,0.08846978098154068,-0.39811304211616516,0.28860166668891907,-0.08756780624389648,-0.1579630821943283,0.10250774025917053},{-0.43132922053337097,-0.2745799720287323,0.13536261022090912,0.03008020482957363,-0.05100809782743454,0.16384261846542358,0.3909410834312439,-0.1650322675704956},{-0.4178611934185028,-0.027776801958680153,-0.2913857698440552,-0.33149123191833496,0.21391741931438446,0.10303248465061188,0.040860436856746674,0.03679206967353821},{0.13550259172916412,0.3101792633533478,-0.2082224190235138,0.12805390357971191,0.2431255728006363,0.4477076232433319,-0.15422388911247253,-0.1903328001499176},{0.16672708094120026,0.16097919642925262,0.10788534581661224,0.01947207935154438,0.299029678106308,0.26504239439964294,0.4107009172439575,0.3659976124763489},{-0.3528673052787781,0.29755493998527527,0.22491297125816345,-0.02197524905204773,0.20540814101696014,0.0807427391409874,-0.2032010406255722,-0.2954259216785431},{-0.4062902629375458,-0.30624160170555115,0.12228284776210785,-0.31106477975845337,-0.29258257150650024,-0.15977337956428528,0.39705291390419006,-0.04589782655239105},{0.15019860863685608,-0.3460286557674408,0.310613751411438,-0.40506550669670105,0.10316186398267746,0.2970443665981293,0.2827555239200592,-0.2319870889186859},{-0.00843056757003069,0.30066871643066406,0.37376436591148376,-0.3843347132205963,-0.20226086676120758,0.12368815392255783,0.2688623070716858,0.06132549047470093}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.029535073786973953,0.4446907639503479,-0.15115471184253693,0.18715256452560425,-0.482318252325058,0.26660653948783875,0.3236495852470398,0.17914772033691406},{-0.4643385708332062,-0.5176964402198792,-0.3123656213283539,-0.4824177920818329,-0.521552562713623,0.3500104248523712,0.32647964358329773,-0.27958446741104126},{0.08375567942857742,-0.10987290740013123,0.0006747766747139394,0.13555499911308289,-0.015288114547729492,0.49420320987701416,-0.3345317840576172,-0.6101728677749634},{0.5048334002494812,0.018644504249095917,0.15868909657001495,-0.0768684595823288,0.4724709987640381,0.29163557291030884,0.3146434724330902,0.587614119052887},{0.12391658127307892,0.267984002828598,-0.16486120223999023,-0.12319329380989075,0.11891274154186249,-0.3536633551120758,-0.2629989981651306,0.37292250990867615},{0.42577335238456726,0.05452686920762062,0.004310124553740025,-0.3175435960292816,-0.42642682790756226,-0.4935271739959717,-0.0921245589852333,0.3095053434371948},{-0.4504079520702362,-0.3428000807762146,-0.13526484370231628,-0.23010019958019257,0.05259028449654579,0.5692331790924072,-0.5388198494911194,0.4135838747024536},{0.18724267184734344,0.14446921646595,-0.03779376670718193,-0.10041360557079315,0.3115372955799103,-0.6183358430862427,0.23558638989925385,-0.18949076533317566}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.12336786091327667,-0.07824432849884033,0.12299343943595886,-0.14621129631996155,0.02421734482049942,0.12267391383647919,0.19506025314331055,-0.05514267832040787};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.033289287239313126,0.020592549815773964,-0.0622963011264801,0.0607934407889843,0.0533633790910244,0.054640743881464005,-0.027071956545114517,-0.1753600537776947};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

