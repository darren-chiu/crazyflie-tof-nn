#include "network_evaluate_tof.h"


// attention stuff
#define D_MODEL 16
#define NUM_TOKENS 2
#define EPS 0.000001 // 1e-6

static float tokens[NUM_TOKENS][D_MODEL];
static float q_outputs[NUM_TOKENS][D_MODEL];
static float k_outputs[NUM_TOKENS][D_MODEL];
static float v_outputs[NUM_TOKENS][D_MODEL];
static float residual[NUM_TOKENS][D_MODEL];

static float attn_weights[NUM_TOKENS][NUM_TOKENS];
static float softmax_sums[NUM_TOKENS];
static float query_output[NUM_TOKENS][D_MODEL];
static float query_embeds[NUM_TOKENS][D_MODEL];

static float last_layer_means[NUM_TOKENS];
static float last_layer_variances[NUM_TOKENS];
static float attn_embeds[NUM_TOKENS][D_MODEL];

static float output_embeds[3 * D_MODEL];
static float obstacle_embeds[D_MODEL];
static float neighbor_embeds[D_MODEL];

float base;
float exponent;
static const int self_structure [3][2] = {{18, 16},{48, 16},{16, 4}};
static const int nbr_structure [1][2] = {{12, 16}};
static const int obst_structure [1][2] = {{32, 16}};
static const int attn_structure [4][2] = {{16, 16},{16, 16}};
static float output_0[16];
static float output_1[16];
static float output_2[4];
static const float actor_encoder_self_embed_layer_0_weight[18][16] = {{-0.04427119717001915,0.08353421837091446,-0.23857802152633667,0.21791918575763702,-0.23854219913482666,-0.2557384669780731,-0.2541313171386719,-0.11227953433990479,0.00867331400513649,0.21230913698673248,-0.0964355394244194,-0.43093904852867126,-0.15193131566047668,-0.011336924508213997,-0.02187166176736355,0.36387309432029724},{0.16420172154903412,-0.3111802041530609,0.4196670651435852,-0.1763155311346054,-0.3470250368118286,-0.11083456128835678,0.17318546772003174,-0.10720925033092499,0.337586909532547,0.1947922706604004,-0.4013291597366333,0.11305511742830276,0.16653600335121155,0.3815669119358063,0.37633445858955383,0.25094401836395264},{0.06472862511873245,0.12087554484605789,0.08713138103485107,0.043124888092279434,-0.3825302720069885,-0.007050621323287487,-0.09573087841272354,0.23943111300468445,-0.31791824102401733,-0.2118101418018341,-0.012264120392501354,-0.23851491510868073,0.01883876882493496,0.11599192023277283,-0.3146440386772156,0.15341857075691223},{-0.05514184385538101,-0.2250867486000061,0.09013914316892624,-0.2232189029455185,-0.06942038238048553,0.11074520647525787,-0.37761470675468445,-0.2605717182159424,-0.1907239705324173,-0.16596022248268127,-0.21846629679203033,0.3260997533798218,0.14739775657653809,0.08867102861404419,-0.21677860617637634,0.35914474725723267},{0.1352870762348175,-0.140995055437088,0.14302630722522736,0.17517715692520142,-0.15770798921585083,0.022530553862452507,-0.17206871509552002,-0.12490478903055191,0.2684865891933441,-0.24875520169734955,0.14579357206821442,-0.1523660123348236,-0.39563801884651184,-0.010442200116813183,0.17597301304340363,0.4644700288772583},{0.22547905147075653,0.2983251214027405,-0.39422547817230225,-0.05373357608914375,0.00036590680247172713,-0.17457208037376404,-0.14039184153079987,0.3314550220966339,-0.1217154785990715,-0.42314743995666504,0.022191056981682777,0.20473532378673553,-0.07974334806203842,0.042883556336164474,-0.1069178581237793,0.06697370111942291},{-0.39320996403694153,-0.01545890886336565,0.3785746991634369,-0.32677212357521057,0.26089075207710266,0.0980096384882927,0.47823193669319153,-0.2557556629180908,0.398785263299942,-0.2725038528442383,-0.008048090152442455,-0.2220536470413208,-0.026534901931881905,-0.05069432035088539,0.26670414209365845,-0.34117501974105835},{-0.2687111496925354,-0.10409731417894363,-0.005756892263889313,-0.13445129990577698,0.09070974588394165,0.31148457527160645,0.3395301103591919,0.22294966876506805,0.06667707860469818,0.2158883959054947,0.16892369091510773,-0.34938353300094604,-0.11491013318300247,0.27591854333877563,-0.3267594277858734,-0.06869310140609741},{0.03790108487010002,-0.26099321246147156,-0.14516592025756836,-0.11810293048620224,-0.2579849362373352,-0.11884118616580963,-0.23285628855228424,-0.3223739266395569,-0.11569957435131073,0.2190132886171341,-0.21130047738552094,0.08208862692117691,0.005938200745731592,-0.19613882899284363,0.1805935502052307,0.25508472323417664},{0.31535279750823975,0.2512089014053345,0.13631220161914825,-0.03784888982772827,0.046110376715660095,-0.24557985365390778,-0.19660942256450653,0.28711602091789246,-0.5649522542953491,0.006751575507223606,-0.29654833674430847,0.03375857323408127,-0.12386703491210938,0.42658257484436035,-0.10803233087062836,-0.250448614358902},{-0.17362076044082642,-0.29197752475738525,-0.1277351826429367,0.04722990840673447,-0.38930103182792664,-0.16631163656711578,-0.1722155213356018,-0.013299107551574707,-0.2507377564907074,-0.07286971062421799,0.23988954722881317,0.018174920231103897,0.161616712808609,0.3381527066230774,-0.22563540935516357,-0.020840290933847427},{-0.18519234657287598,-0.47522810101509094,0.028689412400126457,0.04295511916279793,0.12640957534313202,-0.08286619931459427,-0.0048005240969359875,0.4085269272327423,-0.04014363884925842,0.245303213596344,0.15941953659057617,-0.24417564272880554,-0.2766946852207184,0.520819902420044,0.3482852578163147,0.12825943529605865},{0.25799795985221863,-0.0454552136361599,0.34271109104156494,-0.036598943173885345,0.17475329339504242,-0.07178604602813721,0.06175772845745087,-0.07400461286306381,0.33835485577583313,0.10511694103479385,-0.16789190471172333,-0.26281875371932983,0.22626790404319763,-0.24226367473602295,-0.09250445663928986,0.281400591135025},{-0.05142052471637726,-0.05623681843280792,-0.1142081618309021,0.22052256762981415,0.09224890917539597,0.06751276552677155,-0.24066245555877686,0.28004536032676697,-0.09996835142374039,0.018849797546863556,0.08471186459064484,-0.0499751903116703,0.12032385170459747,0.3242506980895996,-0.2144833505153656,-0.06871486455202103},{-0.028500888496637344,-0.30152878165245056,-0.16339111328125,-0.2688254714012146,0.40426313877105713,0.09990782290697098,0.13592840731143951,-0.08281268924474716,-0.12655691802501678,0.37205350399017334,0.032962486147880554,0.2662871479988098,-0.07084450125694275,0.40195417404174805,-0.2169000655412674,0.010566148906946182},{-0.5746604204177856,0.11480608582496643,-0.5991173386573792,0.6683099865913391,0.5418745875358582,-0.5788557529449463,0.4078718423843384,-0.5759688019752502,-0.1565648913383484,0.008443414233624935,-0.03797345608472824,0.09586722403764725,0.4740675985813141,-0.5195071697235107,-0.514171302318573,-0.2606408894062042},{0.005411229562014341,-0.7428613901138306,-0.5400151014328003,-0.3415495753288269,0.07293268293142319,0.26840680837631226,-0.21391266584396362,0.030184969305992126,0.0608980655670166,-0.4944331645965576,-0.7032442688941956,-0.7290201783180237,-0.31709766387939453,-0.1857142597436905,-0.4671269655227661,-0.34315910935401917},{0.3807370960712433,0.3214694559574127,-0.28301846981048584,-0.42772984504699707,-0.17821139097213745,-0.6092778444290161,0.1308567076921463,0.1684323251247406,-0.38863804936408997,0.1218930184841156,0.04912511259317398,0.424641489982605,0.027423573657870293,-0.17448242008686066,-0.26723361015319824,-0.09630430489778519}};
static const float actor_encoder_feed_forward_0_weight[48][16] = {{0.1772667020559311,-0.29903697967529297,0.1615365892648697,-0.09587692469358444,0.11590211093425751,-0.2245217114686966,-0.04347459599375725,0.07594984024763107,-0.372820645570755,-0.2641780376434326,0.40093210339546204,-0.3810722827911377,0.10786605626344681,0.20771707594394684,-0.052367184311151505,0.1359700858592987},{0.321835994720459,0.2107231318950653,0.38779541850090027,-0.05355009064078331,0.00990961492061615,-0.25808408856391907,-0.004886940121650696,-0.10028108954429626,0.019257554784417152,-0.26670050621032715,0.12523528933525085,0.19066883623600006,-0.2280411571264267,-0.2990892827510834,0.4860689640045166,0.2599143087863922},{0.35369911789894104,0.03478686138987541,0.2687990665435791,-0.25589683651924133,-0.065749891102314,0.0743611752986908,-0.13662408292293549,-0.4996289014816284,-0.36111196875572205,-0.05347791314125061,0.09415135532617569,0.07694385945796967,0.09361489117145538,-0.025015003979206085,-0.10507205128669739,-0.11225970834493637},{0.1952216923236847,-0.018727131187915802,-0.23131942749023438,0.025441447272896767,-0.2917863726615906,-0.32306280732154846,-0.09465130418539047,-0.33024659752845764,0.2995007336139679,0.1816035360097885,-0.1781463921070099,0.11137615889310837,-0.2853608727455139,0.04358214884996414,0.3196541368961334,0.07081954926252365},{0.23481766879558563,-0.1562923640012741,0.30448195338249207,0.04681842029094696,-0.05302988365292549,0.046060577034950256,-0.23204351961612701,-0.06823348253965378,0.2320556640625,0.1857624053955078,0.15683415532112122,0.17368938028812408,-0.4463154077529907,-0.11528730392456055,-0.17725229263305664,-0.1911315768957138},{-0.19732294976711273,0.3323785364627838,-0.1840837597846985,0.06288516521453857,0.17482416331768036,-0.09046787768602371,-0.3181150555610657,-0.23719650506973267,-0.0915328860282898,-0.021850213408470154,0.03504975140094757,-0.3170003592967987,-0.20205959677696228,0.44728460907936096,-0.16191914677619934,-0.05377853661775589},{0.26232194900512695,-0.10901913791894913,-0.16669677197933197,-0.34562861919403076,0.2354014813899994,-0.12076953798532486,-0.2492087036371231,0.014501038938760757,0.2562011182308197,-0.2120783030986786,-0.1706298440694809,0.3579329550266266,0.1660027951002121,-0.2938216030597687,0.2296883761882782,0.083835668861866},{-0.19452308118343353,-0.16057875752449036,-0.1568736433982849,-0.29427605867385864,-0.0376536101102829,0.2186266928911209,-0.3106989860534668,0.04887574911117554,-0.00933706946671009,-0.2995593547821045,-0.20736099779605865,0.1493861973285675,0.376472532749176,-0.007668256759643555,0.14484411478042603,-0.0610072948038578},{-0.2103419154882431,0.15573155879974365,0.19536764919757843,-0.37532639503479004,-0.1834939420223236,-0.10753143578767776,-0.06382898986339569,-0.35717374086380005,-0.5132800340652466,0.11992205679416656,0.0004862807982135564,-0.30040523409843445,-0.15521591901779175,-0.018902326002717018,-0.29482904076576233,-0.29699358344078064},{0.21343591809272766,-0.35161229968070984,0.09553441405296326,0.12892450392246246,-0.006344053894281387,0.4221511781215668,-0.2805590331554413,-0.15985225141048431,0.1590195894241333,0.38772597908973694,0.26567623019218445,0.056877728551626205,-0.050430778414011,0.2291349172592163,-0.2973996102809906,-0.1507883369922638},{0.4288142919540405,0.16445718705654144,0.17913895845413208,-0.4296919107437134,-0.20610900223255157,0.09971095621585846,-0.5250183343887329,-0.27153268456459045,0.08826198428869247,-0.04689444601535797,0.11083411425352097,0.020475272089242935,0.055874865502119064,0.28438085317611694,0.3950241208076477,0.07708179205656052},{0.2635936141014099,0.08086912333965302,0.3252676725387573,0.1425546258687973,-0.06792402267456055,0.20283938944339752,0.1099184975028038,-0.17340169847011566,0.22805364429950714,-0.22177991271018982,0.25307828187942505,0.21235895156860352,0.16870412230491638,0.051259845495224,-0.018853487446904182,0.4286800026893616},{0.24146659672260284,0.1495424062013626,0.25871023535728455,0.05035209655761719,-0.09602028876543045,0.1453157663345337,-0.15779519081115723,-0.006459004711359739,0.37359756231307983,0.33031466603279114,-0.07326578348875046,0.43156906962394714,-0.20737507939338684,-0.10516487807035446,-0.12099777907133102,0.11920394003391266},{-0.1713510900735855,0.012359516695141792,0.13293048739433289,-0.14495062828063965,0.18231159448623657,0.20968365669250488,-0.13625860214233398,-0.3674267530441284,-0.4028731882572174,-0.38233131170272827,0.07805409282445908,0.015600440092384815,-0.1135118156671524,-0.07074957340955734,-0.28819337487220764,0.22918462753295898},{0.2181113213300705,0.208480566740036,-0.15062926709651947,0.1496579498052597,-0.046099722385406494,0.34955403208732605,0.029145315289497375,-0.1863274723291397,-0.273588627576828,-0.1585346907377243,0.18086695671081543,-0.20720574259757996,0.40407538414001465,0.10011481493711472,-0.0697987973690033,-0.007273513358086348},{-0.1075240895152092,0.18050897121429443,-0.12543924152851105,0.14504759013652802,-0.23697678744792938,0.14925144612789154,0.18834902346134186,-0.17033298313617706,0.15710943937301636,-0.25026845932006836,0.0889972597360611,-0.006667912006378174,0.1594911366701126,0.23729708790779114,0.022970937192440033,0.020131180062890053},{-0.11397561430931091,0.10049297660589218,-0.19797511398792267,-0.15811721980571747,-0.1985950469970703,-0.11563913524150848,0.1603131890296936,-0.2894979417324066,0.19727103412151337,-0.200652614235878,0.12324760854244232,-0.14627677202224731,0.11220793426036835,-0.0681283175945282,-0.23962050676345825,0.11678749322891235},{-0.06540273874998093,0.12047726660966873,-0.18002064526081085,0.05832682177424431,-0.023904286324977875,-0.1813460737466812,0.2209579199552536,-0.03795121610164642,-0.17371608316898346,-0.17020560801029205,0.182449609041214,0.12536953389644623,0.01678573712706566,0.21411876380443573,-0.14981916546821594,0.19705478847026825},{0.07744158059358597,-0.2964586913585663,0.021723352372646332,0.21256734430789948,-0.21873943507671356,0.2751014232635498,0.001873231609351933,-0.027376310899853706,0.2697119116783142,0.037664636969566345,-0.10138371586799622,-0.0141000272706151,-0.029680876061320305,0.09866001456975937,-0.3044172525405884,-0.19768895208835602},{0.0424564927816391,0.02464505098760128,-0.2445230334997177,-0.21163929998874664,-0.027576608583331108,0.27508360147476196,0.19985802471637726,0.05052187293767929,-0.28566041588783264,0.24813751876354218,0.22873800992965698,0.2513158917427063,-0.07479380816221237,-0.25781774520874023,0.12455932796001434,-0.04480241611599922},{-0.2728266417980194,-0.1386847048997879,0.22284331917762756,-0.10770027339458466,-0.22923557460308075,-0.20752958953380585,-0.20078611373901367,0.21269981563091278,0.049834318459033966,-0.24605408310890198,0.09540881961584091,-0.017256367951631546,0.3087639808654785,0.052001938223838806,-0.18610112369060516,0.17403048276901245},{0.28255531191825867,-0.15624602138996124,-0.20387116074562073,-0.04003995284438133,-0.19326646625995636,0.1317465454339981,-0.007712641730904579,0.11080660670995712,-0.22667865455150604,-0.042317893356084824,-0.1507260799407959,-0.07714682817459106,0.06009785830974579,-0.1882072538137436,-0.24823012948036194,0.11040619015693665},{0.05012611299753189,0.0806351900100708,0.08337890356779099,0.13811534643173218,0.01340777799487114,-0.21160005033016205,0.264080286026001,0.09552817791700363,0.1840135157108307,-0.06709041446447372,-0.11446373909711838,-0.1345677524805069,0.2836100459098816,-0.006384654901921749,0.14015042781829834,-0.021406088024377823},{-0.01875285618007183,-0.287273645401001,-0.0884820893406868,0.19376973807811737,-0.1426137536764145,0.14325696229934692,-0.1647629588842392,-0.1141449436545372,-0.009495522826910019,0.26757970452308655,0.20716285705566406,0.08439107239246368,-0.05102956295013428,0.2096017450094223,0.1984451562166214,0.10576165467500687},{0.042957793921232224,-0.14101886749267578,0.22829964756965637,0.27863994240760803,0.2202250361442566,0.03976597636938095,0.14824166893959045,-0.23648248612880707,0.17520885169506073,-0.0466601587831974,0.2739833891391754,0.09190546721220016,-0.04593225196003914,-0.2365446239709854,-0.22974960505962372,-0.26231610774993896},{0.19235266745090485,-0.16274936497211456,0.16785135865211487,0.06142700836062431,0.20918244123458862,-0.0775625929236412,0.09607961773872375,0.11120996624231339,0.15878838300704956,0.36165159940719604,0.04916099086403847,-0.2073463797569275,0.20439763367176056,0.14928868412971497,0.11357824504375458,-0.004957366734743118},{0.1286243200302124,0.06314339488744736,0.2594892680644989,0.04356091469526291,-0.09617966413497925,-0.31808775663375854,-0.07203053683042526,-0.16541726887226105,0.014288860373198986,0.14980843663215637,0.08604232966899872,-0.2912423610687256,-0.1299353688955307,-0.2679944932460785,-0.21178877353668213,-0.2253541797399521},{0.09771943092346191,0.1686999648809433,-0.16560843586921692,0.17861127853393555,-0.05081641674041748,-0.22969402372837067,0.14509356021881104,0.026141652837395668,-0.06361272186040878,-0.21288205683231354,-0.01545563992112875,0.07697376608848572,-0.14595752954483032,0.007051714230328798,0.21197839081287384,-0.2536436915397644},{0.101680226624012,-0.014060194604098797,-0.07548941671848297,-0.005881848745048046,0.004588352050632238,0.0906955823302269,0.19557946920394897,0.1492909938097,0.2397293746471405,-0.14246393740177155,-0.13592906296253204,-0.21557918190956116,-0.2037440836429596,-0.06599782407283783,-0.026843469589948654,0.10348858684301376},{-0.10871000587940216,-0.0803050696849823,0.12148384749889374,-0.1586621105670929,-0.01828133687376976,0.10041983425617218,-0.030200323089957237,-0.19803118705749512,0.03789936751127243,-0.11970340460538864,-0.22684840857982635,-0.08076662570238113,0.26731470227241516,-0.10661596059799194,-0.12466857582330704,0.20132458209991455},{0.20507743954658508,-0.2086850106716156,-0.0702797919511795,0.10486119240522385,-0.05741193890571594,0.20609579980373383,-0.1026030033826828,0.2167205810546875,0.0031208430882543325,0.08112134784460068,-0.13360388576984406,-0.11724767088890076,-0.27631697058677673,0.040617503225803375,-0.14328545331954956,0.19473016262054443},{-0.2660483717918396,-0.05776252597570419,-0.13026867806911469,-0.30156129598617554,-0.26555973291397095,0.08251819759607315,0.007606089115142822,0.19741535186767578,-0.12068301439285278,-0.08259724080562592,-0.19556540250778198,0.00996971596032381,0.08689319342374802,0.08172182738780975,0.17412257194519043,0.3048369884490967},{-0.017139779403805733,-0.21741287410259247,-0.06273023039102554,-0.1486244648694992,0.1625278890132904,0.2672957181930542,0.09603483974933624,-0.17352037131786346,-0.06775577366352081,0.19765004515647888,-0.10150307416915894,0.2187100350856781,0.0004668097826652229,-0.11034180223941803,0.07199885696172714,0.088380828499794},{0.11306781321763992,0.045887213200330734,0.2716262936592102,-0.02947722002863884,0.0049761813133955,0.09120921045541763,0.10042177885770798,-0.12649133801460266,0.028657572343945503,0.09215568006038666,-0.18178969621658325,0.08489862829446793,0.2436741292476654,0.07848523557186127,-0.022061839699745178,0.10404378175735474},{-0.22128929197788239,-0.3081606328487396,0.17454974353313446,-0.19641251862049103,0.14349274337291718,0.06108507513999939,0.22803916037082672,0.07001905888319016,0.12731313705444336,0.03833205625414848,-0.10946552455425262,0.09153486788272858,0.002099439734593034,-0.02188378944993019,-0.1761772632598877,-0.18149244785308838},{-0.03458591550588608,-0.25881972908973694,0.17229494452476501,0.1954866200685501,0.18991723656654358,0.23912185430526733,-0.0289798304438591,-0.09929881989955902,0.12836800515651703,0.3040781319141388,0.2267439365386963,-0.20890435576438904,-0.2377084642648697,0.0641166940331459,0.13549622893333435,-0.08431588113307953},{-0.15625080466270447,-0.10104557871818542,0.016410337761044502,0.15657511353492737,0.1587127298116684,0.09634055197238922,0.14639785885810852,0.1748165339231491,0.08663983643054962,0.01190128829330206,-0.14536011219024658,-0.2682875394821167,0.19192585349082947,0.06842580437660217,0.17311614751815796,0.20047864317893982},{-0.0765165314078331,0.2044062465429306,0.18142889440059662,0.0903945043683052,0.10984238982200623,-0.18311858177185059,0.14935533702373505,0.13282445073127747,0.1022961214184761,-0.0560174323618412,-0.18502524495124817,-0.003031929489225149,-0.020700011402368546,-0.2146620899438858,-0.14390206336975098,0.3247874677181244},{-0.15389622747898102,0.07224526256322861,0.13439980149269104,-0.08914082497358322,-0.09846492111682892,0.19085711240768433,0.17747804522514343,0.1016182228922844,-0.15827576816082,-0.17520485818386078,-0.07442303001880646,0.08288400620222092,-0.2788552939891815,-0.13330435752868652,0.14652256667613983,0.18863840401172638},{-0.13444077968597412,0.16986887156963348,0.15585637092590332,-0.005173900630325079,0.210450679063797,0.07129319757223129,-0.2161746621131897,0.04133731499314308,0.18809668719768524,0.2299795299768448,0.252531498670578,-0.026627639308571815,-0.09124443680047989,0.003918843809515238,-0.09794702380895615,0.140018031001091},{0.14111700654029846,0.16718445718288422,0.12256649136543274,-0.07810288667678833,0.08289970457553864,0.18239052593708038,0.2520034611225128,-0.21485812962055206,0.22428926825523376,0.2500878572463989,0.028349125757813454,-0.2509317398071289,-0.07058754563331604,0.2670741081237793,0.16624298691749573,0.19809691607952118},{0.09589006751775742,-0.1815984845161438,0.0323646180331707,0.016629893332719803,0.29098206758499146,-0.24693049490451813,0.1805173009634018,-0.1696973294019699,-0.10213781148195267,-0.16024869680404663,-0.2296728640794754,0.27211979031562805,0.06745582073926926,0.237391859292984,0.08149075508117676,-0.22879762947559357},{-0.22641874849796295,0.06109987944364548,-0.027289818972349167,-0.16563771665096283,0.05448788031935692,0.045025475323200226,-0.12061954289674759,-0.20359963178634644,-0.15681594610214233,0.01992976665496826,0.1157047227025032,-0.1399693638086319,-0.21139048039913177,-0.18057525157928467,0.023475226014852524,0.2770848274230957},{0.0065534221939742565,0.13252010941505432,-0.15021364390850067,0.04852712154388428,0.17155809700489044,-0.06266366690397263,0.23771752417087555,0.023316677659749985,-0.0173435490578413,-0.016290443018078804,-0.11193820834159851,0.11947798728942871,0.0982460007071495,-0.19440336525440216,0.22934231162071228,0.2659355700016022},{-0.023306459188461304,-0.23861947655677795,-0.021188700571656227,-0.1494370698928833,0.036658938974142075,-0.07116354256868362,0.28619009256362915,-0.1971179097890854,-0.06659042835235596,-0.16718275845050812,-0.2419901192188263,0.1754612922668457,-0.30915629863739014,-0.3060818016529083,-0.20572683215141296,-0.25841477513313293},{-0.048063214868307114,-0.2841297686100006,0.10500767827033997,0.16712507605552673,-0.2045811265707016,-0.07652611285448074,-0.13742192089557648,0.1421087086200714,-0.008615713566541672,0.1001254990696907,0.1508062332868576,0.17146630585193634,-0.11012318730354309,0.11274385452270508,-0.057581931352615356,0.1343015879392624},{-0.2296798676252365,-0.3159261643886566,0.23600174486637115,0.21027904748916626,-0.2888862192630768,-0.0792912021279335,0.08896519988775253,-0.02294360287487507,0.049324724823236465,-0.28133684396743774,0.04080631211400032,0.06300437450408936,0.165178582072258,-0.20446287095546722,-0.07543019205331802,-0.009975465014576912},{0.16605281829833984,-0.2624203562736511,0.2840758264064789,-0.13860943913459778,-0.024892406538128853,0.09451277554035187,-0.16179348528385162,0.10015517473220825,0.15586644411087036,-0.13154657185077667,-0.21826758980751038,-0.27625012397766113,-0.25383806228637695,0.249013751745224,0.2371126264333725,0.26196569204330444}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{-0.04852471500635147,0.1953478902578354,0.4270383417606354,-0.41893139481544495},{-0.421585351228714,0.2835002541542053,-0.4435228109359741,0.10882826149463654},{0.0227571502327919,0.4376744329929352,0.41405045986175537,-0.07839979231357574},{0.2675068974494934,-0.2547632157802582,-0.11856886744499207,-0.07073906064033508},{0.09479694813489914,0.34133368730545044,0.3299095332622528,0.42026400566101074},{0.21545995771884918,0.2555195093154907,0.4696490466594696,0.36097028851509094},{0.42321571707725525,-0.4378049373626709,-0.4334773123264313,-0.08749131858348846},{0.43897780776023865,-0.1778724044561386,-0.5156658291816711,0.15430352091789246},{0.2448728084564209,0.28802767395973206,-0.5596494674682617,-0.3938007354736328},{0.25644180178642273,0.3458835780620575,-0.22821009159088135,0.1732863187789917},{0.2657470107078552,-0.004682432394474745,0.4651115834712982,0.10458458960056305},{0.016429027542471886,0.2951115667819977,0.0076743802055716515,-0.24621187150478363},{-0.46971777081489563,-0.6302313208580017,0.01007279846817255,-0.4716174006462097},{-0.26055121421813965,0.08638909459114075,0.11892075091600418,0.37468060851097107},{-0.2088324874639511,0.13248878717422485,0.21864725649356842,-0.577073335647583},{0.11230266839265823,-0.059032101184129715,0.25551414489746094,-0.38673192262649536}};
static const float actor_encoder_self_embed_layer_0_bias[16] = {0.08010775595903397,0.05866448953747749,0.019887365400791168,-0.08451538532972336,0.029590552672743797,0.0602433867752552,-0.09909118711948395,-0.06755099445581436,0.021058790385723114,0.06162019819021225,0.03841834142804146,-0.045661672949790955,0.07899447530508041,0.13825277984142303,-0.046169400215148926,-0.03375987336039543};
static const float actor_encoder_feed_forward_0_bias[16] = {0.006421586964279413,-0.034907542169094086,0.060503311455249786,-0.0417109876871109,0.0768415629863739,0.09557335823774338,-0.010721931234002113,0.04047110676765442,0.014703155495226383,0.02380458079278469,0.11127792298793793,0.015147344209253788,-0.09930966049432755,-0.033081188797950745,-0.010645043104887009,0.06479684263467789};
static const float action_parameterization_distribution_linear_bias[4] = {0.09377562254667282,0.06440027058124542,0.053009845316410065,0.01985716074705124};
static const float actor_encoder_neighbor_embed_layer_0_weight[12][16] = {{0.15193697810173035,-0.3853382170200348,0.21036669611930847,0.3432466983795166,0.12957584857940674,0.027349328622221947,-0.0031021730974316597,0.23756352066993713,0.24844026565551758,0.07178319990634918,-0.0003802062710747123,0.3985801935195923,-0.1327318549156189,-0.07079852372407913,0.4200688302516937,0.10465962439775467},{0.18948248028755188,-0.33602383732795715,-0.2714282274246216,0.1334654837846756,0.13290661573410034,-0.2458539456129074,-0.07514019310474396,-0.32980969548225403,-0.17678257822990417,0.060999710112810135,-0.391918420791626,-0.39924606680870056,0.17459705471992493,-0.1500532478094101,0.2938362658023834,-0.2339020073413849},{-0.3227273225784302,-0.09854543954133987,0.37141263484954834,-0.02968093380331993,0.3246450424194336,-0.15006186068058014,-0.23959757387638092,-0.28212618827819824,0.29434898495674133,0.2667059302330017,-0.31935399770736694,0.05002457648515701,-0.02690088003873825,-0.20866522192955017,0.35539963841438293,0.18839900195598602},{-0.0716070681810379,-0.014790160581469536,-0.32872074842453003,-0.3470783829689026,0.3191191852092743,0.23330676555633545,-0.32813823223114014,-0.4786160886287689,-0.05753118172287941,0.023542726412415504,-0.060385819524526596,-0.12707799673080444,0.46663907170295715,-0.34709402918815613,0.16879214346408844,-0.19939278066158295},{-0.3659731149673462,-0.37082719802856445,-0.05654280632734299,-0.24818876385688782,-0.40018969774246216,0.46544376015663147,-0.36026930809020996,0.36341050267219543,-0.12986230850219727,-0.1372394561767578,0.4167553782463074,0.26186323165893555,0.08744905143976212,0.18937326967716217,-0.3110695481300354,-0.3445872962474823},{-0.16977877914905548,-0.3785287141799927,0.3838898837566376,0.17662489414215088,-0.09912645816802979,-0.33898627758026123,-0.199159637093544,0.37457895278930664,-0.4160133898258209,-0.38223332166671753,-0.06464685499668121,0.050731610506772995,-0.026166411116719246,-0.2094988077878952,-0.2071778029203415,0.29149818420410156},{-0.08307473361492157,-0.02590029127895832,0.3750951886177063,0.24232050776481628,0.02605840191245079,0.27048659324645996,0.43906810879707336,0.022612687200307846,0.16748163104057312,-0.48735496401786804,0.4181729257106781,0.35657790303230286,0.022524023428559303,-0.2736700177192688,-0.06651145964860916,0.21742980182170868},{0.23507070541381836,-0.4627843499183655,0.11453982442617416,0.021938519552350044,0.05909191444516182,-0.2789859473705292,-0.3721994161605835,0.09508354216814041,0.057815540581941605,0.13935261964797974,0.24311552941799164,-0.1823538988828659,-0.15966996550559998,0.0035148565657436848,0.004315036814659834,-0.12097048759460449},{-0.04621569439768791,-0.1050967276096344,-0.30594557523727417,-0.1775711625814438,-0.47455719113349915,0.42127618193626404,0.15106701850891113,-0.1503555178642273,-0.08078082650899887,-0.1910410076379776,-0.17530760169029236,0.06145767495036125,-0.14411313831806183,-0.356346070766449,-0.12469618022441864,0.3610503673553467},{0.25184255838394165,0.16176439821720123,0.02975866012275219,0.20116496086120605,0.26817864179611206,-0.21152891218662262,-0.07294752448797226,-0.3305980861186981,0.43671420216560364,-0.3484223783016205,0.17063938081264496,-0.2394278645515442,0.04808318614959717,0.04673865810036659,0.4376004636287689,0.2789105176925659},{-0.23235510289669037,0.2193194031715393,0.11081039160490036,-0.4072365164756775,-0.11176960170269012,0.18622256815433502,0.21710149943828583,0.39841845631599426,0.26415228843688965,0.4056621491909027,-0.045945487916469574,-0.23094898462295532,-0.4247533977031708,-0.02648071199655533,0.3174344301223755,-0.03926149383187294},{0.051783859729766846,-0.20915710926055908,0.2155354768037796,0.07466766983270645,0.04890570789575577,0.11601272225379944,-0.2954833209514618,-0.41136470437049866,0.27822408080101013,-0.1492973268032074,0.33552923798561096,-0.29833507537841797,0.05899322032928467,-0.25063952803611755,0.07113124430179596,0.03231658786535263}};
static const float actor_encoder_neighbor_embed_layer_0_bias[16] = {-0.04779086261987686,-0.010816282592713833,-0.03021387755870819,-0.0011824495159089565,0.0006876655970700085,0.005785950925201178,-0.09704667329788208,0.05010227486491203,0.10102689266204834,0.023956939578056335,0.011825787834823132,-0.07296865433454514,0.0351368710398674,-0.027805538848042488,0.1045948937535286,-0.03495895862579346};
static const float actor_encoder_obstacle_embed_layer_0_weight[32][16] = {{0.3233332335948944,0.049143657088279724,-0.24376487731933594,-0.35267114639282227,0.3743247091770172,-0.2894708514213562,-0.07958202809095383,-0.007028687279671431,0.328802227973938,0.16460159420967102,-0.08841721713542938,0.062203701585531235,-0.26127710938453674,0.23200634121894836,-0.0642571747303009,0.15624010562896729},{-0.04256676882505417,-0.0027964948676526546,-0.10349342972040176,-0.1109897643327713,-0.20540893077850342,-0.2761588990688324,0.08355054259300232,0.2806131839752197,0.3607844114303589,-0.03646710515022278,0.07449833303689957,0.02922247163951397,-0.05044731870293617,0.21790915727615356,-0.03583279997110367,0.3083028197288513},{0.25524312257766724,-0.0482572503387928,-0.03528757765889168,-0.3909808397293091,-0.16050121188163757,-0.22950482368469238,-0.010279688984155655,-0.08911976218223572,0.007302934303879738,0.4360320568084717,0.07115237414836884,-0.11831914633512497,-0.20662946999073029,0.3530154824256897,0.0034567699767649174,-0.2943689227104187},{0.09948231279850006,0.2809324264526367,0.08277229964733124,0.13406643271446228,0.14738048613071442,0.14426453411579132,0.12058465927839279,-0.2933853268623352,0.3787245452404022,-0.044532183557748795,0.07716923952102661,-0.33591488003730774,-0.04764162749052048,0.2162286639213562,0.23881126940250397,-0.06125584617257118},{-0.2890472412109375,-0.15147164463996887,0.30636608600616455,0.013523892499506474,-0.3012503683567047,0.351698100566864,-0.08800220489501953,-0.338057279586792,0.1599356234073639,0.2794371247291565,0.27650877833366394,-0.3606918752193451,0.2869645357131958,0.14786025881767273,-0.2621050179004669,0.28647369146347046},{-0.06781893968582153,-0.10223894566297531,0.06367356330156326,0.23521196842193604,0.15954004228115082,-0.2194652557373047,-0.2666770815849304,0.24111111462116241,-0.23431135714054108,0.28636714816093445,0.28930583596229553,0.1330532282590866,-0.15918636322021484,-0.15089504420757294,-0.08403148502111435,0.3115447759628296},{0.19165128469467163,0.1706480085849762,-0.30161046981811523,0.23840828239917755,-0.33996981382369995,-0.0977310836315155,0.1366869956254959,0.06214819476008415,0.12625005841255188,-0.28648877143859863,-0.16816475987434387,-0.0843849778175354,-0.07745569944381714,0.3488456606864929,-0.2756384313106537,-0.29399630427360535},{0.030937712639570236,0.1666550189256668,0.05302343890070915,0.10747511684894562,0.214847132563591,-0.06765387207269669,0.16796496510505676,0.2255600392818451,-0.11768578737974167,0.08600077778100967,-0.18259522318840027,0.030669312924146652,-0.06446076184511185,-0.16145919263362885,0.28620314598083496,-0.009271880611777306},{0.15401756763458252,-0.29096364974975586,-0.3040508031845093,0.2488551288843155,-0.07154151052236557,0.02080743946135044,0.10852589458227158,0.2503519356250763,0.045974250882864,0.12296372652053833,-0.040942225605249405,-0.2570289373397827,-0.32689690589904785,-0.21619366109371185,0.04638838768005371,0.15153768658638},{0.10690852254629135,-0.2563844323158264,-0.32411181926727295,0.3554375469684601,-0.08871541917324066,0.28077566623687744,-0.24825888872146606,0.16122134029865265,-0.16108129918575287,-0.0064216298051178455,-0.238671213388443,-0.35734090209007263,0.23361897468566895,0.2709502875804901,-0.07342224568128586,-0.25965824723243713},{0.01762373000383377,0.1670430302619934,-0.034942641854286194,0.10556476563215256,-0.2784087657928467,0.043947115540504456,0.373717337846756,0.039347145706415176,0.3247942626476288,0.19019266963005066,-0.03860218822956085,-0.17495006322860718,0.27025994658470154,-0.2766314744949341,-0.04948604851961136,-0.2041999250650406},{-0.19154787063598633,0.05853785201907158,-0.28845563530921936,0.20206710696220398,-0.34957122802734375,0.2305946797132492,0.1770937442779541,-0.07399334013462067,0.34414198994636536,0.015095677226781845,-0.23257607221603394,0.06501849740743637,0.21443583071231842,0.2551077902317047,-0.020304275676608086,-0.03467930108308792},{-0.09250839054584503,0.08590468019247055,0.15142503380775452,0.08060533553361893,0.011586296372115612,0.016428282484412193,0.15513154864311218,-0.22182002663612366,-0.036316294223070145,0.1135115697979927,-0.12128578871488571,0.1445120871067047,-0.21588683128356934,-0.15405303239822388,0.13279102742671967,0.18292807042598724},{0.11464367806911469,-0.2135072946548462,-0.2226349264383316,-0.013726743869483471,0.3017374873161316,-0.1916997730731964,0.03947773575782776,-0.23448942601680756,0.2924497723579407,0.196602925658226,-0.06458061188459396,0.10812395066022873,0.006321645341813564,0.22917567193508148,-0.24769508838653564,-0.29660341143608093},{0.2965761721134186,-0.13228878378868103,0.2697242498397827,0.12679772078990936,0.31778812408447266,0.25253698229789734,-0.26730987429618835,-0.21883440017700195,-0.2817719280719757,0.26714301109313965,-0.09114465117454529,-0.34448710083961487,-0.1605484038591385,0.03538329899311066,-0.281508207321167,-0.3229965269565582},{-0.12455721944570541,0.12308300286531448,-0.01957882195711136,-0.2958146333694458,0.1607431322336197,-0.26189741492271423,0.16537027060985565,-0.22272489964962006,0.0916806012392044,-0.10068564116954803,0.03257361054420471,-0.019825182855129242,-0.23972192406654358,0.38226497173309326,-0.35174793004989624,-0.12072832882404327},{0.014626788906753063,-0.14844171702861786,-0.24270905554294586,0.11817498505115509,0.1900993436574936,-0.1274929642677307,0.30224981904029846,0.04473248869180679,-0.2955513894557953,0.020467137917876244,-0.08150997757911682,0.30116528272628784,0.18814849853515625,0.15514105558395386,0.3031523525714874,0.18507589399814606},{-0.288907527923584,-0.2808894217014313,0.21805566549301147,-0.18664023280143738,-0.18158262968063354,0.32981786131858826,0.24684949219226837,-0.28880801796913147,0.008446689695119858,0.10263912379741669,-0.366892546415329,-0.2765457034111023,-0.3839537501335144,-0.20307698845863342,0.24613121151924133,0.2081208974123001},{-0.07353606075048447,-0.006986155174672604,-0.1138569712638855,0.06336501985788345,0.3621348440647125,0.27713021636009216,-0.11626958847045898,-0.1784323900938034,0.036022670567035675,0.3717987835407257,0.02309502102434635,-0.01560647040605545,-0.21515345573425293,0.2740890681743622,-0.1699104756116867,-0.2959681749343872},{0.10330579429864883,-0.3701132833957672,0.01553209125995636,0.21750466525554657,-0.13178503513336182,0.2661920189857483,-0.20712323486804962,-0.1985517144203186,-0.26525941491127014,0.23475825786590576,0.08694564551115036,-0.06443864852190018,-0.22313617169857025,-0.09817679971456528,-0.2265675663948059,-0.055758461356163025},{0.28430426120758057,-0.17247632145881653,0.3003481328487396,0.18999317288398743,-0.019676994532346725,-0.295108824968338,-0.13461706042289734,-0.13351503014564514,-0.3126493990421295,-0.04463035985827446,-0.21189865469932556,0.13347788155078888,-0.13232947885990143,0.2145433872938156,0.14453475177288055,0.08154913038015366},{0.4009147584438324,-0.1468386948108673,-0.214170902967453,-0.26794737577438354,0.29902079701423645,-0.2822848856449127,0.05312677472829819,-0.13480335474014282,-0.30824196338653564,0.15206775069236755,-0.08924512565135956,0.286690354347229,-0.3307513892650604,0.21344608068466187,-0.3613888919353485,0.26403477787971497},{0.19479601085186005,0.14199009537696838,-0.11217658221721649,-0.04910524934530258,-0.01767885312438011,-0.16258275508880615,-0.1531316041946411,0.2427048534154892,0.209858238697052,-0.21193182468414307,0.267653226852417,-0.09488888829946518,0.22338038682937622,0.24392066895961761,-0.111699178814888,-0.4001017212867737},{-0.09781499952077866,-0.3709014058113098,-0.06953388452529907,-0.16389533877372742,-0.23594450950622559,0.30475082993507385,0.18237148225307465,0.2008577138185501,-0.010449481196701527,0.1653515100479126,0.3154565393924713,-0.20954693853855133,0.2284000813961029,0.23461413383483887,0.01978057064116001,-0.18758338689804077},{0.1029539555311203,0.22367320954799652,0.13404232263565063,0.21313244104385376,0.16673167049884796,-0.3455977141857147,-0.23576751351356506,-0.0267304927110672,-0.12506337463855743,0.23538638651371002,0.10669253766536713,-0.1844353973865509,-0.26246100664138794,0.18049576878547668,0.3214489817619324,0.23642466962337494},{-0.14918255805969238,0.2861795723438263,0.21383033692836761,0.2769966125488281,0.05319080129265785,-0.27410009503364563,0.04446838051080704,-0.08665581792593002,-0.004169153515249491,0.04229959473013878,0.06209864839911461,-0.12266075611114502,-0.23182682693004608,-0.292996346950531,0.28509053587913513,0.15857170522212982},{-0.06847327947616577,0.17939917743206024,0.3580271005630493,-0.1731761246919632,0.184464231133461,0.09835514426231384,0.1918765753507614,0.3012421429157257,0.10293839126825333,-0.23516899347305298,0.0430268757045269,0.013626934960484505,0.0836234837770462,0.08058232069015503,0.0032954211346805096,-0.061027925461530685},{0.18711397051811218,-0.17845496535301208,-0.10232055187225342,0.042873650789260864,-0.15180546045303345,0.24274112284183502,-0.13661521673202515,-0.2813524603843689,-0.39977338910102844,0.007677824702113867,0.29160353541374207,0.26320818066596985,-0.36742255091667175,0.3596193194389343,-0.15743103623390198,-0.15452873706817627},{0.38404256105422974,-0.12120673805475235,0.29746752977371216,-0.15275387465953827,0.2831498086452484,0.26713353395462036,-0.29821696877479553,-0.15971152484416962,0.17439942061901093,0.3498767614364624,0.15932397544384003,-0.12624295055866241,-0.2719227373600006,-0.34346678853034973,-0.017560744658112526,0.192003071308136},{0.3057892620563507,-0.17246051132678986,0.3563937842845917,0.30171242356300354,-0.021924523636698723,-0.014827258884906769,-0.32195937633514404,0.32559704780578613,-0.10101793706417084,0.34703943133354187,0.26840656995773315,-0.11771315336227417,-0.05048896744847298,-0.2892720103263855,-0.0752997025847435,0.0726873129606247},{0.17749828100204468,-0.14004617929458618,0.17313235998153687,-0.05142302066087723,-0.27389171719551086,-0.05582990124821663,0.3082144558429718,0.04015079885721207,0.12562020123004913,0.2613670825958252,0.3399814963340759,0.025931699201464653,0.2973165214061737,0.12456994503736496,-0.12973584234714508,-0.27938589453697205},{0.03001370094716549,-0.30552810430526733,-0.13862831890583038,-0.334969699382782,0.007517974358052015,-0.38978976011276245,0.04434419423341751,0.0935249775648117,0.19438481330871582,0.0285476241260767,0.33684757351875305,0.23496107757091522,-0.32590344548225403,-0.25755470991134644,0.32100871205329895,0.263444185256958}};
static const float actor_encoder_obstacle_embed_layer_0_bias[16] = {0.07634072005748749,-0.06478524208068848,0.017080558463931084,-0.018450986593961716,-0.014666734263300896,0.0003023461322300136,0.02690252847969532,0.03802261874079704,0.03203706443309784,0.028410905972123146,0.039614707231521606,-0.06132114678621292,-0.008150546811521053,0.0336163267493248,-0.044488001614809036,-0.016598021611571312};
static const float actor_encoder_attention_layer_w_qs_weight[16][16] = {{0.33639809489250183,-0.09286583960056305,-0.011379741132259369,0.4618830382823944,-0.3626476228237152,0.08832062035799026,0.13951142132282257,-0.4213903546333313,-0.3021247088909149,-0.30579283833503723,0.39442774653434753,0.012197990901768208,0.10943790525197983,0.21620507538318634,0.20912028849124908,0.2666471004486084},{0.2920438349246979,-0.21804159879684448,-0.17207640409469604,-0.3544098436832428,-0.14879000186920166,-0.08994129300117493,-0.36457473039627075,-0.03173505887389183,0.005067931488156319,0.38251420855522156,-0.2560269832611084,0.33551836013793945,0.14078666269779205,-0.01832445152103901,0.34244397282600403,-0.17675377428531647},{-0.19464470446109772,0.19056788086891174,0.3366900682449341,0.4230928421020508,0.1463584303855896,-0.3293518126010895,-0.32581663131713867,0.257887065410614,0.16799433529376984,-0.3653494119644165,-0.31990885734558105,-0.24734212458133698,-0.44100290536880493,-0.12165223807096481,-0.24480843544006348,-0.37241676449775696},{0.03862382471561432,0.13517911732196808,-0.23262286186218262,0.1421157419681549,0.09135162830352783,0.27386096119880676,0.11961880326271057,-0.278550922870636,0.28085896372795105,-0.030101848766207695,0.159774050116539,0.0414775088429451,-0.11649079620838165,-0.08070021867752075,0.15342220664024353,-0.4187624752521515},{-0.16929925978183746,-0.4151703715324402,0.04936541989445686,0.03192289173603058,-0.1550675928592682,-0.3317272961139679,0.0216591265052557,-0.5016966462135315,-0.3546043038368225,-0.15391318500041962,0.11416436731815338,0.03536580502986908,0.22679150104522705,0.1901109367609024,0.07734981179237366,-0.3773728311061859},{-0.18237729370594025,-0.17744551599025726,-0.2954505980014801,-0.3174648880958557,0.16266347467899323,0.08125896751880646,-0.16152530908584595,-0.4024447202682495,0.09475205838680267,0.11669080704450607,0.05583909898996353,0.13899631798267365,-0.2862967550754547,0.022170348092913628,-0.05015690252184868,-0.33606067299842834},{0.38324108719825745,-0.14451919496059418,0.39584070444107056,-0.22327347099781036,0.20562969148159027,0.18539950251579285,-0.1574632078409195,-0.200362429022789,-0.30984967947006226,0.27278372645378113,-0.3544612228870392,0.3703514337539673,-0.22901570796966553,-0.44052088260650635,0.3456229269504547,0.38419973850250244},{-0.23898197710514069,0.31447139382362366,-0.22293810546398163,-0.153211772441864,-0.44871434569358826,-0.08192404359579086,0.27859625220298767,-0.2198116034269333,-0.08771228045225143,-0.3587092459201813,0.0602978877723217,-0.1341995894908905,-0.21616409718990326,0.2703228294849396,-0.08317259699106216,0.022073596715927124},{-0.12748219072818756,-0.25219297409057617,0.3775976002216339,0.3904961347579956,-0.017842676490545273,-0.03407935053110123,0.2328193336725235,0.20570050179958344,0.2749382257461548,-0.3829022943973541,0.42022764682769775,0.3069857656955719,0.22485846281051636,0.4145384430885315,0.44087958335876465,-0.018150167539715767},{0.04136967658996582,0.20304545760154724,0.11819614470005035,0.024314479902386665,-0.2222885936498642,-0.07753738015890121,0.32335761189460754,0.42908576130867004,0.41713157296180725,0.0843011811375618,-0.005364526528865099,-0.3091748356819153,0.14823390543460846,0.3007822632789612,-0.3467157185077667,0.28520238399505615},{-0.3630434572696686,0.013579592108726501,-0.32353293895721436,0.18768346309661865,-0.3099766969680786,0.30988630652427673,-0.11180774122476578,-0.03330232575535774,0.3288057744503021,-0.2643445134162903,0.33816298842430115,-0.01711447350680828,0.07297305017709732,0.47663187980651855,-0.359332799911499,0.11746235936880112},{-0.12720122933387756,0.2560376524925232,0.21014149487018585,0.3583981394767761,-0.22223491966724396,-0.38710635900497437,-0.008217073045670986,0.2179454118013382,-0.3747531771659851,-0.32035407423973083,0.06131032109260559,0.19328734278678894,0.1360916942358017,0.09437266737222672,0.2750205397605896,0.19662544131278992},{-0.30660298466682434,0.14146068692207336,-0.3818758428096771,0.17121361196041107,-0.10697714239358902,-0.30315181612968445,0.3444669842720032,-0.45915043354034424,-0.051076728850603104,0.10960966348648071,-0.3331250548362732,0.4353099465370178,0.19931232929229736,0.35899144411087036,0.34697386622428894,0.3453110158443451},{0.03550861403346062,0.31196898221969604,0.3534144461154938,0.2749224901199341,0.17863908410072327,0.3937707841396332,0.2691401541233063,-0.25020626187324524,-0.25693124532699585,0.39674392342567444,-0.2957741618156433,0.41156038641929626,-0.09234695136547089,0.31295713782310486,0.20913341641426086,0.364162415266037},{0.10727744549512863,-0.21201547980308533,0.04443823918700218,0.21893294155597687,0.3922954797744751,-0.3958781063556671,0.17571909725666046,-0.09781324863433838,0.36694055795669556,0.38008925318717957,0.4170038104057312,0.18851971626281738,-0.44785061478614807,-0.2117638736963272,-0.18305902183055878,-0.3523774743080139},{0.04186923801898956,-0.06426946073770523,-0.020266152918338776,0.3164813220500946,0.38449037075042725,-0.3863587975502014,-0.3537701666355133,-0.2182987630367279,0.1407969743013382,0.29366379976272583,-0.2401939183473587,0.009929109364748001,0.2964722812175751,-0.24860318005084991,0.22620640695095062,-0.36288580298423767}};
static const float actor_encoder_attention_layer_w_ks_weight[16][16] = {{0.3453420102596283,0.09309021383523941,0.1695680022239685,-0.4714914858341217,0.46897462010383606,0.12179551273584366,-0.1739163100719452,0.04329167306423187,0.13559843599796295,0.3237878382205963,0.3138275146484375,-0.20636917650699615,-0.05634886771440506,0.34798628091812134,0.3984261155128479,-0.31598079204559326},{0.34055131673812866,-0.1374078392982483,0.36117759346961975,0.11595768481492996,-0.23908448219299316,-0.17789007723331451,-0.0888756811618805,-0.2524881958961487,-0.37026333808898926,0.06073624640703201,-0.0015303296968340874,0.28919366002082825,0.2177562117576599,0.1309211403131485,-0.4107435345649719,0.16004228591918945},{0.2559303045272827,-0.29785504937171936,-0.18129834532737732,-0.26115164160728455,0.3437073528766632,0.03806440159678459,0.39946919679641724,-0.45283976197242737,0.26472926139831543,-0.19525277614593506,0.1392052173614502,-0.30749809741973877,0.34373748302459717,-0.45208147168159485,0.3450884222984314,0.14807942509651184},{-0.3905179798603058,0.36409053206443787,-0.4032294452190399,0.04202810302376747,0.17848405241966248,0.016469333320856094,-0.36566051840782166,0.32327938079833984,0.07942214608192444,-0.16565445065498352,0.16841821372509003,0.12708279490470886,0.07422066479921341,0.06532108783721924,0.29609009623527527,0.4183990955352783},{0.2811257243156433,0.30940520763397217,0.3401871919631958,0.09308294206857681,-0.36435356736183167,-0.23630578815937042,0.20864924788475037,0.33650311827659607,-0.0302849393337965,-0.1009477749466896,-0.4162638485431671,0.16528025269508362,0.146147221326828,-0.39234569668769836,-0.06366483867168427,0.43780839443206787},{0.01692960038781166,-0.36146995425224304,0.2094719558954239,-0.12028328329324722,-0.16497080028057098,0.10145125538110733,-0.15791642665863037,-0.3336620032787323,-0.15601851046085358,0.12436897307634354,-0.0631955936551094,0.23023362457752228,-0.2882757782936096,0.24520184099674225,0.1341542750597,-0.2880922555923462},{0.1432494819164276,-0.29955965280532837,-0.12253554910421371,-0.06278768926858902,0.34165528416633606,-0.405061274766922,-0.18348856270313263,-0.06758394837379456,0.2012377232313156,0.1552680879831314,0.46117645502090454,-0.34756430983543396,-0.3203456699848175,0.16742712259292603,0.20478133857250214,0.20818613469600677},{-0.0021825414150953293,-0.15421022474765778,-0.2429802119731903,-0.3049357235431671,-0.23734600841999054,0.3951658308506012,-0.31791582703590393,0.41107815504074097,0.29464274644851685,-0.06100448593497276,-0.2744581699371338,0.2902907431125641,-0.22696930170059204,0.39648139476776123,0.20125716924667358,-0.12458015233278275},{-0.34202831983566284,-0.18358559906482697,-0.17949442565441132,0.006465883459895849,-0.22497159242630005,0.11338839679956436,-0.4054151177406311,-0.24125252664089203,0.020449798554182053,-0.27379539608955383,-0.28307315707206726,0.12048417329788208,0.05560313165187836,0.28446534276008606,-0.1670207530260086,0.10368906706571579},{-0.16976113617420197,-0.18220126628875732,-0.3584645688533783,-0.36426475644111633,-0.20909368991851807,-0.25237637758255005,-0.37362465262413025,-0.19763846695423126,-0.08953626453876495,0.3529902994632721,0.1925840824842453,-0.27207326889038086,0.08474469184875488,0.012575899250805378,-0.22206351161003113,0.21771059930324554},{0.01941518299281597,-0.43621358275413513,0.06155930086970329,-0.15587159991264343,-0.1976960152387619,-0.12399949133396149,-0.2894562780857086,-0.12291919440031052,0.37587660551071167,0.33195358514785767,-0.2775563597679138,0.28533440828323364,-0.045445799827575684,0.2184736132621765,-0.06780879199504852,0.08700709789991379},{0.3583078980445862,-0.26614928245544434,0.15399064123630524,0.033425088971853256,0.30286887288093567,-0.11688664555549622,0.06774760782718658,-0.07925581187009811,-0.09028994292020798,0.09377168864011765,0.10031262040138245,0.35759299993515015,0.21876178681850433,0.3908366858959198,0.13069234788417816,0.3558471202850342},{0.45730340480804443,0.04243680462241173,0.08760251849889755,-0.15966260433197021,0.2413061410188675,-0.42733320593833923,-0.45321816205978394,0.1170935407280922,-0.25546589493751526,-0.32219722867012024,0.16411755979061127,-0.1776881068944931,0.4217185080051422,-0.2336110919713974,-0.11744380742311478,-0.029265141114592552},{-0.2874220013618469,0.05570879206061363,0.40042388439178467,0.06671150773763657,-0.04121121019124985,-0.015114476904273033,0.1552629917860031,-0.1895671784877777,0.13360337913036346,-0.31814906001091003,0.4615824818611145,0.28857073187828064,-0.04828283563256264,0.13872994482517242,0.1645652800798416,-0.3010380268096924},{-0.36635881662368774,-0.2094455063343048,0.35078901052474976,-0.14774483442306519,-0.4413151144981384,0.48782894015312195,0.37265995144844055,-0.11322721838951111,-0.3450331687927246,-0.1571807712316513,0.054376270622015,-0.3341935873031616,-0.4323853850364685,0.4871090352535248,0.08024594932794571,-0.29190462827682495},{0.11905722320079803,-0.34703901410102844,0.17441518604755402,-0.10024044662714005,-0.26020288467407227,0.15984274446964264,0.24509964883327484,-0.46008822321891785,-0.05976193770766258,0.03635868430137634,-0.41596704721450806,0.2721146047115326,0.36114993691444397,-0.24714113771915436,0.1326151341199875,-0.1055673211812973}};
static const float actor_encoder_attention_layer_w_vs_weight[16][16] = {{0.25338780879974365,-0.01896246150135994,0.4589780569076538,0.4884348511695862,-0.29996392130851746,-0.3146210312843323,-0.09973237663507462,-0.35263314843177795,0.2737307846546173,-0.07469645887613297,-0.30263108015060425,0.08907096087932587,-0.2748201787471771,-0.014852709136903286,0.19490942358970642,-0.011234973557293415},{-0.1327604353427887,0.2851489782333374,-0.029764490202069283,0.12168291211128235,0.06355639547109604,0.037347789853811264,0.16233371198177338,0.016465861350297928,0.015533817932009697,0.17793326079845428,-0.12118199467658997,-0.34340909123420715,-0.29862669110298157,-0.23628287017345428,-0.24414318799972534,0.09068764001131058},{0.24507389962673187,-0.04274771735072136,-0.14244648814201355,0.2771899104118347,0.15282253921031952,-0.4187583327293396,-0.2663508951663971,-0.23938393592834473,0.13267268240451813,0.2913486361503601,-0.046889498829841614,0.41753822565078735,-0.15862230956554413,0.027647046372294426,-0.30858010053634644,0.0008838686626404524},{-0.1612550914287567,0.4648309648036957,-0.44650402665138245,0.2692207396030426,0.3232988715171814,-0.3543244004249573,0.2759378254413605,-0.05911973491311073,-0.34620600938796997,0.33591699600219727,-0.06929241120815277,0.34273701906204224,-0.3374420702457428,-0.3067428767681122,-0.065017469227314,0.4166220724582672},{0.2075396031141281,0.06760857254266739,0.2452014982700348,0.06903716921806335,0.28475502133369446,0.3001425862312317,-0.269578218460083,-0.3547743558883667,-0.32884982228279114,0.07191181182861328,0.10861904174089432,-0.11919927597045898,-0.1723492443561554,-0.37416815757751465,-0.23473019897937775,-0.1873287707567215},{-0.3852784335613251,-0.18031814694404602,-0.03515543043613434,-0.3305094540119171,0.2892000079154968,-0.185616597533226,-0.38222676515579224,0.3326941132545471,-0.10667110234498978,-0.38950440287590027,0.20503117144107819,0.23576676845550537,-0.2776668965816498,-0.03845755383372307,0.08983112126588821,-0.015873946249485016},{-0.43003085255622864,0.055667340755462646,-0.3496406078338623,0.026663804426789284,-0.07484869658946991,0.10897716134786606,-0.08683641254901886,0.040649380534887314,0.08156754076480865,-0.26381999254226685,-0.3635817766189575,-0.3296213448047638,-0.3983382284641266,0.30950623750686646,0.0658603310585022,-0.14335523545742035},{0.07164100557565689,0.3602817952632904,-0.2619769275188446,0.27944788336753845,-0.3342350125312805,-0.20990484952926636,0.218161478638649,-0.11518668383359909,-0.014529023319482803,-0.2208384871482849,0.08898229151964188,0.28941458463668823,-0.23998859524726868,0.08770483732223511,0.42528703808784485,0.4608461260795593},{-0.360000342130661,-0.26995667815208435,0.09990057349205017,-0.21221423149108887,0.11966316401958466,-0.42876216769218445,-0.11295588314533234,-0.26954522728919983,-0.16523683071136475,0.30545032024383545,-0.3888331651687622,0.09500694274902344,0.20533683896064758,0.11097962409257889,0.16159813106060028,-0.07374729216098785},{0.3280041515827179,-0.3205195963382721,-0.2627089023590088,0.05345794931054115,-0.3692476451396942,0.09735634922981262,0.2807377874851227,-0.394011914730072,-0.19881018996238708,0.22081583738327026,0.35535869002342224,-0.4473602771759033,0.137889564037323,0.14961859583854675,-0.3532978892326355,-0.13599815964698792},{-0.09038762003183365,0.2990686595439911,0.2071111798286438,-0.1482395976781845,-0.3843119442462921,0.08265238255262375,-0.05917363613843918,0.4380713999271393,-0.22396934032440186,0.17459893226623535,0.3320285677909851,-0.011533703655004501,-0.400436669588089,-0.10179699957370758,0.35109272599220276,-0.12877772748470306},{-0.17592841386795044,0.4565854072570801,-0.3213500380516052,0.2907094955444336,0.25802430510520935,-0.29707416892051697,-0.03841874375939369,-0.31420570611953735,-0.23437096178531647,-0.2003806084394455,0.16509079933166504,0.2640582025051117,0.17253106832504272,0.42679068446159363,-0.12532274425029755,-0.0695890262722969},{0.2352297455072403,-0.3025617003440857,-0.21861129999160767,0.21647633612155914,-0.31923848390579224,-0.012715459801256657,-0.2000424861907959,0.4350075423717499,-0.17358729243278503,0.33164048194885254,-0.42555996775627136,0.349197119474411,-0.22128838300704956,-0.0885128527879715,-0.05948007479310036,-0.24150528013706207},{0.06852846592664719,0.17862923443317413,0.1250297874212265,-0.3274947702884674,-0.19825203716754913,-0.40811777114868164,0.15008220076560974,-0.11858879774808884,-0.010552613064646721,-0.3514096736907959,-0.2505253851413727,-0.397213339805603,-0.30171629786491394,0.4037759304046631,0.3603842854499817,0.34881874918937683},{-0.30671730637550354,-0.1570264846086502,-0.36983728408813477,0.2485143095254898,-0.15650981664657593,-0.18423181772232056,-0.07800553739070892,-0.16346250474452972,-0.09273672848939896,-0.14131420850753784,0.20341847836971283,-0.3713235557079315,-0.20758117735385895,0.1264757663011551,-0.403088241815567,0.2659584879875183},{-0.24162191152572632,0.22868862748146057,-0.1646626740694046,0.39640066027641296,-0.2377210557460785,0.319121390581131,0.026278475299477577,0.13515399396419525,-0.243543341755867,-0.0836038738489151,-0.17959058284759521,0.46128734946250916,0.13166405260562897,-0.05128131061792374,0.04818973317742348,0.20132440328598022}};
static const float actor_encoder_attention_layer_fc_weight[16][16] = {{0.35309356451034546,-0.2334693819284439,-0.2954586148262024,-0.3016664385795593,0.35560351610183716,0.30041179060935974,0.321795254945755,0.22251199185848236,0.11162234097719193,0.42530757188796997,-0.06615543365478516,-0.13320903480052948,0.42625606060028076,0.16378465294837952,0.08257295936346054,0.13160373270511627},{0.10050997883081436,0.25733017921447754,0.35426780581474304,-0.2278878390789032,-0.06777682155370712,-0.4059217572212219,0.017176279798150063,-0.1005917564034462,-0.22973725199699402,-0.4128836691379547,0.02010824717581272,-0.1319732964038849,-0.19785799086093903,-0.05437713861465454,0.08628910779953003,-0.05029561370611191},{0.3261646330356598,-0.37510359287261963,-0.39197051525115967,-0.27468717098236084,0.26364701986312866,0.33096951246261597,0.26459720730781555,0.33822041749954224,0.28871119022369385,-0.28405067324638367,-0.06861653178930283,-0.279879093170166,0.11185147613286972,-0.3853270709514618,0.4554569125175476,-0.0984104722738266},{-0.005007193423807621,0.012244775891304016,-0.3015870153903961,0.19181334972381592,0.2663440704345703,0.2420722097158432,-0.14608420431613922,-0.15629537403583527,0.2564087212085724,-0.10851790755987167,-0.3979158401489258,-0.0849669799208641,0.173832505941391,0.45291751623153687,-0.06989043951034546,0.16631080210208893},{-0.13924995064735413,0.3503008484840393,-0.3690698742866516,0.37178778648376465,-0.4165451228618622,-0.36184704303741455,0.158376082777977,0.023189939558506012,0.005876761861145496,0.35069647431373596,-0.14767329394817352,0.31478971242904663,0.21783918142318726,-0.27096033096313477,0.40849775075912476,0.42302632331848145},{0.2648982107639313,0.08470006287097931,-0.22778654098510742,0.35476621985435486,-0.2285367101430893,-0.14978910982608795,-0.30139821767807007,0.12268616259098053,-0.2457723468542099,-0.39866745471954346,0.2503928542137146,0.06915173679590225,0.1611689329147339,0.017941497266292572,0.3544447422027588,-0.3182574510574341},{0.15936021506786346,-0.1132848933339119,0.08221039175987244,0.2787722647190094,-0.1400219202041626,0.20063546299934387,0.32680049538612366,0.1494935005903244,-0.0002441891992930323,-0.07777959853410721,-0.431885689496994,0.08077864348888397,0.21473385393619537,0.04263719916343689,0.030397996306419373,0.1289655566215515},{-0.24498623609542847,0.15283456444740295,-0.0037434794940054417,-0.16062931716442108,-0.08410913497209549,-0.20780165493488312,-0.3741268813610077,0.3493667542934418,0.06367609649896622,-0.34662961959838867,-0.353392630815506,0.2211727499961853,-0.35333988070487976,0.2047143280506134,0.46766015887260437,0.14605320990085602},{-0.1645350307226181,0.20145535469055176,0.007965050637722015,-0.058882903307676315,-0.4205056130886078,-0.32693636417388916,-0.2541901469230652,-0.28806164860725403,0.2690916061401367,0.09479650855064392,-0.333591490983963,0.2844112515449524,-0.012071103788912296,-0.4039285182952881,0.3700743317604065,0.011945848353207111},{-0.41345182061195374,-0.045451682060956955,-0.3128374516963959,0.2957329750061035,0.11618917435407639,-0.22561702132225037,0.06065736338496208,-0.3516199588775635,-0.1476738303899765,0.07109113037586212,-0.20307694375514984,-0.27980268001556396,0.38422510027885437,-0.2993848919868469,0.04869745299220085,0.16888420283794403},{-0.003735042642802,-0.3289583623409271,0.40904900431632996,0.01985696516931057,0.18557968735694885,-0.02739831618964672,-0.06450255215167999,0.27909713983535767,-0.10477348417043686,-0.36102500557899475,0.23133964836597443,0.4601306915283203,-0.35279449820518494,-0.2884451746940613,-0.3485441505908966,-0.422296941280365},{0.15586048364639282,0.0343608595430851,0.2877223491668701,0.39692947268486023,-0.2718746066093445,0.1406879723072052,-0.4730289578437805,-0.3121342957019806,-0.03376651555299759,-0.09977898746728897,0.06412815302610397,0.21118810772895813,-0.4515572786331177,0.5078129768371582,0.03457469865679741,-0.2968776226043701},{0.39102575182914734,0.1564253866672516,0.37164607644081116,-0.1684616655111313,-0.04859858751296997,0.1447845846414566,-0.3176324963569641,0.112786203622818,0.2773788571357727,-0.006274390034377575,0.29939237236976624,-0.24396836757659912,0.050681158900260925,-0.3991696536540985,0.18420378863811493,-0.11402548104524612},{0.07735355198383331,-0.12458852678537369,0.36493855714797974,0.020045500248670578,0.3853591978549957,-0.07149747014045715,-0.03879159316420555,0.07672491669654846,-0.14964766800403595,-0.3755201995372772,-0.11349369585514069,-0.3895425498485565,0.0905008465051651,-0.010382704436779022,-0.06728039681911469,-0.23488111793994904},{-0.41353124380111694,0.05107301101088524,-0.09895003587007523,-0.06448955088853836,0.3828321397304535,-0.029856014996767044,0.41735273599624634,0.17443664371967316,0.39462172985076904,-0.41535890102386475,0.35146528482437134,0.152522474527359,0.3015187084674835,0.0790863111615181,0.30856984853744507,0.0389450266957283},{-0.2014124095439911,-0.35345858335494995,0.04597366973757744,-0.17217138409614563,-0.0187809057533741,0.23082603514194489,-0.2569054663181305,-0.45852941274642944,0.23219728469848633,-0.22065620124340057,0.31393399834632874,0.40233084559440613,-0.053416959941387177,-0.016658486798405647,0.1231549009680748,-0.0849509909749031}};
static const float actor_encoder_attention_layer_layer_norm_weight[16] = {0.9170907735824585,0.8605126738548279,0.9225496053695679,0.9593779444694519,0.9166497588157654,0.9118847250938416,0.9460029602050781,0.8871322274208069,0.9235225319862366,0.8791688084602356,0.896213710308075,0.9110227227210999,0.9057790637016296,0.9023275375366211,0.9384915828704834,0.8966591358184814};
static const float actor_encoder_attention_layer_layer_norm_bias[16] = {-0.03881154581904411,-0.11072629690170288,0.03740421682596207,0.09835733473300934,-0.003767791436985135,-0.02174445427954197,-0.0008029700256884098,0.09395776689052582,0.09264270216226578,-0.057624220848083496,0.05994485318660736,-0.07288230210542679,0.039523880928754807,0.015834776684641838,0.015020918101072311,0.01810312271118164};
static const float mean[62] = {-0.07054387969702851,-0.05564333359737086,-0.16611349442430196,-0.012064861183841822,-0.008550764086995304,-0.005647264744495526,-0.7056942348764793,-0.05489293720533309,-0.0009655997514044392,0.0625287582568923,-0.692228282307967,0.01110255204493921,-0.03797469734852766,-0.00033463924206206215,-0.27362281641044356,-0.05964108468835908,0.08306656255113531,-0.6279992598795606,-0.012441823329738358,0.02681571600719096,0.00947513265787003,0.00936085010777806,-0.01268149601838138,-0.06448430992433041,-0.007468301575263971,0.019578422674360104,-0.010512945106439424,0.010142822501169036,0.0353339778242733,0.035248027291815254,1.9451767211896338,1.9457245739107452,1.9459928317446569,1.9458590668602616,1.9453416261844534,1.9446240089149036,1.9441389860182796,1.9439972914612338,1.9428999218564107,1.9417195769690245,1.9405163794290583,1.9394352730321613,1.9386877340270952,1.938342214478818,1.938349069618896,1.9386637350807543,1.9442171507870518,1.9448685501280252,1.945282158374538,1.945762271227763,1.946355989381828,1.9470794216505019,1.9478008690392354,1.9482920941779265,1.95170714505887,1.9519980294992523,1.9518126707703545,1.9511245094490923,1.9499031285757231,1.9483315047974972,1.9466960008986667,1.9455373967616318};
static const float input_std[62] = {1.825075427838518,2.701237661413196,0.7885139818326465,1.1214113193415438,1.1413395449866224,1.1229650149428732,0.6376521189823663,0.5909131438021084,0.39415954302245765,0.5876566884879961,0.6374528664686133,0.38770555829826664,0.39605394018379986,0.3840534175513434,0.40867500202068174,7.464382117004707,7.958740659415107,7.218723992739007,1.4028278954054223,1.1613447030547912,0.6087137511087569,1.635063239422569,1.4631972293980637,1.4303087325893091,1.7806592672623174,1.3881551884085706,0.6625821427862363,1.3965490802443818,1.310814169655747,1.2894400059219056,0.2532446253042621,0.25215706807786303,0.2516489306689614,0.2519504037491317,0.25291994743045726,0.2542754831611501,0.2552569547740164,0.25570026578892735,0.25847180403865644,0.2607746992252751,0.262952534940116,0.26480364185036265,0.26591981785091,0.26629486485670373,0.26601325202742376,0.26516008215195785,0.25299080629026555,0.25157696420673337,0.2504845414633909,0.24930800684695345,0.24804106200166623,0.2466726870285105,0.24523831758342304,0.2441960177360394,0.23651121360381472,0.2360458438359685,0.23659257267877404,0.23829066256462073,0.24102774754543746,0.24451758811189275,0.2481155258077577,0.2507631321017577};
   
void normalize_state(float *state_array) {
    for (int i = 0; i < STATE_DIM; i++) {
        state_array[i] = (state_array[i] - mean[i]) / ((input_std[i]) + EPS);
    }
}

void normalize_neighbor(volatile float *neighbor_inputs) {
    for (int i = 0; i < OBST_DIM; i++) {
        neighbor_inputs[i] = (neighbor_inputs[i] - mean[i+STATE_DIM]) / ((input_std[i+STATE_DIM]) + EPS);
    }
}

void normalize_obstacle(volatile float *obstacle_inputs) {
    for (int i = 0; i < OBST_DIM; i++) {
        obstacle_inputs[i] = (obstacle_inputs[i] - mean[i+STATE_DIM+(NEIGHBORS*NBR_OBS_DIM)]) / ((input_std[i+STATE_DIM+(NEIGHBORS*NBR_OBS_DIM)]) + EPS);
    }
}

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        normalize_state(state_array);
        // Self embed layer
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_embed_layer_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_embed_layer_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
    
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_embeds[i] = output_0[i];
            output_embeds[i + self_structure[0][1]] = attn_embeds[0][i];
            output_embeds[i + 2 * self_structure[0][1]] = attn_embeds[1][i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < 3 * self_structure[0][1]; j++) {
                output_1[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_1[i] += actor_encoder_feed_forward_0_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
    
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_2[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_2[0];
        control_n->thrust_1 = output_2[1];
        control_n->thrust_2 = output_2[2];
        control_n->thrust_3 = output_2[3];	
    }

void neighborEmbedder(volatile float neighbor_inputs[NEIGHBORS * NBR_OBS_DIM]) {
        normalize_neighbor(neighbor_inputs);
    
                for (int i = 0; i < nbr_structure[0][1]; i++) {
                    neighbor_embeds[i] = 0; 
                    for (int j = 0; j < nbr_structure[0][0]; j++) {
                        neighbor_embeds[i] += neighbor_inputs[j] * actor_encoder_neighbor_embed_layer_0_weight[j][i]; 
                    }
                    neighbor_embeds[i] += actor_encoder_neighbor_embed_layer_0_bias[i];
               }
        }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));
        normalize_obstacle(obstacle_inputs);
    
                for (int i = 0; i < obst_structure[0][1]; i++) {
                    obstacle_embeds[i] = 0;
                    for (int j = 0; j < obst_structure[0][0]; j++) {
                        obstacle_embeds[i] += obstacle_inputs[j] * actor_encoder_obstacle_embed_layer_0_weight[j][i];
                    }
                    obstacle_embeds[i] += actor_encoder_obstacle_embed_layer_0_bias[i];
                }
            }


void singleHeadAttention() {
        uint8_t i, j, k;
        // fill the tokens matrix with obstacle and neighbor embeddings
        for (i = 0; i < D_MODEL; i++) {
            tokens[0][i] = neighbor_embeds[i];
            tokens[1][i] = obstacle_embeds[i];
        }
        
        // save the residual
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                residual[i][j] = tokens[i][j];
            }
        }
        
        // compute Q, K, V projection 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                q_outputs[i][j] = 0;
                k_outputs[i][j] = 0;
                v_outputs[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    q_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_qs_weight[k][j]; 
                    k_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_ks_weight[k][j];
                    v_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_vs_weight[k][j];
                }
            }
        }
        
        // compute attention weights and parts of softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            softmax_sums[i] = 0;
            for (int j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    attn_weights[i][j] += (q_outputs[i][k] / sqrt((float)D_MODEL)) * k_outputs[j][k];
                }
                softmax_sums[i] += exp(attn_weights[i][j]);
            }
        }
        
        // softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = exp(attn_weights[i][j]) / softmax_sums[i];
            }
        }

        // compute query 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_output[i][j] = 0;
                for (k = 0; k < NUM_TOKENS; k++) {
                    query_output[i][j] += attn_weights[i][k] * v_outputs[k][j];
                }
            }
        }
        
        // compute the q embeddings 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_embeds[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    query_embeds[i][j] += query_output[i][k] * actor_encoder_attention_layer_fc_weight[k][j];
                }
                // add the residual
                query_embeds[i][j] += residual[i][j];
            }
        }
        
        // calculate per-token mean
        for (i = 0; i < NUM_TOKENS; i++){
            last_layer_means[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                last_layer_means[i] +=  query_embeds[i][j];
            }
            last_layer_means[i] = last_layer_means[i] / (float)D_MODEL;
        }
        
        // calculate per-token variance
        for (i = 0; i < NUM_TOKENS; i++) {
            last_layer_variances[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                base = query_embeds[i][j] - last_layer_means[i];
                exponent = pow(base, 2);
                last_layer_variances[i] += exponent;
            }
            last_layer_variances[i] = last_layer_variances[i] / (float)(D_MODEL);
        }
        
        // perform layer norm (2x16) x (16)
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                attn_embeds[i][j] = (query_embeds[i][j] - last_layer_means[i]) / (sqrt(last_layer_variances[i] + EPS)) * actor_encoder_attention_layer_layer_norm_weight[j]; 
                attn_embeds[i][j] += actor_encoder_attention_layer_layer_norm_bias[j]; 
            }
        }
}
