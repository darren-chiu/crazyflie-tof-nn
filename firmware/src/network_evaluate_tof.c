#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.22944466769695282,-0.15854690968990326,0.36829715967178345,0.258716344833374,-0.3343293368816376,0.18051236867904663,0.004127813968807459,-0.19174695014953613,0.02684466727077961,0.3524097502231598,0.13604022562503815,-0.03783244639635086,0.14804351329803467,-0.19858446717262268,0.2796168625354767,-0.1353372484445572},{-0.041996393352746964,-0.3501643240451813,0.33222270011901855,0.02134142816066742,-0.31054800748825073,0.011397501453757286,-0.4344807267189026,0.079493947327137,-0.1456267535686493,-0.10787057876586914,0.22267267107963562,-0.15471778810024261,0.040507666766643524,-0.2876211702823639,-0.17419388890266418,0.20496827363967896},{-0.20898272097110748,-0.5398553013801575,-0.1775376796722412,0.26241934299468994,0.6933044195175171,0.5390279293060303,0.0575745664536953,-0.5746968984603882,0.20780949294567108,-0.8496286869049072,-0.3754400312900543,0.8542143702507019,-0.5572198033332825,-0.23864586651325226,-0.2867635488510132,0.11206504702568054},{-0.1480727195739746,0.2155131995677948,0.4068062901496887,0.013450357131659985,-0.37521621584892273,-0.251718670129776,0.4137819707393646,0.14782221615314484,0.33341169357299805,-0.24545173346996307,-0.0513201504945755,0.36587774753570557,-0.17898420989513397,-0.10558417439460754,0.3159765899181366,-0.3306008279323578},{-0.007071528118103743,-0.01179190631955862,0.34362995624542236,-0.07866505533456802,0.22585436701774597,0.4250664710998535,0.3716796040534973,-0.09669551998376846,0.07614168524742126,0.2981991767883301,0.3663753271102905,-0.3084939122200012,-0.12490681558847427,-0.1894843578338623,0.33164095878601074,0.14235159754753113},{-0.07116714119911194,-0.29793429374694824,-0.18554414808750153,-0.2133610099554062,0.16471119225025177,0.14353801310062408,0.028429795056581497,-0.3516403138637543,0.4973485469818115,-0.40086495876312256,-0.28350186347961426,0.25358277559280396,0.24089407920837402,0.05217437073588371,-0.002510898979380727,-0.0002778285415843129},{-0.01415324117988348,-0.07887978106737137,-0.08126017451286316,-0.22069406509399414,0.2472388595342636,0.147184818983078,0.08751364797353745,0.2522968053817749,0.315345823764801,-0.11437681317329407,-0.10162075608968735,0.1417567878961563,-0.25543197989463806,0.31713953614234924,-0.23546332120895386,-0.2570190727710724},{-0.030970899388194084,0.013575215823948383,0.11966314911842346,0.30980727076530457,-0.330262154340744,-0.012510719709098339,0.2620779573917389,0.29249057173728943,0.16034451127052307,0.3390171527862549,-0.3045128881931305,-0.34811797738075256,0.3597714900970459,0.19533981382846832,0.10184299200773239,0.1191696897149086},{0.21944402158260345,-0.5879592299461365,0.9636650085449219,0.4077548384666443,0.5605795979499817,-0.23028524219989777,-0.09193558245897293,-0.3646021783351898,0.4202948212623596,-0.3783119320869446,0.12040027976036072,-0.4133593738079071,-0.33182352781295776,-0.012392332777380943,0.9314448833465576,-0.451384961605072},{0.06627538800239563,-0.3390597701072693,-0.35617631673812866,-0.15956546366214752,-0.41479864716529846,0.1691390722990036,0.41954970359802246,0.3099682927131653,0.1469658464193344,0.2884752154350281,-0.17783693969249725,-0.32491931319236755,-0.048751793801784515,0.3900609314441681,0.050178322941064835,-0.28061801195144653},{0.14617925882339478,0.18592029809951782,0.2619256377220154,-0.29171690344810486,-0.31485381722450256,0.3265124559402466,0.1843957006931305,0.32888874411582947,-0.33818650245666504,-0.10940807312726974,0.11957837641239166,0.14730751514434814,-0.40971559286117554,-0.04435322806239128,0.2750219702720642,-0.410779744386673},{0.4917021095752716,0.2742314338684082,0.03440108895301819,-0.5244899988174438,0.6248098611831665,0.3832949101924896,-0.22156275808811188,0.2603353261947632,0.23137009143829346,0.06538666039705276,1.154309868812561,0.03931666910648346,-0.38763031363487244,-0.48330533504486084,0.543199896812439,0.6944127082824707},{-0.08349896967411041,0.9016162157058716,-0.08918669819831848,-1.1266145706176758,0.11762641370296478,0.2519436478614807,-0.16958507895469666,0.37173572182655334,-0.028750719502568245,0.06845034658908844,0.49639883637428284,0.5505164265632629,0.2373303771018982,0.16752412915229797,-0.035200148820877075,0.2723524868488312},{-0.4752791225910187,-0.1335591971874237,-0.7551083564758301,-0.15293124318122864,-0.678970992565155,0.2976890206336975,0.10142149776220322,0.18205754458904266,-0.5756784677505493,0.16093409061431885,-0.5471380352973938,-0.0813748687505722,0.08240148425102234,0.36432158946990967,-0.3902844488620758,0.21661387383937836},{0.1759285032749176,-0.09637505561113358,-0.09644931554794312,0.23332205414772034,-0.33599910140037537,-0.6410821080207825,0.25026342272758484,0.39316776394844055,-0.015159841626882553,0.6722310185432434,0.13624195754528046,-0.23416520655155182,0.4355362355709076,0.02698078565299511,-0.1640239655971527,0.4180845022201538},{0.08626110106706619,-0.03588571399450302,-0.15749335289001465,-0.08189897984266281,-0.22784940898418427,0.1856738030910492,0.3909573554992676,-0.08369576930999756,0.1505517065525055,0.26582226157188416,-0.13317550718784332,0.07681167125701904,-0.1485293060541153,0.17346355319023132,-0.08034811913967133,0.009497507475316525},{-0.24799205362796783,-0.22443260252475739,0.20605380833148956,0.13572297990322113,-0.11582126468420029,0.061053719371557236,-0.20463845133781433,-0.09434348344802856,-0.1784399449825287,-0.2501811683177948,0.041976697742938995,-0.3949522078037262,0.1374102532863617,-0.19988054037094116,0.0952816903591156,-0.1369798183441162},{-0.11750198900699615,0.19493871927261353,-0.2313670516014099,-0.14578698575496674,-0.10408302396535873,0.31049299240112305,-0.06308314949274063,-0.11982078850269318,-0.02073664776980877,0.2029285877943039,0.07462651282548904,-0.04049695283174515,-0.41216421127319336,0.3092765808105469,0.0710979476571083,-0.4400020241737366}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.02499057911336422,-0.011287221685051918,-0.17405524849891663,-0.23928256332874298,0.3475865423679352,0.30158719420433044,0.1214507445693016,0.0747842937707901,-0.009832141920924187,-0.1606406569480896,0.017889410257339478,0.10980531573295593,0.19509680569171906,0.2785353362560272,0.11599628627300262,0.035461749881505966},{-0.18517722189426422,-0.3254046142101288,-0.08549309521913528,0.15907062590122223,0.24747873842716217,-0.2902042269706726,0.11256479471921921,0.07566336542367935,-0.059944037348032,0.20794528722763062,-0.2067314088344574,0.30038341879844666,-0.2463245391845703,0.14793679118156433,-0.3741748034954071,-0.2666397988796234},{-0.03953747823834419,0.16237720847129822,-0.30074578523635864,-0.37670689821243286,0.3076836168766022,0.3536653518676758,0.07056452333927155,0.10075648874044418,-0.19775395095348358,-0.35314345359802246,0.022119920700788498,0.27636778354644775,-0.0905158594250679,-0.21677841246128082,0.12411084026098251,0.009181030094623566},{0.11355383694171906,0.04071751981973648,0.05549751594662666,0.08534613251686096,-0.4328191876411438,-0.035216353833675385,0.045240916311740875,-0.26188427209854126,0.4434686005115509,0.38705775141716003,-0.23836299777030945,-0.12003184109926224,-0.4774532914161682,-0.36562880873680115,0.2610635757446289,0.10369476675987244},{-0.07887270301580429,0.18829362094402313,0.049625229090452194,0.2962159514427185,-0.18262168765068054,0.0419500395655632,0.10483131557703018,0.1943487524986267,0.1318390667438507,-0.2846352756023407,0.11959616839885712,0.2341005653142929,0.22204698622226715,-0.40697261691093445,0.05791351944208145,0.027776110917329788},{0.17238982021808624,0.07856577634811401,0.07958996295928955,0.306037038564682,-0.3821908235549927,-0.40797463059425354,0.2905406355857849,0.36543816328048706,-0.033591896295547485,0.3003194034099579,0.2667373716831207,-0.35225945711135864,0.07092271000146866,-0.13867317140102386,-0.11495675891637802,0.22038474678993225},{-0.15241307020187378,0.20929192006587982,0.3134690821170807,-0.22925275564193726,-0.17686636745929718,0.006513991858810186,-0.2407265156507492,0.023747052997350693,0.05499708279967308,0.10003180801868439,-0.13752032816410065,-0.229928657412529,-0.19352522492408752,-0.04527920112013817,0.13758495450019836,-0.020682135596871376},{-0.09843780845403671,-0.16224442422389984,-0.31673189997673035,0.374564528465271,-0.22884468734264374,-0.28492090106010437,-0.2254886031150818,-0.4466429650783539,0.07016563415527344,-0.13787131011486053,-0.007009127177298069,0.0789511650800705,-0.03762369230389595,0.4010581970214844,-0.17447398602962494,-0.17569302022457123},{-0.31077840924263,0.2552008032798767,-0.12031945586204529,-0.03457843139767647,0.24702632427215576,-0.2389017939567566,0.29539886116981506,0.09759023785591125,0.32921940088272095,0.25150689482688904,0.18932442367076874,0.40978196263313293,0.08994467556476593,-0.10979926586151123,0.29857197403907776,-0.043598368763923645},{0.07056894153356552,-0.25771909952163696,-0.271528959274292,-0.18466447293758392,0.27881208062171936,-0.13976681232452393,-0.3650684654712677,-0.19876502454280853,0.1333104819059372,-0.3231191039085388,-0.30131083726882935,0.38308003544807434,0.027527928352355957,0.212501659989357,-0.4356316030025482,0.06345503777265549},{-0.21529273688793182,-0.5378745794296265,0.25734326243400574,0.2849832773208618,0.30244991183280945,0.06150833144783974,0.3509942293167114,-0.09540465474128723,0.26210540533065796,-0.5104610323905945,0.058825064450502396,0.2939642071723938,0.42586714029312134,0.2596234977245331,-0.24420088529586792,-0.12137697637081146},{0.07857098430395126,-0.01090310700237751,0.29924747347831726,0.0881800726056099,-0.23255422711372375,-0.13558031618595123,0.37298819422721863,0.26396533846855164,-0.2826206386089325,-0.20023934543132782,-0.07828677445650101,-0.25384438037872314,0.013395230285823345,-0.39452221989631653,-0.2841755747795105,0.10929445922374725},{-0.08181878179311752,-0.2748834788799286,0.3057137429714203,-0.2075590342283249,0.35112255811691284,-0.33119311928749084,-0.4085424244403839,0.055375467985868454,0.15409740805625916,0.05246404558420181,-0.2942558526992798,0.09774958342313766,0.10631214082241058,-0.26282113790512085,-0.3420817255973816,-0.022202717140316963},{0.20346374809741974,-0.3109572231769562,0.28679317235946655,0.15872527658939362,-0.008300406858325005,0.3065791726112366,-0.1619306206703186,-0.2195749282836914,-0.351323664188385,0.056857191026210785,-0.011486959643661976,-0.23416757583618164,-0.0167499091476202,0.006864713504910469,0.2642252743244171,-0.02425101026892662},{-0.21233594417572021,0.16270098090171814,0.0653553307056427,-0.3311489522457123,-0.07798048853874207,0.1379181444644928,0.361141562461853,-0.23167893290519714,0.2921682298183441,-0.35133206844329834,0.02045752853155136,0.01731812208890915,0.053979404270648956,0.1952192187309265,-0.021743163466453552,0.007231648080050945},{-0.3264491856098175,0.3646863102912903,-0.3926122784614563,0.4362644553184509,0.31207728385925293,-0.3557797968387604,0.04767343029379845,-0.07501630485057831,-0.3211177885532379,0.32360920310020447,-0.3741286098957062,0.3288116455078125,-0.0759662389755249,-0.16723668575286865,-0.21267758309841156,-0.5785898566246033}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.17285385727882385,0.09222759306430817,-0.03387713059782982,-0.014061114750802517,-0.051184024661779404,-0.004520102869719267,0.2708747684955597,0.027513932436704636,-0.16429249942302704,-0.24105167388916016,0.11799278855323792,-0.2901368737220764,-0.21994532644748688,0.20702752470970154,0.22174310684204102,0.30629032850265503,-0.2670277953147888,-0.29638123512268066,-0.22789964079856873,0.11290400475263596,-0.04578026756644249,-0.3724684715270996,-0.24350258708000183,-0.26526179909706116,-0.22134828567504883,0.19501493871212006,-0.22620432078838348,-0.0188116617500782,0.004533718805760145,0.015087509527802467,0.1652483493089676,-0.20673300325870514},{0.33092495799064636,0.18924131989479065,0.2116643637418747,-0.0011228516232222319,0.09340613335371017,-0.15600015223026276,0.3007100522518158,0.15660612285137177,-0.13677790760993958,-0.0487082377076149,-0.1291530579328537,-0.2456434965133667,-0.09310335665941238,0.25628605484962463,-0.23894068598747253,-0.25263711810112,-0.09254678338766098,0.1358494609594345,-0.3206007480621338,-0.24762175977230072,0.019298728555440903,0.17975738644599915,0.04468199238181114,0.04420505091547966,0.14871728420257568,-0.31435659527778625,-0.05954151973128319,-0.04877716675400734,0.22492140531539917,-0.06733182817697525,-0.06287781894207001,0.26001664996147156},{0.21184958517551422,0.04867028445005417,-0.02693113498389721,0.09212006628513336,-0.11539966613054276,-0.09552621841430664,-0.2134852558374405,0.1184476688504219,-0.09217067062854767,0.27938541769981384,-0.25440964102745056,-0.20158159732818604,0.19403129816055298,-0.3278704285621643,-0.16175594925880432,0.1152300164103508,-0.020153498277068138,-0.0584389828145504,0.2565464973449707,-0.015310741029679775,0.14769980311393738,0.30108150839805603,-0.3697977066040039,0.02403121627867222,-0.1344725489616394,-0.07675248384475708,0.0880051776766777,0.028433557599782944,-0.027065575122833252,-0.11575210094451904,-0.035085465759038925,-0.1686582714319229},{0.31125566363334656,0.0010339569998905063,0.05966530367732048,-0.08160294592380524,-0.21776345372200012,-0.05368852615356445,-0.1528673619031906,0.1480305939912796,0.3179980218410492,-0.35706496238708496,-0.09393257647752762,0.23155388236045837,0.11314059048891068,-0.08042077720165253,-0.24048078060150146,0.20812545716762543,-0.24673455953598022,0.25627249479293823,-0.0785302072763443,-0.007928314618766308,-0.02072368748486042,-0.11354783177375793,0.2575136125087738,0.12445713579654694,0.0849941149353981,-0.2029184103012085,0.24645832180976868,-0.17474769055843353,-0.05795896798372269,0.053877416998147964,-0.24091386795043945,0.19634729623794556},{-0.016320398077368736,0.023987114429473877,-0.07945175468921661,0.036876678466796875,0.20425918698310852,-0.031290944665670395,-0.3786970376968384,-0.016846777871251106,-0.17105600237846375,-0.2620796263217926,0.15647363662719727,0.24285486340522766,-0.009953989647328854,-0.04990263283252716,-0.11735399812459946,0.17599491775035858,0.05763501301407814,0.03774479404091835,-0.2322186380624771,-0.24138857424259186,-0.25522881746292114,-0.2917720079421997,0.1910712569952011,0.13146920502185822,-0.08481958508491516,0.22045329213142395,-0.17350882291793823,0.271820068359375,0.3011540174484253,0.35842034220695496,0.07759889960289001,0.31577780842781067},{-0.141610786318779,-0.09479005634784698,-0.10829636454582214,-0.21219870448112488,-0.13410627841949463,0.20388883352279663,0.2595632076263428,0.13755258917808533,0.326221764087677,0.17144840955734253,0.2850099205970764,-0.18651296198368073,-0.17810851335525513,0.19328071177005768,0.2559437155723572,-0.26663872599601746,-0.07897210121154785,-0.16752873361110687,0.2411600947380066,0.3034287989139557,0.02698805183172226,0.15890617668628693,-0.04404536634683609,0.0405440479516983,-0.14912991225719452,0.2413027584552765,-0.1531214714050293,0.22697880864143372,0.2462226152420044,0.24296249449253082,0.08873265981674194,-0.06551680713891983},{0.27233049273490906,-0.17768646776676178,-0.002274600090458989,-0.34798604249954224,0.003942091949284077,0.33239445090293884,0.2829047441482544,0.33003607392311096,0.04913510009646416,0.30761709809303284,0.04027551785111427,0.050858572125434875,-0.34120285511016846,-0.0493793748319149,-0.14185966551303864,0.181211456656456,-0.1881951540708542,-0.13957101106643677,0.2900596261024475,-0.017929937690496445,-0.26731422543525696,-0.072377048432827,-0.3314909338951111,-0.19265517592430115,0.23752014338970184,-0.30522313714027405,-0.1551877111196518,-0.08655952662229538,0.24117964506149292,0.19975093007087708,0.004852205514907837,-0.32119429111480713},{0.08477231115102768,0.2168436348438263,0.10989724844694138,0.006069945637136698,0.06823857873678207,-0.2799361050128937,-0.11610303074121475,-0.07631415873765945,-0.09092718362808228,-0.22040005028247833,-0.2485221028327942,-0.047527994960546494,-0.08057954907417297,0.10770483314990997,-0.08554607629776001,0.4286094307899475,-0.059281449764966965,-0.19559980928897858,0.1661982387304306,0.4045916497707367,-0.15994474291801453,-0.22170162200927734,0.2812892198562622,0.1421041190624237,-0.004733459558337927,-0.32834118604660034,-0.3502438962459564,-0.2873763144016266,-0.34504762291908264,-0.23612266778945923,0.14407266676425934,-0.36706605553627014},{-0.0023712709080427885,0.2882988452911377,-0.34804439544677734,-0.3612954914569855,-0.19366011023521423,0.03962065652012825,0.13330446183681488,-0.069956935942173,0.16701644659042358,-0.2597079277038574,-0.28356799483299255,0.22859841585159302,-0.27793723344802856,-0.08476763218641281,0.13767915964126587,-0.375819593667984,0.24935880303382874,0.15573109686374664,0.1882552057504654,-0.021343721076846123,0.20669877529144287,0.0839330181479454,0.22480109333992004,-0.11321564763784409,0.30222082138061523,-0.13023042678833008,0.09718551486730576,0.2633109986782074,-0.20341871678829193,0.0846981629729271,-0.051083531230688095,0.12065258622169495},{-0.15680502355098724,0.16329117119312286,-0.24340668320655823,-0.13991183042526245,0.1768602877855301,-0.1600518673658371,0.09405995160341263,-0.026737233623862267,0.18056856095790863,-0.1115875318646431,-0.28030213713645935,-0.3128400146961212,-0.3157934546470642,-0.032809026539325714,-0.271388441324234,0.10564151406288147,0.07473837584257126,-0.2128731906414032,0.25681889057159424,0.0846380889415741,0.0251256562769413,-0.046600472182035446,0.27120521664619446,-0.16665281355381012,0.2852665185928345,0.11142568290233612,-0.29640236496925354,0.005059543997049332,-0.009080926887691021,0.15252552926540375,-0.12332198768854141,0.07072208821773529},{0.1150059700012207,-0.027405845001339912,0.22900159657001495,-0.26813575625419617,-0.2862370014190674,-0.2545737624168396,-0.25776299834251404,0.01780310459434986,-0.2514970302581787,0.44800132513046265,0.12824398279190063,-0.23134732246398926,-0.33163782954216003,-0.023926151916384697,-0.16498464345932007,-0.06014247238636017,0.17768628895282745,-0.16662214696407318,0.2599271833896637,-0.08068045228719711,-0.19323715567588806,0.013154723681509495,0.13902677595615387,0.2744486927986145,0.17226004600524902,-0.14107617735862732,-0.058326203376054764,-0.11022314429283142,-0.0676497220993042,0.0564710758626461,-0.010295256972312927,0.12838776409626007},{-0.16952987015247345,-0.11499973386526108,0.22490404546260834,0.31477200984954834,0.2447260171175003,-0.022128302603960037,0.03623593971133232,-0.26217979192733765,0.0011881382670253515,-0.2636277973651886,0.23622889816761017,-0.2101559042930603,-0.13145661354064941,-0.20775297284126282,0.24325509369373322,-0.11004658043384552,0.029143543913960457,-7.950548024382442e-05,0.3430454432964325,-0.026153983548283577,-0.1369250863790512,0.20605766773223877,0.08928683400154114,-0.11895933002233505,0.17778992652893066,-0.09345115721225739,-0.15150442719459534,0.18038927018642426,0.147805318236351,-0.016571715474128723,-0.2775649428367615,-0.19382981956005096},{0.299935519695282,-0.23039042949676514,0.027752717956900597,-0.3278825581073761,0.08353141695261002,-0.03377711400389671,0.1211705207824707,0.10191530734300613,0.222222700715065,-0.02050698734819889,0.16326315701007843,0.2166467308998108,-0.33863264322280884,-0.22438809275627136,-0.057009533047676086,-0.32041406631469727,-0.0912293940782547,-0.2085365504026413,0.3005113899707794,-0.3059765696525574,0.24182002246379852,-0.02234952710568905,-0.03210235387086868,0.1432836353778839,0.12290269881486893,-0.10079380869865417,0.06905203312635422,0.13131192326545715,0.08864652365446091,-0.009904385544359684,-0.10588978976011276,-0.08080890774726868},{0.22757814824581146,0.018597478047013283,-0.025167370215058327,0.3486199975013733,-0.08598842471837997,-0.1625521332025528,-0.03132771700620651,0.16496741771697998,0.1066853255033493,0.34848862886428833,0.11197234690189362,-0.11974829435348511,0.03424125537276268,0.1782187670469284,-0.10062520205974579,0.1981838345527649,0.20796185731887817,-0.22138069570064545,0.13747155666351318,-0.3629549741744995,0.23862208425998688,0.19303011894226074,-0.05634504184126854,0.1873062551021576,0.19831998646259308,0.014257142320275307,0.12287215143442154,0.08007104694843292,0.04957510158419609,-0.13918256759643555,0.010592013597488403,0.3631376326084137},{0.09962630271911621,-0.19266094267368317,-0.011805581860244274,0.06356394290924072,-0.27383410930633545,0.0009279122459702194,0.09148343652486801,-0.15964776277542114,-0.18230585753917694,-0.0013330469373613596,0.194430872797966,0.16371093690395355,0.08899368345737457,0.289406955242157,-0.05049102008342743,0.04072622209787369,-0.22439493238925934,0.3195619583129883,-0.06659764051437378,-0.13199551403522491,-0.2530578374862671,-0.055579427629709244,0.12743990123271942,0.11174783855676651,0.04955413192510605,-0.14190174639225006,-0.1841079443693161,0.18916937708854675,0.06864449381828308,-0.17190402746200562,0.29052862524986267,0.10060549527406693},{0.13212358951568604,-0.22224202752113342,-0.004497682675719261,-0.18489857017993927,0.057668399065732956,0.16670460999011993,0.0795481875538826,0.2080995738506317,-0.10179878771305084,-0.03048490174114704,0.18818989396095276,0.09022684395313263,0.0585278645157814,-0.0334194079041481,-0.026898153126239777,0.17255643010139465,-0.3163602948188782,-0.17540529370307922,-0.08202308416366577,0.0388980358839035,0.010847220197319984,0.2639738619327545,0.15129126608371735,0.19141370058059692,0.06378157436847687,0.20905981957912445,-0.07938539981842041,-0.05639321729540825,0.18231014907360077,-0.10246437788009644,-0.2667754292488098,0.3058595657348633},{0.14881759881973267,0.009768555872142315,-0.2921164035797119,0.18023382127285004,0.09291251748800278,-0.02425677701830864,0.3116682767868042,0.06890900433063507,0.11917608231306076,-0.16106340289115906,0.20582689344882965,-0.21894265711307526,-0.3875477910041809,0.2661886215209961,0.08945482224225998,-0.03552091121673584,0.021017273887991905,-0.07283657044172287,-0.17588922381401062,0.043611302971839905,-0.03930659219622612,0.19852104783058167,0.0522308424115181,-0.18183761835098267,-0.04632819816470146,-0.1897953450679779,0.0071035949513316154,0.3703857958316803,0.1912783980369568,-0.09890884906053543,0.21221934258937836,0.19909381866455078},{-0.1074456050992012,0.008865251205861568,-0.07403351366519928,-0.0654522031545639,-0.23937617242336273,0.015199888497591019,0.22192931175231934,0.16385820508003235,0.11345382779836655,-0.004279919900000095,0.24033553898334503,0.01932109147310257,0.19874504208564758,0.12742190062999725,0.18789684772491455,-0.1366719752550125,0.11715496331453323,0.18864302337169647,0.23122064769268036,0.023694660514593124,0.18111151456832886,0.2742994427680969,0.08010160177946091,0.10868911445140839,-0.046780601143836975,-0.05808642879128456,-0.12360439449548721,-0.20350950956344604,0.16567280888557434,-0.22203420102596283,0.010180803015828133,-0.06120558828115463},{-0.2991897165775299,0.04389970377087593,-0.3158518075942993,-0.22917482256889343,-0.04318268224596977,-0.0007140308734960854,0.05583334341645241,-0.17457030713558197,0.04546895995736122,0.3553377389907837,0.09533800184726715,-0.15067380666732788,0.08481296896934509,-0.1964510977268219,-0.23858430981636047,-0.0027168213855475187,-0.1955375224351883,0.04463845118880272,-0.03589855879545212,-0.06338643282651901,-0.21484734117984772,0.1031375601887703,0.12923891842365265,0.008561315946280956,-0.08531831204891205,0.31992170214653015,0.09321458637714386,-0.22459226846694946,-0.14832593500614166,0.07039450109004974,-0.16381503641605377,-0.15440168976783752},{0.015869436785578728,-0.23428727686405182,-0.26198363304138184,-0.007791539188474417,-0.31454724073410034,-0.10306037217378616,0.124034084379673,-0.27579209208488464,-0.23269064724445343,0.1131090596318245,0.1967809498310089,0.10976265370845795,0.13127651810646057,-0.10122561454772949,0.3037944734096527,-0.27730509638786316,0.1507534384727478,0.2656782865524292,0.08059248328208923,0.24789176881313324,0.007383208256214857,-0.092061847448349,-0.2831791937351227,0.21301668882369995,-0.13308416306972504,-0.1335456222295761,0.1413080245256424,0.054068658500909805,-0.10060370713472366,-0.3026793301105499,0.0448414571583271,-0.16200707852840424},{0.13611866533756256,0.18249331414699554,-0.10640028864145279,0.20549161732196808,-0.24257434904575348,0.13461855053901672,-0.0957295224070549,-0.2586075961589813,-0.1544487625360489,0.2444903552532196,-0.30196428298950195,-0.1410052478313446,-0.010555185377597809,-0.23545138537883759,-0.338875949382782,-0.23383279144763947,-0.10301821678876877,-0.291650652885437,-0.2918970286846161,0.17438362538814545,0.16362683475017548,0.1197899580001831,-0.3186638057231903,0.27728933095932007,0.11326738446950912,0.3122279644012451,-0.2707291841506958,-0.05438743159174919,0.05022239312529564,-0.23471331596374512,0.05370480194687843,0.15961401164531708},{-0.034731294959783554,-0.301796555519104,-0.031482744961977005,-0.25035178661346436,-0.0766231119632721,0.2837356925010681,0.15229187905788422,0.019430747255682945,-0.0699051022529602,-0.0005200631567277014,-0.18971776962280273,0.1300041824579239,0.12182137370109558,0.0834418535232544,0.1364615112543106,0.012594851665198803,-0.06543143838644028,0.10756391286849976,-0.10398048162460327,0.1445988416671753,0.2165762335062027,0.22693610191345215,-0.03895724192261696,-0.247665673494339,0.13436919450759888,0.1858372986316681,0.28459009528160095,0.11919500678777695,0.054350338876247406,0.11407143622636795,0.04130733758211136,-0.056949906051158905},{0.011568711139261723,-0.17071659862995148,0.21800419688224792,0.024426229298114777,0.240022674202919,-0.047311149537563324,-0.1507045477628708,-0.16349874436855316,0.13925376534461975,-0.04541419818997383,0.05491273105144501,0.019970843568444252,-0.2915709912776947,0.01779756508767605,-0.08348246663808823,-0.2249176800251007,-0.04186086356639862,-0.0392688624560833,0.2026902735233307,0.24091221392154694,0.040956802666187286,0.04645286872982979,0.1855037361383438,0.3114575743675232,-0.18390800058841705,-0.061594292521476746,0.195949986577034,-0.0866287425160408,-0.13201546669006348,-0.27262163162231445,0.27660709619522095,0.012671120464801788},{0.14945028722286224,-0.11181631684303284,-0.0034204183612018824,0.20745939016342163,0.010727789252996445,0.06123119592666626,-0.2626188397407532,0.20268873870372772,-0.0575113520026207,-0.06773623824119568,0.07801186293363571,-0.32176434993743896,0.045952096581459045,-0.027285907417535782,-0.1380157172679901,0.22904397547245026,-0.05396352708339691,-0.20176725089550018,-0.01577502302825451,-0.07244628667831421,-0.13174951076507568,0.17854224145412445,0.19746190309524536,0.21634076535701752,-0.30106836557388306,0.21076074242591858,-0.07244960963726044,0.06400461494922638,-0.1883336454629898,0.2427087426185608,-0.0772593691945076,0.0843290388584137}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.14840686321258545,-0.0881156474351883,0.05559920892119408,-0.07087791711091995},{0.20819012820720673,-0.2154422253370285,0.21163985133171082,0.18018227815628052},{-0.15729272365570068,-0.01005780790001154,0.06729980558156967,-0.0356193482875824},{0.2625444233417511,0.4018579125404358,0.31177085638046265,0.03938418999314308},{-0.1541963517665863,0.06083515286445618,-0.1723688244819641,0.06656499207019806},{0.0032405422534793615,-0.03236996755003929,0.03005301207304001,0.19417306780815125},{-0.04862343519926071,-0.03324209526181221,-0.18140755593776703,-0.067100390791893},{-0.1321905255317688,-0.27504873275756836,0.12117966264486313,-0.048695094883441925},{-0.09417087584733963,0.16049697995185852,-0.06613817065954208,-0.07934487611055374},{0.18156249821186066,-0.0600333996117115,-0.06918980926275253,-0.1808103770017624},{0.1430417001247406,-0.18871185183525085,0.22585129737854004,0.22841840982437134},{0.001141327666118741,0.01707637496292591,0.24633091688156128,-0.009733638726174831},{-0.1449599266052246,0.11530141532421112,0.011249215342104435,-0.01736545003950596},{-0.07194431126117706,-0.02868223935365677,-0.13816514611244202,-0.021749092265963554},{0.1326557695865631,-0.031558532267808914,0.14299671351909637,0.03834190592169762},{-0.1202278658747673,-0.23641887307167053,-0.10785751044750214,-0.05943255499005318},{-0.13617751002311707,0.03149593994021416,-0.04657464101910591,0.1413576304912567},{-0.2093309462070465,-0.04765716940164566,-0.1950729787349701,0.17111238837242126},{-0.07487797737121582,-0.07102233916521072,0.22910600900650024,0.07832148671150208},{-0.09360642731189728,-0.12292748689651489,0.024938184767961502,-0.12609049677848816},{0.10223730653524399,0.10830964893102646,0.07993157207965851,-0.05703861638903618},{-0.0020782076753675938,-0.15239247679710388,-0.142936110496521,0.23795847594738007},{0.20639804005622864,-0.0752478763461113,0.06611265242099762,-0.004911347758024931},{-0.1684575080871582,-0.04827316105365753,-0.1914350986480713,-0.1306823194026947},{-0.057628799229860306,-0.03998803719878197,-0.0051779597997665405,-0.025541381910443306},{0.12375417351722717,0.0844624936580658,-0.027466880157589912,0.0746007189154625},{0.19145704805850983,-0.13294599950313568,0.2105766385793686,0.08237697929143906},{-0.047358158975839615,-0.09125085175037384,-0.04941108822822571,0.14622049033641815},{0.03198840469121933,0.022572962567210197,0.01444912701845169,0.009892242960631847},{-0.08228158950805664,0.05539322644472122,0.07078178226947784,0.0044976514764130116},{-0.061394087970256805,-0.11932283639907837,0.03023376688361168,0.047923870384693146},{0.18141353130340576,0.16874754428863525,0.17610763013362885,-0.020333629101514816}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.025585962459445,-0.053424958139657974,-0.026609474793076515,0.025347532704472542,0.005926261655986309,-0.06172993406653404,-0.009077200666069984,0.04404902085661888,-0.03037938103079796,-0.0014231716049835086,0.006479744333773851,0.0020036501809954643,0.02790864184498787,-0.011428073979914188,-0.05876781791448593,-0.027606267482042313};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0047767749056220055,0.05049033463001251,0.0064223031513392925,-0.0006322052213363349,-0.05266432464122772,-0.004547221586108208,0.007785990834236145,0.015221210196614265,0.06080468371510506,0.0005355080356821418,0.0327419713139534,-0.031681887805461884,0.01116152573376894,-0.05792746692895889,0.012883773073554039,-0.006406293250620365};
static const float actor_encoder_feed_forward_0_bias[32] = {0.008734550327062607,0.03121022880077362,0.0022334191016852856,-0.025000538676977158,-0.010563777759671211,0.013326864689588547,-0.007415482308715582,0.005017446354031563,-0.01060907170176506,-0.016074541956186295,0.000269665993982926,0.03665973246097565,0.022927071899175644,-0.030448485165834427,0.013881197199225426,-0.03380274400115013,-0.010969330556690693,0.006175050046294928,0.019913170486688614,-0.0009093511616811156,-0.008701025508344173,0.007962008938193321,-0.022261105477809906,-0.034161947667598724,-0.013768617995083332,-0.0234739538282156,0.0068687680177390575,0.03336047753691673,-0.04471495747566223,0.0533733144402504,-0.011736258864402771,-0.030811524018645287};
static const float action_parameterization_distribution_linear_bias[4] = {-0.022742992267012596,0.010796904563903809,0.004872690420597792,0.010327923111617565};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.5556043982505798,-0.312037855386734,-0.1706339418888092,0.23855985701084137,-0.10385967791080475,0.1609439104795456,-0.17981693148612976,-0.003830714849755168},{0.32008910179138184,0.13844187557697296,0.3853515684604645,0.4102969169616699,-0.003914955537766218,-0.3149426579475403,0.510744571685791,0.36245056986808777},{0.15090630948543549,0.15462075173854828,0.11069513857364655,-0.019348325207829475,0.4236955940723419,0.2536032199859619,0.1495891511440277,0.2282518446445465},{0.1511411815881729,-0.3603755533695221,0.32916030287742615,-0.159795880317688,-0.156748428940773,0.13593068718910217,0.46832507848739624,0.22552399337291718},{-0.20010611414909363,-0.08203606307506561,-0.04638351500034332,-0.25813695788383484,0.1915176808834076,0.14779648184776306,0.5220771431922913,0.2678734362125397},{-0.009403091855347157,0.2100980430841446,0.0060176244005560875,-0.17784549295902252,0.42322805523872375,0.14395391941070557,0.2109532207250595,-0.1527683138847351},{0.050778597593307495,0.16296091675758362,0.18037749826908112,-0.08462539315223694,0.6337096691131592,-0.0399617999792099,0.31995975971221924,0.1423765867948532},{0.08963468670845032,-0.49791455268859863,0.004439778625965118,-0.13187509775161743,0.5472488403320312,0.1763889640569687,0.040801648050546646,-0.26577726006507874},{-0.2599716782569885,0.07407520711421967,0.04182466119527817,-0.025667576119303703,0.14308315515518188,0.5762425065040588,0.515085756778717,0.30868756771087646},{-0.0010567656718194485,-0.21487538516521454,-0.24395433068275452,0.2610267698764801,0.3749500811100006,0.45256948471069336,0.36153677105903625,-0.31592223048210144},{-0.16127118468284607,-0.4679308831691742,0.3688041865825653,0.12077687680721283,0.06526061147451401,-0.12709452211856842,-0.07048381119966507,-0.3668593168258667},{0.2544704079627991,0.021500805392861366,0.42427802085876465,0.3298508822917938,-0.1186707466840744,0.42852941155433655,0.07873846590518951,-0.4067533314228058},{-0.3565743565559387,0.18149365484714508,-0.3344240188598633,0.3821721374988556,-0.02269565686583519,0.4465307295322418,-0.08881565928459167,0.22453181445598602},{-0.05326598882675171,0.13099592924118042,-0.08269838988780975,-0.1726604700088501,0.045688606798648834,0.19657306373119354,0.24967747926712036,-0.028957724571228027},{0.1306675523519516,-0.41581085324287415,-0.2804352939128876,-0.254037082195282,0.14446710050106049,-0.10379474610090256,0.013729045167565346,-0.16786611080169678},{-0.48353004455566406,-0.48014405369758606,-0.21554453670978546,-0.15992371737957,-0.016318565234541893,0.3428046405315399,0.06134412810206413,-0.2246885597705841},{-0.180191308259964,-0.40860748291015625,0.13809876143932343,-0.41811898350715637,0.04640389233827591,0.12625406682491302,-0.48612114787101746,-0.47284266352653503},{0.051933690905570984,0.12941406667232513,0.07114475965499878,0.17502643167972565,-0.035336922854185104,0.38795384764671326,0.26353010535240173,-0.35205239057540894},{0.07595238834619522,-0.3446795344352722,-0.14138223230838776,-0.01871374249458313,-0.07577432692050934,-0.3609973192214966,0.0417567640542984,-0.3211427330970764},{-0.0007707179756835103,0.03675636649131775,0.06638326495885849,-0.25074833631515503,0.11579171568155289,0.07134535163640976,0.09289461374282837,-0.08196888864040375},{0.10473333299160004,-0.05460092052817345,-0.011449724435806274,-0.2288028746843338,0.06671633571386337,-0.05330241471529007,0.0005414217012003064,-0.25979000329971313},{-0.30799344182014465,0.23660874366760254,0.009231100790202618,-0.2745903432369232,-0.3998359441757202,-0.031143316999077797,0.15161994099617004,-0.06707345694303513},{0.33016717433929443,0.17905983328819275,-0.6091268658638,0.0064575206488370895,-0.0016433476703241467,0.17494046688079834,0.2353818714618683,0.1422310471534729},{0.04390218108892441,-0.0466725192964077,-0.2592288851737976,0.13315488398075104,-0.2688083350658417,-0.10640518367290497,-0.18349650502204895,-0.5085011124610901},{0.26147347688674927,0.1058957651257515,-0.690713107585907,0.2147873491048813,-0.2778017520904541,-0.32916194200515747,-0.38417962193489075,0.10021600127220154},{0.083161860704422,0.3590015470981598,-0.3965238928794861,-0.11933764070272446,0.14718124270439148,-0.21218132972717285,0.32771745324134827,-0.3187876045703888},{-0.031151058152318,0.06468312442302704,-0.1690668761730194,-0.17013320326805115,0.11011409759521484,-0.15015903115272522,-0.08136080205440521,-0.1293497085571289},{0.1532602459192276,-0.1706269532442093,-0.034229736775159836,-0.12111684679985046,0.07735287398099899,0.038363587111234665,-0.2027820199728012,0.08556551486253738},{0.37181785702705383,0.05119624733924866,-0.340736448764801,-0.22242186963558197,-0.18638809025287628,0.12551866471767426,0.21213971078395844,0.06640076637268066},{0.4598722755908966,-0.25496697425842285,-0.06346026808023453,-0.07183585315942764,0.16077470779418945,-0.13119885325431824,0.16815784573554993,0.30651867389678955},{-0.1210276409983635,-0.09342866390943527,-0.013185365125536919,-0.28501519560813904,0.3761574923992157,-0.25974202156066895,0.04027479514479637,0.038275446742773056},{0.33393043279647827,0.10413999855518341,-0.22610589861869812,0.2855517864227295,0.14982657134532928,0.016067512333393097,0.022737279534339905,-0.019852835685014725}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.25026917457580566,0.36511799693107605,-0.6087528467178345,-0.3856455087661743,-0.3688732385635376,0.16659153997898102,-0.3528459966182709,0.6141772270202637},{-0.007398686371743679,0.6222472786903381,-0.23456968367099762,0.29917892813682556,0.03570515289902687,-0.06311973929405212,-0.30568233132362366,-0.00558138033375144},{-0.4607454836368561,-0.1586497724056244,-0.17774993181228638,-0.3827373683452606,0.5966811776161194,0.05764014273881912,-0.015842895954847336,0.3906816244125366},{-0.38747864961624146,-0.3734811842441559,0.3189025819301605,0.13184572756290436,-0.44647857546806335,-0.3072890639305115,0.304648756980896,0.22227783501148224},{-0.3261561989784241,-0.396296888589859,-0.28366315364837646,0.0046843006275594234,0.2658565044403076,-0.10910007357597351,0.5635387897491455,-0.34892651438713074},{-0.09181007742881775,0.08832429349422455,0.3757897615432739,-0.24733319878578186,0.527145266532898,-0.21540690958499908,-0.420864075422287,-0.22182022035121918},{-0.4386530816555023,0.0895071029663086,0.10513346642255783,-0.1711311638355255,-0.0874418169260025,-0.43638402223587036,0.535785973072052,0.08340215682983398},{-0.44254931807518005,-0.23125667870044708,-0.20938438177108765,-0.5787848830223083,-0.21430297195911407,-0.049999747425317764,0.47874635457992554,-0.38447272777557373}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.013957028277218342,-0.018118618056178093,0.01661866158246994,0.02507873810827732,-0.005357091780751944,-0.01744276098906994,0.03788809850811958,0.02560499869287014};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.020108351483941078,-0.10445737093687057,0.01562996208667755,0.2420501857995987,-0.09507826715707779,0.14095917344093323,0.0041845208033919334,0.07006189972162247};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

