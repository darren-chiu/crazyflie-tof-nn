#include "network_evaluate_tof.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};
#define D_SELF 16 // self_structure[1][1]
#define D_NBR 8 //nbr_structure[1][1]

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.17702573537826538,0.284822553396225,0.09828876703977585,-0.1237940788269043,0.06666575372219086,-0.18242815136909485,-0.010357889346778393,-0.5961633324623108,-0.14265376329421997,-0.012242985889315605,-0.06837967783212662,0.07267918437719345,-0.39327162504196167,0.08235784620046616,0.022758355364203453,-0.4405941069126129},{0.03151902183890343,0.11478205025196075,0.05408385396003723,-0.23162433505058289,0.24655349552631378,0.08362635225057602,0.09394726157188416,0.10083573311567307,-0.07139953225851059,0.06352497637271881,-0.3344056308269501,0.1271507740020752,0.1094774454832077,0.07780798524618149,0.07442061603069305,-0.1380278617143631},{-0.20830854773521423,-0.36747491359710693,0.2580559551715851,-0.14125774800777435,-0.25999414920806885,0.3249209225177765,-0.468908429145813,0.5070242881774902,-0.5934507250785828,-0.555176854133606,-0.3718980848789215,-0.286703497171402,-0.38382387161254883,0.14254936575889587,-0.4671832323074341,-0.6867950558662415},{-0.365805059671402,-0.060354456305503845,0.0117482990026474,0.2340349555015564,0.1415383666753769,-0.051003843545913696,0.25531500577926636,-0.22737661004066467,-0.28048935532569885,0.0873248279094696,-0.2143503874540329,0.06394564360380173,-0.14932577311992645,0.2694070339202881,-0.22046484053134918,-0.10732370615005493},{0.16355060040950775,-0.03644634410738945,0.1254902482032776,-0.26364585757255554,0.2249353528022766,0.414868026971817,-0.11715226620435715,-0.10485286265611649,0.017863770946860313,0.22815749049186707,-0.046018633991479874,0.08224879205226898,0.2308337539434433,0.1283748596906662,-0.2733350396156311,-0.35040006041526794},{0.1467200368642807,0.0893128365278244,0.18945756554603577,-0.19894900918006897,-0.30631986260414124,0.003634540131315589,-0.32694631814956665,0.07703588157892227,-0.19302184879779816,0.17890436947345734,-0.10433097183704376,-0.3619879186153412,-0.16204272210597992,0.10743152350187302,-0.40401017665863037,-0.08788369596004486},{-0.48874595761299133,-0.3111271560192108,0.19787704944610596,-0.2772827744483948,-0.18035976588726044,0.015303477644920349,0.1968194991350174,0.27399685978889465,-0.2142602950334549,-0.006316736340522766,-0.06825489550828934,-0.0645475685596466,-0.2669053077697754,-0.09163522720336914,0.2200334370136261,0.01342702191323042},{0.1291036605834961,0.22373232245445251,0.10943248122930527,0.08397399634122849,-0.26633986830711365,0.3904934525489807,0.3238348364830017,0.20420508086681366,-0.13824839890003204,0.1893128603696823,0.14151892066001892,0.36531251668930054,-0.4650156795978546,-0.41042524576187134,-0.056950196623802185,0.30955687165260315},{-0.5760107636451721,0.06342004239559174,0.1443966031074524,0.053782764822244644,0.13249054551124573,0.1364501565694809,0.27109044790267944,-0.25821712613105774,-0.3701550364494324,-0.13754025101661682,0.01993943378329277,0.37257760763168335,0.08684849739074707,0.20910853147506714,0.44600772857666016,0.04868820309638977},{0.4445229470729828,0.2413748949766159,-0.3325541019439697,-0.07100065052509308,0.2113616019487381,-0.029562951996922493,-0.39165180921554565,-0.3670560121536255,-0.29728272557258606,0.29985132813453674,-0.04062281921505928,0.33155786991119385,-0.23149511218070984,0.4926789104938507,-0.3753398656845093,0.010205887258052826},{0.33234891295433044,-0.12555775046348572,0.1099025160074234,0.4119637608528137,-0.17188017070293427,0.3555597960948944,0.2181359976530075,0.413070410490036,-0.0676555410027504,-0.2257511466741562,-0.27582722902297974,0.07512743771076202,-0.1973925679922104,-0.34992676973342896,-0.27943241596221924,0.09884718060493469},{0.1789984107017517,-0.13327261805534363,-0.0014286880614235997,-0.6247388124465942,0.24122463166713715,0.035097360610961914,-0.12122812122106552,-0.16069699823856354,-0.21361136436462402,-0.38577398657798767,-0.8412326574325562,-0.2135343849658966,-0.0004560348461382091,-0.07293970882892609,0.4571834206581116,-0.0030172751285135746},{0.220565527677536,-0.6962195634841919,-0.37137120962142944,-0.06990285962820053,0.4002505838871002,0.06720659136772156,0.19873759150505066,-0.28651130199432373,0.21107618510723114,-0.7064967751502991,0.033905647695064545,-0.5202019214630127,0.5922574996948242,-0.8948660492897034,-0.3316134214401245,-0.2497890740633011},{0.032486602663993835,-0.17139409482479095,-0.7696755528450012,0.7071918249130249,-0.17842711508274078,-0.11083228141069412,-0.06305528432130814,-0.05818704888224602,-0.1034381166100502,-0.08302359282970428,0.2739628851413727,-0.18591618537902832,-0.48932963609695435,0.0027247853577136993,0.23579947650432587,-0.36995822191238403},{-0.17665722966194153,0.11232481896877289,-0.1947983354330063,0.2107030600309372,0.31088539958000183,-0.19802790880203247,0.22264054417610168,-0.013411825522780418,0.03241657093167305,0.08561057597398758,0.2960004210472107,0.09354614466428757,-0.017788371071219444,-0.2599117159843445,0.03822750970721245,0.0838053971529007},{-0.17630112171173096,0.15552110970020294,-0.17522433400154114,0.2749175727367401,-0.014960465021431446,-0.3389672636985779,0.25301748514175415,0.19992810487747192,-0.13078270852565765,-0.07868234813213348,0.09871940314769745,-0.01620214246213436,-0.2122499644756317,-0.1920013725757599,-0.23385044932365417,-0.21941189467906952},{-0.2367098480463028,0.20777194201946259,0.05194707214832306,0.012217295356094837,-0.20982998609542847,0.06848151236772537,-0.23640966415405273,0.2167203277349472,-0.15779681503772736,0.12551750242710114,-0.006361155770719051,0.29335471987724304,0.20012806355953217,0.3162190020084381,0.4155598282814026,-0.25022992491722107},{0.22206953167915344,-0.2950054705142975,-0.1078210100531578,-0.0246896892786026,-0.44007930159568787,-0.20736370980739594,-0.25998690724372864,-0.30141663551330566,-0.1586519032716751,0.034342292696237564,-0.23508904874324799,0.04580242186784744,0.0950547456741333,0.14183783531188965,-0.03424479439854622,-0.18364159762859344}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.19185642898082733,0.2941313683986664,0.003934113308787346,0.4889599680900574,0.16252823173999786,-0.08470895141363144,-0.21125900745391846,-0.38543373346328735,-0.1468932032585144,-0.2100074142217636,0.2182387113571167,0.020412219688296318,0.3639752268791199,0.049486514180898666,-0.36579957604408264,-0.27876439690589905},{-0.2433638870716095,0.19734731316566467,-0.237002432346344,0.012907526455819607,0.10349009186029434,0.024146614596247673,-0.48849356174468994,0.14958570897579193,0.21132943034172058,0.08137857913970947,0.014844441786408424,0.020968159660696983,-0.155156672000885,-0.12764650583267212,-0.30226531624794006,-0.1546194851398468},{0.4486498534679413,0.3107084333896637,-0.3329266905784607,-0.5741850137710571,0.28636112809181213,-0.2736799120903015,-0.6073252558708191,0.16414794325828552,0.41564226150512695,-0.25662195682525635,0.166079580783844,-0.2896028161048889,-0.06873751431703568,-0.1013399139046669,0.3509213328361511,0.4186890423297882},{0.3135056495666504,-0.09529309719800949,-0.24912886321544647,0.3311575651168823,-0.27380186319351196,0.30454781651496887,0.1693437695503235,-0.0851341113448143,-0.062250006943941116,0.2849494218826294,0.3425903022289276,-0.41695988178253174,0.12687847018241882,-0.27887943387031555,-0.4343809485435486,0.00377953820861876},{0.008973217569291592,0.18105262517929077,0.0067596458829939365,-0.06638779491186142,0.07523946464061737,-0.013836751691997051,-0.2450401484966278,0.23233871161937714,-0.1047583818435669,-0.2855686843395233,-0.2321159988641739,0.19930042326450348,0.2250429391860962,-0.1639833152294159,0.2112007886171341,0.08854003995656967},{0.3891139030456543,0.0020744209177792072,-0.1928780972957611,-0.12991146743297577,0.18852750957012177,0.19586998224258423,-0.16359537839889526,-0.2883944511413574,-0.060148581862449646,0.2265312224626541,-0.1309501826763153,-0.031385768204927444,-0.2739526331424713,0.37245064973831177,0.1917894333600998,-0.1688767522573471},{0.23726049065589905,-0.3361298441886902,-0.38198167085647583,-0.20768822729587555,0.038791440427303314,0.2388715296983719,-0.2473621964454651,0.09886781871318817,0.05213870480656624,0.14649595320224762,-0.008188152685761452,0.31401732563972473,0.31354787945747375,-0.13023124635219574,0.23145359754562378,0.20092898607254028},{-0.24113351106643677,0.36253276467323303,-0.10914824903011322,0.40447866916656494,0.17366397380828857,-0.012162111699581146,0.4172467589378357,0.46049964427948,-0.06654691696166992,-0.23078173398971558,0.20395474135875702,-0.40147122740745544,-0.08424495160579681,-0.07602576166391373,-0.12069699913263321,-0.08339909464120865},{0.03757509961724281,-0.2760770618915558,0.053766537457704544,0.25359392166137695,0.10474462807178497,0.21599756181240082,0.06306558847427368,0.39517906308174133,-0.016143307089805603,0.14380380511283875,-0.24849432706832886,-0.06881027668714523,0.3378257155418396,-0.4831157922744751,0.3477805554866791,0.016139298677444458},{-0.097101129591465,-0.06771089881658554,-0.2092580646276474,0.17935441434383392,-0.29061657190322876,-0.05079776421189308,0.3432634472846985,0.2203252911567688,0.21045200526714325,-0.15599392354488373,-0.10613318532705307,0.01346828043460846,-0.23819494247436523,0.04635648801922798,-0.3775170147418976,0.009639648720622063},{-0.09784454852342606,-0.2502273917198181,0.1975192278623581,0.2589731514453888,-0.13086839020252228,-0.22317732870578766,0.32189640402793884,-0.14467966556549072,-0.1145317554473877,0.07131490856409073,-0.001703955582343042,-0.2972024977207184,-0.3632338047027588,-0.5706287026405334,-0.2820092737674713,-0.056091248989105225},{0.004728294909000397,-0.4698795974254608,0.23084938526153564,-0.21712200343608856,0.13574887812137604,0.18208062648773193,-0.3082846999168396,-0.2800257205963135,0.18348006904125214,0.0758204311132431,-0.5516010522842407,0.37216925621032715,-0.2218782901763916,-0.12380654364824295,0.2555898427963257,0.1080411747097969},{-0.0994114950299263,0.07899979501962662,-0.253065288066864,0.11537976562976837,0.14194157719612122,0.020268626511096954,0.4025968313217163,-0.2605985701084137,-0.142539843916893,-0.11406350135803223,-0.33802464604377747,0.4357373118400574,0.3880922794342041,0.15602436661720276,0.13008899986743927,0.292487233877182},{-0.3475758731365204,0.029867269098758698,0.3162572979927063,-0.3433953523635864,0.32919013500213623,-0.4455834627151489,-0.03866908326745033,-0.2773094177246094,0.2560165822505951,0.21441234648227692,0.29754650592803955,0.42280346155166626,-0.14008355140686035,-0.1836395412683487,-0.280831903219223,0.2088199406862259},{-0.11162427812814713,-0.1738235354423523,-0.2632872760295868,0.19330745935440063,-0.20673538744449615,0.4955526292324066,0.278766006231308,0.21493616700172424,0.21660953760147095,-0.014394224621355534,-0.11194947361946106,-0.17316505312919617,0.2222013771533966,0.13081753253936768,-0.06419862061738968,0.13112974166870117},{-0.1328580379486084,0.315451443195343,-0.037092190235853195,-0.1047954335808754,0.05096028745174408,-0.025238139554858208,0.2947765290737152,0.21914272010326385,-0.17430244386196136,-0.15712109208106995,-0.17187927663326263,0.2864861786365509,0.11839933693408966,-0.25354844331741333,-0.37306278944015503,-0.046558573842048645}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.0402287095785141,0.04474175348877907,0.05046208202838898,0.1740381419658661,0.351906955242157,-0.11897089332342148,-0.07509400695562363,0.06996546685695648,-0.21292349696159363,-0.1179811954498291,-0.004165801219642162,0.19970154762268066,0.25022780895233154,0.016980763524770737,0.25904780626296997,0.11634358763694763,0.19460570812225342,0.10818411409854889,0.05070652812719345,-0.017936021089553833,0.242094025015831,-0.25425830483436584,-0.2684212923049927,-0.26582860946655273,-0.09511575847864151,0.1270587146282196,-0.28437235951423645,-0.2672349810600281,0.19716788828372955,-0.1337260901927948,-0.32699891924858093,-0.20235992968082428},{0.24918070435523987,0.11409267038106918,0.2786615788936615,0.2881098687648773,0.38299721479415894,-0.010617322288453579,0.19554239511489868,-0.3505423367023468,0.15134893357753754,0.059411630034446716,-0.06397935748100281,-0.23524820804595947,-0.13929039239883423,-0.06126118078827858,-0.28361254930496216,0.391694575548172,0.13855400681495667,-0.2751126289367676,0.20436376333236694,0.13376599550247192,-0.003505615284666419,0.2854060232639313,-0.20973679423332214,0.1847059577703476,0.09740781784057617,-0.35310497879981995,-0.19769823551177979,0.34698137640953064,-0.25181642174720764,0.004683135077357292,0.30884256958961487,-0.13524292409420013},{0.21250589191913605,-0.04602086544036865,-0.18575282394886017,-0.2543505132198334,-0.24181607365608215,-0.20325760543346405,-0.3201437294483185,0.07263913750648499,-0.32262465357780457,-0.14595483243465424,0.18269133567810059,0.3048945665359497,0.1835402250289917,-0.09084398299455643,-0.20841184258460999,0.1606491357088089,0.2940581738948822,-0.1885831207036972,-0.11309635639190674,0.19799062609672546,-0.251759797334671,-0.031760938465595245,-0.009197317995131016,-0.031047331169247627,-0.03632168471813202,0.29890814423561096,-0.29361042380332947,0.2048894464969635,-0.3991009294986725,-0.146403506398201,0.0015516827115789056,0.029790310189127922},{0.18709011375904083,-0.28209832310676575,-0.10796214640140533,0.20824426412582397,0.050945017486810684,-0.11115597188472748,0.3441184461116791,0.08119473606348038,0.10606829077005386,-0.07790286839008331,-0.007354011293500662,-0.0837019681930542,0.29836541414260864,0.13407091796398163,-0.19938577711582184,-0.20732733607292175,-0.16509199142456055,0.12805500626564026,0.15024803578853607,-0.04376120865345001,0.00988977774977684,0.3389871418476105,-0.040188342332839966,-0.22736653685569763,0.04315583407878876,0.11269310861825943,0.10983136296272278,0.030841456726193428,-0.3164500296115875,-0.29653802514076233,0.09335783869028091,0.1756945550441742},{-0.03329185023903847,0.09393783658742905,0.02073073387145996,0.025900570675730705,0.1627185195684433,0.20067764818668365,0.10877329856157303,-0.14079517126083374,-0.04278724268078804,0.05444280058145523,-0.0762392058968544,0.057183872908353806,-0.1746571958065033,0.17949660122394562,0.06033780798316002,0.30863451957702637,0.08731735497713089,0.016548797488212585,0.12709279358386993,0.11093934625387192,0.17002011835575104,-0.034111421555280685,-0.28180810809135437,-0.22059275209903717,0.06074340641498566,0.1671813428401947,0.1738566756248474,0.03276577964425087,0.14964553713798523,-0.21621055901050568,-0.253134161233902,0.2444765865802765},{-0.2957608997821808,0.24956248700618744,0.022425808012485504,-0.010301987640559673,-0.35786399245262146,-0.24138227105140686,-0.14203937351703644,0.04989129677414894,0.18369795382022858,-0.15228155255317688,0.056851111352443695,-0.3527137041091919,-0.185043603181839,0.025096574798226357,0.07542257010936737,-0.2026675045490265,-0.14947451651096344,0.0020572582725435495,0.017185142263770103,-0.3083609640598297,0.20871874690055847,-0.07771231234073639,0.04526786133646965,-0.2026849091053009,0.12088865041732788,0.09170287847518921,-0.05405363440513611,0.141343355178833,0.07253697514533997,0.010103032924234867,-0.2504906952381134,-0.2105935662984848},{0.016801293939352036,-0.09845080226659775,0.04946294054389,-0.228490948677063,-0.19001279771327972,0.1092381477355957,-0.329027384519577,-0.08642078191041946,-0.1434200257062912,0.22984521090984344,-0.23066985607147217,0.028037549927830696,0.28349554538726807,0.027250729501247406,-0.3277880847454071,-0.22100600600242615,0.0291827954351902,0.12979750335216522,0.11594753712415695,0.2542027235031128,-0.21824881434440613,0.14875158667564392,0.008528226055204868,0.08606041967868805,0.249925896525383,-0.09640539437532425,-0.03429589048027992,0.3122277557849884,-0.0015911133959889412,-0.2604644000530243,-0.3584670424461365,0.2721690833568573},{0.07826146483421326,0.18850228190422058,0.13218873739242554,0.12241662293672562,-0.1417195051908493,-0.35118547081947327,0.16443976759910583,-0.22113175690174103,-0.07802023738622665,-0.22456897795200348,0.26058652997016907,-0.1037549078464508,-0.04219120740890503,-0.08050209283828735,0.291536420583725,0.10601610690355301,0.07951682806015015,-0.003052289364859462,-0.31553617119789124,0.09192612767219543,-0.25437459349632263,0.0060324291698634624,-0.1804523468017578,0.21670694649219513,0.055868953466415405,-0.0237409844994545,0.208329439163208,0.03594093397259712,0.0309295617043972,-0.18437901139259338,-0.15591664612293243,0.3011370897293091},{0.16713111102581024,0.3780696392059326,-0.19039492309093475,0.30143606662750244,0.03727918118238449,0.12622663378715515,0.4167080223560333,-0.3095608949661255,-0.07671081274747849,-0.04046174883842468,0.17824490368366241,-0.11037226021289825,-0.037458356469869614,0.22994747757911682,-0.10392680019140244,0.19653531908988953,0.22056888043880463,0.2060781568288803,0.1757628470659256,0.22882606089115143,-0.25769349932670593,-0.1877899467945099,0.07825421541929245,0.20214802026748657,0.0970359742641449,0.3239029049873352,-0.34483569860458374,-0.2979416251182556,-0.09378770738840103,0.23519466817378998,0.06447279453277588,0.2036205530166626},{0.05763066187500954,-0.02761915698647499,0.012513079680502415,-0.25051695108413696,-0.0152053227648139,-0.3194321095943451,0.09897667914628983,0.28741419315338135,-0.18411985039710999,-0.256310373544693,0.15987101197242737,-0.07578273117542267,0.02499883435666561,0.05358031019568443,-0.22809961438179016,0.2581092119216919,0.08185634016990662,-0.25858205556869507,0.16912025213241577,0.041910428553819656,0.1541014462709427,-0.32233673334121704,0.24218811094760895,-0.13404031097888947,0.11633527278900146,0.23038962483406067,0.30379608273506165,0.24460625648498535,-0.08146767318248749,0.21396474540233612,-0.025498995557427406,-0.010452033020555973},{0.1485983282327652,0.11657798290252686,0.26855605840682983,-0.28634732961654663,0.16145378351211548,-0.1767612248659134,-0.04500291496515274,-0.32120081782341003,0.05464041605591774,0.36276111006736755,0.17744046449661255,0.09797239303588867,0.10902334004640579,0.17319025099277496,-0.048292696475982666,0.3157765865325928,-0.08869537711143494,-0.26333677768707275,-0.05659567192196846,-0.009877707809209824,-0.2296527773141861,0.10488966107368469,0.026116780936717987,-0.22133474051952362,-0.1325804442167282,-0.21612673997879028,-0.16419865190982819,-0.003193512326106429,-0.1616906374692917,-0.07155530154705048,0.44481655955314636,0.300993412733078},{0.30379951000213623,0.06200578436255455,-0.1175244078040123,-0.35285016894340515,-0.2249791920185089,-0.2440825253725052,0.1896514594554901,0.08673717081546783,-0.16768084466457367,0.2529195249080658,-0.3777987062931061,-0.1710175722837448,-0.1692112535238266,-0.0991383045911789,-0.10533580929040909,-0.2278134822845459,-0.36066654324531555,-0.2980465590953827,0.07274069637060165,0.1335393190383911,-0.018350645899772644,0.30302712321281433,-0.21191412210464478,-0.09386664628982544,0.2033689320087433,0.2817519009113312,0.21264158189296722,-0.15286636352539062,-0.11674981564283371,-0.23059137165546417,-0.30817922949790955,0.17112699151039124},{-0.050921060144901276,-0.10296081006526947,-0.11644511669874191,0.0257123950868845,0.21044868230819702,-0.09345854073762894,0.16595929861068726,0.36244896054267883,0.14842095971107483,0.24800819158554077,-0.12771382927894592,-0.3489643931388855,0.072568878531456,0.10977229475975037,0.21804165840148926,0.1487274318933487,-0.368245393037796,-0.2143663763999939,-0.2024451047182083,0.20293444395065308,-0.08322644978761673,-0.2706944942474365,-0.26082706451416016,-0.1124592125415802,0.17290110886096954,0.27351486682891846,0.257137656211853,0.13604798913002014,-0.1750909686088562,-0.0845470055937767,0.07074657082557678,-0.18300843238830566},{0.300070583820343,-0.09269342571496964,-0.3049618601799011,-0.10054431855678558,0.04085993394255638,0.03726710379123688,-0.07875616103410721,-0.08295544981956482,0.14139333367347717,0.3596339523792267,-0.30230990052223206,0.2764495313167572,0.23743687570095062,-0.2818673253059387,0.08650638163089752,-0.23293852806091309,-0.0819198340177536,0.1392565220594406,-0.12794716656208038,0.37944096326828003,0.12608197331428528,-0.13816045224666595,-0.23883585631847382,-0.12568995356559753,-0.35785573720932007,0.10320744663476944,-0.008198077790439129,0.2439602017402649,-0.0472516268491745,0.11664070934057236,0.3311256468296051,-0.1942247450351715},{0.19478656351566315,-0.20973625779151917,0.13229309022426605,-0.12459579855203629,-0.2374332994222641,-0.2901730537414551,0.1807633638381958,-0.2318880707025528,0.20584575831890106,0.1581869125366211,-0.1253928542137146,0.15598329901695251,0.004884815774857998,0.11616338044404984,-0.06468108296394348,0.014672541059553623,0.09500756859779358,-0.08905177563428879,0.0030426778830587864,-0.2007501870393753,0.016033679246902466,-0.26098424196243286,-0.144745334982872,-0.3477068245410919,0.0381305031478405,-0.2010057419538498,0.08775463700294495,0.10476721078157425,0.15599286556243896,0.06268464028835297,0.014591699466109276,-0.011856678873300552},{0.2391510009765625,-0.14997155964374542,-0.23356640338897705,0.22543370723724365,-0.13073639571666718,0.11022932082414627,0.2731543183326721,-0.2719852030277252,-0.11178465932607651,-0.3068733513355255,-0.24968768656253815,-0.3499411642551422,-0.25909048318862915,-0.2142733782529831,0.06555523723363876,0.33833131194114685,0.3023419976234436,-0.2100987434387207,0.05998479947447777,-0.07582466304302216,-0.06846071779727936,-0.2052060216665268,-0.20074228942394257,0.25611287355422974,-0.116482675075531,-0.028440557420253754,-0.18339577317237854,-0.08211784064769745,-0.19859881699085236,-0.09220831096172333,-0.20265480875968933,-0.16084879636764526},{0.2535746991634369,0.3658989369869232,-0.17779533565044403,-0.14795345067977905,-0.043670568615198135,0.315116286277771,0.26636627316474915,0.2106931507587433,0.02250896766781807,-0.33392155170440674,0.052075084298849106,0.07943910360336304,0.030650699511170387,-0.03869672864675522,0.21341675519943237,0.05881572142243385,-0.23685339093208313,0.023657381534576416,-0.2037968784570694,-0.24855393171310425,-5.299998156260699e-05,0.10287448763847351,-0.08139335364103317,-0.24815142154693604,-0.0786438137292862,0.09356002509593964,0.13198433816432953,-0.22540105879306793,0.09373883903026581,-0.25613096356391907,0.1593315154314041,-0.1998518854379654},{-0.29305756092071533,-0.1339823454618454,0.16892440617084503,-0.07813374698162079,0.25954708456993103,0.16557367146015167,0.11151584982872009,-0.30406424403190613,-0.06213606148958206,0.17884007096290588,0.23680026829242706,0.2219727635383606,-0.0904361680150032,0.028967978432774544,-0.2756791412830353,-0.11270369589328766,0.3015017807483673,-0.15718159079551697,0.03961988165974617,0.16064342856407166,0.27889570593833923,0.17834259569644928,0.11500505357980728,-0.265351802110672,-0.018537338823080063,0.019542507827281952,0.23289528489112854,0.3300078809261322,-0.10005928575992584,-0.14589446783065796,0.15206386148929596,0.24933820962905884},{0.20966728031635284,-0.20629417896270752,-0.1721457540988922,-0.012300699949264526,0.11571620404720306,0.215938001871109,-0.35265254974365234,0.04597591981291771,-0.3229655623435974,-0.21930623054504395,0.2416875809431076,-0.027058914303779602,-0.005752410739660263,-0.2109539955854416,-0.03342488408088684,0.007138342130929232,0.23179833590984344,-0.0018642997602000833,-0.09268121421337128,0.25980740785598755,0.058465491980314255,-0.06693568080663681,0.10980882495641708,0.25174060463905334,0.04234352707862854,-0.376829594373703,-0.10004688799381256,0.2104945033788681,-0.1402769237756729,-0.07879138737916946,0.12185763567686081,0.16269153356552124},{0.21040450036525726,0.2319396734237671,0.10354997217655182,-0.11216800659894943,-0.257982462644577,0.014261903241276741,-0.12502683699131012,0.21926695108413696,0.10407860577106476,0.0005114241503179073,-0.07579182088375092,0.08981876820325851,0.22402553260326385,0.2563946843147278,-0.09653609246015549,-0.2411394715309143,-0.36617961525917053,0.33469194173812866,0.490652471780777,-0.33078309893608093,-0.22286969423294067,0.26408302783966064,0.22253961861133575,-0.20706051588058472,0.20942163467407227,-0.005212306510657072,0.2994847595691681,0.054449766874313354,0.11336173117160797,-0.03634832799434662,-0.11704796552658081,0.13957665860652924},{-0.2776659429073334,0.02022637240588665,-0.11022371053695679,-0.06530212610960007,-0.0776335746049881,-0.15612439811229706,0.039281364530324936,-0.06323174387216568,-0.184102863073349,0.2028931975364685,0.21545545756816864,-0.029041456058621407,0.057657867670059204,-0.3163728415966034,-0.1929275393486023,0.1842101514339447,-0.2187749296426773,-0.017163332551717758,-0.29472512006759644,-0.012657691724598408,-0.019682658836245537,0.09775236994028091,0.25445806980133057,0.019759705290198326,-0.17541854083538055,-0.07441820204257965,0.01315834280103445,0.20789317786693573,0.09059204161167145,-0.1856219470500946,-0.127613827586174,-0.006777247413992882},{0.005251230206340551,0.3061183989048004,0.022508660331368446,0.09505385160446167,0.13346759974956512,0.08882781118154526,0.13376431167125702,0.20596568286418915,-0.34083694219589233,0.02190757356584072,-0.015582076273858547,0.12513871490955353,-0.1766035407781601,0.5811766982078552,-0.004416638519614935,-0.035782404243946075,0.06777451187372208,0.09229657053947449,0.033451300114393234,0.18579056859016418,-0.2603144645690918,0.1172674149274826,-0.01227063499391079,0.27718859910964966,0.1850357949733734,0.07734651863574982,0.17452172935009003,-0.17623202502727509,0.2581610679626465,0.2661421298980713,-0.14256951212882996,-0.16285750269889832},{-0.26667842268943787,0.32088690996170044,0.02420230768620968,0.09758824855089188,-0.12269682437181473,0.19482028484344482,0.03469831496477127,0.03174443542957306,0.14629292488098145,-0.2888507544994354,-0.0970158725976944,-0.2458878755569458,-0.15044474601745605,0.12163257598876953,0.021122610196471214,-0.1469448059797287,0.13490116596221924,0.16137413680553436,0.28821444511413574,0.1401287019252777,-0.24393080174922943,-0.28938624262809753,-0.17645181715488434,0.29364848136901855,0.3449653089046478,0.1383250206708908,0.15743206441402435,-0.03353714197874069,0.07513061165809631,-0.006112035363912582,-0.3187069594860077,0.15052512288093567},{-0.1279916763305664,-0.005010202992707491,-0.09501977264881134,-0.20818229019641876,0.1897224485874176,0.1491072177886963,0.16724057495594025,-0.12983794510364532,0.28113219141960144,0.20476126670837402,0.2111320048570633,-0.0738450288772583,-0.039156414568424225,-0.03264009952545166,-0.34262219071388245,-0.04813235253095627,-0.17565271258354187,-0.23804022371768951,-0.1907832771539688,-0.3023694157600403,-0.03456954285502434,0.08437484502792358,0.07857459038496017,0.15966662764549255,0.05399050563573837,-0.0359894335269928,0.23063333332538605,-0.29706352949142456,-0.05418218672275543,-0.10120080411434174,0.1132516860961914,0.01505101565271616}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.27717411518096924,0.0037227219436317682,-0.2539828419685364,-0.19100652635097504},{0.05693311616778374,-0.13424944877624512,-0.019116487354040146,0.26268523931503296},{0.04740622639656067,0.032596662640571594,-0.13016346096992493,-0.04894832521677017},{-0.16928599774837494,0.019600676372647285,0.1024731695652008,0.11151807755231857},{-0.25492677092552185,0.04438289627432823,-0.09184571355581284,-0.24325664341449738},{0.1896856129169464,-0.24279500544071198,-0.3013828992843628,0.08857126533985138},{0.11522776633501053,0.022149646654725075,-0.02697494998574257,0.3468857705593109},{0.3301982581615448,0.26738736033439636,0.08347607403993607,0.10547458380460739},{-0.27108344435691833,0.17448073625564575,0.16390232741832733,0.07081051170825958},{-0.17101892828941345,-0.19790419936180115,-0.22491313517093658,-0.259253591299057},{-0.04552433267235756,0.2320525199174881,-0.2189910113811493,-0.20652101933956146},{-0.16281567513942719,-0.19690421223640442,0.15480589866638184,0.1338758021593094},{0.23318730294704437,0.25066810846328735,-0.18076124787330627,-0.30891597270965576},{0.29724985361099243,-0.043377406895160675,-0.10773424804210663,0.13144809007644653},{0.32659170031547546,0.30329570174217224,-0.3326125144958496,-0.28979724645614624},{0.030815718695521355,0.10626976191997528,-0.11241506040096283,0.006771680433303118},{-0.3709758520126343,-0.07547687739133835,-0.29462409019470215,-0.34508147835731506},{-0.06628549098968506,0.1338777244091034,0.08292829990386963,0.10183275490999222},{0.07171812653541565,0.33735156059265137,0.22533799707889557,0.0847369059920311},{-0.09122525900602341,-0.2412576824426651,0.12649954855442047,-0.26190418004989624},{0.10339585691690445,0.10824253410100937,-0.1939934641122818,-0.10017111152410507},{-0.10876216739416122,0.1792895793914795,0.2535160481929779,-0.149333193898201},{0.27434733510017395,-0.044705625623464584,-0.2802792489528656,-0.09061998873949051},{0.1888171285390854,0.1829458624124527,-0.1827404946088791,-0.07613704353570938},{0.2866595387458801,0.33390116691589355,0.20153695344924927,0.10397785902023315},{0.1805596947669983,-0.2262684404850006,0.2026926428079605,-0.06372653692960739},{-0.20950013399124146,0.25607967376708984,0.22524921596050262,0.0561053603887558},{-0.10903473943471909,-0.17555174231529236,-0.09390228986740112,-0.3135787844657898},{-0.1685193032026291,0.2097271978855133,-0.1972714215517044,0.2586863040924072},{0.09018132090568542,-0.22361859679222107,-0.32955601811408997,-0.17183071374893188},{-0.04760822281241417,-0.13381831347942352,0.0215259101241827,0.13207289576530457},{0.010842389427125454,0.0318569540977478,-0.25714442133903503,-0.1703151911497116}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0561356320977211,0.09312627464532852,0.06887731701135635,-0.11361264437437057,-0.013226114213466644,0.07639992982149124,-0.034132394939661026,-0.08566954731941223,0.0747409537434578,0.014800146222114563,0.058762017637491226,-0.0442223958671093,0.1617540419101715,0.12441864609718323,-0.0741603896021843,0.031042827293276787};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0016647755401208997,0.05103706195950508,-0.0048432000912725925,0.004694153554737568,0.06143682077527046,-0.024440092965960503,0.03128073737025261,-0.01812230795621872,0.03433392941951752,0.0024183117784559727,0.004394968971610069,0.0025561756920069456,-0.02170068398118019,-0.027360310778021812,-0.025025460869073868,-0.01139023620635271};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0024271064903587103,0.011660702526569366,0.030611561611294746,-0.0025208627339452505,-0.02306799404323101,0.011717730201780796,0.037811946123838425,0.0024652606807649136,0.004970036447048187,-0.030692731961607933,-0.06444182246923447,-0.02012856863439083,-0.05269743502140045,0.015006550587713718,0.026327509433031082,-0.030555028468370438,-0.05231933295726776,0.019532376900315285,0.01598740741610527,-0.003703953232616186,0.000607844500336796,0.0025842119939625263,0.009748640470206738,0.005241038277745247,0.02817656844854355,-0.010048126801848412,-0.00012858254194725305,-0.012238080613315105,-0.009401326067745686,0.016107821837067604,0.04549384117126465,-0.0064957416616380215};
static const float action_parameterization_distribution_linear_bias[4] = {0.024423401802778244,0.0033891680650413036,0.030780527740716934,0.018407490104436874};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.1844991445541382,1.0838783979415894,-0.3910444974899292,0.8548349738121033,1.0331292152404785,-0.04947376996278763,0.6113346219062805,-0.7039479613304138},{0.41277748346328735,0.711125373840332,1.4735275506973267,-0.5124166011810303,0.47361817955970764,-0.20955553650856018,0.18653203547000885,0.6296075582504272},{0.9866825938224792,0.8361616134643555,-0.6033931970596313,0.14382988214492798,-0.3683967888355255,0.7237120270729065,-1.6471096277236938,0.14092150330543518}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.4320226311683655,-0.8337273597717285,0.12246807664632797,-0.876654863357544,1.2227296829223633,-0.7704953551292419,-0.024114102125167847,0.5215921998023987},{0.24800150096416473,-0.20601123571395874,-0.2565643787384033,-0.8427993059158325,-0.46065887808799744,0.529528021812439,-0.8171308636665344,-0.27430421113967896},{-0.25913381576538086,-0.04429341107606888,-0.2814558446407318,-0.5710530877113342,0.9450360536575317,0.9764524102210999,0.6732333302497864,-0.10102704912424088},{-0.2513241469860077,0.3826943635940552,-0.5360068082809448,-0.1368606835603714,-1.0711272954940796,0.11839371919631958,-0.28208473324775696,0.6928281784057617},{-0.7067110538482666,0.02417241595685482,0.31725892424583435,0.1087380200624466,-0.7803016901016235,0.6718478798866272,-0.045309312641620636,0.5247055292129517},{0.42290252447128296,-0.4984620213508606,-0.4751913845539093,-0.36881810426712036,0.10824757814407349,0.2433292269706726,-0.5124930143356323,0.13202431797981262},{0.26654720306396484,-0.27272045612335205,0.0792529359459877,0.4777578115463257,-0.397504597902298,1.029837965965271,0.016638588160276413,0.5209273099899292},{-0.1204759031534195,0.338580459356308,-0.07798047363758087,-0.32578563690185547,0.9827591776847839,-0.5925512909889221,0.2654103934764862,0.11255798488855362}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.027300605550408363,-0.07275316119194031,-0.03173355385661125,0.004990026820451021,0.024090446531772614,-0.005315831862390041,0.016539398580789566,0.013687290251255035};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.010057196021080017,-0.021494004875421524,-0.006413816940039396,0.008120096288621426,-0.06411416083574295,0.03685743734240532,0.0375497080385685,-0.017602352425456047};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
