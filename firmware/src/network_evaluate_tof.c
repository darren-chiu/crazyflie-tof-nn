#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.30413129925727844,-0.1134871244430542,0.021573346108198166,0.2124844640493393,0.1803446114063263,-0.23949746787548065,-0.18828681111335754,0.08792536705732346,0.40361809730529785,-0.3070112466812134,0.3976733386516571,0.025320837274193764,0.23753300309181213,0.036148034036159515,-0.2324524074792862,0.1363707184791565},{-0.29941415786743164,-0.2614366114139557,-0.11070546507835388,-0.16867695748806,0.13778088986873627,0.4232312738895416,0.1555035263299942,-0.014524613507091999,0.13926000893115997,0.16131514310836792,-0.06384515017271042,0.027854405343532562,-0.10656770318746567,0.07045602053403854,0.19271811842918396,-0.13923664391040802},{0.023377550765872,0.273877888917923,0.18837913870811462,0.30146124958992004,-0.04265234246850014,0.0024826510343700647,0.5196377038955688,-0.3176814913749695,-0.1492176204919815,-0.054537758231163025,0.1418905258178711,-0.12555238604545593,-0.11524727940559387,0.640252411365509,-0.305504709482193,0.11948223412036896},{0.13004985451698303,-0.11140795797109604,-0.1062820553779602,-0.037345413118600845,0.02751561999320984,0.06161104887723923,0.031444747000932693,-0.18748056888580322,-0.06987545639276505,-0.11300289630889893,0.3509940505027771,-0.322085976600647,-0.12549486756324768,-0.27670836448669434,0.3235185444355011,0.0636354610323906},{-0.17535872757434845,-0.012820783071219921,0.36304959654808044,-0.29547762870788574,0.4008966386318207,0.18787485361099243,0.21078093349933624,-0.17841966450214386,-0.3155352473258972,0.19216594099998474,-0.13162346184253693,-0.3461112082004547,0.051262397319078445,-0.06880395114421844,0.37932726740837097,-0.0012040154542773962},{0.016833260655403137,-0.03111923858523369,0.0011554529191926122,-0.11036825180053711,0.14556129276752472,-0.011492288671433926,0.4432115852832794,-0.31119874119758606,-0.21032248437404633,-0.1727413684129715,0.29517093300819397,0.09115934371948242,0.20206104218959808,-0.042384739965200424,0.3910295367240906,0.2696020305156708},{0.006569028832018375,0.025324296206235886,-0.10937787592411041,0.17897193133831024,-0.38404184579849243,0.14457936584949493,-0.025491686537861824,0.21553701162338257,0.18483562767505646,0.4326988756656647,-0.6083263158798218,-0.15073749423027039,0.5423188805580139,-0.12138374894857407,-0.14876572787761688,0.4203881025314331},{-0.32290443778038025,0.3902987241744995,0.07335448265075684,-0.37058407068252563,0.39383986592292786,-0.5059320330619812,-0.41716885566711426,-0.320071816444397,0.06220392882823944,-0.19500868022441864,0.4206215739250183,0.09532677382230759,0.1191113218665123,0.3665216565132141,0.11940501630306244,0.20559121668338776},{0.394214928150177,0.11676739156246185,0.004084334708750248,0.060391638427972794,-0.32186469435691833,-0.7428997755050659,0.33321791887283325,-0.6130657196044922,-0.006391186732798815,-0.21493497490882874,0.09611324965953827,-0.6632120609283447,-0.015784170478582382,0.1098073273897171,0.3218354284763336,-0.18596738576889038},{0.5972760915756226,-0.9990657567977905,-0.3247170150279999,0.22958563268184662,0.24923016130924225,0.14566300809383392,-0.05173226445913315,-0.3075277805328369,-0.39188939332962036,0.028302596881985664,-0.25624412298202515,-0.22811126708984375,0.476034939289093,-0.32232391834259033,-0.7099528312683105,0.18045786023139954},{0.4343849718570709,0.038449544459581375,-0.2458999752998352,0.24534165859222412,-0.15737976133823395,-0.09076093137264252,-0.04379979521036148,0.28890854120254517,-0.17097744345664978,0.2439548522233963,-0.12612318992614746,0.17440594732761383,0.12239603698253632,0.1288495510816574,0.016161704435944557,-0.1271854192018509},{-0.08886968344449997,-0.03150629252195358,0.857790470123291,-0.4532525837421417,0.039349816739559174,0.30529314279556274,0.06235542893409729,0.4281539022922516,-0.021882645785808563,0.7339186668395996,0.28218743205070496,-0.10579581558704376,0.4790428876876831,0.06480877101421356,0.18456993997097015,-0.012574180029332638},{0.16811592876911163,-0.4418300986289978,0.09466731548309326,0.47351425886154175,0.12134550511837006,0.15510663390159607,-0.10858561843633652,0.3891819715499878,-0.13319411873817444,0.17971891164779663,-0.1181384027004242,0.4313100576400757,0.43769729137420654,0.40863531827926636,-0.36877426505088806,0.880638599395752},{0.11288730800151825,0.4193555414676666,-0.48462632298469543,0.09727301448583603,-0.11444658041000366,-0.21077661216259003,-0.3409130871295929,0.08252757787704468,-0.37125638127326965,-0.41141632199287415,-0.18256407976150513,0.47396424412727356,-0.6635421514511108,-0.21785324811935425,-0.5613990426063538,-0.14439694583415985},{0.14485257863998413,0.4727652370929718,0.41838377714157104,-0.5540758967399597,-0.47263774275779724,0.0699613094329834,0.006139049772173166,0.13872893154621124,0.4958323836326599,0.28908422589302063,-0.45653432607650757,0.17724840342998505,0.068110890686512,-0.4476226270198822,0.25450095534324646,-0.2715684175491333},{-0.2616780698299408,-0.08957147598266602,-0.0510084442794323,0.24655947089195251,-0.09122993797063828,-0.05117593705654144,-0.24755612015724182,-0.08189576864242554,-0.3442443013191223,-0.12754324078559875,0.3217737674713135,0.10713937133550644,-0.2550627887248993,-0.27222833037376404,-0.3069289028644562,-0.025825390592217445},{-0.29154402017593384,0.10630998015403748,-0.16810619831085205,0.018956098705530167,-0.1471523940563202,0.278956800699234,0.43757614493370056,0.15535670518875122,0.2838447690010071,-0.23066064715385437,-0.18308191001415253,-0.1439373940229416,0.019719962030649185,0.006642237771302462,-0.0034402520395815372,-0.2239774763584137},{0.06070004031062126,-0.37110626697540283,0.0926591232419014,0.3512931764125824,-0.15352877974510193,0.3548218309879303,0.36370524764060974,0.08024464547634125,-0.22234316170215607,-0.3094469904899597,-0.092352956533432,-0.08100741356611252,-0.16039960086345673,-0.40663379430770874,-0.09227341413497925,0.22552955150604248}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.07022500038146973,0.30795857310295105,0.3754996955394745,-0.1080298125743866,-0.19717176258563995,0.10554151982069016,-0.10985217243432999,0.2702194154262543,-0.04950680583715439,0.24203816056251526,0.2926020622253418,-0.29958242177963257,-0.07726218551397324,0.08180060237646103,0.07548071444034576,-0.0778605043888092},{-0.46627259254455566,0.17398187518119812,-0.19213132560253143,0.2992137372493744,0.2264922857284546,-0.07711345702409744,-0.2956409752368927,-0.28665637969970703,0.26138606667518616,0.23301315307617188,-0.002434902358800173,0.23254843056201935,-0.48435866832733154,0.23737755417823792,-0.2445121854543686,0.4801826477050781},{-0.3826471269130707,0.15162970125675201,-0.3768537640571594,-0.06327705085277557,-0.49765744805336,-0.15811292827129364,-0.09732872247695923,-0.022484662011265755,-0.1473083198070526,0.3961421251296997,0.23992013931274414,-0.06704580038785934,0.21711285412311554,-0.3052029609680176,-0.034943077713251114,0.03314562514424324},{0.28601357340812683,-0.27922019362449646,0.11078835278749466,0.3461707830429077,-0.4539009928703308,-0.37922143936157227,0.12598450481891632,0.07766400277614594,0.33498433232307434,-0.07466122508049011,0.21556299924850464,0.2155982255935669,-0.236260324716568,-0.0916917696595192,0.09216447919607162,-0.46092405915260315},{-0.3533170223236084,-0.013706018216907978,0.2536126375198364,-0.3312835693359375,0.1285542994737625,0.34210264682769775,-0.2968065142631531,0.27608826756477356,-0.20942173898220062,0.16032131016254425,0.001998200546950102,-0.0031357791740447283,-0.1905493438243866,0.08681851625442505,-0.18388904631137848,-0.16985806822776794},{0.12449120730161667,-0.31667935848236084,-0.03923321142792702,-0.2779216468334198,0.2112622857093811,-0.024769699200987816,-0.03751411288976669,-0.007723596878349781,-0.19978424906730652,0.37373220920562744,0.3618646562099457,-0.12086237967014313,-0.18905790150165558,0.19885998964309692,-0.05190032720565796,-0.3523879945278168},{0.2702469229698181,-0.1297316700220108,0.32317915558815,-0.26685839891433716,-0.4397490620613098,-0.05987913906574249,-0.321711927652359,0.32456815242767334,-0.1740543395280838,-0.2844234108924866,-0.09139319509267807,-0.016564978286623955,-0.09029499441385269,0.008606701157987118,0.4491840898990631,-0.3161085546016693},{-0.23566479980945587,0.34667250514030457,-0.08368465304374695,0.3165668249130249,0.031242281198501587,-0.31463107466697693,-0.10896392911672592,0.22940170764923096,-0.10808833688497543,0.5052610635757446,0.023428628221154213,-0.24644753336906433,0.07015760987997055,-0.04340140521526337,0.02203352004289627,0.07084625959396362},{0.053407084196805954,0.31203463673591614,-0.09171269834041595,-0.43107137084007263,0.3513266444206238,-0.22643736004829407,0.1350994110107422,-0.3133012652397156,0.1416332870721817,-0.028223590925335884,0.05612409859895706,0.17050610482692719,-0.010198281146585941,-0.23970885574817657,-0.05899660289287567,0.20634423196315765},{-0.18256664276123047,-0.00010989483416778967,-0.3084122836589813,-0.21290232241153717,0.16475118696689606,-0.36256301403045654,-0.17529217898845673,0.3099738657474518,-0.13376595079898834,0.22703783214092255,0.06946933269500732,-0.12965348362922668,-0.3497065603733063,-0.06379883736371994,-0.21875475347042084,-0.37997326254844666},{-0.25191164016723633,-0.1455867439508438,-0.08310679346323013,-0.30285927653312683,-0.336541086435318,-0.00814872421324253,0.11444386839866638,-0.4090745151042938,-0.07510513812303543,-0.022715555503964424,0.18341509997844696,-0.026630805805325508,0.33870017528533936,0.07208319008350372,0.17455045878887177,0.14845655858516693},{-0.15715554356575012,0.004183107055723667,-0.2950049936771393,0.3305201828479767,0.22678954899311066,-0.12657886743545532,0.28250184655189514,-0.00890002679079771,-0.4142279624938965,0.08779986947774887,-0.19318324327468872,-0.12521594762802124,-0.43238115310668945,0.49856075644493103,-0.3738696575164795,0.11375740170478821},{-0.220136821269989,-0.3248777687549591,-0.0429198257625103,0.08683229237794876,-0.10081280767917633,-0.11193935573101044,-0.04940986633300781,0.39909443259239197,0.4094293713569641,0.07927647978067398,-0.0935855582356453,-0.2585887312889099,0.22248715162277222,-0.24759630858898163,0.07601626962423325,-0.21301542222499847},{-0.3159051835536957,-0.4355517029762268,-0.17381274700164795,-0.16327369213104248,-0.4909016191959381,0.4951009452342987,-0.17183516919612885,0.24378114938735962,-0.23619137704372406,-0.31481868028640747,-0.2142496258020401,0.41008391976356506,-0.27035096287727356,0.05174311622977257,-0.22444012761116028,0.27458345890045166},{-0.28898584842681885,0.3340652585029602,-0.11318821460008621,0.18406862020492554,-0.39012452960014343,0.21374425292015076,-0.03034115955233574,-0.34394219517707825,0.14597873389720917,0.16356752812862396,-0.20351777970790863,0.04044654592871666,0.2975636124610901,-0.2569482624530792,-0.31129834055900574,-0.05309765040874481},{-0.048511117696762085,-0.47146156430244446,-0.4787454605102539,0.268995463848114,-0.015516710467636585,0.01931559294462204,-0.42732787132263184,0.30422550439834595,-0.3807961046695709,-0.20609262585639954,-0.3284560441970825,0.19598287343978882,-0.13604776561260223,0.14759308099746704,0.15582093596458435,0.16181717813014984}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10348763316869736,-0.051948431879282,0.1466601938009262,-0.0869063138961792,-0.07758509367704391,0.08797551691532135,0.18069764971733093,-0.24042700231075287,-0.23010818660259247,0.18560457229614258,0.1733589917421341,0.17059552669525146,0.13044235110282898,0.1895246058702469,-0.16789716482162476,0.1991109400987625,0.05224839970469475,-0.3345654010772705,-0.16533833742141724,-0.09255008399486542,-0.13162361085414886,0.02492186613380909,-0.1627991795539856,0.2856537997722626,-0.1473998725414276,-0.01769835688173771,0.0927874743938446,0.21597671508789062,-0.15631282329559326,-0.1867930293083191,0.15233686566352844,0.25846296548843384},{0.14374101161956787,-0.04858110845088959,0.19975461065769196,-0.08896366506814957,-0.15335232019424438,0.24316829442977905,0.04132457822561264,-0.06822766363620758,-0.07919777184724808,-0.040766775608062744,-0.06347059458494186,-0.02504941076040268,0.3168492913246155,0.274883896112442,0.14665277302265167,-0.0176563560962677,-0.18131288886070251,-0.23541079461574554,0.1474960744380951,0.12897486984729767,0.10014718770980835,0.2788216471672058,0.21210317313671112,-0.1748262643814087,0.03396770358085632,0.2213553637266159,-0.32237449288368225,0.1603603959083557,0.011750232428312302,-0.2117237001657486,-0.14175093173980713,-0.08765161782503128},{-0.07741131633520126,-0.0884450376033783,0.24341808259487152,-0.2097122073173523,-0.22614461183547974,0.08064156025648117,-0.1431376039981842,0.2729480564594269,0.15078207850456238,-0.009995918720960617,-0.16967137157917023,-0.009749718941748142,0.37307047843933105,-0.17247912287712097,0.11112146824598312,-0.02846219390630722,-0.36487698554992676,0.3139268457889557,-0.2483517825603485,0.009105007164180279,-0.037313610315322876,-0.10031649470329285,-0.04274872690439224,-0.06894603371620178,-0.06864845752716064,0.27787333726882935,-0.06857748329639435,0.03549247980117798,0.21623776853084564,-0.25481683015823364,-0.24114520847797394,-0.06989584863185883},{0.12497271597385406,-0.14896553754806519,-0.04496101662516594,-0.31016305088996887,0.14176778495311737,-0.1821868121623993,-0.13110193610191345,0.10823681950569153,0.10451868176460266,0.17377743124961853,0.07631459832191467,-0.03870274871587753,-0.1645101010799408,-0.1389022171497345,0.3030373156070709,-0.25636303424835205,-0.017340844497084618,-0.17906418442726135,-0.17682170867919922,0.07470231503248215,-0.15174369513988495,0.1165594533085823,-0.23655550181865692,0.24417836964130402,-0.22339102625846863,0.11095026135444641,-0.06399816274642944,-0.10382077842950821,0.21750302612781525,-0.0987524688243866,0.2976156771183014,-0.12887440621852875},{0.289542019367218,-0.029309596866369247,0.020713819190859795,0.3215554654598236,-0.309478759765625,-0.07214464247226715,0.10699523240327835,-0.05401836335659027,0.13921518623828888,-0.16363942623138428,-0.09053881466388702,-0.03330488130450249,-0.11729239672422409,-0.09346476197242737,0.2814754843711853,0.35030612349510193,-0.1507548689842224,-0.34525084495544434,0.11810779571533203,-0.09814658015966415,-0.194390207529068,0.29774653911590576,0.2683500647544861,0.11780411005020142,-0.08560748398303986,-0.1044134572148323,0.00700741121545434,0.2843262255191803,0.13275019824504852,0.13059960305690765,0.17608365416526794,-0.27501389384269714},{0.29506614804267883,-0.1727498322725296,0.05136851221323013,0.07453121244907379,-0.2095792442560196,-0.3004782795906067,-0.23094837367534637,-0.3171810507774353,-0.21441611647605896,0.03433804214000702,-0.0368669331073761,-0.01732645370066166,-0.13664910197257996,0.055585987865924835,-0.22533993422985077,-0.19822561740875244,0.19914120435714722,0.004409905523061752,-0.3424464166164398,0.23808856308460236,-0.04396834596991539,-0.20015543699264526,0.17503081262111664,-0.1581290066242218,-0.15717415511608124,-0.25727778673171997,-0.12238626927137375,0.015504905954003334,-0.009059244766831398,0.26008906960487366,-0.28061309456825256,0.18064914643764496},{0.1756039410829544,0.13101032376289368,0.23831941187381744,-0.12223152816295624,0.2855710983276367,-0.23321467638015747,-0.26656240224838257,0.019965875893831253,0.22672854363918304,0.08391895145177841,-0.0862368568778038,0.13974998891353607,0.08230261504650116,0.2880436182022095,0.11792363971471786,0.0022049390245229006,-0.2592986822128296,0.08655969053506851,0.05067641660571098,-0.051601774990558624,-0.07326362282037735,0.1407410353422165,0.21648137271404266,0.06799624860286713,-0.2690472900867462,-0.16828149557113647,-0.27096736431121826,-0.30056601762771606,0.04239001125097275,-0.1040152758359909,0.24920925498008728,0.13783003389835358},{0.3338961899280548,-0.32727816700935364,0.10333497077226639,-0.36742958426475525,-0.3145967125892639,0.29910916090011597,0.33291715383529663,0.1820189505815506,-0.059242330491542816,0.09023035317659378,0.14582571387290955,-0.12312474101781845,0.16024990379810333,0.2607758641242981,-0.009722016751766205,0.22021512687206268,0.3324223756790161,-0.30326300859451294,-0.08400093764066696,-0.3654543459415436,0.19786016643047333,0.24732796847820282,0.2737296521663666,0.16339141130447388,0.11259464174509048,0.07393529266119003,0.1034894734621048,0.2880496084690094,-0.01721622794866562,-0.31914207339286804,0.3558342754840851,0.03978777304291725},{0.045824307948350906,-0.06811301410198212,0.24771082401275635,0.2635796070098877,-0.19096675515174866,-0.3009665310382843,-0.07407772541046143,0.25662168860435486,-0.18548771739006042,-0.22518758475780487,0.04476878419518471,0.10457900911569595,0.18688133358955383,-0.3527238368988037,0.19217362999916077,-0.21784359216690063,-0.21026307344436646,0.16897110641002655,-0.24097763001918793,0.3099048435688019,-0.3217328190803528,-0.29689276218414307,-0.2713243067264557,0.262521892786026,0.07776827365159988,0.060773950070142746,0.2806980013847351,0.2730450928211212,-0.11397281289100647,-0.30551767349243164,-0.12744756042957306,0.10304348170757294},{0.30829691886901855,-0.012874534353613853,0.014906994998455048,0.1846209317445755,-0.010373080149292946,0.23466099798679352,-0.04320034757256508,0.21206903457641602,0.00016665231669321656,0.0825987234711647,0.13686804473400116,0.06684086471796036,-0.10894975811243057,-0.27152690291404724,0.141371950507164,0.11002814024686813,0.1169624850153923,-0.06428280472755432,-0.09059221297502518,0.0715021938085556,0.05674434453248978,-0.24256056547164917,0.290438175201416,0.10898096114397049,-0.001409105840139091,0.08430405706167221,-0.33333611488342285,-0.24526439607143402,-0.13606762886047363,-0.005946624558418989,0.07620672136545181,0.1484767198562622},{-0.10128586739301682,0.08977266401052475,-0.007168203592300415,0.16349822282791138,-0.0639546737074852,0.273277223110199,0.17989803850650787,-0.04150144010782242,0.2113427370786667,-0.3406131863594055,-0.07124270498752594,0.09476848691701889,-0.10020062327384949,0.013059155084192753,-0.26348310708999634,-0.030381659045815468,0.13035182654857635,0.21382667124271393,0.16438278555870056,-0.09829007089138031,-0.25390371680259705,0.13022911548614502,0.25442782044410706,0.17364147305488586,-0.3345928490161896,0.3258342444896698,-0.13348594307899475,-0.03269199654459953,-0.032883211970329285,0.15594419836997986,0.07964389771223068,0.22282007336616516},{-0.16184641420841217,0.26143938302993774,-0.12052644044160843,-0.06623246520757675,-0.20787417888641357,-0.1235431507229805,0.1606167107820511,-0.25055208802223206,0.0037367248442023993,-0.21766287088394165,-0.271820068359375,-0.06768420338630676,0.13235780596733093,-0.39229682087898254,-0.15763631463050842,-0.3626030683517456,-0.16481156647205353,-0.07763596624135971,0.2582550644874573,-0.32883381843566895,0.0825820043683052,-0.1408713459968567,-0.023577043786644936,0.2875264883041382,-0.15076971054077148,0.19622883200645447,0.3211081027984619,-0.08508078753948212,0.031543415039777756,0.31893476843833923,-0.10728766769170761,-0.22907797992229462},{-0.013635172508656979,0.2603779733181,0.2318490594625473,-0.29670220613479614,0.2982449531555176,0.016384875401854515,-0.13174815475940704,-0.037614062428474426,0.13767439126968384,-0.26053088903427124,-0.05474450811743736,0.030799588188529015,0.2270093858242035,0.05589791387319565,0.09089868515729904,-0.011938272975385189,0.2344728261232376,-0.2789270579814911,0.3438554108142853,0.09274541586637497,-0.2320730835199356,0.2135680466890335,-0.08151596039533615,-0.2980062961578369,0.20311371982097626,-0.07960732281208038,-0.02193872630596161,-0.13855767250061035,0.03721914067864418,-0.12604017555713654,0.2724524438381195,0.25659045577049255},{0.09250100702047348,-0.21100576221942902,-0.1913863867521286,0.08318207412958145,0.1437702625989914,0.2786965072154999,-0.05183818191289902,-0.20638824999332428,0.3025960624217987,0.03832313418388367,0.05980416759848595,0.06270619481801987,-0.28530198335647583,0.02933635003864765,-0.22298255562782288,-0.26424649357795715,0.07191357761621475,-0.04376424849033356,0.23152968287467957,0.2481556236743927,-0.20500202476978302,0.06483710557222366,-0.1539238840341568,0.03112204186618328,0.09785638004541397,-0.23434700071811676,-0.1278974860906601,-0.20661495625972748,0.014959597960114479,-0.1319608837366104,0.20813950896263123,-0.23703426122665405},{0.02503303997218609,0.25684693455696106,0.14029352366924286,-0.22618451714515686,-0.04924793541431427,-0.11333388835191727,0.19958259165287018,-0.058562975376844406,0.22055043280124664,0.02354692853987217,0.17396318912506104,0.11238670349121094,0.1085432693362236,-0.024395866319537163,-0.04524995759129524,0.17007486522197723,-0.21420007944107056,-0.3374873101711273,-0.1998233050107956,0.1528468132019043,0.02578289993107319,-0.1809421181678772,-0.24262630939483643,-0.178169384598732,-0.3011404871940613,-0.008084073662757874,0.31702885031700134,-0.014983579516410828,-0.0006927147042006254,0.14407409727573395,-0.18354758620262146,0.07866520434617996},{-0.17791347205638885,-0.19210556149482727,-0.20607611536979675,0.04113602265715599,-0.22899991273880005,-0.0715964287519455,-0.06271110475063324,-0.08219070732593536,-0.28644612431526184,-0.15397712588310242,0.11623798310756683,0.1237896978855133,-0.30878573656082153,0.15587450563907623,-0.012900685891509056,0.12251971662044525,0.08899462968111038,0.018455233424901962,0.04973601922392845,0.11937475949525833,0.1852422058582306,0.31493204832077026,0.11802879720926285,0.26862263679504395,0.06143500283360481,-0.2527824640274048,-0.12352702766656876,0.30123355984687805,-0.05546509474515915,-0.17639170587062836,-0.12026622146368027,-0.18296538293361664},{-0.285405695438385,-0.22566112875938416,-0.3550938367843628,0.07175936549901962,-0.08391640335321426,-0.062361061573028564,-0.1045384407043457,0.09586343169212341,-0.07748030126094818,0.09477699548006058,-0.2297935038805008,0.007662471383810043,0.12387179583311081,-0.11090189218521118,0.011417117901146412,0.2135239839553833,-0.15256060659885406,-0.0993916466832161,0.18048593401908875,0.07441496849060059,0.2131148725748062,-0.001122778281569481,-0.24578414857387543,0.06794621050357819,0.18825165927410126,-0.3014257848262787,0.15212024748325348,0.006421908736228943,0.0668071061372757,-0.1394304782152176,0.24547754228115082,-0.10957754403352737},{0.2399837225675583,-0.08777376264333725,0.04523332417011261,0.12805987894535065,-0.33525338768959045,-0.03715012967586517,0.16294492781162262,0.20644935965538025,-0.06006670743227005,-0.1234835535287857,0.3105722963809967,-0.16945524513721466,0.019296199083328247,-0.0317525677382946,-0.18808835744857788,0.19814178347587585,0.04128587618470192,-0.03398622199892998,0.08456463366746902,-0.27086055278778076,0.034776367247104645,-0.2837771773338318,-0.24205859005451202,0.28002315759658813,-0.10540672391653061,-0.1352096050977707,0.17537060379981995,-0.07802332192659378,-0.14730150997638702,-0.010472639463841915,-0.08585801720619202,-0.06739908456802368},{0.3431949317455292,-0.042584747076034546,0.0388314388692379,0.028386594727635384,-0.01834355853497982,-0.07362209260463715,0.17417164146900177,-0.19573159515857697,0.2222723662853241,0.3292171061038971,0.016354134306311607,0.1446017473936081,0.1848030984401703,0.2717706859111786,-0.3044804334640503,-0.29519593715667725,-0.2783035635948181,0.028498271480202675,-0.1467706263065338,-0.35387447476387024,-0.17947852611541748,0.2695355713367462,0.05180109664797783,0.08758476376533508,-0.15472128987312317,-0.05132768675684929,-0.11424963921308517,-0.1483374536037445,0.2787898778915405,0.15782876312732697,-0.2526591122150421,-0.07067901641130447},{-0.13614888489246368,0.19638389348983765,0.28435567021369934,-0.056398436427116394,-0.09333150088787079,0.04567847400903702,0.003020448377355933,-0.2723146080970764,0.1620130091905594,0.19280631840229034,0.21760523319244385,0.2403435856103897,-0.2662019729614258,0.1608947217464447,-0.32220083475112915,0.2994305193424225,0.15133221447467804,-0.2383400946855545,0.2477528154850006,0.10563131421804428,-0.2636277675628662,0.24435661733150482,-0.2957580089569092,0.08824476599693298,0.1824575513601303,0.294303297996521,0.10165279358625412,0.13415847718715668,-0.24080424010753632,0.23049071431159973,-0.06633594632148743,0.13656945526599884},{-0.145679771900177,-0.04108690097928047,0.09543491154909134,0.26809900999069214,0.03707636520266533,0.2044340819120407,-0.31810787320137024,-0.17657144367694855,-0.23058663308620453,-0.12947343289852142,-0.15649907290935516,-0.11477836966514587,0.08010613918304443,-0.14840567111968994,0.16301964223384857,-0.18518418073654175,0.09746503084897995,-0.0020800684578716755,-0.24449089169502258,-0.2263912409543991,0.12518933415412903,0.15623518824577332,-0.13889682292938232,0.2697422206401825,-0.3402940630912781,0.037178732454776764,0.057376254349946976,-0.06881942600011826,0.08941143751144409,-0.2337154895067215,0.2939280569553375,0.04462876170873642},{0.35090428590774536,0.07517965137958527,0.07529336959123611,0.2569343149662018,-0.23788243532180786,0.18153433501720428,-0.09310214966535568,0.1648053228855133,0.11728589236736298,0.023746371269226074,0.06285248696804047,-0.27541470527648926,-0.23859365284442902,-0.024022305384278297,0.15252470970153809,-0.07291034609079361,0.19351805746555328,0.0900096669793129,-0.180172398686409,-0.21886371076107025,0.2973250150680542,0.19856895506381989,0.29807740449905396,0.06377378851175308,-0.10968545079231262,0.05634579807519913,-0.09407473355531693,-0.10149908810853958,0.11477130651473999,0.023652272298932076,-0.13349583745002747,0.1353539228439331},{-0.03280405327677727,0.024658935144543648,-0.032062020152807236,-0.23197592794895172,-0.0829833596944809,-0.24350903928279877,-0.19253753125667572,-0.1492147594690323,-0.020921554416418076,-0.04755597561597824,-0.22961528599262238,0.042479582130908966,-0.24811579287052155,-0.16107270121574402,-0.004650753457099199,0.1099480539560318,0.2868431508541107,-0.18158544600009918,-0.31794995069503784,0.25904300808906555,-0.12862762808799744,0.22021469473838806,0.007013135589659214,-0.04790868982672691,0.02448221482336521,0.12295536696910858,-0.06630434840917587,-0.27819395065307617,0.1597549170255661,0.2721199095249176,-0.13181225955486298,0.19721686840057373},{-0.2715705931186676,-0.033964432775974274,0.01579914800822735,-0.028459686785936356,0.03092750906944275,0.10105850547552109,-0.22692398726940155,0.06096731126308441,-0.16281376779079437,-0.19266265630722046,0.08767908811569214,-0.15239711105823517,-0.15874998271465302,0.2734743654727936,0.006083106156438589,-0.016131723299622536,0.19945961236953735,-0.22645878791809082,-0.18688642978668213,0.2907498776912689,-0.004963927436619997,0.2709571123123169,-0.02896416373550892,0.05400772765278816,-0.22175873816013336,-0.1675529181957245,-0.009166966192424297,0.2763490378856659,0.0408804826438427,-0.01622256636619568,0.23725645244121552,0.2600843012332916}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.14618651568889618,0.10522879660129547,0.2619805634021759,-0.011456036940217018},{0.04728259518742561,-0.04906303063035011,0.02362711913883686,0.14214973151683807},{-0.13931049406528473,0.15055108070373535,0.06965484470129013,0.1421707421541214},{0.2856729030609131,0.04459993913769722,0.047482166439294815,0.34401246905326843},{-0.07658947259187698,0.06000284105539322,0.25876593589782715,0.03571343049407005},{-0.12902018427848816,0.18938401341438293,0.178240567445755,-0.04435835778713226},{-0.21063518524169922,-0.023829320445656776,0.031225979328155518,-0.12759704887866974},{-0.2596225142478943,-0.053764548152685165,0.2654320299625397,-0.24053922295570374},{0.27381429076194763,-0.14054688811302185,-0.22001226246356964,-0.3081951439380646},{0.071282297372818,0.13010574877262115,0.27048981189727783,-0.3514358103275299},{-0.10885801166296005,-0.12890490889549255,-0.13248151540756226,0.08535734564065933},{0.16746482253074646,-0.09447658807039261,0.02279205620288849,0.09256322681903839},{0.2047712802886963,0.27353033423423767,-0.056149471551179886,0.09506797045469284},{-0.027522629126906395,0.01237575989216566,-0.24603179097175598,0.06668838858604431},{0.19182315468788147,0.2961393892765045,0.36376285552978516,0.32184362411499023},{0.12593886256217957,0.02135780081152916,0.21341978013515472,0.21797487139701843},{-0.18216776847839355,-0.12379132956266403,-0.11726647615432739,-0.1813431680202484},{-0.1490841656923294,0.04538024216890335,-0.05759866163134575,-0.07964178919792175},{-0.24516475200653076,0.1302291303873062,0.15210340917110443,0.1965959370136261},{-0.07787299156188965,0.28642627596855164,-0.1670875996351242,0.040449488908052444},{-0.1945536583662033,-0.2605557441711426,-0.12431926280260086,0.0044225468300282955},{0.27509215474128723,0.309050053358078,0.0874248668551445,-0.19889290630817413},{0.029502959921956062,0.14271347224712372,0.13377243280410767,0.14268146455287933},{-0.09357793629169464,0.2824852168560028,-0.008707094006240368,-0.11502636969089508},{0.033757202327251434,-0.03263821825385094,-0.05728905275464058,-0.028530027717351913},{0.21642199158668518,-0.329461932182312,-0.055194225162267685,0.06312711536884308},{-0.006119428668171167,-0.2536172866821289,-0.11680232733488083,-0.2606219947338104},{0.1224416047334671,-0.11609803885221481,0.20285190641880035,0.1404644250869751},{-0.01710326224565506,-0.004112341906875372,0.008986630477011204,0.014603348448872566},{-0.3716965913772583,0.2942582368850708,0.21506352722644806,-0.07524456828832626},{0.3173237442970276,-0.14964786171913147,0.15417508780956268,-0.016991237178444862},{0.08209341764450073,-0.2724711000919342,0.28847312927246094,-0.1343717873096466}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.04808615893125534,0.043729912489652634,-0.036476969718933105,0.08168959617614746,0.030480600893497467,-0.09398065507411957,0.05403467267751694,0.053510911762714386,0.07176750153303146,-0.004921457730233669,0.024073926731944084,0.0330435074865818,0.020181875675916672,-0.052423153072595596,-0.026138363406062126,-0.019984416663646698};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.03292141109704971,-0.014898664318025112,0.015969298779964447,0.02885080687701702,0.012352791614830494,0.021833499893546104,0.018920645117759705,0.04819050803780556,0.018064798787236214,-0.005799601320177317,0.04543165862560272,-0.0025322758592665195,0.025434056296944618,0.0260036438703537,-0.030634459108114243,0.009377378039062023};
static const float actor_encoder_feed_forward_0_bias[32] = {0.018253421410918236,0.002481664763763547,-0.012535056099295616,-0.0287417434155941,0.0019430654356256127,0.007620754651725292,-0.014112469740211964,0.006106315180659294,-0.003306714352220297,0.020113011822104454,-0.02148021198809147,-0.026353228837251663,-0.005841599777340889,-0.004950262140482664,0.0021795753855258226,0.003807983361184597,0.0032313053961843252,-0.013024537824094296,-0.007539399433881044,-0.006468468811362982,-0.03540298715233803,0.020655782893300056,0.011421962641179562,0.0033932228107005358,0.026638267561793327,0.022568143904209137,-0.007293578702956438,0.03574039041996002,0.06799233704805374,-0.013215377926826477,-0.002856882056221366,0.013036418706178665};
static const float action_parameterization_distribution_linear_bias[4] = {-0.008054356090724468,0.0032354588620364666,0.004455771297216415,-0.015740685164928436};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.2156125158071518,0.26349833607673645,-0.1498587727546692,0.09411942213773727,0.11950696259737015,0.10970687121152878,0.4978061616420746,-0.20158401131629944},{-0.31339821219444275,-0.05708213523030281,-0.25316452980041504,-0.2839726507663727,-0.3914722204208374,-0.1818339228630066,0.08081716299057007,-0.36629214882850647},{-0.42291393876075745,-0.007077040150761604,0.2849085330963135,0.22350411117076874,0.2083256095647812,0.02198065258562565,0.4938162863254547,-0.27208492159843445},{-0.1302054226398468,0.0519518107175827,-0.13714708387851715,0.01007982436567545,-0.020074130967259407,0.0066770585253834724,0.4611579477787018,-0.2544700801372528},{-0.3995113670825958,-0.14962969720363617,-0.16028808057308197,-0.11568441241979599,-0.06467653810977936,0.21195170283317566,0.18052707612514496,-0.16202412545681},{-0.3610709607601166,-0.058866310864686966,0.45564979314804077,0.23574814200401306,0.16835491359233856,-0.07160095870494843,-0.12897129356861115,-0.31962716579437256},{-0.36326515674591064,-0.030469296500086784,0.5193377733230591,-0.1676849126815796,-0.12323382496833801,-0.3995409607887268,-0.06892691552639008,-0.25102540850639343},{-0.40287235379219055,-0.3957533538341522,0.6752154231071472,-0.05772843956947327,-0.19511844217777252,0.31536635756492615,0.24765701591968536,-0.42987698316574097},{-0.32475465536117554,-0.047981344163417816,0.06113080680370331,0.4468916058540344,0.038436874747276306,-0.14395084977149963,0.04558678716421127,-0.04521135985851288},{-0.4088817834854126,-0.5637706518173218,-0.010954637080430984,-0.152047261595726,-0.5289701223373413,0.2884013056755066,0.0007773977122269571,0.10604266822338104},{0.06384848803281784,0.16107957065105438,0.23751766979694366,0.021522484719753265,0.20496952533721924,0.2585318684577942,-0.15706028044223785,0.2494051605463028},{0.13319341838359833,-0.02173050493001938,0.2161433845758438,0.2633962333202362,-0.27800700068473816,0.38058891892433167,0.04467100277543068,-0.1823030263185501},{0.08616846054792404,-0.2750880718231201,0.1581730991601944,-0.03600769862532616,-0.32346034049987793,-0.0890020877122879,-0.11147789657115936,-0.0669143870472908},{-0.17755486071109772,-0.15529495477676392,0.2757711708545685,0.3629280626773834,-0.19501425325870514,-0.10520154237747192,-0.23137380182743073,0.20754005014896393},{0.11663758754730225,-0.19614961743354797,0.09103912115097046,-0.13541601598262787,-0.20407748222351074,-0.14882951974868774,0.3851068615913391,-0.040882658213377},{0.2828868627548218,-0.16477802395820618,-0.014971889555454254,-0.08699576556682587,0.18584521114826202,0.09000846743583679,0.2845766544342041,0.3216850161552429},{-0.05320245400071144,-0.3488960266113281,-0.152225062251091,0.13257397711277008,-0.08751115947961807,-0.11105719208717346,-0.040548548102378845,0.10249312222003937},{-0.23086796700954437,-0.2911342978477478,0.045485544949769974,-0.001343238982371986,0.2017190307378769,-0.16187506914138794,0.391512393951416,0.14013798534870148},{-0.04222569242119789,0.11039546877145767,-0.2649362087249756,0.06823927909135818,0.16300787031650543,0.223131000995636,-0.2487601935863495,0.3338291049003601},{0.09544321149587631,-0.025648511946201324,-0.389227956533432,0.06558842957019806,0.012513917870819569,-0.019936826080083847,-0.32390785217285156,-0.012823319993913174},{0.0005449039745144546,-0.10243602097034454,0.039719004184007645,-0.08969421684741974,0.35268497467041016,0.038194380700588226,0.006042524240911007,0.41191166639328003},{-0.004107724409550428,0.13838361203670502,-0.2903807461261749,0.31503260135650635,0.35939082503318787,0.295187383890152,0.29963988065719604,-0.2884041368961334},{-0.45719262957572937,-0.07928179204463959,0.13740137219429016,-0.06514863669872284,0.2476709634065628,-0.355305016040802,0.3555087745189667,-0.21507544815540314},{-0.22573795914649963,0.05971761420369148,-0.09345348924398422,-0.45643362402915955,0.3379077613353729,-0.08333680778741837,-0.19851502776145935,0.2700639069080353},{-0.26562219858169556,-0.11568053066730499,0.007967017590999603,-0.1617051661014557,0.16907349228858948,0.08806061744689941,0.3599499464035034,-0.05222747102379799},{-0.2293054312467575,0.10864371061325073,-0.31836745142936707,-0.45376765727996826,0.30210721492767334,0.008534867316484451,-0.06547519564628601,0.08112367987632751},{0.2972314953804016,0.4023687541484833,-0.2630363702774048,0.07576016336679459,0.3079230785369873,0.3732393682003021,-0.30268049240112305,-0.13564050197601318},{0.3382023274898529,0.25771191716194153,0.06673424690961838,0.06592167168855667,0.27399492263793945,0.13936299085617065,0.27864575386047363,0.36243587732315063},{-0.1622735857963562,0.4026551842689514,0.14028789103031158,0.01616870053112507,0.22923873364925385,0.01448188629001379,-0.23369228839874268,-0.26040297746658325},{-0.2710212469100952,-0.1827947050333023,0.0505191832780838,-0.2163594663143158,-0.23024795949459076,-0.22163575887680054,0.3098297119140625,-0.0014987512258812785},{0.31854334473609924,-0.1977246254682541,0.3050704598426819,-0.39552804827690125,0.11579276621341705,0.2619289755821228,0.20959603786468506,-0.22720195353031158},{0.10162210464477539,0.4217127859592438,0.4044927954673767,-0.38557368516921997,-0.1771899312734604,0.10539977997541428,0.22647668421268463,0.024966426193714142}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.013848397880792618,0.4296920597553253,-0.18046876788139343,0.1750124990940094,-0.4691549241542816,0.2722194194793701,0.4508969783782959,0.23548662662506104},{-0.4602968990802765,-0.49759382009506226,-0.3562035858631134,-0.4871087074279785,-0.5047057271003723,0.398821622133255,0.5463336110115051,-0.2638361155986786},{0.12683919072151184,-0.05641332268714905,0.08726872503757477,0.14077915251255035,-0.0439910851418972,0.45499587059020996,-0.37145060300827026,-0.5987654328346252},{0.4681749939918518,-0.05412432551383972,0.12809084355831146,-0.11178785562515259,0.4963468611240387,0.3382500410079956,0.287601500749588,0.5276551246643066},{0.10834819078445435,0.32006722688674927,-0.18200436234474182,-0.10552862286567688,0.09467389434576035,-0.3638386130332947,-0.39469119906425476,0.4265207052230835},{0.4754174053668976,0.061186231672763824,0.08236946165561676,-0.2755068242549896,-0.43341436982154846,-0.49014654755592346,-0.15622738003730774,0.29027679562568665},{-0.4719076156616211,-0.34271231293678284,-0.12105784565210342,-0.23735225200653076,0.04486757144331932,0.5462268590927124,-0.6694636940956116,0.3834977447986603},{0.19640956819057465,0.06180299073457718,-0.07528529316186905,-0.14340458810329437,0.35008394718170166,-0.6220748424530029,0.3143191933631897,-0.2097368836402893}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.04434104263782501,0.09864083677530289,0.02918889746069908,-0.022245433181524277,-0.018203673884272575,0.022561708465218544,0.07055714726448059,0.07533515989780426};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.013499715365469456,0.02172163687646389,-0.051084358245134354,0.05634060874581337,0.04988378286361694,0.030815571546554565,-0.09168410301208496,-0.1955002397298813};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

