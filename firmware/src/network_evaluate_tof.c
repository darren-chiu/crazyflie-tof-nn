#include "network_evaluate_tof.h"


// attention stuff
#define D_MODEL 12
#define NUM_TOKENS 2
#define EPS 0.000001 // 1e-6

static float tokens[NUM_TOKENS][D_MODEL];
static float q_outputs[NUM_TOKENS][D_MODEL];
static float k_outputs[NUM_TOKENS][D_MODEL];
static float v_outputs[NUM_TOKENS][D_MODEL];
static float residual[NUM_TOKENS][D_MODEL];

static float attn_weights[NUM_TOKENS][NUM_TOKENS];
static float softmax_sums[NUM_TOKENS];
static float query_output[NUM_TOKENS][D_MODEL];
static float query_embeds[NUM_TOKENS][D_MODEL];

static float last_layer_means[NUM_TOKENS];
static float last_layer_variances[NUM_TOKENS];
static float attn_embeds[NUM_TOKENS][D_MODEL];

static float output_embeds[3 * D_MODEL];
static float obstacle_embeds[12];
static float neighbor_embeds[12];

float base;
float exponent;
static const int self_structure [3][2] = {{18, 16},{48, 16},{16, 4}};
static const int nbr_structure [1][2] = {{12, 16}};
static const int obst_structure [1][2] = {{32, 16}};
static const int attn_structure [4][2] = {{16, 16},{16, 16}};
static float output_0[16];
static float nbr_output_0[16];
static float obst_output_0[16];
static float output_1[16];
static float output_2[4];
static const float actor_encoder_self_embed_layer_0_weight[18][16] = {{-0.007466536480933428,0.02824072726070881,-0.2316877692937851,0.20350201427936554,-0.1925586611032486,-0.3068483769893646,-0.40279078483581543,-0.1705140471458435,0.06958802044391632,0.25441449880599976,-0.24573735892772675,-0.4995880722999573,-0.18076935410499573,0.03611372038722038,-0.028965624049305916,0.31993022561073303},{0.11339246481657028,-0.261631578207016,0.4999542236328125,-0.006976403295993805,-0.41754478216171265,-0.060281116515398026,0.18224328756332397,-0.02887013927102089,0.3518253564834595,0.10717570036649704,-0.4006209373474121,0.14131653308868408,0.07964331656694412,0.3311079442501068,0.5806939601898193,0.3583759367465973},{-0.0119579266756773,0.10574877262115479,0.12962067127227783,0.22138363122940063,-0.5676207542419434,-0.06526327133178711,-0.04268888756632805,0.4758240282535553,-0.30180656909942627,-0.3963882327079773,0.08408688008785248,-0.18073652684688568,-0.06203575059771538,0.14358176290988922,-0.37351980805397034,0.5095789432525635},{-0.012926637195050716,-0.2656683325767517,0.037688568234443665,-0.2696935534477234,-0.028815923258662224,0.0535370297729969,-0.33449679613113403,-0.2790340483188629,-0.18337513506412506,-0.20681774616241455,-0.2671300172805786,0.3559618294239044,0.05916231870651245,0.0378640852868557,-0.17303544282913208,0.200947105884552},{0.2511131167411804,-0.10218296945095062,0.18116772174835205,0.16816262900829315,-0.2322988212108612,-0.00322066736407578,-0.17095273733139038,-0.1402343511581421,0.25342974066734314,-0.2489565908908844,0.10769502818584442,-0.04615422710776329,-0.39345893263816833,-0.005763638764619827,0.2580471634864807,0.3631885349750519},{0.09006442874670029,0.19929979741573334,-0.34623920917510986,0.07348688691854477,-0.0056416355073452,-0.06233176961541176,-0.16273699700832367,0.3791860044002533,-0.062446534633636475,-0.5479152798652649,0.08550992608070374,0.12257920950651169,-0.06362312287092209,0.04380600154399872,-0.0893169417977333,0.24896790087223053},{-0.3238810896873474,0.028664425015449524,0.3352518081665039,-0.23763294517993927,0.22928404808044434,0.03904680907726288,0.47272637486457825,-0.1693173497915268,0.3010806441307068,-0.3093718886375427,-0.05988258495926857,-0.24471589922904968,-0.026133690029382706,-0.10446636378765106,0.17202706634998322,-0.26279231905937195},{-0.31587180495262146,-0.09120320528745651,-0.016312843188643456,-0.044060125946998596,0.02655191905796528,0.333682656288147,0.20398935675621033,0.28115954995155334,-0.003462668275460601,0.1549999713897705,0.06268304586410522,-0.4745040535926819,-0.09249962121248245,0.203823059797287,-0.3969247341156006,-0.03370562568306923},{-0.01563849300146103,-0.297612726688385,-0.09964906424283981,-0.0821956992149353,-0.1299901157617569,-0.10319748520851135,-0.2372170239686966,-0.32733601331710815,-0.09651345759630203,0.16303513944149017,-0.21303297579288483,0.17113323509693146,0.052240993827581406,-0.28155067563056946,0.14586986601352692,0.3505871593952179},{0.331773042678833,0.27403524518013,-0.0038209729827940464,-0.1167723536491394,-0.011489180848002434,-0.28693854808807373,-0.01312713511288166,0.2641100287437439,-0.6455730199813843,0.04980706423521042,-0.3035372793674469,0.20422087609767914,-0.09151067584753036,0.364936888217926,-0.15296399593353271,-0.23723624646663666},{-0.18486273288726807,-0.26066383719444275,-0.18104705214500427,0.1449183076620102,-0.3864959478378296,-0.23819850385189056,-0.17480319738388062,0.08467984199523926,-0.3298371434211731,-0.1064796894788742,0.19442501664161682,-0.005508558824658394,0.19172179698944092,0.1870037019252777,-0.2743319571018219,0.07392175495624542},{-0.2534009516239166,-0.44554898142814636,-0.004198617301881313,0.07990125566720963,0.1476355791091919,-0.14900554716587067,0.0035183101426810026,0.3867582082748413,-0.0015153512358665466,0.19705666601657867,0.2513165771961212,-0.27682963013648987,-0.22744612395763397,0.5961999297142029,0.2380806803703308,0.12733548879623413},{0.314624160528183,0.06284371763467789,0.2740961015224457,0.012000194750726223,0.14477846026420593,-0.15344397723674774,0.18688784539699554,0.007726607844233513,0.3018811345100403,0.1285785734653473,-0.13320030272006989,-0.27234598994255066,0.21861132979393005,-0.24580155313014984,-0.013091732747852802,0.30064883828163147},{-0.0694083422422409,-0.04917594790458679,-0.11450102180242538,0.21789011359214783,0.06429126858711243,0.09277299791574478,-0.19686761498451233,0.32015568017959595,-0.07333370298147202,-0.046895332634449005,0.020819872617721558,0.005129669792950153,0.09982088208198547,0.27459532022476196,-0.13229358196258545,-0.055225856602191925},{0.04305364191532135,-0.25181829929351807,-0.217137411236763,-0.2821881175041199,0.41616907715797424,0.12409263104200363,0.048874519765377045,-0.08879580348730087,-0.12230632454156876,0.4333840012550354,-0.004682599566876888,0.2488553375005722,-0.0653158649802208,0.4243198335170746,-0.0479239858686924,0.04966503009200096},{-0.5062683820724487,0.08401819318532944,-0.4502471387386322,0.6050443649291992,0.5595462322235107,-0.6256119608879089,0.3672311305999756,-0.5189204812049866,-0.1078132688999176,-0.04704931750893593,0.015759261325001717,0.02208961546421051,0.4643227756023407,-0.4610714912414551,-0.5838425755500793,-0.24933688342571259},{-0.007914320565760136,-0.7185750603675842,-0.563732385635376,-0.3670254349708557,0.009512071497738361,0.1680668443441391,-0.22796374559402466,-0.022564684972167015,0.05999366566538811,-0.39004912972450256,-0.7529560327529907,-0.7032674551010132,-0.190167635679245,-0.1691010594367981,-0.32885903120040894,-0.32164466381073},{0.6999048590660095,0.4457685053348541,-0.25360530614852905,-0.6625387072563171,-0.48410630226135254,-0.8452143669128418,0.21527276933193207,0.2821462154388428,-0.5362565517425537,0.21114015579223633,-0.12460420280694962,0.5154384970664978,-0.07219824939966202,-0.12270477414131165,-0.026553766801953316,-0.27685409784317017}};
static const float actor_encoder_feed_forward_0_weight[48][16] = {{0.2540121376514435,-0.3447222113609314,0.14009179174900055,-0.1650649756193161,0.12278753519058228,-0.19456161558628082,-0.027746962383389473,0.03819044306874275,-0.29040712118148804,-0.16094759106636047,0.39589956402778625,-0.41696783900260925,0.10261517763137817,0.18132919073104858,0.016499223187565804,0.1640249490737915},{0.23886096477508545,0.12217890471220016,0.3005823791027069,-0.023060496896505356,0.01528075709939003,-0.20761209726333618,0.010999642312526703,-0.08086007833480835,0.017741911113262177,-0.266112744808197,0.17674170434474945,0.0980544239282608,-0.26784172654151917,-0.29910680651664734,0.3808785378932953,0.2099526971578598},{0.3197379410266876,0.01866905204951763,0.17374876141548157,-0.24101126194000244,-0.14132440090179443,0.02076336368918419,-0.05933346226811409,-0.3580535352230072,-0.27599018812179565,0.014916298910975456,-0.026744285598397255,0.1736830472946167,0.09636463969945908,0.020947670564055443,-0.122773177921772,-0.08431784808635712},{0.09802886098623276,0.0033530574291944504,-0.22633211314678192,-0.09790731966495514,-0.2935640811920166,-0.3841398358345032,-0.11619024723768234,-0.3698936700820923,0.2548429071903229,0.12652942538261414,-0.2197078913450241,0.007827761583030224,-0.25173965096473694,0.2141854166984558,0.20680487155914307,0.011975264176726341},{0.16598473489284515,-0.09300561994314194,0.3781817853450775,0.01237075962126255,0.162908673286438,0.06622520834207535,-0.30892160534858704,0.056442346423864365,0.28927481174468994,0.236628457903862,0.22772949934005737,0.2022065967321396,-0.5497241020202637,0.0019260091939941049,-0.2628538906574249,-0.2680763304233551},{-0.15563300251960754,0.4970541000366211,-0.19954976439476013,0.03420935198664665,0.24909459054470062,-0.09186984598636627,-0.3933761417865753,-0.20923106372356415,0.02379697933793068,0.041804611682891846,0.04959419369697571,-0.17085760831832886,-0.19763335585594177,0.5867729187011719,-0.12272082269191742,-0.057450197637081146},{0.25652506947517395,-0.20000459253787994,-0.139750674366951,-0.2059108316898346,0.22955992817878723,-0.12116771191358566,-0.17090535163879395,0.03060847707092762,0.19920340180397034,-0.29976314306259155,-0.0979718491435051,0.34725379943847656,0.18255294859409332,-0.24261711537837982,0.1736508309841156,0.10494625568389893},{-0.27089864015579224,-0.07046812772750854,-0.25296276807785034,-0.29704374074935913,-0.1693449169397354,0.07547857612371445,-0.24364891648292542,-0.025320569053292274,0.01682084985077381,-0.36492016911506653,-0.38043999671936035,0.19687794148921967,0.48826947808265686,-0.019289815798401833,0.14714130759239197,-0.11075472086668015},{-0.1254364550113678,0.14635516703128815,0.3081408143043518,-0.40416833758354187,-0.08220823109149933,-0.08410929888486862,-0.1164865493774414,-0.3778526186943054,-0.3656926155090332,0.12796130776405334,0.043802835047245026,-0.29715338349342346,-0.15148599445819855,0.12753205001354218,-0.3382612466812134,-0.21457624435424805},{0.22071388363838196,-0.45825907588005066,0.21042801439762115,0.19761404395103455,0.1240609660744667,0.48795151710510254,-0.2997475862503052,-0.10679730772972107,0.22370992600917816,0.36572757363319397,0.3984549939632416,0.040975745767354965,-0.17995129525661469,0.2079538106918335,-0.35256803035736084,-0.1599365621805191},{0.2819696068763733,0.24463719129562378,0.12629994750022888,-0.37966012954711914,-0.2536821961402893,-0.04812971130013466,-0.4173949062824249,-0.15868079662322998,0.12335529178380966,-0.05733615532517433,-0.027664687484502792,0.11365757882595062,0.07688676565885544,0.28939932584762573,0.2790476083755493,-0.0292299035936594},{0.2564043402671814,0.14302033185958862,0.267586886882782,0.07336559146642685,0.007618158124387264,0.19179850816726685,-0.010228319093585014,-0.09672542661428452,0.12775851786136627,-0.17702236771583557,0.2551378309726715,0.12818168103694916,0.14154492318630219,0.0970320776104927,0.06330857425928116,0.3255903124809265},{0.20080934464931488,0.16288897395133972,0.1364010125398636,0.14019398391246796,-0.17143897712230682,0.11345019936561584,-0.18652072548866272,0.052310436964035034,0.32074880599975586,0.23467999696731567,-0.0819491371512413,0.4034254550933838,-0.11404966562986374,-0.13940559327602386,-0.07344470918178558,0.0892040953040123},{-0.18551400303840637,0.08125275373458862,0.042260054498910904,-0.12731026113033295,0.05064557492733002,0.07117606699466705,-0.014944557100534439,-0.2482011914253235,-0.3821827173233032,-0.31324368715286255,-0.08389901369810104,0.18113064765930176,-0.034699779003858566,-0.07930702716112137,-0.2701747417449951,0.1883355975151062},{0.20957385003566742,0.19568084180355072,-0.0545990876853466,0.053515784442424774,0.12241856753826141,0.4368712902069092,0.014187871478497982,-0.07069779187440872,-0.24392454326152802,-0.05197765678167343,0.2236667275428772,-0.34438446164131165,0.25887346267700195,0.18115465342998505,-0.15641732513904572,-0.013851920142769814},{-0.08440866321325302,0.28758224844932556,-0.14836306869983673,0.05199112743139267,-0.354704350233078,0.01196177676320076,0.18210892379283905,-0.2533537447452545,0.10636855661869049,-0.23234142363071442,-0.05782949551939964,0.031122911721467972,0.24912458658218384,0.2291061133146286,0.05356941372156143,0.02583625353872776},{-0.10652268677949905,0.050035834312438965,-0.08353777974843979,-0.16072531044483185,-0.1907225102186203,-0.10090605169534683,0.1574602723121643,-0.25070858001708984,0.18560685217380524,-0.20275039970874786,0.14515618979930878,-0.18200424313545227,0.1548139750957489,-0.037608880549669266,-0.2265947163105011,0.10807010531425476},{-0.018663808703422546,0.11687300354242325,-0.195526584982872,0.08548008650541306,0.01182474009692669,-0.1980482041835785,0.19567550718784332,-0.043580375611782074,-0.14519476890563965,-0.040654346346855164,0.19095323979854584,0.22945232689380646,-0.053922709077596664,0.08802598714828491,-0.14265495538711548,0.1457090973854065},{0.084602952003479,-0.24929802119731903,-8.397162309847772e-05,0.19349338114261627,-0.14343374967575073,0.27765214443206787,-0.03095538541674614,-0.07428980618715286,0.21419234573841095,0.011708584614098072,-0.05721709877252579,-0.03789512440562248,-0.023374533280730247,0.10801621526479721,-0.3227314352989197,-0.1815878450870514},{0.040922652930021286,0.01515921950340271,-0.3020593822002411,-0.16696104407310486,-0.01952875219285488,0.24850977957248688,0.214741051197052,-0.019068477675318718,-0.30022022128105164,0.28052157163619995,0.21289020776748657,0.2476576268672943,-0.013460248708724976,-0.302244633436203,0.12571492791175842,-0.05262061953544617},{-0.2738465368747711,-0.12305131554603577,0.2903268337249756,-0.15824459493160248,-0.25279146432876587,-0.17367514967918396,-0.23160921037197113,0.24430781602859497,0.09689313173294067,-0.28589433431625366,0.11074736714363098,-0.05815265700221062,0.280131459236145,0.13730521500110626,-0.21200862526893616,0.19575901329517365},{0.20651571452617645,-0.15632006525993347,-0.18386626243591309,-0.052909236401319504,-0.19235485792160034,0.15696480870246887,-0.004520951304584742,0.15925708413124084,-0.17151892185211182,-0.14936605095863342,-0.10143503546714783,-0.09791145473718643,0.07678699493408203,-0.14618036150932312,-0.2797791659832001,0.12164125591516495},{0.04734133556485176,0.08500441163778305,0.12944532930850983,0.07978367060422897,0.011296122334897518,-0.1697869747877121,0.24562115967273712,0.15690580010414124,0.21531397104263306,-0.06666170805692673,-0.09521430730819702,-0.24644063413143158,0.2386358380317688,0.06411289423704147,0.1286810040473938,-0.029656225815415382},{-0.1267167180776596,-0.2147911936044693,-0.1966882050037384,0.16133183240890503,-0.21811121702194214,0.103757843375206,-0.0918821394443512,-0.014153018593788147,-0.06285449862480164,0.3026336431503296,0.08175624161958694,0.10877447575330734,-0.05373943969607353,0.25040850043296814,0.14987920224666595,0.02561255358159542},{0.0532209537923336,-0.07586703449487686,0.2510586082935333,0.27398681640625,0.17690899968147278,-0.02256154455244541,0.09164270013570786,-0.262398362159729,0.1970086544752121,-0.2014419585466385,0.13156311213970184,0.14416497945785522,0.0525275394320488,-0.21006415784358978,-0.16892871260643005,-0.19109700620174408},{0.21250686049461365,-0.15759411454200745,0.12753169238567352,0.1031566932797432,0.18043513596057892,-0.11225572228431702,0.13337276875972748,0.09122336655855179,0.12524688243865967,0.3637261986732483,0.04083849862217903,-0.2645891010761261,0.21503326296806335,0.1520577371120453,0.09906519204378128,-0.07228866219520569},{0.1677447259426117,0.04995294287800789,0.22036854922771454,-0.03544105961918831,-0.10817909985780716,-0.3042258322238922,0.0009135075379163027,-0.14713624119758606,-0.01347960066050291,0.13453814387321472,0.011320742778480053,-0.16360405087471008,-0.09291481971740723,-0.26022812724113464,-0.17805252969264984,-0.13729220628738403},{0.08433964848518372,0.09192714095115662,-0.20766325294971466,0.24398545920848846,0.011251723393797874,-0.22056904435157776,0.19938166439533234,-0.022108837962150574,-0.12666471302509308,-0.19368207454681396,0.10098826885223389,0.03507685288786888,-0.1587291806936264,-0.05976863577961922,0.1835317313671112,-0.24163781106472015},{0.12808217108249664,0.004297949373722076,-0.016867442056536674,-0.05652531608939171,-0.06879735738039017,0.08335242420434952,0.16361704468727112,0.11657238751649857,0.2566404342651367,-0.1981971263885498,-0.18260295689105988,-0.21064898371696472,-0.14931945502758026,-0.01240486092865467,0.01805919036269188,0.11518123745918274},{-0.12269121408462524,-0.12109336256980896,0.06350536644458771,-0.09400186687707901,-0.001199695747345686,0.15704531967639923,-0.0556829608976841,-0.14626912772655487,0.02371777780354023,-0.068678118288517,-0.13545875251293182,-0.0004602485569193959,0.17278485000133514,-0.13407666981220245,-0.14499926567077637,0.20034565031528473},{0.21715646982192993,-0.18348275125026703,-0.054680559784173965,0.051830142736434937,-0.11973229795694351,0.14448396861553192,-0.08748440444469452,0.08656715601682663,-0.06949710100889206,0.0646962821483612,-0.2928433120250702,-0.083424873650074,-0.21888448297977448,0.016707757487893105,-0.09131576120853424,0.18830448389053345},{-0.21636512875556946,-0.06702752411365509,-0.08285097032785416,-0.26874181628227234,-0.2038320153951645,0.09118726849555969,-0.03203510120511055,0.1806601583957672,-0.034105334430933,-0.0734560415148735,-0.1834333837032318,-0.05982324108481407,0.06231961026787758,0.08875225484371185,0.15585611760616302,0.2944009304046631},{-0.012117569334805012,-0.22520434856414795,0.046503324061632156,-0.11367879807949066,0.1305771917104721,0.2769753336906433,0.10725538432598114,-0.11220542341470718,0.02694813907146454,0.19235682487487793,-0.08017715811729431,0.22669927775859833,0.026969481259584427,-0.09813965111970901,0.08935533463954926,0.1244252547621727},{0.07387334108352661,0.03764330968260765,0.22699889540672302,0.013304809108376503,0.051589153707027435,0.0787101611495018,0.127402201294899,-0.1360653191804886,0.0029088836163282394,0.15217822790145874,-0.1710326075553894,0.06353873759508133,0.20415019989013672,0.04550143703818321,-0.05521475896239281,0.029991790652275085},{-0.24097834527492523,-0.24139384925365448,0.18741725385189056,-0.16143366694450378,0.22859442234039307,0.07361651211977005,0.17572760581970215,0.031022466719150543,0.11255007982254028,-0.010728957131505013,-0.05852581933140755,0.10741136968135834,0.020446985960006714,-0.05048526078462601,-0.1856711506843567,-0.1918938308954239},{0.008292356505990028,-0.22940291464328766,0.10338441282510757,0.2198237031698227,0.10432565957307816,0.1429874747991562,0.0020431268494576216,-0.16383108496665955,0.16514286398887634,0.2763972878456116,0.21501275897026062,-0.251782089471817,-0.15695548057556152,-0.024374885484576225,0.2133570909500122,-0.07000204920768738},{-0.10794532299041748,-0.13103024661540985,0.00011022559192497283,0.13137711584568024,0.12227387726306915,0.10239557921886444,0.15950827300548553,0.18264515697956085,0.10423560440540314,-0.05006600171327591,-0.18823076784610748,-0.22207914292812347,0.2001519650220871,0.1063569113612175,0.23489798605442047,0.2745191156864166},{0.051625899970531464,0.20742234587669373,0.23330868780612946,8.687147055752575e-05,0.11845279484987259,-0.19644270837306976,0.10818377882242203,-0.047894660383462906,0.02471633441746235,-0.044550295919179916,-0.21484127640724182,0.049326978623867035,-0.029629159718751907,-0.1311749368906021,-0.12241295725107193,0.3899691104888916},{-0.0850924402475357,0.0714479461312294,0.1266423463821411,-0.14438298344612122,-0.156708225607872,0.23375466465950012,0.15829099714756012,0.13451023399829865,-0.15864461660385132,-0.15023869276046753,-0.1171080470085144,0.11984013766050339,-0.3073580861091614,-0.0893927738070488,0.1914329081773758,0.23700785636901855},{-0.12434156984090805,0.07263921946287155,0.20886436104774475,-0.004724862519651651,0.1635347306728363,0.11160298436880112,-0.19795700907707214,0.016556570306420326,0.09936866909265518,0.1417156457901001,0.3586195111274719,0.01174068171530962,-0.06680729985237122,-0.02558954432606697,-0.030164143070578575,0.2644050717353821},{0.17605440318584442,0.15981610119342804,0.1420145481824875,-0.17720487713813782,0.07416702806949615,0.26715928316116333,0.23632854223251343,-0.1857479214668274,0.2489829659461975,0.2909885346889496,-0.04192453250288963,-0.23506565392017365,-0.0826585665345192,0.28428152203559875,0.1160278171300888,0.21897444128990173},{0.07403799891471863,-0.16128191351890564,0.051762573421001434,0.0184953510761261,0.264504075050354,-0.3138241171836853,0.22890159487724304,-0.1699838787317276,-0.009298632852733135,-0.13591544330120087,-0.28796297311782837,0.14644917845726013,0.10376768559217453,0.2806597054004669,0.03167219087481499,-0.26118898391723633},{-0.33585336804389954,0.05160883441567421,-0.012008807621896267,-0.09293212741613388,0.07729417830705643,0.05243782699108124,-0.0748201534152031,-0.12925414741039276,-0.1293603926897049,-0.012631671503186226,0.11513548344373703,-0.10329747945070267,-0.21099460124969482,-0.23442116379737854,0.008386775851249695,0.2657877206802368},{-0.030226467177271843,0.19716404378414154,-0.1464104950428009,0.0014124943409115076,0.26200348138809204,-0.08043237775564194,0.18517491221427917,-0.003315732814371586,-0.039268672466278076,-0.02272098697721958,-0.10223568975925446,0.08752834796905518,0.0784374326467514,-0.14687500894069672,0.20927740633487701,0.1579841524362564},{-0.021001020446419716,-0.2950003445148468,-0.02226378582417965,-0.15856610238552094,0.044330500066280365,0.003449599491432309,0.2456938922405243,-0.1999528706073761,-0.21118295192718506,-0.08923138678073883,-0.2508988082408905,0.20116232335567474,-0.36615675687789917,-0.24909618496894836,-0.24871113896369934,-0.30368971824645996},{-0.08402152359485626,-0.22541233897209167,0.05366484820842743,0.10782237350940704,-0.20435504615306854,-0.057268477976322174,-0.1644172966480255,0.19090832769870758,0.03502669930458069,0.11706826090812683,0.1068132147192955,0.13890455663204193,-0.16251134872436523,0.15407419204711914,-0.09710218757390976,0.13361474871635437},{-0.24176716804504395,-0.31557998061180115,0.2188197523355484,0.25487351417541504,-0.24139538407325745,-0.08417060971260071,0.01849794015288353,-0.017685778439044952,0.02222532592713833,-0.27935975790023804,0.07257767766714096,0.12153156846761703,0.14550411701202393,-0.18529492616653442,-0.121292844414711,-0.0693434476852417},{0.08003593236207962,-0.31611496210098267,0.2406090945005417,-0.06787943094968796,-0.05274147540330887,0.0763670802116394,-0.08767041563987732,0.13459789752960205,0.12936991453170776,-0.18900887668132782,-0.17177890241146088,-0.24163918197155,-0.2004854828119278,0.14553366601467133,0.2200758159160614,0.25131121277809143}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{0.013861899264156818,0.10401158779859543,0.28446099162101746,-0.265190452337265},{-0.30941519141197205,0.2232138067483902,-0.24957603216171265,0.09100936353206635},{0.03162746876478195,0.3039303421974182,0.3739623725414276,-0.07558408379554749},{0.12300200760364532,-0.13078875839710236,-0.030436182394623756,-0.04759214445948601},{0.13985541462898254,0.2429530769586563,0.29328253865242004,0.24992191791534424},{0.12333337217569351,0.15752194821834564,0.29403141140937805,0.19059205055236816},{0.3190876245498657,-0.3086320459842682,-0.2280275672674179,-0.09087156504392624},{0.39836546778678894,-0.15681929886341095,-0.28820908069610596,0.08149639517068863},{0.10502663999795914,0.22197751700878143,-0.38190218806266785,-0.28554001450538635},{0.2054590880870819,0.22765080630779266,-0.162687748670578,0.09050785005092621},{0.23362310230731964,5.1941849960712716e-05,0.3399697542190552,0.007538174744695425},{0.03510242700576782,0.1887608915567398,-0.04354660585522652,-0.14450591802597046},{-0.3219994902610779,-0.461473673582077,-0.02951107732951641,-0.31832781434059143},{-0.2174566686153412,0.11602053046226501,0.0273220706731081,0.274456650018692},{-0.1302221268415451,0.0039422353729605675,0.0856769010424614,-0.3691863417625427},{0.05465229973196983,-0.011957534588873386,0.16564470529556274,-0.2813355028629303}};
static const float actor_encoder_self_embed_layer_0_bias[16] = {0.0766499787569046,0.06442677974700928,0.06914296746253967,-0.08005096763372421,-0.020344818010926247,0.07032928615808487,-0.14179210364818573,0.004346191883087158,0.028640277683734894,0.0629841759800911,-0.004492382984608412,-0.08736404031515121,0.06270954757928848,0.13916833698749542,-0.03271626681089401,-0.04433231055736542};
static const float actor_encoder_feed_forward_0_bias[16] = {0.04288375750184059,-0.06392494589090347,0.05259859934449196,-0.05381239578127861,0.10530097782611847,0.1873001903295517,-0.0005811347509734333,-0.006751480046659708,-0.10958493500947952,0.045028477907180786,0.059501226991415024,0.15229694545269012,-0.10305208712816238,-0.03766687586903572,-0.018943527713418007,0.039790164679288864};
static const float action_parameterization_distribution_linear_bias[4] = {0.08931819349527359,0.05264618620276451,0.05498162657022476,0.04723590984940529};
static const float actor_encoder_neighbor_embed_layer_0_weight[12][16] = {{0.1317032128572464,-0.35808223485946655,0.033589668571949005,0.14631052315235138,0.1570405513048172,0.03499410301446915,-0.04345586150884628,-0.003957976121455431,0.2906278073787689,0.00399388000369072,-0.05392402037978172,0.3015740215778351,-0.19831633567810059,-0.0224313922226429,0.41125357151031494,-0.018344279378652573},{0.17319035530090332,-0.27186936140060425,-0.31156817078590393,0.18125514686107635,0.25820526480674744,-0.14807815849781036,-0.06038058176636696,-0.36494481563568115,-0.14908960461616516,0.04045574739575386,-0.4881538152694702,-0.23975449800491333,0.09448319673538208,-0.1329272836446762,0.15419626235961914,-0.10238231718540192},{-0.294570654630661,-0.02311519719660282,0.2764289677143097,-0.1735619753599167,0.2586398124694824,-0.1983223259449005,-0.059812113642692566,-0.29437360167503357,0.3469495177268982,0.3911385238170624,-0.20192499458789825,0.07090751826763153,-0.17944978177547455,-0.1245654970407486,0.3338952660560608,0.24906185269355774},{-0.03542504087090492,-0.03060188703238964,-0.38481318950653076,-0.2393067628145218,0.3356831967830658,0.10328498482704163,-0.2700815200805664,-0.5703644752502441,0.0084914555773139,-0.07373376190662384,-0.15014101564884186,-0.18141776323318481,0.45472320914268494,-0.34866052865982056,0.10701874643564224,-0.1677824854850769},{-0.35137853026390076,-0.20828154683113098,-0.05152442678809166,-0.2585054337978363,-0.3211052417755127,0.5197613835334778,-0.23722366988658905,0.21707084774971008,-0.18173685669898987,-0.10763794928789139,0.22395183145999908,0.3946172297000885,0.03165976703166962,0.23471301794052124,-0.44162774085998535,-0.21933315694332123},{-0.10929308086633682,-0.41121289134025574,0.3420935273170471,0.07756957411766052,-0.05405207723379135,-0.37595754861831665,-0.22231537103652954,0.34033262729644775,-0.29573819041252136,-0.40910160541534424,-0.0121925612911582,0.016027750447392464,0.02742835320532322,-0.15190830826759338,-0.2489621639251709,0.24488963186740875},{-0.07878386974334717,-0.18760213255882263,0.44703209400177,0.29263511300086975,-0.011583875864744186,0.21543282270431519,0.41999027132987976,0.04174654185771942,0.12001565098762512,-0.4435056447982788,0.39604097604751587,0.22018836438655853,-0.10334505885839462,-0.2359267771244049,-0.10772950947284698,0.1916910856962204},{0.14411413669586182,-0.2863244116306305,0.19392378628253937,0.23560307919979095,0.11517630517482758,-0.11116695404052734,-0.35445666313171387,-0.07493745535612106,0.009717262350022793,0.036333177238702774,0.18134155869483948,-0.034814849495887756,-0.151163712143898,0.001203803694806993,0.06712694466114044,0.07529374957084656},{-0.08307503163814545,-0.04752814769744873,-0.35629627108573914,-0.22294200956821442,-0.48076632618904114,0.33414411544799805,0.20287568867206573,-0.20937463641166687,0.003519199090078473,-0.070856973528862,-0.14625340700149536,-0.0027105133049190044,-0.09314648061990738,-0.2693672478199005,-0.12460405379533768,0.39125576615333557},{0.26572591066360474,0.15070520341396332,0.06653760373592377,0.1745520532131195,0.26791808009147644,-0.2974502444267273,-0.09188953787088394,-0.4104856550693512,0.5498312711715698,-0.28413912653923035,0.07438875734806061,-0.22791868448257446,0.04678516089916229,0.1382780373096466,0.45954927802085876,0.24156470596790314},{-0.1843709647655487,0.33184272050857544,0.09907793253660202,-0.3047041594982147,-0.033175695687532425,0.2873154282569885,0.31395167112350464,0.18701007962226868,0.19675374031066895,0.3017089366912842,-0.130244642496109,-0.09358709305524826,-0.4744211733341217,0.03459523990750313,0.181419238448143,0.02268163487315178},{0.10404098778963089,-0.13914917409420013,0.1651964783668518,0.029004042968153954,0.08943844586610794,0.14788104593753815,-0.2783815860748291,-0.3267524540424347,0.30841436982154846,-0.24321284890174866,0.4241916835308075,-0.35564547777175903,0.021149057894945145,-0.228135347366333,0.10726100206375122,0.16231220960617065}};
static const float actor_encoder_neighbor_embed_layer_0_bias[16] = {0.028103703632950783,-0.4732739329338074,-0.15808513760566711,-0.15983805060386658,0.08226325362920761,-0.03726515546441078,-0.11512339860200882,0.1996850222349167,0.17529740929603577,0.13700149953365326,0.0935559868812561,-0.35527274012565613,0.04014759510755539,0.05221930891275406,0.09517765790224075,-0.07786082476377487};
static const float actor_encoder_obstacle_embed_layer_0_weight[32][16] = {{0.43915829062461853,0.02490917034447193,-0.27217406034469604,-0.4645003378391266,0.4835217595100403,-0.5453971028327942,-0.05291185528039932,-0.041445743292570114,0.34595754742622375,0.1300770491361618,-0.03069569729268551,0.044917020946741104,-0.2502745985984802,0.3978947699069977,-0.06832963973283768,0.125833660364151},{0.12314026802778244,-0.0604732483625412,-0.14183567464351654,-0.2116452008485794,-0.11802656948566437,-0.5777409076690674,0.14319854974746704,0.306321382522583,0.40264105796813965,-0.09137311577796936,0.10250305384397507,-0.005569690838456154,-0.0256109107285738,0.3238358199596405,-0.15377242863178253,0.2389155626296997},{0.5256384611129761,-0.11139341443777084,-0.044541191309690475,-0.40323325991630554,-0.13462142646312714,-0.37320205569267273,0.07917791604995728,-0.03933802992105484,-0.055940646678209305,0.5054863691329956,0.15452440083026886,-0.0883280336856842,-0.24932587146759033,0.5159016251564026,-0.12363667786121368,-0.24034754931926727},{0.25961169600486755,0.0379098616540432,0.03356916829943657,0.16052287817001343,0.14673122763633728,0.03556394949555397,0.24767149984836578,-0.2197817713022232,0.34226879477500916,-0.0029081401880830526,0.1777840256690979,-0.3479767143726349,-0.11858764290809631,0.3709341585636139,0.08432567864656448,0.026986151933670044},{-0.22029176354408264,-0.3262278139591217,0.3833693265914917,0.07874780893325806,-0.3587179183959961,0.22634002566337585,-0.029477566480636597,-0.20812414586544037,0.1348770409822464,0.29520970582962036,0.38544076681137085,-0.330136775970459,0.34134167432785034,0.29862549901008606,-0.3247578740119934,0.3656632602214813},{0.017857009544968605,-0.170091912150383,0.06701742112636566,0.3747066855430603,0.16616582870483398,-0.29684019088745117,-0.2126682549715042,0.371712327003479,-0.20134401321411133,0.37052619457244873,0.34997498989105225,0.18435926735401154,-0.1595359742641449,-0.06406228244304657,-0.14968915283679962,0.32063037157058716},{0.2583014965057373,0.24148307740688324,-0.3339514136314392,0.24094940721988678,-0.348601758480072,-0.1322493553161621,0.17937809228897095,0.1727706789970398,0.20635166764259338,-0.12467769533395767,-0.13272415101528168,-0.10097170621156693,-0.08270479738712311,0.4497520625591278,-0.4162488877773285,-0.34732887148857117},{0.20319658517837524,0.21989509463310242,-0.055508196353912354,-0.011466436088085175,0.29283416271209717,-0.15685641765594482,0.23597925901412964,0.3469339609146118,-0.054060354828834534,0.34724685549736023,-0.011380857788026333,0.08690764755010605,-0.18527136743068695,-0.054033420979976654,0.20060278475284576,-0.08405753970146179},{0.2622736394405365,-0.37252360582351685,-0.27042222023010254,0.23688854277133942,0.1064494252204895,-0.007709326688200235,0.06475693732500076,0.22341683506965637,0.011733390390872955,0.23317661881446838,-0.15851247310638428,-0.23136430978775024,-0.3964346647262573,-0.1471942961215973,0.10146623104810715,0.21336565911769867},{0.15344566106796265,-0.2008131593465805,-0.21233971416950226,0.27999529242515564,-0.007519766688346863,0.272436261177063,-0.34045568108558655,0.14045092463493347,-0.14348043501377106,0.13074325025081635,-0.2428034543991089,-0.33939799666404724,0.1039080023765564,0.35284876823425293,-0.10081993043422699,-0.16236406564712524},{-0.014417729340493679,0.17422574758529663,0.05883047729730606,0.0013940776698291302,-0.1550506055355072,-0.022378938272595406,0.2843574583530426,-0.07315155118703842,0.30367210507392883,0.22032302618026733,-0.0923016145825386,-0.08131936192512512,0.08983095735311508,-0.18627607822418213,-0.04812117666006088,-0.17328409850597382},{-0.21886655688285828,0.08760160952806473,-0.1927727609872818,0.14522536098957062,-0.1947343796491623,0.12322606146335602,0.16416208446025848,-0.12697836756706238,0.27359092235565186,0.06639553606510162,-0.18959744274616241,0.12293747067451477,0.08074416220188141,0.2973591983318329,0.01910511963069439,-0.08438967913389206},{-0.12083806097507477,0.11209758371114731,0.14306758344173431,0.03867727890610695,0.2017296552658081,-0.07553736120462418,0.15496596693992615,-0.25689008831977844,-0.06345745921134949,0.23653016984462738,-0.13244009017944336,0.1555354744195938,-0.39526841044425964,-0.09208248555660248,0.20471617579460144,0.06404329091310501},{0.021392863243818283,-0.24273282289505005,-0.1851169615983963,0.04287654906511307,0.4407007694244385,-0.25970107316970825,0.023685134947299957,-0.22062747180461884,0.3430120646953583,0.20362821221351624,-0.20412929356098175,0.0442742183804512,0.012257833033800125,0.22472451627254486,-0.22226645052433014,-0.37436339259147644},{0.19603018462657928,-0.16409868001937866,0.2508120834827423,0.11411544680595398,0.36720240116119385,0.25533321499824524,-0.31590762734413147,-0.19903212785720825,-0.14416372776031494,0.46098172664642334,-0.17809616029262543,-0.39893338084220886,-0.351712703704834,-0.07807758450508118,-0.30009880661964417,-0.3727624714374542},{-0.257967472076416,-0.046682920306921005,0.07758504152297974,-0.4743131697177887,0.21601790189743042,-0.24375006556510925,0.1258668303489685,-0.2713724970817566,0.16831476986408234,0.08736374974250793,0.09605728089809418,-0.037121035158634186,-0.2750915288925171,0.35143959522247314,-0.272947758436203,-0.39247554540634155},{-0.012981656938791275,-0.1794452965259552,-0.21675720810890198,0.06990039348602295,0.24227741360664368,-0.22221490740776062,0.27252569794654846,0.022648146376013756,-0.2613142430782318,-0.016413027420639992,-0.08036056160926819,0.325443834066391,0.08340121060609818,0.1607770472764969,0.3385322093963623,0.09929877519607544},{-0.3621053397655487,-0.3772543668746948,0.2714042663574219,-0.14990490674972534,-0.18589568138122559,0.1715986728668213,0.27159354090690613,-0.2610096037387848,0.01656673662364483,0.07866933196783066,-0.3808118402957916,-0.2846926748752594,-0.4173257350921631,-0.35323429107666016,0.25572341680526733,0.2556558847427368},{-0.07489174604415894,-0.115870900452137,-0.18612435460090637,0.03932317718863487,0.4441649615764618,0.19086672365665436,-0.10701318085193634,-0.16033649444580078,0.021338408812880516,0.544920802116394,-0.010169574990868568,-0.021921373903751373,-0.1933799535036087,0.19008828699588776,-0.13791561126708984,-0.19628934562206268},{0.13102200627326965,-0.38982856273651123,0.08015090227127075,0.19361495971679688,-0.1350080668926239,0.25397565960884094,-0.19733735918998718,-0.1333090364933014,-0.2803652882575989,0.2325202226638794,0.05824432894587517,-0.09802021831274033,-0.18800857663154602,-0.20164844393730164,-0.18919895589351654,-0.04545362666249275},{0.3162754774093628,-0.28949594497680664,0.36177223920822144,0.14400510489940643,-0.055810797959566116,-0.23582668602466583,-0.2123967409133911,-0.019025268033146858,-0.31255337595939636,-0.07766170799732208,-0.231181800365448,0.073042131960392,-0.17214401066303253,0.2265002578496933,0.19506321847438812,0.11534500867128372},{0.529411256313324,-0.32210448384284973,-0.161365807056427,-0.2980943024158478,0.3238662779331207,-0.2518463134765625,-0.06035201624035835,-0.08435563743114471,-0.3361278474330902,0.17356932163238525,-0.11653245985507965,0.2497299760580063,-0.4163476824760437,0.36403658986091614,-0.23314927518367767,0.18118374049663544},{0.2933875024318695,-0.06487441062927246,-0.024737492203712463,-0.04141353815793991,-0.022837551310658455,-0.23584650456905365,-0.19624435901641846,0.24762794375419617,0.14864659309387207,-0.23036161065101624,0.2608150541782379,-0.21701329946517944,0.20176342129707336,0.3260864019393921,-0.07683517783880234,-0.44307631254196167},{-0.04873430356383324,-0.5964704751968384,-0.04667568951845169,-0.20822496712207794,-0.2831001281738281,0.29213979840278625,0.18866212666034698,0.18431483209133148,0.01747089996933937,0.12281599640846252,0.3514860272407532,-0.30358627438545227,0.17048777639865875,0.28549978137016296,-0.06990084797143936,-0.20604586601257324},{0.1989118903875351,-0.05520088970661163,0.1891051083803177,0.15392567217350006,0.22299034893512726,-0.41380009055137634,-0.2869082987308502,-0.029503198340535164,-0.3211080729961395,0.32103022933006287,0.05311192199587822,-0.1351316273212433,-0.46036621928215027,0.2851845324039459,0.4497827887535095,0.11270712316036224},{-0.170023575425148,0.11419931054115295,0.17407256364822388,0.1915546953678131,0.08851896971464157,-0.30560600757598877,-0.06836168467998505,-0.12706807255744934,-0.1436309665441513,0.09464618563652039,0.08417723327875137,-0.04200243949890137,-0.43189921975135803,-0.2612738609313965,0.37141090631484985,0.15242493152618408},{-0.0539979562163353,0.06856921315193176,0.2844644784927368,-0.17682184278964996,0.16537585854530334,0.032322533428668976,0.16549190878868103,0.34970036149024963,0.05192098394036293,-0.24247951805591583,0.01994726061820984,0.1420777291059494,-0.06125346198678017,0.10498647391796112,0.1564316302537918,-0.0027662734501063824},{0.30463334918022156,-0.22578665614128113,-0.054267119616270065,-0.024165693670511246,-0.13177937269210815,0.18743866682052612,-0.16263733804225922,-0.2465779185295105,-0.40213334560394287,0.007184627931565046,0.22744478285312653,0.4585336446762085,-0.45972177386283875,0.47503912448883057,-0.05597136542201042,-0.1835734099149704},{0.3537738025188446,-0.22699826955795288,0.3154851198196411,-0.24110814929008484,0.2784534990787506,0.2836192548274994,-0.31514763832092285,-0.05175929516553879,0.16997428238391876,0.34742748737335205,0.14337590336799622,0.05994437634944916,-0.3576609194278717,-0.20319490134716034,0.05813325196504593,0.15844765305519104},{0.30800342559814453,-0.3106405735015869,0.3444053530693054,0.2774195075035095,0.042171962559223175,-0.05611547455191612,-0.3666937053203583,0.350106418132782,-0.07405245304107666,0.2824948728084564,0.26127544045448303,0.009289346635341644,-0.15783114731311798,-0.15440678596496582,-0.0702589824795723,0.13464820384979248},{0.1841079741716385,-0.21883957087993622,0.11450434476137161,-0.04023158922791481,-0.20555542409420013,-0.09762465953826904,0.3249746561050415,0.1381133794784546,0.19358211755752563,0.29106828570365906,0.2449510246515274,0.13898158073425293,0.1719803810119629,0.24459214508533478,-0.17206737399101257,-0.22237442433834076},{0.07826681435108185,-0.4020951986312866,-0.1735192984342575,-0.3607369065284729,0.11563494056463242,-0.4239312708377838,0.05606425553560257,0.23954784870147705,0.33635711669921875,0.13049738109111786,0.32750755548477173,0.30818095803260803,-0.47548985481262207,-0.08757677674293518,0.23886510729789734,0.27245932817459106}};
static const float actor_encoder_obstacle_embed_layer_0_bias[16] = {0.45354291796684265,-0.2789439558982849,-0.11113053560256958,-0.15808634459972382,0.0677059218287468,-0.24233382940292358,0.07902831584215164,0.0419488362967968,0.10220126062631607,0.10244971513748169,0.14643855392932892,-0.1789482831954956,-0.1734084039926529,0.2579500377178192,-0.02448856085538864,-0.07196727395057678};
static const float actor_encoder_attention_layer_w_qs_weight[16][16] = {{0.3531763255596161,-0.19320538640022278,-0.06509718298912048,0.3751335144042969,-0.31881093978881836,0.04153710603713989,0.05393398180603981,-0.5205572247505188,-0.25207996368408203,-0.17435967922210693,0.35030728578567505,0.10701059550046921,0.11003872752189636,0.2217969298362732,0.19064882397651672,0.20965969562530518},{0.22574669122695923,-0.15802118182182312,-0.16088004410266876,-0.3420100510120392,-0.3357662260532379,0.04663824662566185,-0.27519866824150085,0.02132825367152691,-0.06301435828208923,0.18505173921585083,-0.3088299334049225,0.17238248884677887,0.09748239070177078,0.028203999623656273,0.32145193219184875,-0.1585913598537445},{-0.2929149866104126,0.3326258361339569,0.21304439008235931,0.4189537465572357,0.09683604538440704,-0.3044719994068146,-0.2995429039001465,0.3075268268585205,0.09961578994989395,-0.3779149651527405,-0.2551913559436798,-0.4577005207538605,-0.47052350640296936,-0.21368573606014252,-0.2578713595867157,-0.3718699514865875},{0.053880199790000916,0.17429599165916443,-0.150808647274971,0.23854035139083862,0.041065167635679245,0.17698882520198822,0.19901008903980255,-0.33956781029701233,0.19155903160572052,-0.0520145483314991,0.2516516149044037,-0.015059220604598522,-0.13665653765201569,-0.0979013592004776,0.02468334697186947,-0.4299169182777405},{-0.13082168996334076,-0.42971426248550415,-0.05215967074036598,0.066203773021698,-0.05805670842528343,-0.3363293707370758,-0.05717237666249275,-0.5029447674751282,-0.33017051219940186,-0.13058529794216156,0.04108521714806557,0.13818548619747162,0.2396795153617859,0.16583053767681122,0.09463026374578476,-0.31099820137023926},{-0.11682851612567902,-0.08927254378795624,-0.16474637389183044,-0.2575121223926544,0.08746068179607391,0.12907558679580688,-0.005544567480683327,-0.35682085156440735,-8.927903400035575e-05,0.055348437279462814,0.016979215666651726,0.0786653384566307,-0.14038649201393127,-0.020713001489639282,-0.07488644123077393,-0.27458086609840393},{0.22425326704978943,-0.07709632068872452,0.4587656855583191,-0.2558271288871765,-0.00715747382491827,0.3630874752998352,-0.048132702708244324,-0.2360847443342209,-0.3847346901893616,0.26972657442092896,-0.367881178855896,0.29682430624961853,-0.27059221267700195,-0.4076084792613983,0.30726417899131775,0.20080959796905518},{-0.17767973244190216,0.359150767326355,-0.04944080486893654,-0.023074457421898842,-0.4185829758644104,-0.18933208286762238,0.3677688539028168,-0.2167024165391922,-0.17802315950393677,-0.48214152455329895,0.15273810923099518,-0.26542022824287415,-0.18089833855628967,0.18561390042304993,-0.2002674639225006,-0.06480040401220322},{-0.02035113237798214,-0.15600351989269257,0.4098089635372162,0.35976529121398926,0.1324775367975235,-0.14095021784305573,0.23720672726631165,0.3103773295879364,0.28753241896629333,-0.3542144000530243,0.5278258323669434,0.2305828034877777,0.3099159896373749,0.3235408067703247,0.4112837612628937,0.011395955458283424},{0.1777813732624054,0.1885935366153717,0.03475579246878624,0.10066264867782593,-0.043350253254175186,-0.23917561769485474,0.27282559871673584,0.4412693381309509,0.4459648132324219,0.1344512701034546,-0.013176960870623589,-0.18903253972530365,0.2730043828487396,0.1809116154909134,-0.3848988115787506,0.29540202021598816},{-0.4110720753669739,0.2193363904953003,-0.29011714458465576,0.189431831240654,-0.27251237630844116,0.22201944887638092,-0.03344395384192467,0.08835543692111969,0.3195308744907379,-0.22783085703849792,0.5151386260986328,-0.28287604451179504,0.0649680346250534,0.29392561316490173,-0.4400451183319092,-0.020492063835263252},{-0.2564391791820526,0.3377939462661743,0.2471226304769516,0.3404098153114319,-0.45036444067955017,-0.17063957452774048,0.035642825067043304,0.2452925145626068,-0.5303893685340881,-0.36644288897514343,-0.02859090454876423,0.09088265150785446,0.03238449618220329,0.15234223008155823,0.23453983664512634,0.028767410665750504},{-0.29148557782173157,0.08180872350931168,-0.3469685912132263,0.1389371007680893,-0.1858479380607605,-0.27235421538352966,0.30077067017555237,-0.49003010988235474,-0.09885033220052719,0.07480404525995255,-0.3864045739173889,0.3752377927303314,0.13321861624717712,0.4634682834148407,0.31887051463127136,0.3564801812171936},{0.06070197746157646,0.3135719895362854,0.3138597905635834,0.3228487968444824,0.18107841908931732,0.355664998292923,0.2890881597995758,-0.22976353764533997,-0.2373732477426529,0.36223578453063965,-0.42069220542907715,0.4578104615211487,0.026298455893993378,0.1463850885629654,0.13076958060264587,0.34177735447883606},{0.2707284092903137,-0.2348421812057495,0.13314495980739594,0.2931516170501709,0.46015051007270813,-0.4319809079170227,0.16677947342395782,-0.07098173350095749,0.32002392411231995,0.32027173042297363,0.45362043380737305,0.36188840866088867,-0.3490777909755707,-0.1412864774465561,-0.1996055543422699,-0.249789297580719},{-0.10435009002685547,0.005912126507610083,0.0033512702211737633,0.19186024367809296,0.32573363184928894,-0.28593286871910095,-0.3657560646533966,-0.16933518648147583,0.1924319714307785,0.2995762228965759,-0.06521197408437729,-0.12585408985614777,0.14124612510204315,-0.07561954110860825,0.29078033566474915,-0.4612249433994293}};
static const float actor_encoder_attention_layer_w_ks_weight[16][16] = {{0.3071444630622864,0.06106755882501602,0.21870945394039154,-0.3730572760105133,0.4517756402492523,0.07619974762201309,-0.21571554243564606,0.07326780259609222,0.13755032420158386,0.21410852670669556,0.3598630130290985,-0.23060499131679535,0.03420782461762428,0.35968324542045593,0.3994961380958557,-0.3288966417312622},{0.4448789060115814,-0.15537182986736298,0.4367004334926605,0.15656086802482605,-0.15336497128009796,-0.16916240751743317,0.10983043909072876,-0.2513120472431183,-0.23264534771442413,0.12172108888626099,0.15545722842216492,0.3039519190788269,0.18255116045475006,0.18738649785518646,-0.44243109226226807,0.16450297832489014},{0.34605884552001953,-0.3702094852924347,-0.14155371487140656,-0.28536853194236755,0.41232359409332275,0.03249748796224594,0.38004228472709656,-0.4276825487613678,0.2717764377593994,-0.1343265175819397,0.15497446060180664,-0.3389218747615814,0.3801172375679016,-0.4635033905506134,0.32760050892829895,0.13684475421905518},{-0.2960141897201538,0.19965718686580658,-0.2738383412361145,0.019578611478209496,0.2946406602859497,-0.09707597643136978,-0.40933623909950256,0.4178955852985382,0.07214025408029556,-0.07392474263906479,0.14364184439182281,0.16846920549869537,0.12628541886806488,-0.006037660408765078,0.2560177743434906,0.4048255383968353},{0.18577367067337036,0.3045339286327362,0.2636670768260956,0.06764928251504898,-0.3861461281776428,-0.19303080439567566,0.1382402926683426,0.3375602066516876,-0.002613273449242115,-0.15220986306667328,-0.4083743095397949,0.1629551351070404,0.11989295482635498,-0.38086289167404175,-0.05525903403759003,0.3410356044769287},{0.04285025596618652,-0.4113917052745819,0.11725917458534241,-0.18303434550762177,-0.18893404304981232,-0.04311748221516609,-0.1813288778066635,-0.39420098066329956,-0.22803282737731934,0.13617628812789917,-0.11089575290679932,0.20507438480854034,-0.2586961090564728,0.19094966351985931,0.20017920434474945,-0.3082580864429474},{0.15710513293743134,-0.2661583423614502,-0.1918521225452423,-0.07893519848585129,0.3094525933265686,-0.4266647696495056,-0.05170385539531708,-0.04066065326333046,0.3274049460887909,0.12653902173042297,0.530182957649231,-0.44323211908340454,-0.25354069471359253,0.1958288550376892,0.12575167417526245,0.198844313621521},{0.20792320370674133,-0.2681989073753357,-0.17592869699001312,-0.2802000641822815,-0.13018353283405304,0.3139443099498749,-0.2735779285430908,0.39231085777282715,0.26094233989715576,0.06383593380451202,-0.29649338126182556,0.3429228961467743,-0.08785013109445572,0.31955477595329285,0.23394018411636353,-0.03290306031703949},{-0.2613374888896942,-0.2229306697845459,-0.24009676277637482,-0.03110060654580593,-0.243505597114563,0.03907284513115883,-0.37736332416534424,-0.3767375946044922,-0.1534985452890396,-0.2306017130613327,-0.3614274263381958,0.15800094604492188,0.15654252469539642,0.251337468624115,-0.04702223837375641,0.1428716778755188},{-0.16888867318630219,-0.16906942427158356,-0.3449127972126007,-0.28643250465393066,-0.20322252810001373,-0.20280039310455322,-0.487775981426239,-0.19670036435127258,-0.10155532509088516,0.2658771872520447,0.1340513378381729,-0.28638797998428345,0.11803186684846878,-0.05002462491393089,-0.17042776942253113,0.2117854654788971},{0.1723666936159134,-0.4908076822757721,0.12626905739307404,-0.1440829634666443,-0.11548210680484772,-0.1301426738500595,-0.26761770248413086,-0.11548075079917908,0.3153827488422394,0.3962610960006714,-0.2759997546672821,0.23346436023712158,0.10905379056930542,0.17080910503864288,-0.07487878948450089,0.1734612137079239},{0.3921752870082855,-0.40746745467185974,0.052713118493556976,-0.09189490228891373,0.45058172941207886,-0.15839047729969025,0.06051748991012573,-0.1039654091000557,0.022479046136140823,0.22525084018707275,0.12272515892982483,0.43422210216522217,0.20070993900299072,0.28256163001060486,0.21870793402194977,0.28172051906585693},{0.3362973928451538,0.11165803670883179,0.037393417209386826,-0.20190738141536713,0.1463133841753006,-0.4053133428096771,-0.3354184627532959,0.14237293601036072,-0.19110217690467834,-0.31795039772987366,0.2102230042219162,-0.15419073402881622,0.36143702268600464,-0.11630269140005112,-0.14211781322956085,-0.02691054344177246},{-0.2143852412700653,0.04769439250230789,0.40878769755363464,0.13390406966209412,0.0275516789406538,0.01649089902639389,0.15160822868347168,-0.2195809781551361,0.18992584943771362,-0.35629531741142273,0.5189513564109802,0.20409747958183289,-0.028866929933428764,0.05777093023061752,0.11858679354190826,-0.32635751366615295},{-0.46568042039871216,-0.17492422461509705,0.2731976807117462,-0.26132363080978394,-0.45719942450523376,0.4639681577682495,0.1295763999223709,-0.13557986915111542,-0.5470698475837708,-0.08708904683589935,-0.14201518893241882,-0.18079353868961334,-0.5120968222618103,0.3404783606529236,0.2786857783794403,-0.3340455889701843},{0.15268714725971222,-0.300432950258255,0.20667381584644318,-0.20210878551006317,-0.30805402994155884,0.29061076045036316,0.3429654538631439,-0.4335117042064667,-0.1982138454914093,0.11157062649726868,-0.4498540759086609,0.3894299566745758,0.2747972309589386,-0.19826573133468628,0.11748110502958298,0.04557466879487038}};
static const float actor_encoder_attention_layer_w_vs_weight[16][16] = {{0.4469672739505768,0.0012239419156685472,0.6819510459899902,0.5762071013450623,-0.4644325077533722,-0.48401737213134766,-0.11344823241233826,-0.35855865478515625,0.07342791557312012,-0.06947994977235794,-0.37309980392456055,-0.10243628174066544,-0.34281304478645325,0.07532188296318054,0.3381556570529938,-0.10081212222576141},{-0.26599499583244324,0.09805811196565628,-0.1306024193763733,0.1812787503004074,0.2771211564540863,0.1494455337524414,0.27743732929229736,0.04209219291806221,0.14969202876091003,0.2177358865737915,-0.10723239183425903,-0.19581076502799988,-0.34683963656425476,-0.3681730031967163,-0.2838546931743622,0.12259292602539062},{0.15967059135437012,-0.09898223727941513,-0.1352178305387497,0.28392863273620605,0.08485112339258194,-0.3970160484313965,-0.25580501556396484,-0.12443012744188309,0.19641517102718353,0.2034495621919632,-0.006296060048043728,0.49068886041641235,-0.0905074030160904,0.07167094945907593,-0.22993111610412598,0.042638279497623444},{-0.16668079793453217,0.4689255952835083,-0.5461544990539551,0.21726275980472565,0.32217514514923096,-0.3563351631164551,0.19941572844982147,0.02862820215523243,-0.2839316725730896,0.2758871614933014,0.006754414178431034,0.3731740117073059,-0.31367942690849304,-0.31485220789909363,-0.06962555646896362,0.39896711707115173},{0.29849663376808167,0.05844190716743469,0.26820215582847595,-0.02067025750875473,0.2773461639881134,0.16093216836452484,-0.23212166130542755,-0.5064020156860352,-0.2413804680109024,0.10147194564342499,0.09541205316781998,-0.25583216547966003,-0.1555272936820984,-0.3692692220211029,-0.22567200660705566,-0.13880787789821625},{-0.41897648572921753,-0.21576018631458282,-0.23201535642147064,-0.28755855560302734,0.38218244910240173,-0.15799447894096375,-0.4068201780319214,0.3122844994068146,-0.013267341069877148,-0.4494656026363373,0.18700861930847168,0.3261231780052185,-0.2727506756782532,-0.18742318451404572,-0.07840524613857269,0.03619522601366043},{-0.41323748230934143,0.014133447781205177,-0.20747889578342438,-0.05626504123210907,-0.07264017313718796,0.12684716284275055,-0.07217114418745041,0.016370387747883797,0.026049552485346794,-0.2823120951652527,-0.2868310213088989,-0.4462626278400421,-0.37637725472450256,0.2774130702018738,0.2283705621957779,-0.11477017402648926},{0.15626506507396698,0.25717225670814514,-0.12161591649055481,0.3236108720302582,-0.33652544021606445,-0.18814052641391754,0.19820812344551086,-0.11420859396457672,-0.09653172641992569,-0.1425311416387558,0.125962495803833,0.20705215632915497,-0.3038526773452759,0.0818408951163292,0.46323227882385254,0.43443235754966736},{-0.20539449155330658,-0.32063910365104675,0.3083096742630005,-0.2514525055885315,0.04763556644320488,-0.517050564289093,-0.07145822793245316,-0.378294974565506,-0.21690669655799866,0.28010642528533936,-0.43682238459587097,-0.054686788469552994,0.18236283957958221,0.0871235579252243,0.26324892044067383,0.04681193456053734},{0.4759981036186218,-0.22394715249538422,-0.04428922012448311,0.10169123113155365,-0.48700425028800964,-0.0020757250022143126,0.290347695350647,-0.436743825674057,-0.3931248188018799,0.21275250613689423,0.38698694109916687,-0.6570428013801575,-0.007514716126024723,0.19211208820343018,-0.0665779784321785,-0.12380680441856384},{0.004802433308213949,0.20433522760868073,0.4399028718471527,-0.10509006679058075,-0.48134690523147583,0.05259058251976967,0.03799426555633545,0.4237158000469208,-0.312455952167511,0.20341230928897858,0.3072569668292999,-0.11120037734508514,-0.41479378938674927,-0.012368807569146156,0.43078768253326416,-0.13803720474243164},{-0.24522116780281067,0.3747026026248932,-0.3961958587169647,0.27096718549728394,0.37560802698135376,-0.3025240898132324,-0.05481564253568649,-0.2785135805606842,-0.0869775041937828,-0.2107294201850891,0.1937340945005417,0.24285106360912323,0.2036815881729126,0.3200443983078003,-0.10905472189188004,-0.13068686425685883},{0.12044647336006165,-0.31725355982780457,-0.4695410430431366,0.19317106902599335,-0.19478394091129303,0.08066260069608688,-0.1643260270357132,0.4497082531452179,-0.059439048171043396,0.33276399970054626,-0.40305694937705994,0.5354897379875183,-0.14868302643299103,-0.1419876515865326,-0.37812885642051697,-0.2834463119506836},{0.1608571857213974,0.21457085013389587,0.37021496891975403,-0.30271100997924805,-0.270394504070282,-0.4121634066104889,0.2271777093410492,-0.12968994677066803,-0.12500233948230743,-0.2755427956581116,-0.28897807002067566,-0.5442072749137878,-0.3584604263305664,0.4865033030509949,0.5813265442848206,0.384464830160141},{-0.31211280822753906,-0.1911747306585312,-0.3405648171901703,0.18849830329418182,-0.06570811569690704,-0.14051756262779236,-0.10882402211427689,-0.1030716672539711,0.06360029429197311,-0.1644820272922516,0.2002187818288803,-0.3477420508861542,-0.19475418329238892,0.016634685918688774,-0.37490785121917725,0.3625773787498474},{-0.21686434745788574,0.15820316970348358,-0.08301189541816711,0.4243903160095215,-0.2362721711397171,0.28646209836006165,0.038979798555374146,0.19385375082492828,-0.18947620689868927,-0.1140800416469574,-0.1610732078552246,0.4210951328277588,0.13003292679786682,-0.04387974366545677,0.1178961992263794,0.1437462568283081}};
static const float actor_encoder_attention_layer_fc_weight[16][16] = {{0.3901587724685669,-0.30982327461242676,-0.21498501300811768,-0.3374355137348175,0.4616146981716156,0.22334279119968414,0.38141533732414246,0.2110779732465744,0.05383272469043732,0.4261569380760193,-0.14975164830684662,-0.21380619704723358,0.43204063177108765,0.26689964532852173,0.14415870606899261,0.13886725902557373},{-0.010778006166219711,0.30254432559013367,0.27933254837989807,-0.16483663022518158,-0.03508209064602852,-0.4045165777206421,0.028404293581843376,-0.057058610022068024,-0.15387260913848877,-0.4306340515613556,-0.05180387571454048,-0.11613354831933975,-0.2562357187271118,-0.12730054557323456,0.08003942668437958,-0.09324627369642258},{0.3773932456970215,-0.5460678339004517,-0.3275068700313568,-0.3432729244232178,0.3363851010799408,0.28842517733573914,0.3731685280799866,0.2952636182308197,0.22953028976917267,-0.2556287944316864,-0.1356288343667984,-0.3571336269378662,0.14532242715358734,-0.25980138778686523,0.5304813385009766,-0.022856559604406357},{-0.07688970118761063,0.10904420912265778,-0.3208586275577545,0.20375937223434448,0.30709385871887207,0.1998593509197235,-0.1588057428598404,-0.10014151781797409,0.3452783524990082,-0.0928526297211647,-0.4534517824649811,-0.11341531574726105,0.08807387202978134,0.4351029098033905,-0.09407632797956467,0.1387752741575241},{-0.17806731164455414,0.5344757437705994,-0.34130698442459106,0.4138425588607788,-0.5325798392295837,-0.32988041639328003,0.05243854597210884,0.023746194317936897,0.10492995381355286,0.43603041768074036,-0.08793870359659195,0.35116684436798096,0.2086969017982483,-0.4226197898387909,0.3040156662464142,0.31231528520584106},{0.334298700094223,0.19723623991012573,-0.26629722118377686,0.41682523488998413,-0.28055012226104736,-0.13950881361961365,-0.32082125544548035,0.09725172072649002,-0.2691009044647217,-0.365456759929657,0.26110950112342834,0.10516760498285294,0.15871864557266235,-0.05992814153432846,0.27922511100769043,-0.32037514448165894},{0.15541404485702515,-0.16071781516075134,-0.002588383387774229,0.21330688893795013,-0.02602478116750717,0.16197869181632996,0.40641269087791443,0.15017248690128326,-0.1001521497964859,-0.14948409795761108,-0.44067060947418213,0.12470946460962296,0.21192415058612823,0.13975156843662262,0.08385144919157028,0.21885144710540771},{-0.2594260275363922,0.27143678069114685,0.0047874669544398785,-0.046452876180410385,-0.1915574073791504,-0.09470365941524506,-0.5332151651382446,0.3724345862865448,0.03245751932263374,-0.3575590252876282,-0.32869580388069153,0.2316596806049347,-0.35130295157432556,0.16467471420764923,0.4530048370361328,0.04960035905241966},{-0.15690173208713531,0.29073482751846313,-0.05090441182255745,0.03656788170337677,-0.45842546224594116,-0.27498024702072144,-0.3710513710975647,-0.23587656021118164,0.2791658639907837,0.06080135330557823,-0.2545998692512512,0.22101303935050964,-0.08200037479400635,-0.3190198540687561,0.3208948075771332,0.008323650807142258},{-0.44299766421318054,0.022797320038080215,-0.2521195411682129,0.27104541659355164,0.09221020340919495,-0.10152199119329453,0.03320888802409172,-0.3468012511730194,-0.14435049891471863,0.10937951505184174,-0.2633885145187378,-0.28544190526008606,0.38126271963119507,-0.25967368483543396,0.030325643718242645,0.031949304044246674},{0.08357088267803192,-0.22651775181293488,0.3298245668411255,0.016591574996709824,0.2652019262313843,-0.12114652246236801,-0.03312205895781517,0.22564294934272766,-0.10165562480688095,-0.4248611330986023,0.20211338996887207,0.5569434762001038,-0.39426371455192566,-0.32214590907096863,-0.36661824584007263,-0.42450812458992004},{0.10429899394512177,0.21622565388679504,0.2861524224281311,0.4577507972717285,-0.2924744486808777,0.2054610550403595,-0.6056382060050964,-0.28051385283470154,0.03057227097451687,-0.03129325434565544,0.038626644760370255,0.2081623375415802,-0.5223239064216614,0.4563908278942108,-0.02614879235625267,-0.4147876501083374},{0.4800656735897064,0.2397921234369278,0.37943220138549805,-0.16619731485843658,-0.04162277281284332,0.06025020033121109,-0.3166673481464386,0.0685640349984169,0.2873738408088684,0.03490125760436058,0.3277145326137543,-0.2434369921684265,-0.0003070602542720735,-0.38032421469688416,0.09956786781549454,-0.04828835651278496},{0.07656354457139969,-0.2525912821292877,0.3141712248325348,-0.055333442986011505,0.44291189312934875,-0.14149349927902222,0.07046598941087723,0.10410891473293304,-0.14590232074260712,-0.4455316662788391,-0.03597055748105049,-0.3835197985172272,0.08071112632751465,0.03816153109073639,-0.0912957563996315,-0.05385071784257889},{-0.3862450122833252,-0.11568093299865723,-0.08836442232131958,-0.13756513595581055,0.5105792284011841,-0.059880323708057404,0.5127830505371094,0.16858436167240143,0.30434298515319824,-0.42532414197921753,0.3198815882205963,0.10388245433568954,0.3004949688911438,0.19842223823070526,0.37670040130615234,0.1307227909564972},{-0.20449630916118622,-0.3660798668861389,-0.03731952980160713,-0.1498415619134903,0.02846287190914154,0.17539305984973907,-0.2997561991214752,-0.4222855269908905,0.21856047213077545,-0.2942107319831848,0.2977190315723419,0.4450443685054779,-0.05924755334854126,-0.014991242438554764,0.21835647523403168,-0.1013704463839531}};
static const float actor_encoder_attention_layer_layer_norm_weight[16] = {0.6679406762123108,0.49682557582855225,0.7519980669021606,0.863792359828949,0.902644693851471,0.7270792126655579,0.861373245716095,0.7525935769081116,0.816403329372406,0.7439037561416626,0.6248671412467957,0.8040871620178223,0.8213781118392944,0.6343636512756348,0.7719478011131287,0.6032211184501648};
static const float actor_encoder_attention_layer_layer_norm_bias[16] = {-0.043821752071380615,0.08624806255102158,0.07773636281490326,0.18121971189975739,-0.12877152860164642,-0.008916704915463924,-0.07884673774242401,0.03512202203273773,0.02074080891907215,-0.023663055151700974,-0.015037781558930874,-0.022299649193882942,0.03999544680118561,-0.008239521645009518,0.011664592660963535,0.022098135203123093};
static const float mean[62] = {0.02614430301936256,0.012244319358829893,0.056785872927876596,0.004326294292884543,0.0005884563535934043,0.010907279518928765,-0.0798279586093632,0.006627505085920576,0.0009015447117007957,-0.007199083029861098,-0.08120420414211392,0.006347992954527553,-0.00483943642203341,0.001419154687177038,-0.04717065400144284,0.0230450431399815,0.03327391578252533,-0.048538864163292054,0.008072319259361638,0.0010573073673014347,0.004379772933008769,4.932169076939268e-05,0.00035175086829164064,0.0014881081985107358,0.003209903974612113,0.007841149126134418,0.009439984856169766,0.0006870242493150552,0.004290002087504256,0.0075196022663307355,1.9303081273427773,1.930099756525166,1.9296262792870333,1.9287761645062902,1.927572572724936,1.9261183565268696,1.9248647745642138,1.9240658241440318,1.9325444697681862,1.9370070103545953,1.9398294570702075,1.9409297936612944,1.9405355592893907,1.9385891531098653,1.9348329101086184,1.9297469027050758,1.9264898781612885,1.9278585400862818,1.9291013845501164,1.930111808075061,1.9306554251518635,1.93050787267521,1.9296411509588856,1.928201077880892,1.933176085574469,1.940143470021701,1.945314879378713,1.9477522922316315,1.9477098695721955,1.945700128370935,1.942069722540565,1.9375636927414934};
static const float input_std[62] = {0.6095693969933984,0.6877068975373156,0.35453767535233766,0.42761299730914515,0.4894989426129063,0.5139244484907833,0.29603509851120674,0.20220091008951155,0.15754600075717407,0.20189752150021886,0.29275302844942613,0.17135494270112486,0.15783641380837685,0.17113153007160511,0.1948630114165613,2.1529022509581384,2.338997748419607,1.7970433736562996,1.6655367817858868,1.2760003081738518,0.30081229032920576,0.6391451215977835,0.6702188492367975,0.5821309923745177,2.565286816364673,1.7536637705928793,0.3274475539580228,0.5943685021439453,0.6712749687443768,0.5627553414801849,0.29330325946945063,0.29427722346308477,0.2956043488306067,0.2975494957866584,0.2999752402732809,0.30264217555160383,0.3048212663788407,0.3061343932101531,0.27587911794776204,0.26703338223186857,0.26100958832963733,0.25832815515071483,0.2589123697319475,0.26266768096819737,0.269567539466214,0.2787344060906276,0.2999737577356353,0.29801223203232874,0.29609041780843787,0.2945913732852146,0.2939749973902744,0.29447539867310907,0.2959402312643455,0.29806427905001537,0.27367171027419257,0.2599189530218109,0.24889608408724612,0.2428769971834477,0.24227927734544363,0.24640191627664543,0.25413099016697954,0.26371113517417744};
   
void normalize_state(float *state_array) {
    for (int i = 0; i < STATE_DIM; i++) {
        state_array[i] = (state_array[i] - mean[i]) / ((input_std[i]) + EPS);
    }
}

void normalize_neighbor(volatile float *neighbor_inputs) {
    for (int i = 0; i < OBST_DIM; i++) {
        neighbor_inputs[i] = (neighbor_inputs[i] - mean[i+STATE_DIM]) / ((input_std[i+STATE_DIM]) + EPS);
    }
}

void normalize_obstacle(volatile float *obstacle_inputs) {
    for (int i = 0; i < OBST_DIM; i++) {
        obstacle_inputs[i] = (obstacle_inputs[i] - mean[i+STATE_DIM+(NEIGHBORS*NBR_OBS_DIM)]) / ((input_std[i+STATE_DIM+(NEIGHBORS*NBR_OBS_DIM)]) + EPS);
    }
}

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        normalize_state(state_array);
        // Self embed layer
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_embed_layer_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_embed_layer_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
    
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_embeds[i] = output_0[i];
        }

        for (int i = 0; i < sizeof(neighbor_embeds) / sizeof(neighbor_embeds[0]); i++) {
            output_embeds[i + self_structure[0][1]] = attn_embeds[0][i];
        } 

        for (int i = 0; i < sizeof(obstacle_embeds) / sizeof(obstacle_embeds[0]); i++) {
            output_embeds[i + 2 * self_structure[0][1]] = attn_embeds[1][i];
        } 

        // Feedforward layer
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < 3 * self_structure[0][1]; j++) {
                output_1[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_1[i] += actor_encoder_feed_forward_0_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
    
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_2[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_2[0];
        control_n->thrust_1 = output_2[1];
        control_n->thrust_2 = output_2[2];
        control_n->thrust_3 = output_2[3];	
    }

void neighborEmbedder(volatile float neighbor_inputs[NEIGHBORS * NBR_OBS_DIM]) {
        normalize_neighbor(neighbor_inputs);
    
                for (int i = 0; i < nbr_structure[0][1]; i++) {
                    neighbor_embeds[i] = 0; 
                    for (int j = 0; j < nbr_structure[0][0]; j++) {
                        neighbor_embeds[i] += neighbor_inputs[j] * actor_encoder_neighbor_embed_layer_0_weight[j][i]; 
                    }
                    neighbor_embeds[i] += actor_encoder_neighbor_embed_layer_0_bias[i];
               }
        }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));
        normalize_obstacle(obstacle_inputs);
    
                for (int i = 0; i < obst_structure[0][1]; i++) {
                    obstacle_embeds[i] = 0;
                    for (int j = 0; j < obst_structure[0][0]; j++) {
                        obstacle_embeds[i] += obstacle_inputs[j] * actor_encoder_obstacle_embed_layer_0_weight[j][i];
                    }
                    obstacle_embeds[i] += actor_encoder_obstacle_embed_layer_0_bias[i];
                }
            }


void singleHeadAttention() {
        uint8_t i, j, k;
        // fill the tokens matrix with obstacle and neighbor embeddings
        for (i = 0; i < D_MODEL; i++) {
            tokens[0][i] = neighbor_embeds[i];
            tokens[1][i] = obstacle_embeds[i];
        }
        
        // save the residual
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                residual[i][j] = tokens[i][j];
            }
        }
        
        // compute Q, K, V projection 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                q_outputs[i][j] = 0;
                k_outputs[i][j] = 0;
                v_outputs[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    q_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_qs_weight[k][j]; 
                    k_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_ks_weight[k][j];
                    v_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_vs_weight[k][j];
                }
            }
        }
        
        // compute attention weights and parts of softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            softmax_sums[i] = 0;
            for (int j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    attn_weights[i][j] += (q_outputs[i][k] / sqrt((float)D_MODEL)) * k_outputs[j][k];
                }
                softmax_sums[i] += exp(attn_weights[i][j]);
            }
        }
        
        // softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = exp(attn_weights[i][j]) / softmax_sums[i];
            }
        }

        // compute query 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_output[i][j] = 0;
                for (k = 0; k < NUM_TOKENS; k++) {
                    query_output[i][j] += attn_weights[i][k] * v_outputs[k][j];
                }
            }
        }
        
        // compute the q embeddings 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_embeds[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    query_embeds[i][j] += query_output[i][k] * actor_encoder_attention_layer_fc_weight[k][j];
                }
                // add the residual
                query_embeds[i][j] += residual[i][j];
            }
        }
        
        // calculate per-token mean
        for (i = 0; i < NUM_TOKENS; i++){
            last_layer_means[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                last_layer_means[i] +=  query_embeds[i][j];
            }
            last_layer_means[i] = last_layer_means[i] / (float)D_MODEL;
        }
        
        // calculate per-token variance
        for (i = 0; i < NUM_TOKENS; i++) {
            last_layer_variances[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                base = query_embeds[i][j] - last_layer_means[i];
                exponent = pow(base, 2);
                last_layer_variances[i] += exponent;
            }
            last_layer_variances[i] = last_layer_variances[i] / (float)(D_MODEL);
        }
        
        // perform layer norm (2x16) x (16)
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                attn_embeds[i][j] = (query_embeds[i][j] - last_layer_means[i]) / (sqrt(last_layer_variances[i] + EPS)) * actor_encoder_attention_layer_layer_norm_weight[j]; 
                attn_embeds[i][j] += actor_encoder_attention_layer_layer_norm_bias[j]; 
            }
        }
}
