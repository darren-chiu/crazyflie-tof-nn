#include "network_evaluate_tof.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

#define D_SELF 16 // self_structure[1][1]
#define D_NBR 8 // self_structure[1][1]

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.002067011781036854,-0.0819254145026207,-0.13966935873031616,0.13672955334186554,-0.1600174903869629,-0.0776214450597763,0.44668567180633545,-0.24489934742450714,-0.22436188161373138,0.04117026552557945,-0.20001418888568878,0.2981627583503723,-0.3418821692466736,0.2764115035533905,0.23759791254997253,-0.14048467576503754},{-0.11666836589574814,-0.25494953989982605,0.31787538528442383,-0.2238704264163971,-0.04169844463467598,-0.1898978352546692,0.0904218852519989,-0.2732999324798584,0.006905015558004379,0.24344636499881744,0.21290838718414307,0.16269569098949432,0.1679171472787857,0.0948348119854927,-0.1121135875582695,-0.12354759871959686},{0.03828221932053566,0.15827281773090363,0.31373584270477295,-0.33930671215057373,-0.05483270063996315,0.12862785160541534,0.08674991875886917,-0.09751594811677933,-0.022139208391308784,-0.7404369115829468,0.04101910442113876,0.4511825442314148,0.03210069239139557,0.5016754865646362,-0.0951453298330307,0.022394543513655663},{-0.23737415671348572,0.16386091709136963,0.24571654200553894,-0.0073964898474514484,0.5628580451011658,0.6450077891349792,-0.12807022035121918,-0.16649051010608673,-0.028040070086717606,-0.05320378392934799,0.03560543432831764,0.10562310367822647,-0.2780049443244934,-0.018246427178382874,-0.033074356615543365,-0.11812350153923035},{-0.21956105530261993,0.18417751789093018,-0.1628745049238205,-0.3258168697357178,0.23635922372341156,-0.3750273287296295,-0.3130126893520355,-0.26220765709877014,-0.26558905839920044,0.2873695492744446,0.22607409954071045,0.10227293521165848,0.1660384237766266,0.014848893508315086,0.0966537743806839,0.32634788751602173},{0.2739737927913666,-0.17489740252494812,0.030951853841543198,0.0401182658970356,-0.23614069819450378,0.10544700920581818,-0.22288718819618225,-0.27477848529815674,0.23127856850624084,-0.3513648808002472,-0.20283401012420654,0.16666099429130554,0.011468175798654556,0.2713709771633148,-0.2380635291337967,0.1709609031677246},{-0.3185313045978546,0.3220983147621155,-0.28626465797424316,-0.5051276683807373,0.2440219670534134,-0.09670522809028625,-0.3569715619087219,0.1590990424156189,-0.04792705923318863,-0.09894474595785141,0.30607858300209045,0.3041819632053375,-0.35292571783065796,0.3806377649307251,-0.42386844754219055,-0.15604211390018463},{-0.6419437527656555,-0.051188766956329346,-0.17850850522518158,-0.3053479492664337,-0.5313461422920227,-0.0059206001460552216,0.2039046585559845,-0.004984615370631218,0.28788408637046814,-0.1291891634464264,-0.5490928888320923,0.6333910226821899,-0.010273115709424019,-0.2760245203971863,-0.22676236927509308,0.24309536814689636},{0.027338895946741104,0.18563035130500793,0.14049223065376282,0.2255772203207016,0.6079805493354797,0.22248758375644684,-0.07562252879142761,-0.3530518114566803,-0.16049271821975708,-0.140353262424469,-0.11636289954185486,0.23533226549625397,-0.3379621207714081,0.12368360161781311,0.32106882333755493,0.43772950768470764},{0.9331486821174622,0.5682806372642517,0.12521499395370483,0.6180000901222229,0.47377637028694153,-0.11931247264146805,-0.2762504816055298,-0.345379501581192,0.056765224784612656,-0.14582157135009766,0.03806840628385544,-0.5806308388710022,0.23498259484767914,0.3946146070957184,0.5175275206565857,-0.4129205644130707},{0.4178435802459717,0.15557268261909485,-0.27822092175483704,0.06860654801130295,-0.30990925431251526,-0.18360337615013123,0.20317919552326202,0.5483177304267883,0.25717753171920776,0.28737616539001465,0.1129138395190239,-0.06067754700779915,-0.21254292130470276,0.13035848736763,-0.09407763928174973,0.2905537486076355},{-0.2170388549566269,-0.40748193860054016,0.09814830869436264,-0.5859307646751404,-0.5330706834793091,-0.08139950782060623,-0.33926254510879517,-0.4430895447731018,-0.05988392233848572,0.012797362171113491,0.9070088863372803,0.2573891580104828,0.41427090764045715,-0.014555125497281551,0.32363665103912354,-0.26604118943214417},{0.32692989706993103,0.5468706488609314,0.07392783463001251,-0.1515534520149231,0.06395957618951797,-0.3110647201538086,-0.09051597118377686,0.09292570501565933,0.2030995637178421,0.09690821170806885,-0.055664654821157455,0.3841319680213928,0.6642929911613464,-0.11090973019599915,0.3856965899467468,-0.37140706181526184},{-0.04364046826958656,0.07478232681751251,-0.11089114099740982,-0.09465912729501724,0.03874388337135315,0.2098943144083023,-0.03271333500742912,0.7141441106796265,-0.39732906222343445,-0.3251148462295532,-0.5087680220603943,-0.2174401581287384,0.10240886360406876,-0.17344731092453003,-0.12712891399860382,-0.3750804364681244},{0.34808409214019775,-0.3813598155975342,0.30932775139808655,0.08036193251609802,0.1974683552980423,0.25127676129341125,0.0862755998969078,0.18528884649276733,-0.13052943348884583,0.12058376520872116,0.13242650032043457,0.13397549092769623,0.13679592311382294,-0.2662186920642853,-0.005315504968166351,-0.11622939258813858},{-0.08183097839355469,0.26540955901145935,0.11532983928918839,-0.03444681316614151,0.2674655318260193,0.015936391428112984,-0.126191183924675,0.23440273106098175,-0.24726782739162445,-0.12696118652820587,-0.20258688926696777,-0.2740364074707031,-0.23071855306625366,-0.13070739805698395,-0.23000919818878174,-0.08336779475212097},{0.12685008347034454,-0.04635806009173393,-0.35466650128364563,0.00022741392604075372,-0.0037850530352443457,-0.044129736721515656,0.343550443649292,-0.014169738627970219,-0.25988638401031494,0.04052519053220749,0.06400544941425323,-0.18807843327522278,-0.1705489158630371,0.12922705709934235,-0.3148933947086334,0.04740457609295845},{0.2908551096916199,0.2149403840303421,-0.028036780655384064,-0.20552633702754974,0.4288649559020996,0.19783246517181396,-0.017100347205996513,0.10282854735851288,0.09391699731349945,-0.09614445269107819,0.1235845610499382,-0.32164567708969116,-0.11286421865224838,0.25705990195274353,0.3664277493953705,-0.3910881280899048}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.21160146594047546,0.09131894260644913,-0.37174153327941895,0.08289385586977005,0.39833369851112366,-0.35783690214157104,0.43030229210853577,-0.29536253213882446,-0.4468272030353546,-0.07750946283340454,0.1092955693602562,0.11506082117557526,-0.17664895951747894,-0.6075134873390198,0.07007764279842377,0.4281826317310333},{0.0075631760992109776,0.1313914954662323,-0.13128425180912018,-0.02853134088218212,0.23684771358966827,-0.22788020968437195,-0.3815709352493286,-0.26110509037971497,0.06767847388982773,0.21068014204502106,0.28893500566482544,0.04552297666668892,-0.1200365424156189,-0.16105054318904877,0.10970970243215561,0.34469878673553467},{0.2784121632575989,-0.24654610455036163,-0.33259859681129456,-0.14931552112102509,0.15408800542354584,-0.14755035936832428,0.19026397168636322,-0.26647594571113586,0.11659704893827438,-0.5212058424949646,0.15221118927001953,0.16287820041179657,-0.07522277534008026,-0.2909816801548004,0.39099645614624023,-0.07467126101255417},{0.0489279069006443,0.5112025737762451,0.32585957646369934,-0.2878550887107849,0.23303014039993286,0.20081183314323425,0.09572461247444153,0.1938953548669815,-0.08649812638759613,-0.12479261308908463,-0.06267908960580826,0.16328351199626923,-0.42743656039237976,0.4250680208206177,0.18672877550125122,-0.3854890763759613},{0.22248893976211548,0.24864569306373596,-0.2096346914768219,0.026163877919316292,0.346822589635849,0.17852525413036346,0.2239396572113037,0.1295170933008194,-0.12054135650396347,-0.14718444645404816,0.03280828893184662,-0.00870911031961441,-0.10994607210159302,0.3142334818840027,0.20401164889335632,-0.052948277443647385},{-0.019947292283177376,-0.07619323581457138,-0.006854282226413488,0.19520699977874756,-0.4027763903141022,-0.10768933594226837,0.372348427772522,0.008372119627892971,-0.08552221953868866,0.3688127398490906,0.17884555459022522,-0.20238542556762695,-0.02564425766468048,0.11815053224563599,-0.18292443454265594,-0.297848641872406},{-0.04142751917243004,0.3148975074291229,-0.16722165048122406,-0.024108396843075752,-0.2042926400899887,0.1232454776763916,-0.11986341327428818,0.027804668992757797,0.34531277418136597,0.16331616044044495,-0.07680215686559677,0.1888636201620102,0.04382529854774475,0.11580243706703186,-0.18572141230106354,-0.41253939270973206},{-0.2970412075519562,0.5194185972213745,0.32396143674850464,-0.22866465151309967,-0.29000216722488403,-0.2055046409368515,-0.14402370154857635,-0.13909266889095306,0.1142740324139595,0.07195085287094116,0.27337005734443665,-0.011325841769576073,0.25357136130332947,-0.13340456783771515,0.4797830581665039,-0.05545321851968765},{-0.07697837799787521,0.25155210494995117,0.2108680158853531,-0.3808605670928955,-0.4081023335456848,-0.03118191659450531,-0.07384612411260605,0.40447214245796204,-0.2857775092124939,0.236912339925766,0.20738954842090607,0.21025267243385315,0.32301440834999084,-0.1483420431613922,-0.03162844479084015,0.43734392523765564},{0.7107061147689819,0.3174755275249481,-0.24807167053222656,0.3627285361289978,-0.44655123353004456,0.22654478251934052,-0.17135487496852875,0.16216981410980225,0.29238492250442505,-0.48117363452911377,0.2749658524990082,-0.1440296173095703,-0.3803844153881073,0.34230008721351624,0.3846789300441742,0.35980305075645447},{0.16758239269256592,-0.32093310356140137,-0.3689873516559601,0.3170233964920044,-0.06775389611721039,0.3149946331977844,0.22334948182106018,0.23728880286216736,0.07480717450380325,-0.07564359903335571,-0.08036098629236221,0.31233587861061096,0.012042375281453133,-0.17153210937976837,-0.13611046969890594,0.41322648525238037},{0.1717991679906845,-0.35814008116722107,-0.15609589219093323,-0.1370665729045868,0.04287474602460861,0.07500921934843063,0.10502758622169495,-0.4152563214302063,0.2986300587654114,0.3000684976577759,0.3061746060848236,-0.16507044434547424,0.4306719899177551,0.1768856942653656,-0.2928282618522644,-0.00034974413574673235},{0.1825653612613678,-0.025012342259287834,0.071801096200943,-0.2076743096113205,0.29879510402679443,-0.40951669216156006,-0.25888559222221375,0.15732812881469727,-0.21598325669765472,-0.44930171966552734,0.12185545265674591,0.21499420702457428,0.21906639635562897,-0.4711892008781433,0.18091444671154022,0.059484388679265976},{-0.034361086785793304,-0.19736184179782867,-0.5356727838516235,-0.24980129301548004,0.357142835855484,0.2745225429534912,-0.05829724296927452,0.22113937139511108,-0.15992330014705658,0.2643541395664215,-0.5140618085861206,-0.3175766170024872,0.23552781343460083,0.20158959925174713,0.10978851467370987,-0.3712999224662781},{-0.04870864748954773,0.01008165255188942,-0.02094479836523533,0.17508786916732788,-0.008935089223086834,0.011423463933169842,-0.23628507554531097,-0.11778682470321655,-0.23302246630191803,-0.20343585312366486,-0.13931815326213837,0.08227615803480148,-0.5176823735237122,0.2729121148586273,-0.11113503575325012,0.12117752432823181},{0.2742373049259186,-0.130797877907753,-0.27607986330986023,-0.3285667300224304,0.24107186496257782,0.3132387101650238,-0.05447039753198624,-0.1421627700328827,0.12154680490493774,-0.11413194984197617,0.33961671590805054,-0.05531350523233414,0.4281216859817505,0.18569959700107574,-0.38409554958343506,-0.18593424558639526}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07772046327590942,-0.2176773101091385,0.19866475462913513,0.21609552204608917,0.08770290017127991,0.12598885595798492,0.21044990420341492,-0.07025528699159622,-0.09073571115732193,0.16736406087875366,0.06117643788456917,0.18476389348506927,-0.25033706426620483,0.17367921769618988,-0.24634963274002075,0.1582704484462738,0.004716493189334869,0.07578837871551514,0.06551826000213623,-0.13472400605678558,0.248835027217865,0.2160312831401825,0.09869060665369034,-0.14492414891719818,0.033198680728673935,0.37215280532836914,-0.03762358799576759,0.02758690156042576,-0.10573957115411758,0.23573514819145203,-0.2915645241737366,-0.25419503450393677},{-0.10443087667226791,-0.2713477313518524,-0.19813445210456848,0.08378943055868149,-0.18351514637470245,0.07874675840139389,0.00955273862928152,0.19034679234027863,0.057590302079916,0.18696828186511993,-0.16920994222164154,0.2712440490722656,-0.09655483067035675,0.1297743171453476,-0.19097115099430084,0.2683205008506775,0.18115946650505066,-0.27534133195877075,0.24677781760692596,-0.3282381296157837,0.37355804443359375,-0.20906861126422882,0.20951369404792786,-0.10893398523330688,-0.04349816218018532,-0.17178666591644287,0.008056162856519222,-0.017052970826625824,0.13978300988674164,0.06433065980672836,-0.2571994960308075,-0.1849696934223175},{-0.243258535861969,0.10329113155603409,-0.11608550697565079,-0.007890594191849232,0.05293305963277817,0.1857401579618454,-0.010051146149635315,-0.024544458836317062,-0.3034578859806061,0.14551536738872528,0.12068551778793335,-0.06645865738391876,0.24206937849521637,0.32077711820602417,-0.1667618751525879,-0.28230196237564087,-0.22058141231536865,0.19575805962085724,0.03141412511467934,-0.1271301954984665,-0.11250235885381699,-0.08421457558870316,0.15087099373340607,-0.03237398341298103,0.0469808466732502,-0.14227080345153809,-0.3573635518550873,0.03652806952595711,0.1327742040157318,-0.17174026370048523,0.16745010018348694,-0.3104472756385803},{-0.17322838306427002,0.09425727277994156,-0.06481055170297623,-0.25871503353118896,-0.33886006474494934,0.25049248337745667,-0.24609911441802979,-0.27305784821510315,-0.10755747556686401,-0.058475248515605927,-0.2863609492778778,0.08652123063802719,-0.01060460414737463,0.06015536189079285,-0.1764448881149292,0.11944253742694855,-0.25166669487953186,-0.05415298789739609,-0.06175246089696884,-0.2674216032028198,0.2225438952445984,-0.0982208251953125,0.1360906958580017,-0.09178367257118225,-0.06331349164247513,0.10091698169708252,0.1557479351758957,0.06720677018165588,-0.16141508519649506,-0.13556016981601715,-0.23585861921310425,0.06353230029344559},{-0.01606142148375511,0.05112258717417717,-0.24942035973072052,-0.22461873292922974,-0.1856621503829956,-0.15892662107944489,-0.1661226898431778,-0.039729177951812744,0.22501355409622192,0.26866331696510315,0.12732836604118347,-0.3786926865577698,0.0699377954006195,-0.12561947107315063,0.05199136957526207,-0.232093945145607,-0.06573712825775146,-0.0867832750082016,0.27388668060302734,0.4212486743927002,0.0955585315823555,-0.19937032461166382,0.12189874798059464,0.17543227970600128,0.20466668903827667,0.1941741406917572,0.0760076642036438,-0.27944985032081604,0.20176981389522552,0.10266521573066711,-0.0935063362121582,0.061501745134592056},{0.21395879983901978,0.19934141635894775,-0.2920565903186798,0.21033445000648499,0.22904130816459656,-0.03452862426638603,0.1023469865322113,-0.27843615412712097,-0.14965353906154633,-0.21481677889823914,-0.11025877296924591,-0.014845447614789009,0.24144677817821503,-0.2140263020992279,-0.2400527447462082,0.16633591055870056,0.31247660517692566,0.048579081892967224,-0.06580334156751633,0.021909473463892937,-0.17655228078365326,0.040933143347501755,0.3377472162246704,-0.08420664072036743,0.28696486353874207,-0.07654062658548355,-0.1221705824136734,0.3299749791622162,0.0930977389216423,-0.17556951940059662,-0.2637915015220642,0.2675131559371948},{0.10551607608795166,0.291965514421463,-0.20194144546985626,-0.04442752152681351,0.22856207191944122,0.04469122737646103,0.09739809483289719,-0.19810761511325836,0.22470900416374207,0.2374642938375473,-0.10693609714508057,0.06851835548877716,0.04839324206113815,0.020034415647387505,0.11329548805952072,0.2136419117450714,0.0960405170917511,-0.07346217334270477,0.0019061709754168987,-0.2181687206029892,-0.12309890985488892,-0.18892228603363037,0.04039992764592171,-0.21843253076076508,0.2147367298603058,-0.17016489803791046,0.05321907252073288,-0.21356748044490814,0.17268939316272736,0.028031598776578903,-0.073635995388031,0.11282631009817123},{-0.1470867544412613,0.2333628237247467,-0.09575003385543823,-0.215836763381958,-0.12396689504384995,-0.0016894630389288068,0.026040172204375267,-0.06594886630773544,0.21095170080661774,-0.11824628710746765,0.03152583912014961,-0.22249425947666168,0.029134364798665047,0.1827029287815094,0.2588560879230499,-0.28750455379486084,0.28396493196487427,0.19532431662082672,0.17008185386657715,-0.19989758729934692,-0.02214999683201313,0.2644043564796448,-0.1797596514225006,0.22787192463874817,0.23116624355316162,0.1652710884809494,0.08328063040971756,-0.1428319811820984,-0.2749214470386505,-0.09929797798395157,0.04196030646562576,-0.2636539340019226},{0.21171218156814575,0.2732856571674347,-0.0008168317726813257,0.2854243516921997,0.24972102046012878,-0.11593224108219147,-0.2802841365337372,0.06803994625806808,-0.07982949912548065,-0.3895069360733032,-0.04124271869659424,-0.03771694004535675,-0.06162995845079422,-0.09319265186786652,-0.2748343348503113,-0.3241451680660248,0.22648486495018005,0.262858122587204,0.24703212082386017,0.28418171405792236,-0.2646030783653259,0.16222906112670898,-0.1769639253616333,0.030990492552518845,0.08506997674703598,0.20795832574367523,-0.05925073102116585,0.3477676808834076,0.19450753927230835,0.16708078980445862,0.31915825605392456,-0.12069078534841537},{0.13285160064697266,-0.11301516741514206,-0.0012920321896672249,0.09922235459089279,0.07218076288700104,0.144033282995224,-0.16748611629009247,0.11127372086048126,-0.15847983956336975,0.027456102892756462,-0.2678614854812622,0.0703582763671875,0.10023530572652817,0.15320611000061035,0.05120027810335159,-0.2296079695224762,0.16977904736995697,0.12413375079631805,-0.2916392982006073,0.1409568190574646,0.14399662613868713,0.27457642555236816,-0.06439940631389618,-0.18436679244041443,0.1595674604177475,0.0868140459060669,-0.26539504528045654,-0.14973203837871552,-0.21694327890872955,0.21511085331439972,-0.2132325917482376,0.4258403778076172},{0.31022411584854126,-0.08950978517532349,-0.24045400321483612,0.10744369775056839,-0.03570612519979477,-0.18356388807296753,-0.1058926060795784,0.2725977897644043,-0.236862912774086,-0.03924223408102989,-0.016642292961478233,-0.25129011273384094,-0.28306224942207336,0.07048864662647247,-0.181753471493721,0.25414150953292847,-0.2549072504043579,0.26027336716651917,0.08542028069496155,-0.2855668067932129,0.04084519296884537,0.033453568816185,0.2875543534755707,-0.031151462346315384,0.1750093400478363,-0.03748708590865135,-0.006574667990207672,0.32204410433769226,0.1339958757162094,-0.009521539323031902,0.16180391609668732,0.2447654753923416},{0.22491684556007385,-0.16243158280849457,-0.012953992933034897,-0.12196434289216995,-0.1363445520401001,0.12463643401861191,0.18940700590610504,0.36670833826065063,-0.2371697574853897,0.0588289313018322,0.028739310801029205,-0.024659553542733192,-0.2215437889099121,-0.222586527466774,-0.3237170875072479,-0.09352980554103851,0.014588825404644012,0.028384461998939514,0.2412024587392807,0.1986718773841858,0.2711879014968872,-0.07054496556520462,0.2189847230911255,-0.1262994408607483,-0.20784500241279602,0.0747009739279747,0.12991997599601746,-0.1980094164609909,-0.14966072142124176,0.22462263703346252,0.11902648210525513,-0.2460888773202896},{-0.21839644014835358,0.4287140965461731,-0.02799188531935215,-0.3007667064666748,0.2849649488925934,0.1765400916337967,-0.2468269169330597,-0.2197292447090149,-0.2745502293109894,-0.004187630955129862,-0.29083800315856934,-0.23865754902362823,-0.14604996144771576,-0.27427661418914795,0.43714824318885803,-0.3548085391521454,-0.19321148097515106,-0.1166328713297844,-0.22767016291618347,0.39058828353881836,0.1285170465707779,0.09188301861286163,0.40098077058792114,0.1364355981349945,-0.16035020351409912,0.2846013903617859,0.21170572936534882,-0.07148773968219757,-0.06719368696212769,0.04125254973769188,-0.041148241609334946,-0.22013480961322784},{-0.044271234422922134,0.03657512739300728,-0.044330235570669174,-0.011824407614767551,-0.20832905173301697,0.30805060267448425,-0.12461262196302414,0.26971450448036194,0.09091807156801224,-0.20721612870693207,-0.17701928317546844,0.026363132521510124,0.0854301005601883,0.33259284496307373,-0.016546141356229782,0.04574641212821007,-0.17675818502902985,0.03097902424633503,0.049312036484479904,-0.204848051071167,-0.051547687500715256,0.058249425143003464,-0.02433527447283268,-0.3506472110748291,-0.05851871147751808,-0.03900725767016411,0.2914571762084961,-0.09682074934244156,0.12837032973766327,0.13716894388198853,-0.06460225582122803,0.1652887761592865},{-0.04255465790629387,0.25642696022987366,-0.02893882244825363,0.2706713378429413,0.25977015495300293,-0.12031441926956177,-0.14928847551345825,0.08736883848905563,-0.08884003758430481,-0.15263545513153076,-0.015096448361873627,0.055760446935892105,-0.01904819905757904,-0.00852674338966608,-0.3531883955001831,0.19014503061771393,0.15644867718219757,-0.130192369222641,0.2516977787017822,-0.2826444208621979,0.24776655435562134,-0.2148478776216507,0.15401481091976166,-0.29506251215934753,-0.15452958643436432,0.09470385313034058,-0.08182680606842041,-0.013381194323301315,-0.1520048975944519,0.14478105306625366,-0.030028916895389557,-0.28254204988479614},{-0.16228853166103363,0.16901694238185883,0.1943231225013733,0.3616586923599243,0.10028696060180664,0.19836734235286713,0.10829285532236099,-0.1911797821521759,0.1857466995716095,0.14479701220989227,0.03529973700642586,0.10721182823181152,0.07360292971134186,-0.24642881751060486,0.21119153499603271,0.2000161111354828,0.3904676139354706,-0.03756025433540344,0.34689417481422424,0.15270496904850006,0.3179500102996826,0.30366846919059753,-0.1291123479604721,0.17872388660907745,0.0952281653881073,0.04761781543493271,0.04160122200846672,-0.019778257235884666,0.2746468484401703,-0.03923732042312622,-0.35631072521209717,-0.31707751750946045},{0.16085776686668396,-0.04911298677325249,-0.23191411793231964,-0.18768495321273804,0.24195647239685059,-0.14877261221408844,0.3527616560459137,-0.16042779386043549,0.14712266623973846,-0.07901636511087418,0.2757474184036255,-0.11711233109235764,0.2658591866493225,0.3942663073539734,-0.4710175096988678,0.33403176069259644,0.01483921892940998,-0.167114719748497,-0.2996152639389038,-0.24291005730628967,-0.11220644414424896,0.31074976921081543,0.08714175224304199,0.24878019094467163,0.11782575398683548,0.019025342538952827,0.22600510716438293,-0.14351126551628113,-0.11626015603542328,0.03241635859012604,-0.32796695828437805,0.05856550484895706},{0.27453839778900146,-0.1503298282623291,-0.10473503172397614,-0.21065445244312286,-0.018225137144327164,0.040522247552871704,-0.08906541019678116,0.1442326456308365,0.09949503093957901,-0.1484389305114746,-0.1694091409444809,0.005548151675611734,-0.38403475284576416,0.06209884583950043,-0.4903861880302429,-0.16120336949825287,0.3165810704231262,-0.1984199583530426,-0.16514351963996887,0.1578027307987213,-0.1888907104730606,0.0452486053109169,0.19731183350086212,-0.042857229709625244,0.017279809340834618,0.01689811795949936,-0.09534692764282227,0.10239140689373016,-0.14589625597000122,0.1530543863773346,0.2205151617527008,-0.37429699301719666},{0.15328706800937653,-0.08896990120410919,0.25898462533950806,0.0075004189275205135,-0.16962681710720062,-0.13590741157531738,-0.12500469386577606,-0.24356763064861298,-0.010951264761388302,0.13603144884109497,-0.09770142287015915,-0.3077147901058197,-0.08825758099555969,-0.45686256885528564,0.2937685549259186,-0.0759141817688942,-0.365291953086853,-0.23171232640743256,-0.16722966730594635,-0.009292557835578918,-0.27491751313209534,0.16036838293075562,0.3721936345100403,0.04676980897784233,-0.2994298040866852,-0.07669701427221298,0.10525064170360565,-0.18806661665439606,0.12569032609462738,-0.011969036422669888,0.09338149428367615,0.27025672793388367},{-0.1364012509584427,0.16800425946712494,0.08726438134908676,0.14894019067287445,-0.3234788477420807,0.014685522764921188,-0.01114118192344904,0.1380077302455902,0.03470270335674286,0.01872916705906391,-0.18981891870498657,-0.1713545173406601,-0.3273465931415558,0.219900980591774,-0.1716226190328598,-0.1253766417503357,0.3347974121570587,0.3394620716571808,-0.22133614122867584,-0.11729812622070312,-0.046895235776901245,0.16644138097763062,0.21357420086860657,0.33379390835762024,0.37694433331489563,-0.11990225315093994,0.02671808935701847,-0.06924591213464737,-0.07717257738113403,0.06668571382761002,0.07439064234495163,-0.33310914039611816},{-0.26187628507614136,-0.07196472585201263,-0.34332236647605896,0.00474317092448473,-0.09102677553892136,0.0795733630657196,0.0381302572786808,0.06824779510498047,0.056459132581949234,0.042336978018283844,0.26863521337509155,0.31717681884765625,-0.059058163315057755,-0.02453860640525818,0.12166003882884979,-0.09642243385314941,0.31335318088531494,0.2598906457424164,-0.3213728666305542,0.039515335112810135,0.15467895567417145,0.27124324440956116,0.2731664776802063,-0.2633354961872101,0.2864253520965576,0.10455931723117828,-0.22426936030387878,-0.10069643706083298,-0.11924513429403305,-0.0850687325000763,0.32476043701171875,0.12305692583322525},{0.15646721422672272,0.1418541967868805,0.038877930492162704,0.15402932465076447,-0.04971124604344368,0.24174034595489502,0.2430584579706192,0.12472235411405563,-0.20022578537464142,0.0043856073170900345,-0.25230708718299866,0.21026188135147095,0.2745700180530548,-0.16644585132598877,0.10397472232580185,0.27541032433509827,-0.29648077487945557,-0.2414456307888031,-0.026350075379014015,-0.28645992279052734,-0.12690803408622742,-0.16200664639472961,0.16940437257289886,-0.21479329466819763,0.1982821375131607,-0.2635223865509033,0.3244163691997528,0.322820782661438,0.15430858731269836,0.2811684012413025,0.043428804725408554,0.23929829895496368},{-0.11165392398834229,-0.03431607037782669,-0.09300990402698517,-0.15722694993019104,-0.2245441973209381,-0.1607281118631363,-0.3450920283794403,-0.3207775056362152,-0.07824544608592987,0.24140682816505432,0.05370693281292915,-0.25576144456863403,0.15625721216201782,-0.2896820604801178,0.2702774405479431,-0.4060119092464447,-0.2067456841468811,-0.2244603931903839,0.06865951418876648,0.015580473467707634,-0.1888146847486496,-0.0698620080947876,-0.09396246075630188,0.14715443551540375,-0.33082252740859985,0.16632603108882904,0.10495911538600922,0.22598490118980408,-0.2043798565864563,-0.16972626745700836,0.15037237107753754,0.008823432959616184},{-0.10391652584075928,-0.16026031970977783,-0.10135990381240845,0.03690285608172417,0.17213496565818787,-0.06321101635694504,0.037164658308029175,0.1337127536535263,-0.07406007498502731,-0.0716019719839096,0.15097124874591827,0.1485045999288559,-0.18416661024093628,0.2833253741264343,-0.1323203593492508,0.36157697439193726,-0.16644412279129028,0.3281012773513794,-0.16130398213863373,0.07768712937831879,-0.031641636043787,-0.13721925020217896,-0.3268718421459198,0.05726943537592888,-0.25664740800857544,-0.15504036843776703,-0.09022213518619537,0.317645400762558,-0.29538291692733765,-0.21657685935497284,0.14354293048381805,0.1937001496553421}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.05471610277891159,-0.17138652503490448,0.06894978880882263,0.07418609410524368},{-0.12450724095106125,0.06645787507295609,0.09039659053087234,0.046035293489694595},{-0.22068260610103607,-0.226296529173851,0.18353109061717987,-0.16263535618782043},{0.1820714920759201,-0.005206451751291752,-0.01833106204867363,-0.06557084619998932},{-0.23607607185840607,0.31225961446762085,-0.046811919659376144,-0.05104482173919678},{-0.21053461730480194,-0.2103217989206314,-0.12905505299568176,0.2899601459503174},{-0.16580000519752502,0.14671801030635834,0.15689577162265778,0.17964902520179749},{0.05246829614043236,0.32709231972694397,-0.1499178260564804,-0.04777758568525314},{0.11557916551828384,-0.26165899634361267,-0.06615976244211197,0.16427987813949585},{-0.04612584784626961,-0.15618878602981567,0.10355789214372635,-0.16524823009967804},{-0.1303236037492752,-0.223767951130867,0.2663988769054413,0.1746758222579956},{0.12676064670085907,0.06500207632780075,0.16842591762542725,0.2627556025981903},{0.1378759890794754,-0.0323394276201725,-0.08197721838951111,-0.16298998892307281},{0.2614707946777344,0.3532080352306366,0.19223053753376007,0.25469502806663513},{-0.14548088610172272,0.1736198514699936,-0.18978889286518097,-0.39657992124557495},{0.21165713667869568,0.04378659650683403,0.09856613725423813,0.04417113587260246},{0.2355329990386963,-0.07579586654901505,0.1611270010471344,0.15620125830173492},{0.01761571876704693,0.033529020845890045,-0.10544861108064651,0.2775549590587616},{0.20788076519966125,0.1375693678855896,0.034590963274240494,-0.2547023594379425},{-0.05183383449912071,-0.1805528700351715,-0.28905531764030457,-0.03651488572359085},{0.10907265543937683,0.25504070520401,0.3597087562084198,-0.19573533535003662},{-0.14939270913600922,0.04969710111618042,0.26362958550453186,0.12570719420909882},{-0.09086662530899048,-0.02273385040462017,-0.025848275050520897,0.0211598202586174},{-0.16610224545001984,-0.07562867552042007,0.22583472728729248,0.04367700219154358},{0.05516953393816948,-0.26969853043556213,0.08669877797365189,0.2833383083343506},{-0.21504345536231995,0.09018726646900177,-0.16083092987537384,0.05790112912654877},{-0.13591806590557098,-0.27660688757896423,0.25238871574401855,0.15389512479305267},{-0.12191996723413467,0.1063460037112236,0.03396952152252197,0.32669344544410706},{-0.1277865469455719,0.2789621949195862,-0.17061106860637665,0.07518886029720306},{0.096734419465065,-0.22503624856472015,-0.17992453277111053,0.04355747252702713},{-0.14282409846782684,0.12890635430812836,0.05032091215252876,-0.024741748347878456},{0.008428318426012993,-0.40838298201560974,-0.2948063910007477,-0.3112207055091858}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.014671063981950283,0.028394317254424095,-0.05998370796442032,0.02451971359550953,0.06524311006069183,0.013165543787181377,-0.04241141676902771,-0.07119531184434891,-0.0005695151048712432,-0.0505373440682888,0.013401790522038937,0.11352556943893433,0.048734262585639954,-0.054328229278326035,-0.06678351759910583,0.019644802436232567};
static const float actor_encoder_self_encoder_2_bias[16] = {0.09116124361753464,-0.029269989579916,0.05944210663437843,-0.09905705600976944,0.018393700942397118,-0.021653247997164726,0.02594180591404438,-0.01865142583847046,0.004162278492003679,0.06087310239672661,-0.02494887262582779,-0.045629214495420456,-0.02928200736641884,0.004280627705156803,-0.036287710070610046,0.012991410680115223};
static const float actor_encoder_feed_forward_0_bias[32] = {0.04013710841536522,-0.02935865707695484,-0.030057858675718307,0.027037158608436584,0.03424936532974243,-0.03955870494246483,-0.017060890793800354,-0.0251857191324234,-0.00021549046505242586,-0.05080932006239891,0.014185285195708275,0.04487768933176994,0.06287691742181778,0.06093006208539009,-0.07452327013015747,-0.0014053060440346599,0.009504597634077072,-0.03784208372235298,-0.020026007667183876,-0.023853469640016556,0.04190892353653908,0.06606806069612503,-0.0375436432659626,-0.024622414261102676,0.010219285264611244,-0.03405779227614403,0.021443791687488556,0.00543821370229125,0.010464251041412354,0.012719126418232918,-0.006750099826604128,-0.034624356776475906};
static const float action_parameterization_distribution_linear_bias[4] = {0.05385575443506241,0.0172563549131155,0.005385211668908596,0.02888435684144497};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.0841302871704102,-0.8000754117965698,0.5247766375541687,-0.46086838841438293,-0.9750980734825134,0.3105064332485199,-0.593774139881134,-0.9809686541557312},{-0.7943342924118042,-0.2987401485443115,-0.5865925550460815,0.3338859975337982,-0.5225468277931213,-1.8612197637557983,1.2282627820968628,-0.6495624780654907},{0.9745246767997742,-0.07152222096920013,0.4206361174583435,0.1291314661502838,1.1311941146850586,-0.7886872291564941,0.9646465182304382,1.3092150688171387}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.6053245067596436,0.5836572051048279,0.7296352386474609,-1.1613225936889648,-0.10619325935840607,-0.5845644474029541,-0.1439458727836609,-0.23451967537403107},{0.48728346824645996,0.3171052634716034,-0.17876671254634857,-0.5888216495513916,-0.2381131500005722,-0.8110106587409973,-0.3395104706287384,0.24110786616802216},{0.45406433939933777,0.29659226536750793,-0.19979973137378693,-0.47847071290016174,-0.21182706952095032,0.5765134692192078,-0.21297016739845276,0.3578864336013794},{0.002017104299739003,-0.48440659046173096,-0.003685393836349249,0.32323524355888367,-0.016694243997335434,-0.15732398629188538,-0.6500283479690552,0.29870811104774475},{-0.2283037304878235,0.07946684211492538,0.5870175957679749,-1.1241627931594849,0.041122857481241226,-0.14690911769866943,-0.35528379678726196,0.49892017245292664},{-0.1781129688024521,-0.054433900862932205,-0.968856930732727,-0.8518708944320679,-0.16344159841537476,-0.15873980522155762,-0.08051186800003052,-0.08057490736246109},{-0.19061237573623657,0.4022460877895355,1.1588608026504517,0.19189177453517914,-0.2379407435655594,-0.5854241251945496,-0.3769184648990631,0.44119685888290405},{0.3442052900791168,0.09569786489009857,1.1356158256530762,-1.08418869972229,0.33636990189552307,-0.5138023495674133,0.1613159030675888,0.005609612911939621}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {0.015081382356584072,-0.04514665901660919,-0.015392291359603405,-0.03569163382053375,0.004233063664287329,-0.003960886038839817,0.01757850870490074,0.018879037350416183};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {0.020138759166002274,-0.037519216537475586,-0.01107063889503479,-0.008081984706223011,-0.005881964229047298,-0.02038218080997467,0.002231520600616932,-0.0005264206556603312};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
