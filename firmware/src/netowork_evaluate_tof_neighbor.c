#include "network_evaluate_tof.h"


static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = 16; // self_structure[1][1]
static const int D_NBR = nbr_structure[1][1]; //nbr_structure[1][1]

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.16369393467903137,0.24649855494499207,0.1498042196035385,-0.12733758985996246,0.076429583132267,-0.2748132348060608,-0.0042306482791900635,-0.5647187232971191,-0.020802577957510948,-0.20034463703632355,-0.1348235309123993,0.12500280141830444,-0.26481443643569946,0.07076799869537354,0.28718531131744385,-0.16844460368156433},{-0.0017621477600187063,-0.02613005042076111,-0.02685490809381008,-0.17819944024085999,0.31457701325416565,0.11550269275903702,0.05546438321471214,-0.008485405705869198,-0.14762869477272034,0.052418794482946396,-0.15018144249916077,0.1050611212849617,0.2647419273853302,-0.0214068740606308,0.0826200544834137,-0.0887526199221611},{-0.23815737664699554,-0.328230082988739,0.30143800377845764,-0.08033916354179382,-0.14859820902347565,0.3633114993572235,-0.48938557505607605,0.3866988718509674,-0.4364524483680725,-0.46677061915397644,-0.2960025370121002,-0.3474113345146179,-0.3210825026035309,0.08611083030700684,-0.42843854427337646,-0.47131481766700745},{-0.34633582830429077,-0.07397580146789551,-0.0019654061179608107,0.16892658174037933,0.13738791644573212,0.006888215895742178,0.25656333565711975,-0.1703261435031891,-0.14853914082050323,0.0010455206502228975,-0.3126145303249359,-0.052290115505456924,-0.14248980581760406,0.4078032374382019,-0.2380174845457077,0.03865077719092369},{0.06279012560844421,-0.04316262900829315,0.12689153850078583,-0.296737939119339,0.3736693859100342,0.44241786003112793,-0.08452465385198593,-0.09035056829452515,0.010611000470817089,0.3187316954135895,0.032925527542829514,-0.01786973513662815,0.22475795447826385,0.0036868725437670946,-0.2182183414697647,-0.26901760697364807},{0.08422238379716873,0.12380420416593552,0.15722475945949554,-0.11708023399114609,-0.16095992922782898,-0.0637534111738205,-0.168112114071846,0.11414003372192383,-0.1735038012266159,0.19325542449951172,-0.20587998628616333,-0.29634568095207214,-0.10586249083280563,0.03710167855024338,-0.22716893255710602,0.02483006939291954},{-0.32227346301078796,-0.4645187258720398,0.06235311180353165,-0.26148849725723267,-0.337338924407959,-0.13758650422096252,0.25285905599594116,0.37540343403816223,-0.6613548994064331,-0.06853614002466202,-0.09622485935688019,0.08407283574342728,-0.4029899835586548,-0.07299690693616867,0.30803272128105164,0.06415525823831558},{-0.1236724928021431,0.6049595475196838,0.42281094193458557,0.2896099090576172,-0.2843490540981293,0.23276300728321075,0.5097835659980774,0.7041144371032715,0.12259135395288467,0.04321962222456932,0.10798156261444092,0.15170730650424957,-0.15825441479682922,-0.5306130647659302,0.2637806236743927,0.4532465636730194},{-0.47342127561569214,-0.006413149181753397,0.1964026540517807,-0.16380563378334045,0.06440617144107819,0.1540534496307373,0.13293831050395966,-0.23031292855739594,-0.24746844172477722,-0.4251502454280853,-0.023689666762948036,0.2751995921134949,0.042472369968891144,0.3320343494415283,0.21909643709659576,-0.18831495940685272},{0.7296810150146484,-0.14485780894756317,-0.6481409668922424,-0.19916985929012299,0.22176764905452728,0.03521086275577545,-0.6576108932495117,-0.7967222332954407,-0.561396598815918,0.4045022130012512,0.09648561477661133,0.4209933280944824,-0.5964889526367188,0.5744258165359497,-0.6634438633918762,-0.08334306627511978},{0.4359820783138275,-0.25409263372421265,-0.03660907223820686,0.3577921986579895,-0.3644973635673523,0.22237694263458252,0.3244849145412445,0.35696107149124146,-0.4228726029396057,-0.3219026029109955,-0.4133206605911255,0.3287544250488281,-0.22817252576351166,-0.2901678681373596,-0.20719563961029053,0.1845872849225998},{0.2048751413822174,-0.2871996760368347,-0.21021196246147156,-0.6385760307312012,0.3854224681854248,0.00899024773389101,-0.16626562178134918,-0.36682620644569397,-0.35325369238853455,-0.5437915921211243,-0.537379801273346,-0.27432385087013245,0.11048845201730728,-0.30222901701927185,0.46448493003845215,0.3557405173778534},{0.08303824067115784,-0.5691426396369934,-0.37341564893722534,0.07940243184566498,0.24052976071834564,0.1686204969882965,0.2993052899837494,-0.38256600499153137,0.13196688890457153,-0.44767382740974426,0.05549169331789017,-0.3193618953227997,0.4773152470588684,-0.84719318151474,-0.17604555189609528,-0.06336387246847153},{0.0355827733874321,-0.27540308237075806,-0.5445617437362671,0.6535285711288452,-0.21031524240970612,-0.011424867436289787,-0.04850297048687935,-0.06588650494813919,-0.0810980275273323,-0.2546965777873993,0.23402109742164612,-0.063776895403862,-0.502459704875946,0.00422087823972106,0.3154314458370209,-0.542232096195221},{-0.16856274008750916,0.022177966311573982,-0.25825828313827515,0.25285208225250244,0.38504940271377563,-0.30099058151245117,0.2878601551055908,0.2657763659954071,-0.2645694315433502,0.05471833795309067,0.22421583533287048,0.08816790580749512,-0.1869215965270996,-0.4260508716106415,0.14677418768405914,0.17709313333034515},{-0.24769088625907898,0.12488766014575958,-0.1654602438211441,0.26045703887939453,-0.04567640647292137,-0.28163546323776245,0.20452159643173218,0.13943026959896088,-0.0028618816286325455,-0.12054387480020523,0.004698467906564474,-0.035692282021045685,-0.2239464372396469,-0.133965402841568,-0.24152125418186188,-0.21432602405548096},{-0.21553905308246613,0.12842893600463867,0.053270887583494186,0.0025817181449383497,-0.3594743013381958,0.10556813329458237,-0.1923423558473587,0.12219143658876419,-0.24662117660045624,0.074065662920475,-0.030355755239725113,0.2816396951675415,0.1781027615070343,0.26169952750205994,0.3635823428630829,-0.2659842073917389},{0.19757820665836334,-0.22990551590919495,-0.1589362770318985,-0.03831607848405838,-0.3267943263053894,-0.2951141595840454,-0.32111504673957825,-0.2125391811132431,-0.15735891461372375,0.008165379986166954,-0.3455456793308258,0.025464922189712524,-0.03085743635892868,0.21763816475868225,-0.12054231017827988,-0.339697003364563}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.14152249693870544,0.24806825816631317,0.031556617468595505,0.4683593511581421,0.13311822712421417,-0.09978644549846649,-0.18030394613742828,-0.35979771614074707,-0.05515575408935547,-0.10019644349813461,0.22697123885154724,0.0459078848361969,0.3379007875919342,0.0790199488401413,-0.4187484681606293,-0.3302393853664398},{-0.24481377005577087,0.23474374413490295,-0.22003556787967682,-0.0511794351041317,0.13082736730575562,0.0016409773379564285,-0.43725425004959106,0.09471720457077026,0.28223875164985657,0.1213190108537674,-0.012578820809721947,-0.002322002314031124,-0.20508432388305664,-0.08633199334144592,-0.3316384255886078,-0.06859953701496124},{0.5390359163284302,0.3837018609046936,-0.38120701909065247,-0.5885622501373291,0.2832760810852051,-0.2990962266921997,-0.541497528553009,0.2582518458366394,0.335434228181839,-0.28653424978256226,0.2133871465921402,-0.3511604964733124,-0.15878798067569733,-0.1667938232421875,0.469000905752182,0.44353294372558594},{0.2658267021179199,-0.12581881880760193,-0.2775276005268097,0.31904879212379456,-0.22302648425102234,0.23131828010082245,0.07325944304466248,-0.0924919992685318,-0.0982297882437706,0.2837756276130676,0.32655179500579834,-0.44557565450668335,0.13688711822032928,-0.24734440445899963,-0.3815706968307495,-0.012910988181829453},{0.08110830187797546,0.24643273651599884,-0.005168714560568333,-0.059460658580064774,0.051782213151454926,0.024580510333180428,-0.18660306930541992,0.20037174224853516,-0.17910777032375336,-0.34634265303611755,-0.3272801339626312,0.22037255764007568,0.23158474266529083,-0.10574875771999359,0.2446880340576172,0.04523169621825218},{0.36764606833457947,0.07338378578424454,-0.23521655797958374,-0.11614755541086197,0.1770073026418686,0.24907591938972473,-0.18372295796871185,-0.3312376141548157,-0.10468408465385437,0.1879674345254898,-0.09559306502342224,-0.021702293306589127,-0.2648423910140991,0.3403207063674927,0.13320057094097137,-0.14120538532733917},{0.2455054074525833,-0.34543517231941223,-0.3847352862358093,-0.2750760018825531,-0.0020841783843934536,0.27740731835365295,-0.36386483907699585,0.02523430436849594,0.15207456052303314,0.12476355582475662,-0.03012985736131668,0.3258723020553589,0.2864779531955719,-0.13354477286338806,0.2301696538925171,0.25918421149253845},{-0.31499093770980835,0.3380576968193054,-0.09721965342760086,0.4061814546585083,-0.010715890675783157,0.06666674464941025,0.4100794494152069,0.4110778570175171,-0.10424789041280746,-0.23331981897354126,0.33727601170539856,-0.40175682306289673,-0.0865463986992836,-0.20928333699703217,-0.2469489872455597,-0.09650253504514694},{-0.0016137431375682354,-0.3237776458263397,-0.026785554364323616,0.16225294768810272,0.11222510784864426,0.224225252866745,0.00820990465581417,0.4395800828933716,0.05758785083889961,0.20322836935520172,-0.29629459977149963,-0.15155257284641266,0.23961995542049408,-0.4195317327976227,0.2808643579483032,0.03508017584681511},{-0.0814039409160614,-0.07035358250141144,-0.1745053082704544,0.24327518045902252,-0.32425493001937866,0.003377102082595229,0.31377971172332764,0.21744418144226074,0.17429734766483307,-0.21045011281967163,-0.17199502885341644,0.01588987000286579,-0.18836615979671478,0.050482846796512604,-0.395242303609848,-0.05829176306724548},{-0.11592859029769897,-0.1598469316959381,0.14167049527168274,0.26891642808914185,-0.17768466472625732,-0.21719276905059814,0.3245123624801636,-0.10582444071769714,-0.16368696093559265,0.03012506663799286,-0.05189765617251396,-0.316793829202652,-0.3521755039691925,-0.5222471952438354,-0.3312831521034241,-0.021708181127905846},{-0.01521138846874237,-0.5035139918327332,0.30419808626174927,-0.13798817992210388,0.07840018719434738,0.09196647256612778,-0.33656999468803406,-0.2533022463321686,0.19500480592250824,0.15915846824645996,-0.48696476221084595,0.3773185908794403,-0.21528629958629608,-0.10556824505329132,0.2041611224412918,0.08914770185947418},{-0.14422117173671722,0.07187442481517792,-0.3371965289115906,0.13837572932243347,0.15244844555854797,0.07840991765260696,0.3088182806968689,-0.2572590112686157,-0.14882023632526398,-0.09449449926614761,-0.37320902943611145,0.4106679856777191,0.40897107124328613,0.17669463157653809,0.043206192553043365,0.2743743360042572},{-0.35754120349884033,-0.029666200280189514,0.2720613181591034,-0.35888826847076416,0.41331684589385986,-0.5179271101951599,-0.12890130281448364,-0.17297521233558655,0.26894381642341614,0.20779739320278168,0.304212361574173,0.36369189620018005,-0.19568562507629395,-0.2246360033750534,-0.26347628235816956,0.23222723603248596},{-0.11116264760494232,-0.1908448338508606,-0.2977338135242462,0.20238803327083588,-0.06910296529531479,0.45588257908821106,0.2567918300628662,0.2974170446395874,0.20424611866474152,0.025748807936906815,-0.18714550137519836,-0.18278805911540985,0.24589979648590088,0.13711880147457123,-0.005736176390200853,0.18406957387924194},{-0.1541413962841034,0.2620908319950104,-0.0870954841375351,-0.21888819336891174,0.06453358381986618,0.016945090144872665,0.14310617744922638,0.21466651558876038,-0.1513424515724182,-0.12466755509376526,-0.17902688682079315,0.2660283148288727,0.10444800555706024,-0.2333664447069168,-0.3449496626853943,0.06607558578252792}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.06988851726055145,0.017830505967140198,0.02523704245686531,0.1918056309223175,0.36993488669395447,-0.08085288852453232,-0.12916253507137299,0.05114641413092613,-0.22452151775360107,-0.07089731097221375,-0.0005071315681561828,0.19811686873435974,0.25274163484573364,-0.07112696021795273,0.22623196244239807,0.07272332906723022,0.19643084704875946,0.06039289012551308,0.02445872686803341,0.01314430870115757,0.25780367851257324,-0.22756792604923248,-0.27228447794914246,-0.27872538566589355,-0.12601909041404724,0.13343048095703125,-0.28325381875038147,-0.21288220584392548,0.20277050137519836,-0.13849171996116638,-0.2657356560230255,-0.16866551339626312},{0.24525174498558044,0.08355190604925156,0.27052581310272217,0.3180296719074249,0.41391605138778687,-0.013391626067459583,0.16339237987995148,-0.3536025285720825,0.1708947718143463,0.11077534407377243,-0.07410585135221481,-0.28998345136642456,-0.18084217607975006,-0.10312598943710327,-0.3032456338405609,0.3761156499385834,0.19171343743801117,-0.2779744565486908,0.1460902988910675,0.1288752406835556,0.007027689833194017,0.23875699937343597,-0.22389644384384155,0.16477954387664795,0.06904353201389313,-0.3861573338508606,-0.2189038246870041,0.3714197874069214,-0.2163955569267273,0.04049234837293625,0.23713554441928864,-0.10601627081632614},{0.2116129845380783,-0.030531635507941246,-0.16947153210639954,-0.25837472081184387,-0.28770211338996887,-0.1543770134449005,-0.3334721028804779,0.0898566022515297,-0.3998435437679291,-0.14719104766845703,0.09995894879102707,0.32143232226371765,0.1177443340420723,-0.09496137499809265,-0.2029803991317749,0.09988798201084137,0.2977631688117981,-0.19666863977909088,-0.17858536541461945,0.2716556787490845,-0.24947017431259155,-0.0756533071398735,0.0025683820713311434,-0.09060103446245193,-0.04287230968475342,0.3894474506378174,-0.32902318239212036,0.2645883560180664,-0.46741119027137756,-0.11031097918748856,0.04476074501872063,0.05194879695773125},{0.2289775013923645,-0.31854379177093506,-0.09389078617095947,0.1831270158290863,0.1124323159456253,-0.17727167904376984,0.29809820652008057,0.07767970860004425,0.11897709220647812,-0.04810069873929024,0.03746462240815163,-0.05353748798370361,0.3117952048778534,0.18237607181072235,-0.18383373320102692,-0.179468035697937,-0.16064921021461487,0.14867118000984192,0.1809200495481491,-0.014506757259368896,0.01061717327684164,0.3515114188194275,-0.06473299860954285,-0.2053452581167221,0.06327837705612183,0.13451342284679413,0.12562315165996552,0.05361991748213768,-0.3669589161872864,-0.33538252115249634,0.11862517893314362,0.18075768649578094},{-0.040403977036476135,0.1625332087278366,0.03563731163740158,0.0439191609621048,0.09449762105941772,0.24987702071666718,0.18731215596199036,-0.13894671201705933,-0.055951375514268875,0.05258499085903168,-0.12843208014965057,0.023471849039196968,-0.22201529145240784,0.18931177258491516,0.02869138866662979,0.26037055253982544,0.06983549892902374,0.007435408886522055,0.06533235311508179,0.08522088080644608,0.1616361141204834,-0.05220630392432213,-0.25530189275741577,-0.22108763456344604,0.05107594281435013,0.14414338767528534,0.13657315075397491,0.007526134140789509,0.1756897270679474,-0.16811078786849976,-0.23655380308628082,0.2701184153556824},{-0.2589533030986786,0.23382647335529327,0.0014212816022336483,-0.06166640296578407,-0.3434440791606903,-0.2652691900730133,-0.1182495728135109,0.08383279293775558,0.23846355080604553,-0.1627366840839386,0.09680529683828354,-0.35976195335388184,-0.10820170491933823,0.0495222732424736,0.1054043248295784,-0.15196065604686737,-0.18944761157035828,0.035053033381700516,0.11701277643442154,-0.3504948019981384,0.2096559852361679,-0.052173200994729996,0.025832723826169968,-0.14856621623039246,0.1883520483970642,0.08146166801452637,0.011633723974227905,0.07146526873111725,0.0750112235546112,-0.052874691784381866,-0.3121631443500519,-0.22323647141456604},{0.03670710325241089,-0.034181952476501465,0.06831235438585281,-0.18981464207172394,-0.22293983399868011,0.1117912232875824,-0.2339046746492386,-0.07705051451921463,-0.12452864646911621,0.22376222908496857,-0.21975652873516083,0.04212310537695885,0.25829431414604187,0.06831295043230057,-0.2796047329902649,-0.1256292164325714,0.010079413652420044,0.15348327159881592,0.11305791139602661,0.2154260277748108,-0.23300614953041077,0.15829546749591827,-0.00023176796094048768,0.09273602068424225,0.24910908937454224,-0.15910392999649048,-0.025672348216176033,0.2638649344444275,0.050722699612379074,-0.25621700286865234,-0.2976895868778229,0.23289549350738525},{0.0758940726518631,0.22172245383262634,0.11587121337652206,0.10390318185091019,-0.17523951828479767,-0.3390587866306305,0.16876372694969177,-0.24399901926517487,-0.08318305015563965,-0.21867211163043976,0.2420138269662857,-0.07190274447202682,-0.06233055889606476,-0.077507883310318,0.25055813789367676,0.10397597402334213,0.07780630886554718,-0.04153739660978317,-0.32332223653793335,0.108926922082901,-0.3095988929271698,-0.04927382990717888,-0.22003282606601715,0.18445391952991486,0.04175126180052757,-0.01692044734954834,0.18001987040042877,0.010011674836277962,0.04864250868558884,-0.18784137070178986,-0.17458905279636383,0.2580728232860565},{0.1698753982782364,0.38515225052833557,-0.16042417287826538,0.29013702273368835,0.003738138824701309,0.10134123265743256,0.4608323872089386,-0.31627678871154785,-0.03822551667690277,-0.11106079816818237,0.1983916461467743,-0.13355882465839386,-0.016804523766040802,0.25423941016197205,-0.10708453506231308,0.23832902312278748,0.23129314184188843,0.2601377069950104,0.19811448454856873,0.16112345457077026,-0.2599843144416809,-0.18028785288333893,0.07518164813518524,0.20046256482601166,0.1250264048576355,0.28587430715560913,-0.32552552223205566,-0.3625577688217163,-0.06584419310092926,0.2266620248556137,0.01414506882429123,0.1789809912443161},{0.06922779977321625,0.02001894637942314,0.009700361639261246,-0.2669867277145386,-0.11070092022418976,-0.2904696464538574,0.1471315622329712,0.324667751789093,-0.22271884977817535,-0.3136202096939087,0.09334998577833176,-0.09127533435821533,0.01044812984764576,0.09770996868610382,-0.1956041157245636,0.24907782673835754,0.0058230445720255375,-0.2812142074108124,0.2056274712085724,0.02848336286842823,0.16934436559677124,-0.2937804162502289,0.27342623472213745,-0.08732763677835464,0.15938319265842438,0.2796162962913513,0.30280178785324097,0.22749698162078857,-0.1269592046737671,0.2276197224855423,0.0122241685166955,-0.021950239315629005},{0.18930675089359283,0.03928025811910629,0.3293009400367737,-0.3251538872718811,0.18423348665237427,-0.155992329120636,-0.1562548726797104,-0.2681157886981964,0.032765913754701614,0.3869113028049469,0.15916351974010468,-0.02473503351211548,0.10743685066699982,0.16230244934558868,-0.0058684884570539,0.31158825755119324,-0.05257630720734596,-0.2992091476917267,-0.10165205597877502,-0.0032147441525012255,-0.17588165402412415,0.12663710117340088,0.016013363376259804,-0.2286461889743805,-0.12199269980192184,-0.19490347802639008,-0.17796263098716736,0.05879773199558258,-0.2018163502216339,0.0016711291391402483,0.33495375514030457,0.3731774091720581},{0.24361081421375275,0.055413417518138885,-0.16207076609134674,-0.3539700210094452,-0.1882648468017578,-0.2753581702709198,0.2074400931596756,0.07321270555257797,-0.16989339888095856,0.24454697966575623,-0.34201952815055847,-0.07887866348028183,-0.12121503800153732,-0.1315796971321106,-0.09020917862653732,-0.21031257510185242,-0.37034904956817627,-0.2987775504589081,0.10617918521165848,0.18423771858215332,-0.046830642968416214,0.34689319133758545,-0.17873406410217285,-0.10806694626808167,0.17164407670497894,0.3103775680065155,0.20569103956222534,-0.15667498111724854,-0.15073131024837494,-0.27043184638023376,-0.271541565656662,0.14127768576145172},{-0.06466303020715714,-0.07557711750268936,-0.1775929480791092,0.04104135185480118,0.24714477360248566,-0.10884744673967361,0.18999812006950378,0.33498212695121765,0.14984183013439178,0.2735873758792877,-0.11725210398435593,-0.2962981164455414,0.07692087441682816,0.10868534445762634,0.2056504637002945,0.19435374438762665,-0.36572501063346863,-0.18697060644626617,-0.16905547678470612,0.2165840119123459,-0.07875971496105194,-0.3413800299167633,-0.26768311858177185,-0.11044564098119736,0.15985172986984253,0.2752264738082886,0.2500205934047699,0.10033048689365387,-0.14922095835208893,-0.13674475252628326,0.12191507965326309,-0.18482311069965363},{0.28051328659057617,-0.05945940315723419,-0.30417463183403015,-0.08348571509122849,0.01644701510667801,0.06313542276620865,-0.039252907037734985,-0.048969950526952744,0.15556283295154572,0.3247269093990326,-0.347553551197052,0.24824292957782745,0.18530869483947754,-0.23703397810459137,0.05963894724845886,-0.24341464042663574,-0.11147168278694153,0.17596326768398285,-0.14116992056369781,0.34092840552330017,0.1388150304555893,-0.15546272695064545,-0.2127685546875,-0.12798692286014557,-0.3274248540401459,0.10246007144451141,-0.014186578802764416,0.20834755897521973,-0.025067714974284172,0.1281411498785019,0.32392069697380066,-0.19921152293682098},{0.19916237890720367,-0.19483321905136108,0.14914050698280334,-0.10116655379533768,-0.2443307340145111,-0.22832542657852173,0.17232145369052887,-0.2486860752105713,0.18176260590553284,0.1690012812614441,-0.15182459354400635,0.11844523996114731,-0.022660668939352036,0.07300250232219696,-0.1114402487874031,-0.060911860316991806,0.09200417250394821,-0.10829868167638779,-0.03414295241236687,-0.1744922250509262,0.02968676947057247,-0.26168668270111084,-0.15197531878948212,-0.3734080493450165,0.024794772267341614,-0.18781116604804993,0.07806844264268875,0.14003600180149078,0.1752227395772934,0.0871550664305687,0.04849255457520485,0.0261402428150177},{0.2034856528043747,-0.14179523289203644,-0.2565672695636749,0.2692212462425232,-0.1607527881860733,0.07914998382329941,0.3353707790374756,-0.2937021553516388,-0.043787360191345215,-0.3351942300796509,-0.2108166217803955,-0.3496803343296051,-0.23841921985149384,-0.2565452456474304,0.07904687523841858,0.3672948181629181,0.29521721601486206,-0.1950429230928421,0.07885535806417465,-0.10007178783416748,-0.11652927100658417,-0.12557533383369446,-0.23645055294036865,0.2288873940706253,-0.12434479594230652,-0.08350604772567749,-0.11928035318851471,-0.13044334948062897,-0.1633462756872177,-0.11851871758699417,-0.1920199692249298,-0.20679894089698792},{0.2722507119178772,0.4530028700828552,-0.2085149586200714,-0.14991261065006256,-0.0646551102399826,0.4138428270816803,0.33642786741256714,0.10757610201835632,-0.061783745884895325,-0.27589166164398193,0.015353181399405003,0.20793402194976807,-0.06837859004735947,0.012890572659671307,0.14571313560009003,0.10415995121002197,-0.18264904618263245,-0.03703015297651291,-0.23660287261009216,-0.17439359426498413,-0.05669303983449936,0.03266645967960358,-0.05994672700762749,-0.2767399549484253,-0.14471642673015594,0.1279553920030594,0.06592544913291931,-0.18772026896476746,0.09590736031532288,-0.17428429424762726,0.304364413022995,-0.17376300692558289},{-0.3182680010795593,-0.11428710073232651,0.15543954074382782,0.035422176122665405,0.23092009127140045,0.1437835693359375,0.19011664390563965,-0.2850997745990753,0.009564968757331371,0.1255350410938263,0.23549377918243408,0.17087550461292267,-0.17808905243873596,0.006124069914221764,-0.27803483605384827,-0.18075311183929443,0.2553926110267639,-0.07996222376823425,0.017215434461832047,0.09526105970144272,0.2590550184249878,0.24036338925361633,0.02547823078930378,-0.3090122938156128,0.011506805196404457,-0.0066574737429618835,0.3044126331806183,0.26217737793922424,0.008054476231336594,-0.16986386477947235,0.1282183676958084,0.1921224147081375},{0.2229529172182083,-0.15575702488422394,-0.1574302464723587,0.002927180612459779,-0.04544959217309952,0.27265220880508423,-0.2828274667263031,0.13409440219402313,-0.35618525743484497,-0.2822726368904114,0.19824516773223877,-0.04162056744098663,-0.05122017860412598,-0.17502841353416443,-0.044442545622587204,-0.09016227722167969,0.17798814177513123,0.03305541351437569,-0.07101721316576004,0.1780177503824234,0.08703608810901642,-0.09509852528572083,0.12071049213409424,0.2588762640953064,0.09941034018993378,-0.3428833484649658,-0.11035149544477463,0.12661705911159515,-0.11205010116100311,-0.06214484944939613,0.13194812834262848,0.17321230471134186},{0.32080718874931335,0.2092326283454895,0.17031437158584595,-0.06508972495794296,-0.2578951418399811,0.08650321513414383,-0.15525321662425995,0.16893351078033447,0.0917019322514534,0.056262411177158356,-0.08370356261730194,0.0929165855050087,0.17540889978408813,0.20544224977493286,-0.07784516364336014,-0.26260510087013245,-0.31363236904144287,0.32452720403671265,0.3637140989303589,-0.31023213267326355,-0.22955363988876343,0.2798265218734741,0.1945900022983551,-0.20371104776859283,0.16015057265758514,0.008885825984179974,0.29139775037765503,0.10596615076065063,0.140827476978302,0.018551994115114212,-0.2090235948562622,0.1941566914319992},{-0.38428017497062683,-0.010817845351994038,-0.18422304093837738,-0.07863982021808624,-0.10465778410434723,-0.2183198779821396,0.002992698224261403,-0.0212674830108881,-0.14037980139255524,0.17248857021331787,0.24532246589660645,-0.03395181521773338,0.06790546327829361,-0.32451459765434265,-0.2371496558189392,0.09715711325407028,-0.2631770670413971,0.003750678151845932,-0.20862038433551788,-0.025644954293966293,-0.017048362642526627,0.16987626254558563,0.24900537729263306,-0.014877337031066418,-0.13998864591121674,-0.05725922808051109,0.05485179275274277,0.18088458478450775,0.049975428730249405,-0.22991350293159485,-0.10825365781784058,-0.041373319923877716},{0.015174082480370998,0.3022330701351166,0.04851396754384041,0.1399492770433426,0.16625985503196716,0.0964740440249443,0.10244466364383698,0.14663586020469666,-0.3397849202156067,0.06830635666847229,-0.07180969417095184,0.1529061198234558,-0.20500005781650543,0.468082994222641,-0.013370329514145851,-0.0021902741864323616,0.11656958609819412,0.08096859604120255,-0.040551166981458664,0.24343474209308624,-0.2872892916202545,0.08200165629386902,-0.037762079387903214,0.2350274622440338,0.1233174204826355,0.07189478725194931,0.1720752865076065,-0.12461258471012115,0.26726800203323364,0.2742798626422882,-0.14395062625408173,-0.14662733674049377},{-0.23962292075157166,0.32020673155784607,0.04416045546531677,0.024833591654896736,-0.22102634608745575,0.2580590844154358,-0.0006505289929918945,0.09515903145074844,0.060476720333099365,-0.3089536130428314,-0.11105522513389587,-0.287208616733551,-0.12439286708831787,0.12092674523591995,0.012173398397862911,-0.20528125762939453,0.11958753317594528,0.10598475486040115,0.27992793917655945,0.14045017957687378,-0.18718940019607544,-0.3217983543872833,-0.1023227870464325,0.31631794571876526,0.3706035315990448,0.20591995120048523,0.10038071125745773,-0.03325589373707771,0.025521086528897285,0.04137081652879715,-0.3204023540019989,0.22253009676933289},{-0.07416705042123795,-0.04579104483127594,-0.12064993381500244,-0.26021909713745117,0.050925079733133316,0.13977406919002533,0.15726487338542938,0.011275272816419601,0.24131757020950317,0.0822695642709732,0.1477459818124771,-0.16712996363639832,-0.015242941677570343,-0.012307446449995041,-0.3261716961860657,-0.11224144697189331,-0.28737306594848633,-0.19356034696102142,-0.1340501457452774,-0.3215717375278473,-0.0783761590719223,0.11083828657865524,0.06759912520647049,0.20337527990341187,0.19135592877864838,0.054610561579465866,0.26091209053993225,-0.37671560049057007,-0.1432325690984726,-0.14340804517269135,0.02825024724006653,-0.030942458659410477}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2885560095310211,-0.05134735628962517,-0.2979961037635803,-0.20339621603488922},{0.07898696511983871,-0.1284511536359787,-0.037195589393377304,0.2560216188430786},{0.030950669199228287,0.028486641123890877,-0.1445453017950058,-0.10904575139284134},{-0.243849515914917,0.05496563762426376,0.06569238752126694,0.12282390147447586},{-0.30450624227523804,0.05733313784003258,-0.10525285452604294,-0.2591298222541809},{0.21619097888469696,-0.2141076624393463,-0.3231923282146454,0.1453103870153427},{0.12122345715761185,0.05012506991624832,-0.03190791606903076,0.3766374886035919},{0.3518599271774292,0.25753411650657654,0.11702068895101547,0.06792189925909042},{-0.32321321964263916,0.22247815132141113,0.16947996616363525,0.023334989324212074},{-0.19725795090198517,-0.20744816958904266,-0.2346959263086319,-0.271961510181427},{-0.010567710734903812,0.2642800509929657,-0.21129564940929413,-0.23748372495174408},{-0.17347106337547302,-0.2551446259021759,0.1516750007867813,0.14740091562271118},{0.21166644990444183,0.21899808943271637,-0.1287110149860382,-0.308603435754776},{0.3200710713863373,-0.06372742354869843,-0.117489293217659,0.0630776658654213},{0.3029068410396576,0.3070773780345917,-0.3837091624736786,-0.30675697326660156},{0.03299105539917946,0.11196520924568176,-0.17273497581481934,0.0430520735681057},{-0.362888902425766,-0.08160711824893951,-0.32501092553138733,-0.2967822849750519},{-0.10027451813220978,0.15096640586853027,0.10149151086807251,0.15054789185523987},{0.03450801596045494,0.29143986105918884,0.21972204744815826,0.04859743267297745},{-0.08698800951242447,-0.27504056692123413,0.09512487798929214,-0.1859564334154129},{0.10910238325595856,0.14667052030563354,-0.18046090006828308,-0.12396936863660812},{-0.16335968673229218,0.20909996330738068,0.3183867633342743,-0.20485876500606537},{0.30106663703918457,-0.01471963431686163,-0.22094538807868958,-0.10920459032058716},{0.2460380643606186,0.20922891795635223,-0.16815510392189026,-0.06383297592401505},{0.32098981738090515,0.30891677737236023,0.18730419874191284,0.08493869751691818},{0.2335181087255478,-0.27038130164146423,0.21493327617645264,-0.057812005281448364},{-0.18204820156097412,0.24274587631225586,0.26671433448791504,0.08221852779388428},{-0.13807512819766998,-0.2052633911371231,-0.08811119943857193,-0.2572665214538574},{-0.2107284516096115,0.20624834299087524,-0.2228696048259735,0.2862098813056946},{0.1188150942325592,-0.2407432496547699,-0.3502276837825775,-0.1687554270029068},{-0.024404142051935196,-0.11616065353155136,-0.0020259669981896877,0.12924233078956604},{0.06543225795030594,0.02238856628537178,-0.23378939926624298,-0.18868687748908997}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.011685848236083984,-0.06983602046966553,0.0031964315567165613,-0.04188762232661247,0.06170924752950668,0.06549721211194992,0.04309843108057976,0.048145927488803864,0.07994735985994339,0.038259804248809814,0.06828027963638306,-0.03037780523300171,-0.06647196412086487,0.0006314034690149128,-0.14965906739234924,-0.045622196048498154};
static const float actor_encoder_self_encoder_2_bias[16] = {0.03506249934434891,0.004233756102621555,0.019423093646764755,-0.02560592256486416,0.004744534846395254,0.020191578194499016,-0.005547675304114819,-0.007939213886857033,-0.017409397289156914,-0.02014872245490551,0.01815243624150753,0.005213077180087566,-0.0337430015206337,0.023563750088214874,-0.041448596864938736,-0.007860181853175163};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.01767166703939438,0.017981212586164474,0.03388289734721184,-0.013640673831105232,-0.0383329838514328,0.01747054047882557,0.014521858654916286,0.01451360248029232,0.004270975012332201,-0.03132598102092743,-0.026583777740597725,-0.000790822843555361,0.004510725848376751,-0.038136500865221024,0.02961518056690693,0.009681505151093006,-0.04418029263615608,-0.008015538565814495,0.007035228423774242,-0.02163635939359665,-0.013469478115439415,0.006177302449941635,-0.022434953600168228,0.025341318920254707,0.02330297790467739,-0.020393315702676773,0.004401514306664467,-0.031194359064102173,-0.0023786413948982954,0.002206304809078574,0.052196186035871506,-0.02625243179500103};
static const float action_parameterization_distribution_linear_bias[4] = {0.021806415170431137,0.016560479998588562,0.01659460924565792,0.02335011400282383};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.157729148864746,1.201673984527588,-0.15963779389858246,0.6769838929176331,0.8731275796890259,0.038506921380758286,0.7235926389694214,-0.8353545665740967},{0.5290329456329346,0.7042326331138611,1.5890238285064697,-0.7166821360588074,0.33011898398399353,-0.4173153340816498,0.25652965903282166,0.6653625965118408},{0.4125986099243164,0.5377739667892456,-0.761480450630188,-0.19879011809825897,-0.6230242252349854,0.41920119524002075,-1.6094895601272583,-0.00742922630161047}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.3723393976688385,-0.7688886523246765,0.16591376066207886,-0.7385220527648926,1.1206618547439575,-0.7280869483947754,0.09379734843969345,0.3761092722415924},{0.19308394193649292,-0.2617426812648773,-0.3047902286052704,-0.6462745666503906,-0.33542704582214355,0.613375186920166,-0.632925808429718,-0.52269446849823},{-0.29580575227737427,0.003918695729225874,-0.3655191659927368,-0.595352053642273,1.112484335899353,0.9782986044883728,0.610612690448761,0.17897437512874603},{-0.23545892536640167,0.4349128007888794,-0.5638079047203064,-0.07174534350633621,-1.2050608396530151,0.10741680860519409,-0.3411003351211548,0.63312828540802},{-0.783350944519043,-0.028685519471764565,0.27087560296058655,0.1401567906141281,-0.5777050852775574,0.7448049783706665,-0.0673273429274559,0.6165446639060974},{0.4656604528427124,-0.431280255317688,-0.3680761754512787,-0.18203513324260712,-0.05825771763920784,0.24778909981250763,-0.44858527183532715,-0.23711426556110382},{0.2686346471309662,-0.3643730878829956,0.12607568502426147,0.18181920051574707,-0.3636511564254761,1.0401641130447388,-0.16987444460391998,0.8896241188049316},{-0.1890324503183365,0.37093791365623474,-0.036042869091033936,-0.3118816316127777,1.0782638788223267,-0.6122227907180786,0.24750156700611115,0.14350348711013794}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.012096733786165714,0.003583791432902217,0.014351164922118187,-0.01962040178477764,0.02723405323922634,-0.002529444871470332,0.019340265542268753,0.01568540930747986};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.005851605907082558,-0.004550296347588301,-0.017952844500541687,-0.013210921548306942,0.0016815939452499151,0.045952457934617996,0.007058467250317335,0.0004890300915576518};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
