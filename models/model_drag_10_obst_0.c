
#include <random>
#include <vector>
#include <iostream>
#include <algorithm>
#include <cstring> 


typedef struct control_t_n {
	float thrust_0;
	float thrust_1;
	float thrust_2;
	float thrust_3;
} control_t_n;

void networkEvaluate(control_t_n* control_n, const float* state_array);

static const int NEIGHBORS = 0;
static const int NBR_DIM = 0; 

static const int NUM_OBSTACLES = 2; 
static const int OBST_DIM = 8;


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.09584091603755951,-0.16033822298049927,-0.11942705512046814,-0.04475502669811249,-0.10202988982200623,-0.009038555435836315,-0.3392830193042755,-0.0033508718479424715,0.07234475761651993,0.012362794019281864,-0.389339417219162,-0.16907712817192078,0.19942250847816467,-0.43637213110923767,0.25946661829948425,-0.03359505534172058},{0.29515889286994934,0.13792529702186584,-0.030445104464888573,-0.06054864078760147,0.033962447196245193,0.2694849967956543,0.0724652111530304,-0.14370398223400116,0.15446990728378296,0.03530014306306839,-0.023072490468621254,-0.11007893085479736,-0.14804701507091522,-0.3998805284500122,0.256081223487854,0.024670526385307312},{0.42740803956985474,0.2621507942676544,0.17537115514278412,-0.4234144985675812,-0.02356932871043682,-0.516909122467041,-0.11373990029096603,0.4569789469242096,0.05150860920548439,-0.5330414772033691,0.0712817907333374,0.20013438165187836,-0.13885295391082764,0.024592190980911255,0.15102078020572662,-0.17603960633277893},{-0.1854960173368454,0.0745248943567276,0.4953007996082306,0.3339396119117737,-0.15551374852657318,-0.05706805735826492,0.029333969578146935,0.05857795104384422,0.08347643911838531,0.0071093556471168995,-0.5417367219924927,-0.2846478819847107,-0.18834736943244934,-0.012090920470654964,-0.2147475779056549,0.15478169918060303},{-0.06955117732286453,0.026230767369270325,-0.02536736987531185,-0.30202949047088623,-0.19363008439540863,-0.13177774846553802,0.022467108443379402,0.1645430624485016,0.060038011521101,0.27702271938323975,-0.15231917798519135,-0.045580364763736725,-0.20459888875484467,-0.4410860538482666,0.0830099955201149,0.3500117361545563},{-0.08355119079351425,0.10049893707036972,0.2941665053367615,-0.024526294320821762,0.10080112516880035,-0.4290127158164978,0.0680193230509758,-0.3262239098548889,0.49406564235687256,-0.18739810585975647,-0.004747951868921518,0.07329939305782318,0.11538643389940262,0.302682489156723,0.1295653134584427,-0.032853659242391586},{-0.1808428019285202,-0.17343512177467346,-0.08346240967512131,-0.22030891478061676,0.2556445896625519,0.21054606139659882,0.45573848485946655,-0.016295175999403,-0.13190098106861115,-0.006166158244013786,-0.15925773978233337,-0.15546958148479462,-0.30699971318244934,0.240879625082016,0.030493702739477158,-0.37212178111076355},{0.1568378061056137,0.2300919145345688,-0.03461673483252525,0.27926358580589294,-0.2772352695465088,0.33079075813293457,-0.1629222184419632,0.09402752667665482,0.34652918577194214,-0.21553589403629303,0.41501638293266296,0.20566655695438385,0.15079571306705475,0.10689006745815277,0.38592424988746643,-0.2936736047267914},{0.05313311517238617,-0.5932149291038513,0.31813836097717285,0.153884619474411,-0.21647219359874725,-0.3675403892993927,0.207082137465477,0.18106284737586975,-0.32260018587112427,-0.051654063165187836,0.0132968220859766,-0.6285561919212341,0.22819867730140686,0.36827558279037476,0.07431641966104507,0.2536218464374542},{0.1819678395986557,0.27038341760635376,-0.505058765411377,0.13727304339408875,0.052137475460767746,0.17665915191173553,0.2270078808069229,0.28608790040016174,-0.07971608638763428,-0.036378830671310425,-0.4621615707874298,0.16352806985378265,0.3024807274341583,-0.06832750886678696,0.20373325049877167,-0.04494652897119522},{0.24724072217941284,-0.10798320174217224,0.210090771317482,-0.18568025529384613,0.2613053619861603,0.13882146775722504,0.01880008727312088,-0.08795153349637985,-0.33707690238952637,0.4305427074432373,-0.38382869958877563,0.10663352906703949,0.4502767026424408,-0.11251617223024368,-0.16191329061985016,0.28380176424980164},{0.2964315116405487,-0.2176196575164795,0.5664612054824829,-0.2609061896800995,0.11347907036542892,0.055833712220191956,-0.22734478116035461,-0.2578336000442505,0.42303526401519775,0.418908953666687,0.38618892431259155,0.0811879113316536,-0.38131895661354065,-0.28839167952537537,0.33788222074508667,0.5191078782081604},{0.14415684342384338,-0.490046888589859,-0.14771507680416107,0.2600293457508087,0.07504209131002426,0.3348182141780853,0.21342292428016663,0.18379341065883636,-0.39156854152679443,0.06533266603946686,0.004391381051391363,-0.5194253921508789,0.12479182332754135,-0.05832463130354881,-0.1784690022468567,-0.22085174918174744},{0.024461841210722923,-0.32750698924064636,0.2724246084690094,-0.20008857548236847,0.6185317635536194,0.26304659247398376,0.009190130047500134,0.14844678342342377,0.21838875114917755,-0.14910869300365448,-0.1867126226425171,-0.1889376938343048,-0.22250235080718994,-0.0032043319661170244,0.08700007945299149,-0.07292919605970383},{-0.2872561514377594,-0.07232818752527237,0.415352463722229,-0.26412227749824524,0.11386731266975403,0.3305271565914154,0.29901331663131714,0.13755634427070618,-0.13822436332702637,-0.31192582845687866,0.08064057677984238,0.1723514050245285,-0.23549571633338928,0.18749676644802094,-0.18458648025989532,-0.39561471343040466},{-0.4573359489440918,-0.16070488095283508,0.17478150129318237,0.14166715741157532,0.15345501899719238,-0.24097619950771332,0.2855548858642578,-0.304609090089798,0.27981433272361755,-0.17039698362350464,-0.08957726508378983,-0.22600024938583374,-0.21894758939743042,0.05955835059285164,-0.021587861701846123,0.1498776078224182},{0.0788426473736763,0.2281966656446457,0.0816177949309349,-0.16540329158306122,0.18637433648109436,-0.07563000917434692,-0.08819209784269333,-0.2547740340232849,0.1490776389837265,0.3505055904388428,0.1391279548406601,0.08280324935913086,-0.11708734184503555,0.24601393938064575,0.22875742614269257,0.16370895504951477},{-0.023817429319024086,0.2905985116958618,0.08315999805927277,-0.15170620381832123,-0.16864359378814697,0.20893874764442444,-0.363469660282135,-0.2567337453365326,-0.35870295763015747,-0.42874211072921753,0.18595081567764282,0.04480476304888725,-0.09678178280591965,-0.12264906615018845,0.19211018085479736,-0.1030580997467041}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.4163202941417694,-0.3432450294494629,-0.16134528815746307,0.37227243185043335,-0.3036409616470337,-0.2729862928390503,0.09625501185655594,-0.07318189740180969,0.07966241240501404,-0.3904108703136444,-0.31913524866104126,0.36449548602104187,0.31589585542678833,-0.0873367115855217,-0.18731392920017242,0.22216789424419403},{-0.12319760769605637,-0.2870899438858032,0.30752032995224,-0.1913887858390808,0.07242227345705032,0.08099737018346786,0.138032466173172,0.3139583468437195,0.28310975432395935,-0.4399115741252899,-0.3188454806804657,-0.12563474476337433,-0.275141179561615,-0.010050177574157715,0.14178937673568726,-0.15476977825164795},{0.1017523929476738,-0.3305811882019043,0.3447364866733551,-0.002474530367180705,0.25134700536727905,-0.31093961000442505,0.19225582480430603,-0.34631791710853577,-0.0243853610008955,-0.5697763562202454,0.2816697061061859,0.13811859488487244,-0.337890625,-0.27485528588294983,-0.3648756742477417,-0.06898307055234909},{0.15346623957157135,-0.25308793783187866,-0.040473997592926025,0.3509615659713745,0.0714574009180069,0.395592600107193,-0.08068060874938965,-0.1989569067955017,0.1800171434879303,-0.03548213094472885,-0.07866287976503372,0.3521144986152649,-0.1381518691778183,-0.08479724824428558,0.4169566333293915,0.1569788157939911},{-0.14171017706394196,0.010165690444409847,0.14915995299816132,0.34411224722862244,-0.14634616672992706,-0.15926074981689453,0.12748463451862335,-0.19564548134803772,0.3193930983543396,0.30012625455856323,-0.33088433742523193,-0.1925152689218521,0.06474791467189789,0.055005256086587906,-0.4554503858089447,-0.12120125442743301},{-0.2427731156349182,-0.2791683077812195,0.39200064539909363,0.06814610958099365,0.43602168560028076,0.04839733615517616,-0.08872850984334946,0.0029509926680475473,-0.27907225489616394,0.08708909153938293,0.01248083170503378,-0.1630147397518158,0.14490722119808197,-0.1709824800491333,-0.3979019522666931,-0.07839874178171158},{-0.35965925455093384,-0.048298127949237823,0.27491870522499084,0.3438297510147095,-0.2271447777748108,-0.41332709789276123,0.10405702888965607,0.028366828337311745,-0.09156402200460434,0.38314032554626465,-0.25260359048843384,-0.49866941571235657,0.09755472093820572,-0.03261223062872887,-0.369202196598053,-0.3039815127849579},{0.2754260003566742,-0.01891898550093174,-0.33239033818244934,0.1939646154642105,-0.25975605845451355,-0.2995196282863617,-0.25039660930633545,-0.023237038403749466,-0.34507933259010315,-0.014071091078221798,0.34714847803115845,0.25878652930259705,-0.32288917899131775,-0.023527570068836212,-0.4041685461997986,-0.38929033279418945},{0.15457181632518768,0.34328150749206543,-0.02778986655175686,0.3379856050014496,-0.353390634059906,-0.037761617451906204,-0.3960365355014801,0.3954477906227112,0.1398126482963562,-0.030623888596892357,0.09638279676437378,0.29075223207473755,-0.1732959747314453,-0.3073118329048157,0.1243172436952591,0.2371305227279663},{-0.2545723021030426,-0.3231586515903473,-0.2952146530151367,0.03526914492249489,0.3689148724079132,0.1858702301979065,-0.3356390595436096,-0.09967406839132309,0.1940079629421234,0.41852378845214844,-0.16896240413188934,0.03176886960864067,-0.185951828956604,-0.06838090717792511,-0.002746824873611331,-0.0462188646197319},{-0.165236696600914,0.3069503903388977,0.40016990900039673,-0.3894628584384918,0.30859100818634033,0.30491238832473755,-0.255806028842926,-0.012491452507674694,-0.22362582385540009,0.2802272140979767,0.3571809232234955,-0.104881152510643,-0.16737446188926697,-0.1459120213985443,0.19247594475746155,0.23576000332832336},{-0.38771161437034607,-0.3048396706581116,-0.08570116013288498,-0.10906617343425751,-0.02398558333516121,-0.2687571048736572,-0.14619217813014984,0.163938969373703,0.0333990603685379,-0.008992427960038185,0.05882591754198074,0.01530931331217289,-0.3399275243282318,-0.010125297121703625,0.02934107929468155,-0.00821120385080576},{0.035183899104595184,-0.32701626420021057,0.0072370776906609535,0.18017412722110748,-0.3450329303741455,0.17025090754032135,0.14984829723834991,0.29074379801750183,0.13165554404258728,0.37354445457458496,0.045321542769670486,0.2297731339931488,0.13743606209754944,-0.36540520191192627,0.007904359139502048,-0.08528922498226166},{-0.14013062417507172,0.01507730595767498,-0.3032408356666565,0.18751631677150726,-0.4642908275127411,-0.06389831006526947,-0.08161074668169022,0.33914434909820557,-0.12002316862344742,-0.2187284380197525,-0.22145377099514008,0.21052707731723785,-0.06617255508899689,-0.0021252313163131475,-0.1471177041530609,-0.42732658982276917},{0.08427870273590088,-0.18653365969657898,-0.24260574579238892,-0.3763810992240906,-0.09200248122215271,0.16590628027915955,-0.24364806711673737,0.0024374674540013075,0.38241100311279297,0.12184765189886093,0.3954075574874878,-0.07583465427160263,-0.3635369539260864,0.3210558593273163,-0.2831663489341736,0.03178180381655693},{0.08481761813163757,0.09507174044847488,0.1297408938407898,0.26839450001716614,0.3016076683998108,-0.22175748646259308,-0.11145122349262238,-0.15684592723846436,0.016213402152061462,0.23862533271312714,-0.019336119294166565,-0.23190981149673462,-0.3010402321815491,0.315997451543808,-0.30141550302505493,0.06772948801517487}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{-0.043709639459848404,-0.03652862831950188,-0.018781203776597977,0.04640355333685875,0.060246895998716354,-0.04394478350877762,-0.33612316846847534,-0.22358883917331696,0.11397529393434525,-0.2836766541004181,0.17068198323249817,-0.11706220358610153,0.19750015437602997,0.14033155143260956,0.20956283807754517,-0.1420956403017044,-0.03393833711743355,0.06265212595462799,0.33899930119514465,-0.13465198874473572,0.2169443815946579,0.07977908104658127,-0.3168735206127167,-0.0049448516219854355,-0.16004183888435364,0.19310340285301208,0.20079368352890015,-0.22932150959968567,-0.009355191141366959,0.12064985185861588,0.2306104153394699,-0.20159488916397095},{0.1379593461751938,-0.15784287452697754,-0.060954175889492035,-0.1729007363319397,-0.24917249381542206,-0.28628668189048767,0.09466005861759186,-0.05308730900287628,-0.12766054272651672,0.24650245904922485,-0.13604867458343506,0.28759530186653137,-0.34445109963417053,0.1972580850124359,-0.30420729517936707,-0.08042459189891815,0.031965337693691254,0.034250419586896896,0.20453637838363647,0.276755154132843,0.2445911169052124,-0.03577517345547676,0.24394544959068298,0.24405059218406677,-0.028010942041873932,0.039471037685871124,0.18461976945400238,0.287421315908432,0.046119820326566696,0.016206832602620125,-0.28077176213264465,-0.029719915241003036},{-0.1108904629945755,-0.0831809937953949,-0.1899111270904541,-0.13597452640533447,-0.11566715687513351,0.33490875363349915,0.023376842960715294,0.03051602467894554,0.07323560118675232,0.03430858626961708,0.053682032972574234,0.06166316568851471,-0.22135508060455322,0.068843774497509,0.23000870645046234,-0.20499375462532043,0.3285008370876312,-0.19004814326763153,-0.1765468865633011,-0.12622509896755219,0.2490273118019104,0.1710452437400818,-0.26245948672294617,-0.09327488392591476,-0.1986880898475647,-0.3369259536266327,0.24962186813354492,0.15858910977840424,0.04735346511006355,-0.022275932133197784,-0.10241475701332092,-0.04867599532008171},{-0.17241358757019043,-0.1887420266866684,-0.17179538309574127,0.23830151557922363,0.17696842551231384,-0.05879165232181549,-0.08557973802089691,-0.08423548936843872,0.07838601619005203,-0.2750528156757355,0.12729518115520477,-0.14053216576576233,0.17798864841461182,0.18696877360343933,0.2703098654747009,-0.12423665076494217,-0.20348462462425232,0.09147587418556213,0.06868699193000793,0.1890946477651596,0.17036795616149902,0.25276437401771545,-0.008266705088317394,-0.2267349809408188,0.026397084817290306,0.1680368185043335,-0.10442755371332169,-0.2818981111049652,-0.11397215723991394,0.013828073628246784,-0.20613108575344086,-0.2950039207935333},{0.08358500152826309,0.2616864740848541,-0.04615473374724388,0.02343536540865898,0.25028979778289795,-0.23296725749969482,0.24577638506889343,0.13739392161369324,0.056992631405591965,-0.057816676795482635,0.2707580626010895,-0.372580885887146,0.09554855525493622,-0.04231184720993042,-0.1982574611902237,0.16464518010616302,-0.3137606382369995,0.25525182485580444,0.14154262840747833,-0.1299239546060562,-0.11413994431495667,0.13768860697746277,0.23150235414505005,-0.039488814771175385,0.1420556902885437,-0.04615596681833267,0.29582229256629944,0.058993905782699585,0.07130984961986542,0.30185389518737793,0.04839981347322464,0.047214388847351074},{-0.26485756039619446,0.18320578336715698,-0.2202541083097458,0.22378967702388763,0.3594815135002136,-0.3726729452610016,-0.34833472967147827,0.30222731828689575,0.18179018795490265,0.026043709367513657,-0.22896802425384521,-0.0822920948266983,-0.1140328049659729,0.19626103341579437,0.024470224976539612,-0.1562667340040207,-0.2894401252269745,-0.21602050960063934,-0.16681694984436035,0.05239393189549446,0.026565006002783775,0.2912954092025757,-0.026923635974526405,-0.12245321273803711,-0.02029767446219921,-0.06793447583913803,-0.09814707189798355,0.0652996078133583,0.2122417390346527,0.1422017514705658,-0.06559700518846512,0.3440946042537689},{-0.29054078459739685,0.25892388820648193,-0.15622861683368683,0.16447928547859192,-0.1472240686416626,-0.17655262351036072,-0.18741151690483093,-0.0332271046936512,0.010062910616397858,-0.0033594556152820587,0.4016554057598114,-0.26130491495132446,-0.13984262943267822,0.06473046541213989,-0.2093230038881302,-0.20577000081539154,0.2636593282222748,-0.2434520125389099,-0.1488943248987198,-0.2624675929546356,0.31199029088020325,-0.3808097839355469,-0.19241252541542053,0.1701679527759552,0.19045954942703247,0.19410036504268646,-0.13636642694473267,0.12473494559526443,-0.1334373652935028,-0.10457074642181396,-0.14135628938674927,0.10085778683423996},{-0.3504904806613922,-0.09065588563680649,-0.1474597007036209,-0.06960728764533997,0.003607753198593855,0.11237853020429611,0.26328226923942566,0.17271773517131805,-0.1009877547621727,-0.2971838414669037,-0.136263906955719,0.09505832195281982,-0.29283398389816284,0.20410864055156708,-0.04128808155655861,0.2701937258243561,-0.2429484724998474,-0.3387065827846527,-0.24078874289989471,-0.039801422506570816,0.14857004582881927,-0.2583466172218323,-0.3151261508464813,-0.06292517483234406,-0.21752320230007172,0.018233513459563255,0.17868949472904205,0.03978566452860832,-0.3612847924232483,-0.19477471709251404,0.27892348170280457,-0.14496123790740967},{-0.10865330696105957,0.033311739563941956,-0.004065400920808315,0.00821883324533701,-0.23857033252716064,-0.15360726416110992,0.20381858944892883,-0.01073565986007452,0.1928935945034027,0.1326017677783966,0.1629454791545868,0.2870446741580963,-0.31353864073753357,0.006442681886255741,0.021041905507445335,0.08751895278692245,-0.12617506086826324,0.08340255171060562,0.11097940802574158,0.25372639298439026,-0.10369566828012466,0.00599554693326354,-0.00031943971407599747,0.18178075551986694,-0.06579465419054031,-0.16500785946846008,0.2743707597255707,0.051683321595191956,0.08017777651548386,0.08521883934736252,0.08811331540346146,0.2372169941663742},{-0.2732478380203247,0.06957997381687164,-0.21357843279838562,-0.23278887569904327,0.04577374458312988,-0.19835960865020752,0.2974395453929901,0.19886523485183716,0.17910295724868774,-0.0531451478600502,-0.21156705915927887,-0.3229876160621643,-0.02397122047841549,-0.330372154712677,0.11572631448507309,0.2305239588022232,0.19171011447906494,-0.10718050599098206,0.03684411942958832,-0.3438953459262848,0.35205814242362976,0.2505398392677307,-0.11267626285552979,0.13907018303871155,-0.1903785914182663,0.13743194937705994,-0.31071507930755615,0.07422693818807602,0.022528337314724922,-0.1794624775648117,-0.3259888291358948,-0.12642139196395874},{0.21350623667240143,-0.1975785344839096,0.14166998863220215,0.3296286463737488,-0.1652311384677887,-0.18718278408050537,-0.13442714512348175,0.16694603860378265,0.10681775957345963,0.3380451798439026,-0.27517956495285034,0.1362367868423462,0.22945842146873474,-0.03239600732922554,-0.09066259115934372,0.23859959840774536,-0.1740766316652298,-0.1428423672914505,0.18828362226486206,0.21225644648075104,-0.24397176504135132,-0.04019559547305107,0.08609731495380402,0.20509012043476105,0.28333285450935364,-0.13307230174541473,0.2453739494085312,-0.31216153502464294,-0.06350724399089813,0.1486983299255371,-0.09489855170249939,-0.08433491736650467},{0.27962222695350647,0.15132060647010803,0.20632560551166534,-0.1417931169271469,0.2238357961177826,0.21761098504066467,-0.35800492763519287,-0.13924404978752136,0.20750252902507782,-0.2939385175704956,-0.27805525064468384,-0.06587330251932144,0.09471309930086136,0.1378776729106903,-0.24402472376823425,-0.011047540232539177,0.28240662813186646,0.2693830132484436,-0.15314806997776031,-0.2614576816558838,0.22871476411819458,0.09421946853399277,0.06271359324455261,-0.033530447632074356,0.3225629925727844,0.279575377702713,-0.0019737952388823032,-0.2154119610786438,0.15024293959140778,-0.25385528802871704,-0.23170824348926544,0.16773080825805664},{-0.005474908743053675,-0.14730697870254517,-0.1833653599023819,0.16307732462882996,0.04151660576462746,0.008200790733098984,-0.134238600730896,-0.042995721101760864,-0.1537875384092331,-0.13615480065345764,0.22993509471416473,-0.35955649614334106,0.048707667738199234,0.1948862373828888,0.13072532415390015,0.05429438129067421,-0.16599884629249573,-0.11128547787666321,0.2514495849609375,0.021810241043567657,0.2949298918247223,0.1919114589691162,-0.000667538377456367,0.09915529191493988,0.27226489782333374,0.3664836287498474,-0.00020672424579970539,0.22924718260765076,0.11657004058361053,-0.0898820236325264,-0.0020985519513487816,0.3786900043487549},{0.23323245346546173,-0.20114800333976746,0.15806390345096588,0.10641241818666458,0.08153194934129715,0.2393551617860794,-0.15515998005867004,0.1373947113752365,-0.04348613694310188,0.005050841253250837,-0.12540441751480103,-0.30173197388648987,-0.09835658222436905,0.10684934258460999,0.18210557103157043,0.2472822666168213,0.10525328665971756,-0.13521267473697662,0.09320036321878433,-0.271255224943161,-0.2453681081533432,-0.3357900381088257,0.20692035555839539,-0.08196409791707993,0.34005647897720337,0.15928040444850922,-0.3469483554363251,-0.1455356776714325,-0.2787221074104309,0.16156265139579773,0.21549807488918304,0.18692104518413544},{0.11364389955997467,-0.1573377400636673,-0.19598887860774994,0.25772953033447266,0.11109767109155655,0.2925761044025421,0.12683850526809692,-0.21979489922523499,0.0037259492091834545,-0.2187114804983139,0.20421013236045837,0.22733834385871887,0.2522389590740204,0.048808395862579346,-0.07239074259996414,-0.28940656781196594,0.10952682793140411,0.06806235015392303,-0.19782453775405884,-0.1957351714372635,-0.2607768177986145,0.04711541905999184,-0.02022361196577549,-0.2608683109283447,0.11500386148691177,0.23032113909721375,-0.006770487874746323,0.19337280094623566,-0.21885909140110016,-0.2862238883972168,-0.1220848336815834,0.3154638111591339},{-0.2675803303718567,-0.3761098384857178,-0.07544903457164764,-0.16701838374137878,-0.012985494919121265,-0.31170937418937683,0.009763474576175213,0.0857287272810936,0.22730351984500885,0.1786462962627411,0.0847364068031311,-0.18209534883499146,-0.0008646524511277676,0.3114459812641144,0.346552312374115,-0.0868101641535759,0.028007442131638527,-0.23368817567825317,-0.11086991429328918,-0.26304689049720764,0.18342074751853943,-0.09891228377819061,-0.2411642223596573,0.025040430948138237,-0.20165956020355225,-0.38295692205429077,-0.07822100073099136,0.3211648464202881,-0.11540239304304123,0.29114630818367004,0.00512190954759717,-0.21200403571128845},{-0.03500659018754959,-0.012341807596385479,0.3074401319026947,0.028541680425405502,0.019423510879278183,0.25908201932907104,-0.09523846954107285,-0.22148877382278442,-0.2703005075454712,0.23446695506572723,0.1338362991809845,0.16282245516777039,0.07617148756980896,-0.11826902627944946,0.25711265206336975,0.06262995302677155,0.23381124436855316,-0.09284327179193497,0.18087777495384216,-0.11678359657526016,0.3101617097854614,-0.25103959441185,-0.21510381996631622,-0.23215320706367493,-0.2174132615327835,-0.18536433577537537,-0.21131029725074768,-0.32127073407173157,-0.10430430620908737,-0.22652260959148407,0.21969595551490784,0.08537831157445908},{-0.06397874653339386,0.0796227976679802,0.07843583077192307,0.10501620173454285,0.003676470136269927,-0.04983063414692879,0.3731767237186432,0.25250568985939026,-0.1870613694190979,0.34755033254623413,-0.06507034599781036,0.03880973905324936,0.030296936631202698,0.30578356981277466,-0.0909835696220398,-0.024877913296222687,0.2574194371700287,0.1760566234588623,0.06412772089242935,0.019383912906050682,0.06875036656856537,0.03740588203072548,0.11356224119663239,-0.2988690435886383,0.038265328854322433,-0.3214394748210907,-0.1488862931728363,-0.11958474665880203,-0.029090652242302895,0.35269832611083984,-0.2218959927558899,-0.2255469262599945},{-0.20569287240505219,-0.020276468247175217,-0.35777169466018677,0.05378877371549606,-0.2931210994720459,0.2989741265773773,0.22763410210609436,0.15282313525676727,-0.0748455673456192,-0.2447284609079361,-0.11165685951709747,0.16448411345481873,0.03790620341897011,0.15452763438224792,0.016496216878294945,0.09752973169088364,-0.1928243190050125,0.07679346948862076,-0.043528128415346146,-0.22638049721717834,-0.15057556331157684,-0.08123995363712311,-0.19060462713241577,0.10017025470733643,-0.2632875144481659,-0.16269880533218384,-0.007908886298537254,0.24365615844726562,-0.24742478132247925,0.09193460643291473,-0.08778082579374313,0.04371585324406624},{0.09943389892578125,0.2287474423646927,0.2900131642818451,0.056738030165433884,0.031995825469493866,0.16409313678741455,-0.21605566143989563,-0.08617506176233292,-0.28777140378952026,0.20866885781288147,-0.16221663355827332,-0.2544889748096466,0.0809643566608429,0.2231907844543457,0.06391463428735733,0.1823301464319229,0.22171913087368011,-0.22572432458400726,-0.2274044007062912,0.10770750790834427,0.16257943212985992,-0.1973886787891388,0.0765727087855339,0.3187999427318573,0.24836327135562897,-0.28102046251296997,-0.09035024046897888,-0.045259587466716766,0.2140851616859436,-0.18029391765594482,-0.0415639765560627,0.29437920451164246}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.043524112552404404,-0.18775373697280884,0.33717241883277893,-0.20067080855369568},{-0.1967293620109558,0.05664854124188423,0.28432697057724,0.21617619693279266},{0.18265198171138763,-0.33180180191993713,-0.25917354226112366,0.3039571940898895},{-0.27045920491218567,0.15532147884368896,-0.02271435782313347,-0.0638086199760437},{0.22891440987586975,0.08560515940189362,0.22228051722049713,0.07758118957281113},{0.09401026368141174,-0.006131799425929785,-0.3552297353744507,0.20153959095478058},{-0.04805358499288559,-0.02358991652727127,0.2697635889053345,0.3850712180137634},{0.18318791687488556,0.34583356976509094,-0.21838726103305817,0.3167556822299957},{0.2897088825702667,0.2792675495147705,-0.26391351222991943,-0.004980372730642557},{0.3016102612018585,0.15643775463104248,-0.16581551730632782,0.04317804425954819},{0.2334943562746048,0.14455924928188324,-0.16786693036556244,0.03750169649720192},{-0.25993552803993225,-0.23245126008987427,-0.1562558114528656,-0.21771885454654694},{0.02601894736289978,0.1363224983215332,0.08537546545267105,-0.011013430543243885},{0.2137576937675476,-0.24836277961730957,0.09754978120326996,-0.08013894408941269},{0.03242669627070427,0.12863940000534058,0.10804416239261627,-0.24358898401260376},{0.2527386248111725,-0.22491374611854553,0.2690008580684662,0.03739054873585701},{-0.22015954554080963,-0.051736313849687576,-0.2437334805727005,-0.05335600674152374},{0.29241296648979187,0.22707027196884155,-0.2836751639842987,-0.1074119284749031},{-0.02898622676730156,0.17833749949932098,-0.2278602123260498,-0.014764797873795033},{-0.25996315479278564,0.2492968738079071,-0.18771125376224518,-0.2625119090080261},{-0.06579703092575073,0.10394077003002167,-0.13404157757759094,0.3254189193248749},{0.35542240738868713,0.1457769274711609,0.21073968708515167,0.2201228141784668},{-0.024649839848279953,0.09423717856407166,-0.2238912284374237,0.30225062370300293},{-0.10038834065198898,0.27317097783088684,-0.287494033575058,-0.29501211643218994},{-0.13715778291225433,0.22858202457427979,0.17738597095012665,-0.2449280470609665},{-0.16326023638248444,0.1100587323307991,-0.20816738903522491,0.31908118724823},{-0.013755499385297298,-0.1210140511393547,0.06470352411270142,-0.10954286903142929},{0.21490441262722015,-0.1861097812652588,-0.27304401993751526,0.047476619482040405},{0.09899962693452835,-0.07299600541591644,0.13139112293720245,0.1311292052268982},{0.02244631014764309,0.1707085222005844,0.23317250609397888,0.008874444290995598},{-0.021107161417603493,-0.20675815641880035,-0.3177918791770935,-0.03246743977069855},{-0.2701101303100586,0.1165650486946106,0.10542170703411102,0.21611180901527405}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.0724627822637558,-0.0308295339345932,-0.007925143465399742,0.060704220086336136,-0.024179352447390556,0.004849218297749758,-0.0362267792224884,-0.0926266759634018,0.04887263849377632,0.051913149654865265,-0.061378590762615204,-0.02322166971862316,0.014444771222770214,0.10812341421842575,0.048785533756017685,-0.004914513789117336};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.006860319059342146,-0.016196787357330322,0.025353658944368362,0.04684457927942276,-0.011949474923312664,0.05127054452896118,-0.008281078189611435,-0.005612814798951149,0.045122385025024414,0.0321316160261631,-0.04852275550365448,-0.02782781422138214,-0.023465648293495178,-0.012706022709608078,0.015793921425938606,0.06903812289237976};
static const float actor_encoder_feed_forward_0_bias[32] = {0.00035829184344038367,0.03853551670908928,0.00761497812345624,-0.05022931843996048,0.04388876631855965,-0.00851796567440033,0.07498939335346222,0.022573627531528473,0.010008950717747211,0.038109272718429565,0.005183871369808912,-0.02565627172589302,0.055610764771699905,-0.0027681782376021147,0.004215626046061516,-0.007099349517375231,-0.044797107577323914,-0.006691069342195988,-0.012250580824911594,-0.01624237932264805,0.03548290207982063,0.04245350882411003,-0.00024400558322668076,-0.032159510999917984,-0.01663762331008911,0.004387207794934511,-0.011241777800023556,-0.001087189419195056,0.044493429362773895,0.0671977773308754,-0.036472294479608536,0.0036530063953250647};
static const float action_parameterization_distribution_linear_bias[4] = {0.012738378718495369,0.029302818700671196,0.0315365307033062,0.03235156834125519};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{-0.17393283545970917,-0.3382192552089691,0.20590214431285858,-0.4604756832122803},{0.003207598812878132,-0.18757236003875732,-0.2357816994190216,-0.2640872299671173},{0.1928950548171997,-0.44865116477012634,-0.032727837562561035,0.4861741065979004},{-0.28022024035453796,-0.16517731547355652,0.019844939932227135,0.18387801945209503},{0.16390863060951233,0.2505212128162384,0.04352220520377159,0.23683063685894012},{0.4362133741378784,-0.012099364772439003,0.22002965211868286,0.09390328079462051},{0.12023241817951202,-0.5636780261993408,-0.09166254848241806,-0.5292302966117859},{0.5191188454627991,-0.587272584438324,-0.06856734305620193,-0.34782853722572327},{0.34291428327560425,0.04731258749961853,-0.1404573619365692,-0.5364519357681274},{-0.35255444049835205,-0.5499418377876282,-0.5448023676872253,-0.4066377282142639},{-0.10969322174787521,-0.4950249195098877,-0.2646316587924957,0.06056021898984909},{-0.03840530291199684,-0.32152456045150757,0.36648795008659363,-0.20770837366580963},{0.273532509803772,0.5324406027793884,-0.4855932891368866,0.4714471697807312},{0.08278075605630875,-0.12922516465187073,-0.4885658919811249,-0.42310261726379395},{0.5441204309463501,-0.23713041841983795,-0.6757679581642151,-0.49201828241348267},{0.14177173376083374,-0.34837785363197327,-0.07063078880310059,0.5342965126037598}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.6747951507568359,0.6857256293296814,-0.6360536813735962,-0.18313302099704742},{0.7022927403450012,-0.26750391721725464,0.14442405104637146,0.24909283220767975},{0.11142444610595703,-0.3622656762599945,-0.9082341194152832,-0.29145780205726624},{-0.8479719758033752,-0.6749623417854309,0.2420521229505539,0.2663024365901947}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.2083539366722107,-0.15041247010231018,-0.08803338557481766,-0.0979304313659668};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.018758613616228104,0.09721270948648453,0.03395433351397514,0.04310368001461029};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }



int main(const float *self_indatav, float *obst_indatav, float *obst_outdata, float *outdatav)
{
    size_t i;
    control_t_n motorThrusts;

    obstacleEmbedder(obst_indatav);

    for (int i = 0; i < D_MODEL; i++) {
        obst_outdata[i] = obstacle_embeds[i];
    }

    networkEvaluate(&motorThrusts, self_indatav);

    outdatav[0] = motorThrusts.thrust_0;
    outdatav[1] = motorThrusts.thrust_1;
    outdatav[2] = motorThrusts.thrust_2;
    outdatav[3] = motorThrusts.thrust_3;

    return EXIT_SUCCESS; 
}

