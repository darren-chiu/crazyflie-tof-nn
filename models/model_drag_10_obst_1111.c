
#include <random>
#include <vector>
#include <iostream>
#include <algorithm>
#include <cstring> 


typedef struct control_t_n {
	float thrust_0;
	float thrust_1;
	float thrust_2;
	float thrust_3;
} control_t_n;

void networkEvaluate(control_t_n* control_n, const float* state_array);

static const int NEIGHBORS = 0;
static const int NBR_DIM = 0; 

static const int NUM_OBSTACLES = 2; 
static const int OBST_DIM = 8;


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.07715143263339996,0.26092690229415894,0.3889021575450897,0.3022499680519104,-0.1970125287771225,0.3687225878238678,-0.010158573277294636,0.07557392120361328,0.2840708792209625,-0.052045371383428574,-0.0010610442841425538,0.524280846118927,-0.01274081226438284,-0.03199483081698418,0.11897190660238266,0.21439504623413086},{0.10710380971431732,-0.11016862094402313,0.4364880621433258,0.1996231973171234,0.18413521349430084,-0.18374009430408478,-0.19107463955879211,-0.24953624606132507,0.25879913568496704,-0.00984548032283783,0.02926919050514698,-0.20864859223365784,-0.23750849068164825,0.0639178603887558,0.02303430065512657,0.18263709545135498},{-0.38462308049201965,-0.32311415672302246,-0.04560301452875137,0.20295900106430054,0.26492297649383545,0.14981868863105774,-0.09564702957868576,-0.27333077788352966,-0.1559334695339203,-0.7222328186035156,-0.16360796988010406,0.08200696855783463,0.0675319954752922,0.29061606526374817,0.3950936198234558,0.19306913018226624},{-0.14528021216392517,-0.05885109305381775,0.11796773970127106,0.40179482102394104,-0.0034754916559904814,0.1712610125541687,0.18422600626945496,-0.26965680718421936,-0.12579317390918732,0.0010242755524814129,-0.1104399710893631,-0.006740354001522064,0.051086075603961945,-0.3815573751926422,-0.08362919837236404,-0.27544814348220825},{-0.31682324409484863,-0.1544511467218399,0.06603807210922241,0.0846133753657341,0.2829117774963379,0.07727061212062836,-0.4067753255367279,0.1047891154885292,-0.10063926130533218,0.32982757687568665,0.1524677872657776,-0.014207551255822182,0.15605022013187408,-0.34612488746643066,0.019744474440813065,0.0005300554330460727},{0.2598794996738434,0.23215369880199432,-0.2855645716190338,0.07425441592931747,0.31018733978271484,-0.18666796386241913,0.2913120985031128,0.09196081757545471,-0.15439464151859283,-0.450343519449234,0.08808679133653641,0.09765298664569855,-0.5534202456474304,0.02919618785381317,0.0341845341026783,-0.02593240700662136},{-0.05604425445199013,-0.2760852873325348,0.2485252171754837,0.35376864671707153,-0.05517677962779999,0.5981857776641846,-0.23077405989170074,0.4356752336025238,-0.03668307140469551,0.40755802392959595,-0.5022029280662537,0.44964778423309326,-0.057145509868860245,0.3486996591091156,-0.2158687561750412,0.17020374536514282},{0.024271754547953606,0.2744331359863281,-0.05606716871261597,-0.13352856040000916,-0.14424818754196167,0.6454887986183167,-0.21972878277301788,-0.3148226737976074,0.0267656147480011,0.28830215334892273,-0.07160503417253494,0.17264437675476074,0.07668111473321915,-0.1260184347629547,0.23950593173503876,-0.014825868420302868},{-0.4895590543746948,0.31170305609703064,-0.07009606808423996,-0.011300038546323776,-0.2844397723674774,-0.14126090705394745,0.19225044548511505,-0.39145520329475403,0.2918449640274048,0.20499399304389954,-0.7116825580596924,0.18122786283493042,-0.028999021276831627,-0.11975710093975067,-0.220968097448349,0.04149137809872627},{-0.17182517051696777,0.2588028311729431,-0.2531035840511322,-0.12372814863920212,-0.07174688577651978,-0.5770429372787476,-0.19875267148017883,0.3440307676792145,0.10488879680633545,0.45813941955566406,0.07503204792737961,0.39247843623161316,0.009885129518806934,-0.3549033999443054,0.32929763197898865,0.05220392346382141},{0.10273977369070053,-0.5288560390472412,0.2395034283399582,-0.0366506390273571,0.11528166383504868,0.048577651381492615,-0.0047922078520059586,0.7132368683815002,-0.33821776509284973,-0.02704392559826374,-0.09167648106813431,-0.08438356965780258,0.07278606295585632,-0.4319579601287842,0.19243407249450684,0.06152081489562988},{-0.31327277421951294,0.18596535921096802,-0.026039263233542442,0.18801084160804749,0.546658456325531,0.4544544219970703,-0.43603283166885376,0.18100713193416595,0.3561743497848511,0.46553876996040344,0.04131517931818962,0.1948034018278122,0.14283785223960876,-0.32970741391181946,0.16280609369277954,0.28341206908226013},{-0.07100609689950943,-0.04493343457579613,-0.08746691793203354,-0.284070760011673,-0.5664822459220886,-0.12655514478683472,0.5954727530479431,-0.08507285267114639,-0.2390775829553604,0.16927823424339294,-0.1424916535615921,-0.045378178358078,0.3578474819660187,0.16444675624370575,0.4736466705799103,-0.2774692475795746},{-0.06837011128664017,0.586196780204773,0.3436274826526642,-0.2072695940732956,0.2518654465675354,0.02638193778693676,-0.1141229197382927,-0.4193267524242401,0.1507880985736847,-0.2576863169670105,-0.3922286629676819,0.6039996147155762,-0.34190797805786133,-0.09564272314310074,-0.060051608830690384,-0.10625103861093521},{0.05503864586353302,0.25904664397239685,-0.2872334420681,-0.40887176990509033,0.31557950377464294,-0.24219469726085663,0.41585031151771545,0.052274055778980255,0.030028020963072777,0.09924570471048355,0.19080089032649994,-0.15008917450904846,0.39027440547943115,0.21507079899311066,-0.2515485882759094,0.00262591359205544},{-0.318359375,0.2487999051809311,-0.13232380151748657,0.32675856351852417,0.057624224573373795,-0.13669812679290771,0.2262958586215973,-0.01553245447576046,-0.20841822028160095,0.32484474778175354,-0.19953040778636932,0.04206554591655731,-0.12105021625757217,0.09223823249340057,-0.19545361399650574,0.11007466912269592},{0.02501905895769596,0.04091222211718559,0.14272677898406982,0.029594844207167625,0.045533496886491776,0.3172304034233093,-0.2832486033439636,0.2801123857498169,0.3623906075954437,-0.16404297947883606,0.0719718337059021,0.09299863874912262,0.0073017640970647335,-0.14961986243724823,-0.2260960340499878,0.09511125087738037},{0.26943203806877136,0.45046207308769226,0.27766454219818115,0.09850776195526123,0.1736001968383789,0.33676832914352417,0.21985550224781036,-0.2945161461830139,0.2420552521944046,-0.30948567390441895,0.00022383248142432421,-0.3133438527584076,0.08476363867521286,0.15312236547470093,-0.011154783889651299,-0.25323861837387085}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.26305150985717773,0.14935795962810516,-0.48925498127937317,-0.05276138335466385,0.04174418747425079,0.27435263991355896,-0.42442530393600464,0.37009668350219727,0.4058278203010559,0.16981524229049683,0.41932791471481323,-0.03295712172985077,0.0954877957701683,0.19471223652362823,-0.11051850765943527,0.21826373040676117},{-0.29696109890937805,-0.41015318036079407,0.09181590378284454,-0.2098338007926941,0.3994646370410919,-0.327372282743454,0.28943386673927307,-0.02441135048866272,0.2831268012523651,0.04081312194466591,0.1654680222272873,0.42644280195236206,-0.1546260565519333,0.2238742709159851,0.293281227350235,0.156248539686203},{-0.042741164565086365,-0.34665682911872864,-0.4503726065158844,-0.3922276496887207,0.3629060685634613,-0.35142016410827637,-0.0007243695436045527,-0.35579007863998413,-0.2998872995376587,-0.04687679558992386,0.15935392677783966,0.0641908124089241,-0.29101312160491943,-0.32929080724716187,0.3811440169811249,-0.07460549473762512},{-0.09969867765903473,0.2787695527076721,0.04783012717962265,0.36040785908699036,0.026560962200164795,-0.30892112851142883,0.24829170107841492,-0.010832005180418491,-0.2350715845823288,0.1733788102865219,-0.14163412153720856,-0.00445399759337306,-0.412814736366272,-0.36245211958885193,0.35108187794685364,0.30747655034065247},{0.16096797585487366,-0.45623713731765747,-0.08222281187772751,0.21504954993724823,-0.27983805537223816,0.037184640765190125,0.49996522068977356,-0.14655905961990356,0.2742476761341095,-0.2724420726299286,-0.27051928639411926,-0.21475431323051453,0.5464183688163757,-0.1049010381102562,-0.012583363801240921,-0.05506250634789467},{-0.15437749028205872,0.06953580677509308,-0.36448732018470764,-0.10033608973026276,0.14986146986484528,0.21211324632167816,0.2010713368654251,0.25892001390457153,-0.17338664829730988,-0.26274386048316956,-0.08007323741912842,-0.052843593060970306,0.18086756765842438,0.0031392755918204784,0.2810046076774597,0.34461888670921326},{0.10314714163541794,0.1383087933063507,-0.11896034330129623,-0.2558384835720062,0.2304399162530899,-0.3019033372402191,-0.34527042508125305,-0.3824191093444824,0.13840876519680023,-0.1736191362142563,-0.07821906358003616,0.28528714179992676,0.056391891092061996,0.26134228706359863,-0.21426483988761902,-0.04260136932134628},{0.1441706418991089,0.477293998003006,-0.2780885398387909,-0.0638834685087204,-0.3558337390422821,0.27949485182762146,0.19395290315151215,0.18215160071849823,-0.2564873993396759,0.29835256934165955,0.21551169455051422,-0.06177666783332825,0.23773325979709625,-0.0852636769413948,0.1983805000782013,-0.0029151919297873974},{-0.04771207273006439,-0.234039768576622,-0.23737022280693054,-0.2193898856639862,0.1673729419708252,-0.21782612800598145,0.03252190351486206,0.36590203642845154,-0.248734250664711,-0.3265935778617859,0.28708744049072266,0.12595126032829285,0.08291637897491455,0.38517144322395325,0.23902562260627747,-0.21805928647518158},{0.3031257390975952,0.10418347269296646,-0.3396607041358948,-0.3376619815826416,0.27923935651779175,0.3593340516090393,-0.176627978682518,0.3619641363620758,0.2622511088848114,-0.42410725355148315,0.18774031102657318,0.1074618399143219,-0.3295418620109558,-0.04165659844875336,0.19920842349529266,-0.1536303460597992},{-0.13241679966449738,-0.34770315885543823,-0.12841618061065674,-0.1557348370552063,0.16738885641098022,0.3148537874221802,0.17011933028697968,0.43587279319763184,-0.08254445344209671,0.205858051776886,0.18170885741710663,-0.31437864899635315,0.21132713556289673,0.19127805531024933,-0.17863546311855316,-0.000336892728228122},{-0.2754700779914856,0.28113171458244324,0.04474367946386337,0.4690204858779907,-0.06720688939094543,0.08980971574783325,-0.4966321885585785,-0.11138506978750229,0.4574221670627594,-0.18035197257995605,-0.3527011275291443,-0.06167283281683922,0.27408209443092346,-0.006327033042907715,-0.2214890569448471,-0.17784133553504944},{-0.08762404322624207,-0.36078929901123047,0.4649578928947449,-0.3695024847984314,0.1401972621679306,-0.1517990082502365,-0.06374628096818924,-0.18226931989192963,-0.1923649162054062,0.2692219316959381,0.22613123059272766,-0.05121156945824623,-0.23067238926887512,0.11102589219808578,0.11515782028436661,0.1239810362458229},{-0.3673408627510071,-0.32238468527793884,0.37058523297309875,-0.08301868289709091,0.35153526067733765,0.21857838332653046,-0.14733166992664337,0.07584036141633987,-0.39848071336746216,0.3688732087612152,0.08720354735851288,-0.12686266005039215,-0.2486802339553833,-0.18307462334632874,-0.38007062673568726,0.20386570692062378},{-0.12882265448570251,0.08350363373756409,-0.1945990025997162,0.22485476732254028,-0.10227872431278229,0.009035778231918812,0.002136827912181616,-0.08409153670072556,-0.41302943229675293,0.043501295149326324,0.28153473138809204,0.27592381834983826,-0.09199827164411545,0.3067954182624817,0.01875094138085842,0.535680890083313},{-0.17217272520065308,-0.02928820624947548,-0.09212358295917511,-0.07438801229000092,-0.25464439392089844,0.17943154275417328,0.4430537819862366,-0.22207550704479218,-0.08065157383680344,-0.1341078132390976,-0.3301636576652527,-0.37953320145606995,-0.026818513870239258,-0.0072600506246089935,-0.2791582942008972,-0.03314831852912903}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.06905348598957062,-0.21871817111968994,0.16600839793682098,0.0003736719663720578,-0.1371181756258011,0.10690132528543472,-0.062321312725543976,-0.1441430002450943,-0.1038670763373375,0.3194557726383209,0.17893415689468384,0.02149936929345131,0.11489260196685791,0.012508262880146503,0.13734523952007294,-0.06624576449394226,-0.22479040920734406,-0.20727576315402985,-0.16908296942710876,-0.1791325807571411,0.34620577096939087,0.15329311788082123,-0.13833343982696533,-0.16252128779888153,-0.23875533044338226,-0.03147158399224281,-0.23138611018657684,-0.10090688616037369,0.1528843194246292,-0.00021295322221703827,0.06363828480243683,-0.20045733451843262},{-0.18917448818683624,0.07344567775726318,0.0029963164124637842,-0.05390480160713196,0.13948607444763184,-0.24899937212467194,-0.37988755106925964,0.013400665484368801,-0.21471793949604034,0.24926654994487762,0.27978506684303284,-0.2902190685272217,0.30700042843818665,-0.25935089588165283,-0.11534488201141357,-0.1706727147102356,0.2003205418586731,-0.2421092838048935,0.06018226593732834,-0.17890959978103638,0.23705552518367767,-0.2621224820613861,-0.28857001662254333,-0.10847428441047668,-0.16866527497768402,0.3599182367324829,0.28311431407928467,-0.38187164068222046,0.2622281014919281,0.10841524600982666,-0.02235884591937065,-0.24863485991954803},{0.026601137593388557,0.21207484602928162,0.17365199327468872,-0.0889095664024353,-0.11357308179140091,0.34144970774650574,0.017146781086921692,0.1634475141763687,0.19658997654914856,-0.05356891080737114,0.12052923440933228,0.015634432435035706,-0.009672109968960285,-0.3477282226085663,-0.23463094234466553,-0.01850576139986515,-0.008689386770129204,0.12198629230260849,0.12931302189826965,-0.0410846546292305,-0.3071421980857849,0.2712778151035309,-0.03750406950712204,0.012448405846953392,0.106612429022789,-0.30259978771209717,-0.10677684098482132,0.22974948585033417,-0.329479843378067,-0.2378963828086853,-0.28706440329551697,0.08444394171237946},{0.24002274870872498,-0.2658665180206299,0.004572810139507055,-0.03580806776881218,-0.07219386845827103,-0.4916185438632965,-0.30111193656921387,0.19643862545490265,0.3866141736507416,0.19358111917972565,0.10171588510274887,0.24540472030639648,0.3020079433917999,0.0011232242686673999,0.195836141705513,0.12398989498615265,0.23607762157917023,0.22954215109348297,0.17546887695789337,-0.0993519201874733,-0.12967437505722046,0.08582624793052673,-0.0652720257639885,0.1213793233036995,-0.1137680783867836,-0.171732559800148,0.3621958792209625,-0.20241710543632507,-0.17911675572395325,-0.10492346435785294,-0.30961474776268005,0.17970135807991028},{0.18551753461360931,-0.0724499374628067,-0.12345690280199051,-0.2641544044017792,-0.05151360481977463,-0.013290178030729294,0.06159427762031555,-0.3595328629016876,-0.03822080045938492,-0.23375585675239563,-0.02568073198199272,-0.30095374584198,-0.1501283347606659,-0.21914057433605194,-0.04960257560014725,-0.06688214838504791,-0.21314109861850739,-0.03674035891890526,0.15074698626995087,-0.38955405354499817,0.168157696723938,-0.07361352443695068,-0.030568905174732208,0.009967231191694736,-0.16672205924987793,-0.003103185212239623,-0.28630656003952026,-0.05063452199101448,-0.02615879476070404,0.20074138045310974,-0.19340918958187103,0.08126076310873032},{-0.07725781947374344,-0.11089536547660828,0.13504910469055176,0.06353019177913666,0.23310968279838562,-0.13394153118133545,-0.21451355516910553,-0.2768450975418091,-0.19152726233005524,-0.1360175609588623,-0.025665758177638054,0.1748066395521164,0.10358759760856628,-0.2561866044998169,-0.10592195391654968,-0.16710598766803741,0.15333010256290436,0.12058445811271667,0.41965678334236145,-0.06368623673915863,0.003050061408430338,-0.39997196197509766,-0.1016714870929718,-0.21444624662399292,-0.11064624786376953,-0.0018616534071043134,0.33560582995414734,0.22777116298675537,-0.2017926722764969,-0.1944970190525055,0.1246316209435463,0.025862975046038628},{0.15662595629692078,-0.36666229367256165,-0.08833584189414978,0.2112828493118286,0.16991376876831055,-0.020934632048010826,0.3083285987377167,0.07421875,0.12019504606723785,-0.3531162142753601,-0.3110061585903168,0.05470973998308182,0.03638117015361786,0.0829688012599945,-0.20226770639419556,-0.22790628671646118,-0.18859875202178955,0.24967102706432343,-0.3005629777908325,-0.05698040500283241,0.04367107152938843,-0.21757714450359344,0.2962338328361511,-0.05988271161913872,0.0004181608965154737,0.003972203470766544,0.16106735169887543,0.24379999935626984,-0.07237686216831207,0.0636458545923233,0.22891265153884888,-0.33166587352752686},{-0.023354487493634224,0.17984023690223694,0.3113602101802826,0.2300867885351181,-0.03185216709971428,0.028748486191034317,0.3538171052932739,0.04325795918703079,0.1118796318769455,-0.24934610724449158,0.266624391078949,-0.21160900592803955,-0.23644064366817474,-0.15146197378635406,0.3036156892776489,0.09748473018407822,-0.24278928339481354,-0.07719910144805908,0.2191891223192215,-0.14732687175273895,0.30090177059173584,-0.3925950825214386,0.07921530306339264,-0.06339119374752045,-0.08197835832834244,-0.05865224450826645,-0.09164067357778549,0.08969737589359283,0.0077216909267008305,0.26985692977905273,-0.2378893494606018,-0.24689103662967682},{0.03391768038272858,0.333271324634552,0.19750423729419708,-0.12780749797821045,0.16187727451324463,0.19574201107025146,0.16431866586208344,-0.1424630880355835,-0.01735042594373226,0.057523470371961594,0.1873125582933426,-0.056816864758729935,-0.29279154539108276,0.005816794466227293,0.03201441094279289,-0.022404072806239128,-0.21212857961654663,-0.016088608652353287,0.22245977818965912,-0.32955116033554077,-0.07892578840255737,0.18586990237236023,-0.0761374905705452,0.10628999024629593,-0.3139653503894806,-0.1032494530081749,-0.13395099341869354,0.0966748297214508,-0.15382292866706848,-0.3575470745563507,-0.12111806869506836,0.039166174829006195},{-0.36701688170433044,-0.0781259685754776,-0.04226621985435486,-0.016275892034173012,-0.19529224932193756,-0.010801003314554691,-0.1745094209909439,-0.2694977819919586,0.2151912897825241,0.08918831497430801,0.21475563943386078,-0.23656533658504486,-0.23597300052642822,-0.03214939311146736,0.15179568529129028,-0.19231687486171722,0.2700878977775574,-0.002405637176707387,-0.04978082329034805,-0.04763083904981613,0.05210809037089348,-0.2857606112957001,-0.11616264283657074,-0.173026904463768,0.3105698823928833,0.17387166619300842,0.08930294215679169,0.18886898458003998,0.28422266244888306,0.26125845313072205,0.14919498562812805,-0.2500757575035095},{-0.07520956546068192,0.23747731745243073,0.23619988560676575,0.03845658153295517,0.006447009276598692,0.28694841265678406,0.10706443339586258,-0.15252403914928436,0.04755929857492447,0.12740424275398254,0.024914298206567764,0.11042071878910065,-0.1834748536348343,0.17123393714427948,0.311445027589798,-0.025598034262657166,0.08681997656822205,-0.3618437647819519,0.3174200654029846,0.0676070973277092,-0.07422816753387451,0.16223007440567017,0.0015325994463637471,0.21838033199310303,0.23456671833992004,-0.4560527801513672,-0.0006126807420514524,0.2410736232995987,-0.059688176959753036,-0.048562534153461456,-0.11775320768356323,0.033093880861997604},{0.036444660276174545,0.050671759992837906,0.16078251600265503,0.04379701241850853,0.0548776239156723,-0.2468678504228592,-0.1955825835466385,0.09590315073728561,-0.073517344892025,-0.06559281796216965,0.28921815752983093,0.2901710867881775,0.07296478003263474,0.06800812482833862,0.06757817417383194,-0.23113282024860382,0.15745337307453156,-0.15596583485603333,0.22953486442565918,0.21993128955364227,-0.013089126907289028,0.0341809019446373,-0.28844398260116577,0.3074052631855011,-0.04850200191140175,0.04718735069036484,0.3482699394226074,-0.07485229521989822,0.28596848249435425,-0.2527596056461334,0.03297438845038414,0.44012483954429626},{-0.17953911423683167,-0.3017587959766388,0.12452094256877899,-0.09212122857570648,0.041023943573236465,0.2068566232919693,-0.1471797674894333,-0.25760021805763245,0.14001278579235077,-0.2540130913257599,0.07124347984790802,0.05903983861207962,0.1120663434267044,-0.10655268281698227,-0.11803111433982849,0.10239040851593018,0.02586994133889675,0.2512334883213043,0.006883555557578802,0.056208521127700806,0.03434084355831146,0.3997457027435303,-0.14244163036346436,0.29464614391326904,0.08168456703424454,0.1448267698287964,0.19663105905056,0.24699881672859192,0.23514777421951294,-0.1344495415687561,-0.4096253514289856,-0.00290445564314723},{0.0006868759519420564,-0.23179684579372406,0.18506935238838196,-0.11604899913072586,-0.19959759712219238,0.20808547735214233,0.23198342323303223,0.04538992792367935,0.07846905291080475,0.17111186683177948,-0.22415012121200562,0.049285437911748886,-0.13289880752563477,0.13578376173973083,0.30093684792518616,-0.21309421956539154,-0.15529952943325043,-0.221159428358078,-0.16744419932365417,-0.05884493887424469,-0.35480019450187683,-0.16904839873313904,-0.1487034559249878,0.09440699964761734,0.1117977574467659,-0.21469473838806152,0.12713561952114105,-0.07837097346782684,-0.28937169909477234,0.21443335711956024,0.1832716315984726,-0.09521808475255966},{0.028338223695755005,0.3275669515132904,0.3096155524253845,0.2477559596300125,-0.02882755547761917,-0.28393831849098206,0.1712585985660553,0.10062806308269501,0.08590714633464813,-0.0750708356499672,-0.12459965795278549,0.04709034040570259,0.09284524619579315,0.2075621634721756,-0.16819146275520325,0.12504738569259644,-0.0201447531580925,-0.14197979867458344,-0.29731810092926025,0.04266127571463585,-0.2209959328174591,0.21622887253761292,0.03356711566448212,0.16250166296958923,-0.005023897159844637,0.04199035093188286,0.1800996959209442,-0.026225952431559563,0.24550005793571472,0.3623816668987274,0.2605622112751007,-0.19281019270420074},{-0.24815542995929718,0.24570497870445251,-0.3381452262401581,0.2045605629682541,0.17370326817035675,0.126084104180336,-0.29578617215156555,-0.08589190989732742,-0.13862155377864838,0.132121279835701,0.03531700372695923,-0.1067144051194191,0.17845435440540314,-0.11576807498931885,0.2725605368614197,-0.3344360589981079,-0.07568278908729553,0.3505173325538635,0.04164132475852966,0.212570920586586,0.17277833819389343,0.33815625309944153,-0.18305201828479767,-0.09813351184129715,-0.1808270663022995,0.31992268562316895,0.03102276101708412,0.1118013858795166,0.007941982708871365,-0.11150957643985748,0.1291504204273224,0.05174177512526512},{0.07516017556190491,-0.12012889981269836,0.34954118728637695,-0.33706536889076233,-0.2434801310300827,0.29051321744918823,0.2090388536453247,-0.09101568907499313,-0.1888173520565033,-0.09216004610061646,0.06422426551580429,-0.24418632686138153,-0.15051625669002533,0.08098141849040985,0.2036515474319458,0.23684094846248627,0.24685794115066528,0.2851797640323639,0.3067757487297058,0.042380526661872864,0.27494341135025024,-0.09785580635070801,-0.011704618111252785,0.20844627916812897,0.12498525530099869,0.027806760743260384,-0.2610626220703125,0.06678463518619537,0.021369384601712227,-0.305780827999115,-0.2941344678401947,-0.28674763441085815},{-0.32843899726867676,-0.006111916154623032,-0.18194061517715454,0.3005852699279785,0.2894032299518585,0.040123794227838516,-0.046809710562229156,0.24508708715438843,0.13350875675678253,-0.06022568419575691,0.02730746380984783,-0.1997811645269394,0.010500157251954079,0.005388833116739988,0.14509275555610657,-0.3617851436138153,0.08920354396104813,0.2698039412498474,0.03973405063152313,-0.26793503761291504,-0.1422986537218094,0.019310537725687027,0.034567493945360184,-0.34267953038215637,0.30136245489120483,0.010479875840246677,0.19422686100006104,0.2090720236301422,0.042505208402872086,0.06734806299209595,0.2628287672996521,0.34601980447769165},{0.05439979210495949,0.2468651980161667,-0.20757712423801422,0.3856053352355957,0.03712591528892517,-0.07148701697587967,0.1748790591955185,-0.15618523955345154,0.29163146018981934,0.321950227022171,0.2911498546600342,0.16309243440628052,-0.21065421402454376,-0.12370120733976364,0.033417053520679474,0.09374754130840302,0.023696057498455048,-0.2849058210849762,0.2714410126209259,-0.13249996304512024,0.23749910295009613,-0.040466248989105225,-0.06714294105768204,0.11411279439926147,-0.17767715454101562,0.048575133085250854,0.13155688345432281,-0.191251739859581,0.1485665738582611,0.2077607959508896,-0.2323973923921585,0.3108139634132385},{-0.21731431782245636,0.16925278306007385,0.15580561757087708,-0.11605779081583023,0.2424759715795517,0.11831831932067871,-0.2564745545387268,0.21926231682300568,-0.2426447868347168,-0.16567881405353546,0.01699686422944069,0.07339432835578918,0.06376519799232483,0.29395079612731934,0.22705695033073425,0.09751560539007187,-0.15630008280277252,-0.1893826723098755,-0.17565640807151794,0.27583569288253784,0.20955559611320496,-0.2440440058708191,-0.3513914942741394,-0.19408369064331055,-0.2701748311519623,0.11739714443683624,-0.08418242633342743,0.006963285151869059,0.1641927808523178,-0.08537862449884415,0.12352138757705688,-0.16351483762264252}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10490413010120392,-0.13898906111717224,0.04174089431762695,-0.009234086610376835},{0.0034401656594127417,0.32537516951560974,0.1664973348379135,-0.023706672713160515},{0.3465665876865387,-0.33981749415397644,0.1340762823820114,0.14638522267341614},{0.35006752610206604,0.019366391003131866,-0.08883357793092728,0.35112109780311584},{0.26799634099006653,0.1512303352355957,-0.08079791069030762,0.26926591992378235},{-0.20273859798908234,0.12007343769073486,0.4852100610733032,0.11088063567876816},{0.33904093503952026,0.21658621728420258,0.04469224065542221,0.2508932948112488},{-0.10884692519903183,-0.3179984390735626,-0.12755683064460754,-0.3728625178337097},{-0.02119210734963417,-0.35879915952682495,-0.37392374873161316,0.37915074825286865},{0.09617353975772858,-0.3295222520828247,-0.41806578636169434,-0.11387898772954941},{0.2070908397436142,0.22803832590579987,0.06895899027585983,0.09665694087743759},{-0.17716746032238007,-0.14093957841396332,0.30236196517944336,-0.0956374853849411},{-0.10053962469100952,-0.136139377951622,-0.33524733781814575,0.2050287276506424},{0.37662842869758606,0.023964928463101387,-0.16329580545425415,0.0326574333012104},{-0.019134115427732468,-0.22093740105628967,0.3166626989841461,-0.15426769852638245},{0.4585297107696533,0.2831117808818817,-0.22097645699977875,0.2620570659637451},{-0.23588906228542328,0.01876681298017502,-0.07391678541898727,-0.1203143373131752},{0.09265833348035812,-0.4040433168411255,-0.15008246898651123,-0.3507842421531677},{-0.25909551978111267,-0.21563774347305298,-0.13734997808933258,0.3886221647262573},{-0.22648102045059204,-0.3913029134273529,-0.09698931127786636,0.21819551289081573},{-0.2530670166015625,-0.08221812546253204,-0.1735791265964508,0.3513716459274292},{-0.1695472151041031,-0.42565301060676575,0.09180472046136856,-0.2678571939468384},{-0.04722798243165016,-0.33480432629585266,0.022913126274943352,0.09646758437156677},{0.3478594720363617,-0.05393896996974945,-0.2786419689655304,-0.0372755266726017},{-0.32922452688217163,0.005878469441086054,0.034460436552762985,-0.2994301915168762},{-0.13448594510555267,-0.27148693799972534,-0.1347433477640152,-0.18794198334217072},{-0.29647397994995117,0.25497013330459595,0.07303789258003235,-0.14990927278995514},{0.14025738835334778,-0.22978243231773376,-0.24668654799461365,0.3509014844894409},{0.12034031003713608,0.08441117405891418,-0.1442786306142807,0.07946909964084625},{0.08181002736091614,-0.27710434794425964,0.3729342222213745,-0.013057111762464046},{0.09939718246459961,0.05700422450900078,-0.14891347289085388,0.29328709840774536},{0.29289770126342773,0.3576785624027252,-0.02218594029545784,-0.25798121094703674}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.1372060626745224,0.049120932817459106,0.009899242781102657,0.030398128554224968,0.17712146043777466,-0.1694985330104828,-0.008491641841828823,-0.07465481758117676,0.01485771220177412,-0.08014046400785446,-0.07416822016239166,0.12730571627616882,0.08274750411510468,0.014827754348516464,0.011877216398715973,0.04119175672531128};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.09853404760360718,-0.012145559303462505,0.010555297136306763,-0.06786035001277924,-0.03281122446060181,-0.1262354850769043,-0.0012816466623917222,-0.03157515078783035,0.04923877865076065,-0.09316949546337128,-0.0665302723646164,-0.015013367868959904,0.047797903418540955,-0.0372028611600399,-0.010205855593085289,-0.061455994844436646};
static const float actor_encoder_feed_forward_0_bias[32] = {0.00022403904586099088,0.05617223307490349,0.021813394501805305,0.024988431483507156,0.06574451178312302,0.10332734137773514,0.10870566219091415,-0.07819488644599915,-0.06514327228069305,-0.06600026786327362,0.0965966060757637,0.006794940214604139,0.011568695306777954,0.05308667570352554,-0.02984156645834446,0.09512708336114883,0.005607484839856625,-0.005601412151008844,-0.07631541788578033,-0.056643303483724594,-0.01448827050626278,-0.056918442249298096,-0.057576291263103485,0.007517022546380758,-0.048770271241664886,-0.0644444152712822,0.008345511741936207,-0.025245262309908867,0.03517765551805496,-0.08486389368772507,0.04732637107372284,0.006310959346592426};
static const float action_parameterization_distribution_linear_bias[4] = {0.03132951632142067,0.062100499868392944,0.026713240891695023,0.027963880449533463};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{-0.07813385874032974,0.5107839703559875,-0.3008970320224762,0.2946971654891968},{-0.2715124785900116,-0.3908393085002899,-0.2104228138923645,0.3550371527671814},{-0.1491461843252182,0.6488658785820007,-0.09504494071006775,-0.1046246886253357},{0.47723907232284546,-0.13324929773807526,0.5323953628540039,0.02123977243900299},{0.018595142289996147,-0.2295413315296173,0.47785255312919617,0.28278136253356934},{-0.3509766459465027,0.17287525534629822,-0.3772541880607605,0.18202397227287292},{-0.40552663803100586,-0.20494717359542847,0.19076968729496002,0.46349069476127625},{0.445011705160141,0.6795507669448853,0.39641427993774414,-0.3462188243865967},{-0.055613551288843155,0.02515498362481594,0.07996479421854019,-0.3252847194671631},{0.29588937759399414,0.5940918922424316,0.09806713461875916,0.3865709900856018},{0.5652235746383667,0.2812308967113495,-0.6943374276161194,-0.1884496957063675},{-0.29300564527511597,0.29558810591697693,-0.02942778915166855,-0.17733865976333618},{0.5212809443473816,-0.2339627742767334,-0.20883940160274506,-0.18924641609191895},{-0.29510608315467834,0.5528104305267334,-0.5019537806510925,-0.14628924429416656},{0.15600697696208954,0.3626258075237274,-0.302950382232666,0.4169597923755646},{0.3743055760860443,0.341691255569458,-0.1951482892036438,0.44196391105651855}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.7934141755104065,-0.011950351297855377,-0.23449544608592987,-0.3398604094982147},{0.1160212904214859,-0.41858047246932983,0.12131817638874054,0.5183175206184387},{-0.9667122960090637,0.15822817385196686,0.8664922118186951,-0.45049721002578735},{-0.19500330090522766,0.44290298223495483,-0.4980848729610443,0.6863756775856018}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.01563819870352745,0.15450964868068695,-0.05874290689826012,0.14864228665828705};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.0917220488190651,-0.012488572858273983,-0.03065638616681099,0.05275322496891022};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }



int main(const float *self_indatav, float *obst_indatav, float *obst_outdata, float *outdatav)
{
    size_t i;
    control_t_n motorThrusts;

    obstacleEmbedder(obst_indatav);

    for (int i = 0; i < D_MODEL; i++) {
        obst_outdata[i] = obstacle_embeds[i];
    }

    networkEvaluate(&motorThrusts, self_indatav);

    outdatav[0] = motorThrusts.thrust_0;
    outdatav[1] = motorThrusts.thrust_1;
    outdatav[2] = motorThrusts.thrust_2;
    outdatav[3] = motorThrusts.thrust_3;

    return EXIT_SUCCESS; 
}

