
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.11105304956436157,-0.05483755096793175,0.000449099374236539,0.006735488772392273,0.10394756495952606,0.41313955187797546,-0.04925607889890671,0.40987512469291687,-0.1961202621459961,-0.055834826081991196,-0.08863572776317596,-0.47874051332473755,-0.1535707265138626,0.39256128668785095,0.03442467376589775,0.02299114130437374},{0.24908339977264404,0.027228977531194687,0.238674134016037,-0.33173105120658875,0.019519854336977005,-0.4980456829071045,0.3638846278190613,0.2350511997938156,-0.0038233590312302113,-0.07565916329622269,0.0931534543633461,0.17206108570098877,0.035727109760046005,0.22568458318710327,-0.15425406396389008,-0.03409159183502197},{-0.13239656388759613,-0.13679970800876617,0.06555019319057465,0.20229074358940125,0.6409146785736084,-0.19086159765720367,-0.025250565260648727,0.1090063750743866,-0.16956660151481628,-0.3852803111076355,-0.4404441714286804,0.03418870270252228,0.2699957489967346,-0.48658183217048645,-0.275147944688797,0.32775360345840454},{-0.19760559499263763,0.12741777300834656,-0.26763489842414856,0.21398641169071198,0.17022457718849182,-0.029395395889878273,0.35008642077445984,0.08860500901937485,0.20754705369472504,0.16029852628707886,0.38919875025749207,0.022169025614857674,0.27430659532546997,0.017291495576500893,0.2591875493526459,-0.19210374355316162},{0.31308871507644653,0.12030305713415146,-0.011886625550687313,-0.08535034209489822,0.06324563920497894,0.10210184007883072,-0.1343621164560318,0.10568997263908386,-0.024678032845258713,-0.3308406174182892,0.15470130741596222,0.3789382874965668,0.17177514731884003,0.1262732446193695,-0.05077417939901352,0.3416712284088135},{-0.3705696165561676,0.18092544376850128,0.19843193888664246,0.13455380499362946,0.19421644508838654,0.16163484752178192,-0.1803847849369049,-0.13071900606155396,-0.28083932399749756,-0.13963240385055542,-0.00029823346994817257,-0.15041203796863556,0.2227543145418167,-0.24913311004638672,-0.3237173855304718,-0.0812416598200798},{0.626991331577301,-0.23703975975513458,-0.07076423615217209,-0.08187483996152878,0.017030993476510048,-0.191989928483963,-0.44923725724220276,0.13769976794719696,-0.28967806696891785,-0.20626799762248993,0.09897430986166,-0.2027524709701538,0.2047075480222702,0.2964554727077484,-0.3303804099559784,-0.5227586030960083},{0.44930723309516907,-0.2507449686527252,-0.21799471974372864,-0.23231066763401031,-0.25898948311805725,-0.30551496148109436,0.2479139268398285,0.45928096771240234,0.13550280034542084,0.22973036766052246,-0.06963679194450378,-0.09743217378854752,0.09638752788305283,0.30927303433418274,-0.6430548429489136,-0.10503016412258148},{-0.011219717562198639,0.0037027273792773485,-0.12371344119310379,0.04596942290663719,0.5304085612297058,0.5394794344902039,-0.47160813212394714,0.24299977719783783,0.14151878654956818,-0.257576584815979,0.3809697926044464,0.12713360786437988,-0.2529197633266449,0.1297730803489685,0.4999912679195404,-0.4667765498161316},{0.1577603667974472,-0.23245571553707123,0.5423598289489746,0.7936455011367798,-0.14218562841415405,0.1449231207370758,0.235626220703125,-0.22623419761657715,-0.043786779046058655,-0.04766734316945076,0.00021477890550158918,-0.00256208679638803,0.374066025018692,-0.21146905422210693,0.1940397024154663,0.434904009103775},{0.7601907849311829,-0.4448423385620117,-0.1219840943813324,0.18481968343257904,0.4552849233150482,0.2554548382759094,-0.267553448677063,-0.6255820989608765,0.17377276718616486,-0.03774847090244293,-0.47671008110046387,0.020761003717780113,-0.019870257005095482,-0.32173481583595276,-0.08623012155294418,-0.4476134777069092},{0.34575945138931274,0.554652750492096,0.22154077887535095,0.06103149801492691,0.13294421136379242,0.06545532494783401,0.5979592204093933,0.07261702418327332,-0.2942253053188324,-0.31750014424324036,-0.1800135225057602,0.2706729769706726,0.08692646771669388,0.22380049526691437,0.052818600088357925,0.33208024501800537},{0.26671668887138367,-0.024606700986623764,0.35617950558662415,0.1051688939332962,-0.1094028502702713,0.025335634127259254,0.19913527369499207,0.5587520599365234,0.041255053132772446,0.11699476838111877,-0.13976775109767914,0.27203506231307983,0.24064002931118011,0.2411441206932068,-0.20260652899742126,0.3715045750141144},{-0.015328745357692242,-0.03172818571329117,0.2027754783630371,0.3992578387260437,-0.4658937156200409,-0.25789889693260193,-0.19874891638755798,-0.3318132758140564,-0.0651661679148674,-0.08517508953809738,-0.21966175734996796,-0.3839986026287079,0.18825210630893707,-0.2286611944437027,-0.5932503342628479,0.30322787165641785},{-0.12468275427818298,0.05073529854416847,-0.11998610198497772,-0.4553103744983673,0.030892882496118546,0.11008241772651672,0.11978748440742493,-0.37130194902420044,-0.3935801088809967,0.3761061131954193,-0.34765559434890747,0.31530115008354187,-0.051102522760629654,-0.35577112436294556,-0.46794915199279785,-0.11887801438570023},{0.06359978020191193,-0.006699804682284594,0.31044551730155945,0.08771638572216034,-0.1390409618616104,0.15909810364246368,-0.01903391256928444,-0.11906872689723969,-0.26549211144447327,-0.10358275473117828,-0.2656222879886627,0.12305529415607452,-0.05411575362086296,-0.0329228937625885,-0.18103091418743134,0.27187255024909973},{-0.19874626398086548,-0.12079846113920212,-0.06223820149898529,-0.013905446045100689,-0.009216432459652424,-0.17421162128448486,-0.36275750398635864,0.07923662662506104,0.34108948707580566,0.03261279687285423,0.014055528677999973,0.07295246422290802,-0.22170338034629822,-0.15629126131534576,-0.05722028389573097,0.21223105490207672},{0.20401805639266968,-0.16760782897472382,0.0024242934305220842,-0.1147332414984703,-0.023255199193954468,0.05146145075559616,-0.007976778782904148,-0.32694336771965027,-0.13553881645202637,-0.12615256011486053,0.025470852851867676,-0.39029210805892944,0.18711420893669128,0.3354102075099945,-0.1493600308895111,-0.2957015037536621}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.20472846925258636,0.636975884437561,-0.2978813350200653,0.27082279324531555,-0.4605412781238556,0.6022452116012573,0.013919739052653313,0.03444930538535118,-0.22281138598918915,0.5422956943511963,-0.03976517543196678,-0.15440472960472107,0.10930689424276352,0.2821192443370819,0.14218731224536896,0.18415877223014832},{-0.48768332600593567,0.057175736874341965,0.3323468267917633,-0.1393822878599167,-0.3824526071548462,-0.0648033395409584,0.37184059619903564,0.4349198341369629,-0.19500023126602173,-0.19861526787281036,-0.14821304380893707,-0.06605712324380875,-0.12182007730007172,0.00870238896459341,-0.34019139409065247,-0.5315350294113159},{0.36306726932525635,-0.35522374510765076,0.2331833839416504,0.2742002606391907,-0.2037801444530487,-0.07656557112932205,-0.06252177059650421,0.15999220311641693,0.31392747163772583,-0.07206083834171295,-0.14527587592601776,-0.2527708113193512,0.08434785902500153,0.3101690411567688,-0.13464237749576569,-0.22899501025676727},{-0.10926657170057297,-0.24888205528259277,0.05485111474990845,-0.417327344417572,-0.04477708786725998,0.005333873443305492,0.09379985183477402,-0.008606834337115288,0.13800209760665894,0.17037613689899445,-0.35577255487442017,-0.07627209275960922,-0.11274515837430954,0.11426379531621933,-0.06413928419351578,-0.16392254829406738},{0.1470738798379898,-0.0483795665204525,-0.5144457817077637,0.09391231089830399,0.02485477738082409,0.23302191495895386,0.2690790593624115,0.5906811952590942,0.08407897502183914,0.3362412452697754,-0.001176420133560896,-0.4555324912071228,-0.10380586981773376,-0.196721151471138,0.2863887846469879,0.5222793221473694},{-0.272534042596817,0.1898547112941742,-0.3924616277217865,-0.03753475472331047,0.15268395841121674,0.17707067728042603,-0.12502598762512207,-0.37584584951400757,-0.14753678441047668,0.13859987258911133,-0.09672363102436066,0.04738609120249748,-0.11387084424495697,-0.34246307611465454,-0.009110682643949986,-0.034918561577796936},{-0.21044360101222992,-0.24113184213638306,-0.05917815491557121,0.20902328193187714,-0.09509055316448212,-0.017146283760666847,0.27696019411087036,0.16620272397994995,0.3219567835330963,-0.1049453467130661,-0.3349168300628662,0.3448210060596466,-0.20621472597122192,-0.01105613261461258,0.3197154998779297,-0.15006501972675323},{0.10618606209754944,0.301357239484787,0.22672683000564575,-0.1222580298781395,-0.019173331558704376,-0.04542294517159462,0.05550457909703255,0.25734129548072815,-0.09842357784509659,-0.3903750479221344,-0.342603474855423,0.4549767076969147,-0.3376936912536621,-0.11675231903791428,-0.013438149355351925,-0.3602379262447357},{0.3541600704193115,-0.3457195460796356,-0.36725008487701416,0.15958531200885773,-0.25607940554618835,0.17850255966186523,-0.4328917860984802,-0.18722231686115265,0.30147188901901245,0.31762516498565674,-0.3130992650985718,-0.145185187458992,0.12159574031829834,-0.23873983323574066,-0.28779152035713196,0.16803093254566193},{-0.15893061459064484,0.438933789730072,0.06878535449504852,0.13732361793518066,0.2322128713130951,0.2559241056442261,-0.40736624598503113,-0.3564753830432892,-0.110528364777565,-0.3588098883628845,-0.18658678233623505,0.11922023445367813,-0.13097737729549408,-0.18587727844715118,-0.14399796724319458,-0.1507992148399353},{0.07655861228704453,0.37971019744873047,-0.25431329011917114,0.1376240849494934,-0.42221033573150635,-0.05522849038243294,-0.40198567509651184,0.14202699065208435,0.21243377029895782,-0.421949177980423,-0.21964368224143982,-0.40238282084465027,-0.08205351233482361,0.099574513733387,-0.4441162347793579,0.025608841329813004},{0.18658557534217834,0.18320241570472717,0.27144303917884827,-0.1147620752453804,-0.26387810707092285,0.36507612466812134,0.10435868054628372,-0.12886175513267517,0.10291743278503418,-0.08418457955121994,-0.06725049018859863,0.3986450433731079,0.1522887647151947,-0.31476500630378723,-0.012379531748592854,0.039227619767189026},{0.392803430557251,0.04179442301392555,-0.0433313250541687,0.08270808309316635,-0.08474451303482056,0.19054727256298065,0.21427613496780396,-0.1007552519440651,-0.34766313433647156,0.05052713304758072,0.1290220469236374,-0.534701943397522,-0.23199278116226196,0.03879721462726593,0.24190400540828705,0.15227507054805756},{-0.03351445123553276,0.2678581178188324,0.004950713366270065,-0.038167472928762436,0.030843373388051987,-0.13356782495975494,-0.11670142412185669,0.05201850086450577,-0.2696628272533417,0.030648043379187584,-0.3594943881034851,-0.2806737422943115,-0.03561428561806679,0.31465014815330505,-0.14671631157398224,0.18765926361083984},{0.422962486743927,-0.15198156237602234,-0.47413909435272217,0.10514044761657715,0.07650364190340042,-0.1480606496334076,0.3327969014644623,-0.3517622649669647,-0.47290393710136414,0.13322457671165466,-0.12292215973138809,-0.43423447012901306,-0.4338543713092804,0.20807266235351562,-0.49730613827705383,-0.08164944499731064},{0.03835354372859001,-0.4486508369445801,-0.2719520330429077,-0.2035837322473526,-0.015870748087763786,-0.38593125343322754,-0.027191637083888054,0.3207996189594269,0.3699190616607666,-0.15792766213417053,-0.13470907509326935,-0.276872456073761,-0.3926001489162445,0.5073146224021912,-0.31172746419906616,0.06119861453771591}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.19535750150680542,-0.4645845890045166,0.14858359098434448,-0.36397644877433777,-0.3289697766304016,0.2753985524177551,0.3636021912097931,-0.32083526253700256,0.30378347635269165,0.1488865315914154,0.04121309891343117,0.44403350353240967,-0.2570522725582123,-0.020765257999300957,-0.10600826889276505,0.25007081031799316,-0.23256351053714752,0.03965906798839569,0.28487586975097656,-0.02553403005003929,0.3074747323989868,0.3186422884464264,0.1835450530052185,0.29063650965690613},{0.12220733612775803,-0.12718330323696136,-0.27729082107543945,-0.09773926436901093,-0.11556961387395859,0.1411413699388504,-0.008418734185397625,0.06624126434326172,-0.3288465440273285,-0.08000358939170837,-0.5242100358009338,-0.0347747877240181,0.44685429334640503,-0.2588561773300171,-0.16538259387016296,0.26356884837150574,-0.17115266621112823,-0.020536914467811584,-0.22629377245903015,-0.22567617893218994,0.4163898527622223,0.03799143806099892,-0.25051644444465637,0.1263594925403595},{-0.14521212875843048,0.040966711938381195,0.1528128981590271,-0.2776951789855957,0.27942562103271484,0.2020852118730545,-0.10390064120292664,0.41925477981567383,-0.40140095353126526,0.12957121431827545,-0.2327447384595871,-0.2178075909614563,-0.2665393352508545,0.1316908299922943,0.366193026304245,0.23941867053508759,0.017463868483901024,0.19252599775791168,-0.019761506468057632,0.024545421823859215,0.2743021547794342,-0.23666922748088837,-0.1406145691871643,0.015930017456412315},{0.09826189279556274,-0.3215300142765045,0.09614567458629608,-0.012036405503749847,0.045797355473041534,0.38412779569625854,0.10579255223274231,-0.26477286219596863,-0.30932602286338806,-0.22227521240711212,-0.34346845746040344,0.25133731961250305,0.13525807857513428,-0.15271246433258057,0.32004040479660034,-0.3345508873462677,-0.16326162219047546,-0.18697313964366913,-0.3340490162372589,-0.18427784740924835,-0.07678716629743576,-0.25418373942375183,-0.3496417999267578,0.08233153074979782},{-0.24714209139347076,-0.3596509099006653,0.26179569959640503,0.08053494244813919,0.07097186893224716,-0.3742515742778778,0.027897842228412628,-0.2912280857563019,0.0016362413298338652,0.18289588391780853,-0.1741546094417572,0.2660042643547058,0.22447317838668823,0.26354116201400757,0.1997852921485901,-0.22007286548614502,-0.15855719149112701,0.08480221778154373,0.0693957507610321,0.21784774959087372,0.12154687196016312,-0.42006823420524597,-0.3612641394138336,-0.2947089374065399},{0.14005358517169952,0.30555006861686707,-0.3384130895137787,-0.11670571565628052,-0.15050534904003143,0.335130512714386,-0.09897464513778687,-0.17770174145698547,-0.10484948009252548,-0.07268930226564407,0.03968164697289467,-0.11073582619428635,-0.001542867859825492,0.22190384566783905,0.31949010491371155,-0.373012900352478,0.1175161674618721,0.17616483569145203,-0.4445702135562897,0.026656581088900566,-0.19914893805980682,0.009050498716533184,0.1820511817932129,-0.06345763802528381},{0.11610841006040573,0.015144011937081814,0.42482298612594604,0.28166869282722473,0.3306135833263397,0.20046430826187134,-0.22434504330158234,0.3044965863227844,-0.0732404813170433,-0.22645920515060425,-0.1433180421590805,0.26830071210861206,-0.2958521842956543,0.18700437247753143,0.16539046168327332,-0.24804724752902985,0.057410821318626404,-0.008155730552971363,0.2775420546531677,-0.11103715747594833,-0.036128345876932144,0.17192505300045013,-0.1017208844423294,-0.004532684572041035},{-0.060284994542598724,-0.33014553785324097,0.042089130729436874,0.011404070071876049,0.10530482232570648,0.42435526847839355,-0.3089134991168976,-0.28859567642211914,0.2856854796409607,-0.04250745847821236,0.26665616035461426,0.24040263891220093,-0.5120791792869568,-0.03315197676420212,-0.23826216161251068,-0.3423713743686676,-0.29103076457977295,-0.2804104685783386,-0.26202279329299927,0.06813279539346695,0.21706880629062653,0.38325539231300354,-0.2728530168533325,0.10217531770467758},{0.1708373725414276,-0.11804387718439102,0.18638254702091217,-0.18323835730552673,0.15006080269813538,0.30235007405281067,0.1254885047674179,-0.23353151977062225,-0.18180632591247559,0.20038025081157684,0.35625019669532776,0.11137707531452179,-0.02986740879714489,0.2910129129886627,-0.2692336440086365,0.24813395738601685,0.025872690603137016,0.07923369109630585,-0.08017724007368088,0.14333359897136688,0.10224367678165436,0.0631394162774086,-0.02894481085240841,-0.16094370186328888},{-0.2022232562303543,-0.09509328752756119,-0.3552961051464081,-0.3781922459602356,0.01664627343416214,-0.26479777693748474,-0.08015167713165283,0.2735825479030609,-0.21327193081378937,0.05060612037777901,0.2521669864654541,0.15972256660461426,-0.08506801724433899,-0.20038087666034698,0.10965181142091751,0.19266535341739655,-0.00866679847240448,-0.24328793585300446,0.15227451920509338,-0.4029637575149536,-0.36417877674102783,0.28583019971847534,-0.3569813668727875,0.09211765229701996},{0.09533102065324783,-0.1785636842250824,-0.12277084589004517,0.14259012043476105,0.04559607058763504,-0.006905492395162582,-0.13023804128170013,-0.16766086220741272,-0.08255085349082947,-0.105929896235466,0.35981225967407227,-0.22001303732395172,-0.11438284814357758,-0.20075015723705292,-0.4761655628681183,0.09720514714717865,0.09272530674934387,0.050422895699739456,-0.24698086082935333,0.08293546736240387,-0.11528699845075607,0.2001633644104004,-0.01303460169583559,-0.10530003905296326},{0.16089434921741486,-0.1597089320421219,-0.19862908124923706,-0.28266462683677673,0.08785322308540344,0.3057619333267212,0.2729484438896179,0.3717808723449707,-0.2984904646873474,-0.2760942876338959,0.18355293571949005,-0.2502281665802002,0.10148876905441284,-0.032722122967243195,0.23613764345645905,-0.0546274334192276,0.10320127755403519,0.20233996212482452,0.1609901636838913,-0.05007210001349449,-0.3418593406677246,-0.3564884662628174,0.25436022877693176,0.20347082614898682},{0.0347946435213089,0.1324603110551834,0.2536919414997101,0.23943625390529633,0.31496116518974304,-0.2393222600221634,-0.013392958790063858,-0.16155868768692017,-0.25213757157325745,-0.34814491868019104,-0.023449711501598358,0.042577262967824936,-0.15126360952854156,-0.13082459568977356,0.10957687348127365,0.2734638750553131,-0.052840832620859146,0.019077634438872337,-0.3741864264011383,-0.27874818444252014,0.11699100583791733,-0.2139374166727066,-0.16267986595630646,-0.27077844738960266},{0.1737603098154068,-0.1458383947610855,-0.23978571593761444,0.07979634404182434,0.24751485884189606,0.13863331079483032,0.21305309236049652,0.003944155760109425,0.22126026451587677,0.4801335334777832,-0.06188514456152916,0.018270988017320633,0.3197230398654938,-0.39596715569496155,0.23784729838371277,0.024858856573700905,0.17620375752449036,-0.28269657492637634,0.45128771662712097,-0.10454251617193222,-0.13154320418834686,0.1652917116880417,0.3057768940925598,-0.012720822356641293},{-0.058744095265865326,0.32882845401763916,0.27099108695983887,0.2001284956932068,0.0706009492278099,-0.2482384592294693,0.29818904399871826,0.08548115193843842,-0.05776041001081467,-0.31366851925849915,0.3142910897731781,-0.040783148258924484,-0.10880441963672638,0.17051155865192413,-0.3508989214897156,-0.06616410613059998,-0.2710040509700775,-0.20262733101844788,-0.08640440553426743,0.011495365761220455,-0.22696122527122498,0.2168012112379074,0.04427776485681534,0.21350757777690887},{-0.18988704681396484,-0.4295212924480438,0.050118885934352875,-0.33650895953178406,0.09446550160646439,-0.133818581700325,0.0710177943110466,-0.16180069744586945,-0.20177534222602844,0.1933877021074295,0.15097472071647644,0.28914961218833923,-0.1674124002456665,0.39949288964271545,0.1384933888912201,0.10846441239118576,-0.1544584184885025,-0.056718550622463226,-0.23990361392498016,-0.25801053643226624,-0.015192092396318913,-0.1464078426361084,-0.37081265449523926,-0.21194764971733093},{0.27644726634025574,-0.07029140740633011,0.17686355113983154,0.3184564709663391,-0.061783213168382645,0.03725673258304596,0.0013021368067711592,0.2846999764442444,0.23708957433700562,-0.11512760072946548,-0.10405108332633972,0.008962897583842278,-0.2562582194805145,-0.1034608855843544,-0.008219236508011818,0.3316393792629242,0.32648518681526184,-0.11926490068435669,0.1918199211359024,0.043333448469638824,0.0582471564412117,0.01538853533565998,0.10275185108184814,-0.08317946642637253},{0.1708085834980011,0.11065918952226639,-0.01987231895327568,-0.3086596429347992,0.2346222847700119,0.16448095440864563,0.25846433639526367,0.3826606273651123,0.17269040644168854,-0.02935776486992836,0.26219090819358826,-0.3909947872161865,0.07075058668851852,0.02214515209197998,-0.1235925480723381,-0.2186962068080902,-0.20604032278060913,-0.08182612806558609,-0.32741397619247437,0.3324267566204071,0.039430659264326096,-0.3577498495578766,0.22820115089416504,0.15149028599262238},{0.15493907034397125,-0.11151167005300522,-0.062029074877500534,-0.23496636748313904,0.08227542042732239,-0.13052116334438324,-0.3030548393726349,-0.13703805208206177,-0.30650952458381653,-0.38544031977653503,-0.3250751793384552,0.04422483965754509,-0.24570509791374207,-0.21713532507419586,0.20876574516296387,0.3744122385978699,0.18019084632396698,-0.24913649260997772,-0.2427188754081726,0.17887179553508759,0.347859650850296,-0.01016942784190178,-0.08047106862068176,0.1332780122756958},{0.2281530499458313,0.38455092906951904,-0.10615404695272446,0.2392100840806961,0.2206835150718689,-0.40303757786750793,-0.14827249944210052,0.2778775095939636,0.08951084315776825,-0.17523106932640076,0.2700630724430084,-0.06337428092956543,0.04439576715230942,0.1220167726278305,0.026319127529859543,-0.019970517605543137,0.31253835558891296,0.2581351697444916,-0.25207239389419556,-0.18229350447654724,0.039709411561489105,0.07222673296928406,0.005610758904367685,0.04526502639055252},{-0.16596858203411102,0.4118684232234955,-0.1567974090576172,0.03377425670623779,-0.07587570697069168,0.15432202816009521,0.0004293590027373284,0.17762848734855652,0.07615397125482559,0.2539874017238617,0.16568057239055634,-0.31568390130996704,-0.06217396631836891,0.1377306580543518,-0.1350153237581253,0.14165052771568298,-0.3163735568523407,0.17033950984477997,0.028120504692196846,0.30807214975357056,0.1266050636768341,-0.02115739695727825,0.046342067420482635,0.12583932280540466},{-0.058396097272634506,0.3869784474372864,0.3964698612689972,-0.18965290486812592,-0.3173370361328125,0.10465237498283386,-0.022154590114951134,0.018377650529146194,-0.3032088875770569,-0.3371233642101288,-0.2748695909976959,0.030305933207273483,0.1897502839565277,0.017969761043787003,0.03419318050146103,-0.3551657795906067,-0.1137370616197586,0.1206657737493515,-0.014829843305051327,-0.16528019309043884,-0.04927891120314598,-0.11530168354511261,0.028101686388254166,-0.2565132677555084},{0.009035790339112282,-0.2880385220050812,-0.02944330684840679,-0.046803757548332214,0.0997292622923851,0.04428234323859215,0.07960006594657898,-0.2772432565689087,-0.11523516476154327,0.2545415759086609,-0.24841684103012085,-0.03926951065659523,-0.17339323461055756,0.19172251224517822,-0.201552614569664,-0.01733800396323204,0.3214281499385834,0.12374749779701233,-0.20156806707382202,-0.14756281673908234,0.011845654807984829,0.1613186150789261,0.1165773794054985,0.3232720196247101},{0.2683880925178528,0.10784173011779785,-0.20689348876476288,-0.3482936918735504,0.18123064935207367,0.33509719371795654,0.23938560485839844,0.017849141731858253,-0.24318118393421173,-0.2555310130119324,0.3001142144203186,-0.13442423939704895,-0.14277899265289307,-0.32137393951416016,0.3078175187110901,-0.19874024391174316,-0.026056163012981415,0.033012665808200836,0.3520300090312958,0.14913272857666016,-0.022132009267807007,-0.07756572961807251,-0.3370562493801117,0.007016525603830814}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.3122890591621399,0.4697994291782379,-0.33814507722854614,0.021968688815832138},{-0.21141336858272552,0.23808643221855164,0.1438482105731964,0.05962758883833885},{-0.4102892577648163,-0.056636739522218704,-0.4205528795719147,-0.094185471534729},{-0.2050352394580841,0.08043353259563446,-0.05244486778974533,-0.1411190927028656},{0.26163479685783386,0.10636204481124878,-0.3215494751930237,-0.356876015663147},{-0.00023133450304158032,0.22573666274547577,0.09438120573759079,-0.017855342477560043},{0.4937977194786072,-0.3883562386035919,-0.059509068727493286,0.3590708374977112},{-0.18582838773727417,0.1735709011554718,0.1115722507238388,-0.09944707900285721},{-0.415993332862854,0.3699646592140198,0.10925893485546112,0.38024112582206726},{0.21371249854564667,0.42234930396080017,-0.30653107166290283,0.2720128893852234},{-0.18010349571704865,-0.06261073797941208,-0.23543410003185272,-0.33451658487319946},{-0.2633705139160156,-0.42417821288108826,-0.29663899540901184,0.19010192155838013},{0.32709571719169617,0.14331956207752228,0.4487772583961487,0.30242347717285156},{-0.048182208091020584,-0.42316216230392456,-0.23515194654464722,-0.21521338820457458},{-0.05646101012825966,0.2848599851131439,0.22158381342887878,-0.0546308271586895},{0.4778854548931122,0.24969182908535004,0.13410519063472748,-0.044956907629966736},{0.24442662298679352,0.23043832182884216,-0.3697613775730133,0.02142692357301712},{-0.3452851474285126,0.02162439003586769,-0.342018187046051,0.3984130322933197},{-0.3846328854560852,0.4219653010368347,-0.12099321186542511,-0.06755121797323227},{-0.21705122292041779,-0.12867258489131927,-0.42213526368141174,0.22128356993198395},{-0.3469923138618469,-0.30639559030532837,0.21472445130348206,0.2818925380706787},{-0.2910766899585724,-0.21740782260894775,0.23833461105823517,-0.4632952809333801},{0.279060959815979,0.37525755167007446,0.012993387877941132,0.26066040992736816},{-0.1890120655298233,-0.08134995400905609,0.14284388720989227,-0.028914043679833412}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.006502182222902775,0.1044272929430008,-0.16436785459518433,-0.14111174643039703,-0.045273151248693466,0.04512757062911987,0.06673286110162735,-0.007397386711090803,-0.16410864889621735,0.013738981448113918,0.03319047763943672,0.06883307546377182,-0.028522973880171776,0.03507407009601593,-0.13317202031612396,-0.15899327397346497};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0377824492752552,0.1556745022535324,0.02430826425552368,0.01071525551378727,-0.02763589471578598,0.011507009156048298,-0.0219956673681736,0.019202809780836105,-0.042738333344459534,-0.04103343188762665,0.024626854807138443,0.05809187889099121,0.0846429243683815,-0.04835464432835579,0.0051629021763801575,-0.11616752296686172};
static const float actor_encoder_feed_forward_0_bias[24] = {0.015127971768379211,0.14300720393657684,0.047028008848428726,0.03747376427054405,-0.02560432441532612,-0.02672780118882656,-0.0654241219162941,0.09194928407669067,-0.05792340263724327,-0.05015706643462181,-0.01910734362900257,-0.06938909739255905,-0.02193821407854557,0.033830974251031876,0.028641939163208008,0.03420701250433922,-0.003165591973811388,-0.009637939743697643,-0.015453681349754333,-0.012669895775616169,0.022652633488178253,-0.00868922658264637,-0.001861718250438571,-0.0022544802632182837};
static const float action_parameterization_distribution_linear_bias[4] = {-0.024077963083982468,0.011805707588791847,-0.0011961193522438407,-0.03680305927991867};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{0.11395666748285294,-0.48438748717308044,-0.35610347986221313,-0.22003889083862305,0.3308875858783722,-0.06540930271148682,0.3346557319164276,0.24920186400413513},{-0.25707510113716125,-0.3406306207180023,0.18212193250656128,-0.39410150051116943,0.2106798142194748,-0.18713364005088806,-0.022932088002562523,0.051672350615262985},{0.014414406381547451,0.1667359471321106,-0.4518291652202606,0.3481796383857727,0.3674512207508087,-0.3728748857975006,-0.5270217657089233,0.25622618198394775},{0.5328375101089478,-0.17312873899936676,0.25292253494262695,0.34302395582199097,-0.17456264793872833,-0.3842015266418457,0.446356862783432,-0.3904572129249573},{-0.4267416000366211,0.5204796195030212,-0.07191917300224304,0.1291876584291458,0.03448548913002014,-0.07058920711278915,0.10282235592603683,-0.06388784945011139},{-0.3568919003009796,-0.31455838680267334,0.21793711185455322,0.4059528112411499,-0.16078686714172363,-0.3012916147708893,-0.12852895259857178,0.21014750003814697},{-0.5812925100326538,-0.3746964633464813,-0.08261977136135101,0.2591135501861572,-0.5541498064994812,-0.3214047849178314,-0.1298017054796219,-0.08499941974878311},{-0.05286769941449165,0.56718909740448,0.22572167217731476,-0.43132638931274414,0.036494262516498566,-0.18259547650814056,0.6620844006538391,-0.07071960717439651},{-0.49125123023986816,-0.34627991914749146,0.07686591148376465,-0.055218689143657684,-0.4842067062854767,-0.31393760442733765,0.12964949011802673,0.2190927267074585},{-0.2781278192996979,0.4732483923435211,0.24856023490428925,-0.09604310989379883,-0.23126110434532166,-0.5381744503974915,0.3483048677444458,-0.38380855321884155},{0.4218897819519043,0.16795159876346588,-0.09199865907430649,-0.2766096889972687,-0.2459486424922943,0.11366678029298782,0.38023632764816284,-0.12660832703113556},{0.22061511874198914,-0.41306599974632263,-0.2133510261774063,0.08254306763410568,-0.5135840177536011,0.23743171989917755,-0.2047545313835144,0.21142807602882385},{0.3477870225906372,0.4056338667869568,0.009160858578979969,-0.3015926480293274,-0.07941101491451263,-0.5601152181625366,-0.01598854549229145,0.3552328050136566},{0.16048608720302582,-0.19892604649066925,-0.33223530650138855,-0.3762669563293457,0.006562940310686827,0.01464439369738102,-0.3809092938899994,0.5824244618415833},{-0.34668660163879395,-0.20261241495609283,-0.25105538964271545,-0.11769440770149231,-0.12845107913017273,-0.4750022292137146,0.35905060172080994,-0.0016550954896956682},{-0.15022240579128265,-0.40356871485710144,-0.4879651963710785,-0.4101690649986267,0.2742863595485687,-0.23392145335674286,-0.31868672370910645,0.2595653235912323}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.3411271274089813,0.10360102355480194,-0.39474526047706604,-0.3138754963874817,-0.4832077622413635,0.6233339309692383,-0.1391766220331192,0.1357141137123108},{-0.07701091468334198,0.04387363791465759,-0.5961644053459167,0.3289502263069153,0.08726780116558075,0.274742066860199,0.5287704467773438,0.3987348675727844},{-0.2885406017303467,-0.44206702709198,-0.603967547416687,0.3898371756076813,0.2076016068458557,-0.39016982913017273,0.45544061064720154,-0.1225583478808403},{0.4816185235977173,0.14433731138706207,0.2548343241214752,-0.45986008644104004,-0.35465890169143677,-0.594867467880249,-0.2879188656806946,0.3738500773906708},{-0.13880987465381622,-0.21260277926921844,-0.28555625677108765,0.20684026181697845,0.4763626456260681,-0.3552875816822052,-0.14348506927490234,0.010037277825176716},{0.26293715834617615,-0.42407745122909546,-0.3206256926059723,-0.23280617594718933,-0.4972609579563141,-0.16165116429328918,-0.02899828739464283,0.196847602725029},{0.3251166343688965,0.5380921959877014,-0.30499160289764404,0.7085538506507874,-0.20469076931476593,0.32271167635917664,0.16274073719978333,0.27766603231430054},{0.09332766383886337,-0.15118557214736938,0.5519542098045349,0.40879178047180176,0.585299551486969,0.2180822789669037,0.015368071384727955,-0.1436726301908493}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.05049622431397438,-0.026208333671092987,-0.029453638941049576,-0.02795790694653988,-0.05541393160820007,-0.15718884766101837,-0.05953936278820038,0.11515935510396957};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.013053903356194496,-0.07821590453386307,0.07026627659797668,0.10452587157487869,0.027592428028583527,0.024523502215743065,0.007972889579832554,0.017998818308115005};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

