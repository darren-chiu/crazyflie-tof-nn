
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.579218327999115,0.26842010021209717,0.0835069939494133,-0.10963264107704163,-0.14156021177768707,0.02802749164402485,0.0527544766664505,0.09502566605806351,-0.2034006118774414,0.12356991320848465,-0.07793398946523666,0.057471178472042084,0.0649099126458168,0.07975762337446213,0.042818259447813034,0.21476750075817108},{0.07224281132221222,0.1864767223596573,-0.012059046886861324,0.18164438009262085,-0.29719245433807373,0.11121504008769989,-0.09342605620622635,0.011908461339771748,0.42450180649757385,-0.1792265921831131,-0.26733335852622986,-0.37269172072410583,0.09104671329259872,-0.030658040195703506,0.3527604937553406,-0.07194313406944275},{0.023492857813835144,-0.23442442715168,-0.11762134730815887,0.7120067477226257,-0.14059610664844513,-0.792060375213623,-0.03294111415743828,0.14195600152015686,-0.17680369317531586,0.3790735602378845,0.08704593777656555,-0.2605241537094116,0.35411518812179565,0.2752678692340851,0.1702377051115036,-0.17751911282539368},{0.3266686797142029,-0.1892007738351822,-0.11714164167642593,0.014283410273492336,-0.20058919489383698,0.22937534749507904,0.27222496271133423,0.052016302943229675,-0.2509029507637024,0.20943835377693176,0.08206812292337418,-0.047659218311309814,0.04798354580998421,-0.07448195666074753,0.03961319848895073,0.16608233749866486},{0.26286745071411133,0.21666181087493896,0.03684798255562782,0.12070747464895248,-0.15655483305454254,0.24445673823356628,-0.15036936104297638,0.018810365349054337,0.1356976181268692,-0.16914893686771393,-0.15653379261493683,0.2619977593421936,-0.18122616410255432,0.04902428388595581,0.5273357629776001,-0.18627247214317322},{0.13223114609718323,0.13532423973083496,-0.0471046157181263,0.3262597918510437,-0.10170947015285492,0.04099184274673462,0.2548137307167053,-0.14639660716056824,-0.15168511867523193,0.05356431379914284,0.3154364228248596,-0.42218008637428284,0.038295913487672806,0.4310753047466278,0.2753686010837555,-0.2561407685279846},{-0.13028009235858917,0.26030585169792175,0.1367296725511551,-0.2768252193927765,0.16349658370018005,-0.2638985216617584,0.5350396633148193,-0.1019512191414833,0.1350654512643814,0.404828816652298,0.08534025400876999,0.1525282859802246,-0.10224860906600952,0.21843428909778595,0.1802595555782318,-0.34648948907852173},{-0.3810405731201172,0.5433347821235657,0.12668612599372864,0.21127593517303467,-0.12872231006622314,0.3359385132789612,-0.29272589087486267,-0.2122153341770172,-0.023012254387140274,-0.23563219606876373,0.018431078642606735,0.022309085354208946,-0.2059328258037567,-0.09985268115997314,-0.13011687994003296,0.36385446786880493},{0.38860347867012024,0.4317912459373474,-0.6228397488594055,0.37759265303611755,-0.46284741163253784,0.15550579130649567,0.30053460597991943,0.5899124145507812,0.022733256220817566,0.2509397864341736,0.14857102930545807,-0.04131090268492699,-0.3673625588417053,-0.7475999593734741,-0.04878352954983711,0.5555603504180908},{-0.1688121110200882,0.05230557173490524,-0.24590273201465607,-0.31250354647636414,0.35770055651664734,-0.0292966365814209,-0.14471791684627533,0.2244865894317627,0.45012161135673523,0.3150705099105835,-0.10605502873659134,-0.1426108181476593,0.1929953396320343,0.18912957608699799,-0.41808903217315674,-0.18897594511508942},{0.2634674310684204,-0.17897547781467438,0.5053514838218689,-0.4218047857284546,0.17765747010707855,0.048675887286663055,0.40227359533309937,0.01690221205353737,0.46961674094200134,-0.206605926156044,-0.046287111937999725,0.08846554160118103,-0.30616363883018494,-0.047694310545921326,0.2650432288646698,-0.06340192258358002},{-0.2999145984649658,-0.17414696514606476,0.40480268001556396,0.5028179883956909,-0.720974326133728,-0.04948652535676956,-0.217637300491333,0.46736621856689453,-0.1427280306816101,-0.1861611157655716,-0.4819371700286865,-0.32417476177215576,-0.667980432510376,0.10955827683210373,0.08192392438650131,-0.5643019676208496},{-0.22108018398284912,0.5482872128486633,-0.32130908966064453,0.16281002759933472,0.03797997906804085,-0.295284628868103,-0.01519947312772274,-0.4494200348854065,-0.2312966287136078,0.6823964715003967,-0.3609731197357178,0.40807899832725525,0.6277554035186768,-0.34966135025024414,-0.493849515914917,0.10417193174362183},{0.05078140273690224,0.18525223433971405,-0.27237668633461,0.19321100413799286,-0.4105210602283478,-0.0007923409575596452,0.45473212003707886,-0.0002814803447108716,-0.04070666432380676,0.6868148446083069,-0.6079795360565186,-0.31034332513809204,-0.010906202718615532,-0.8840683102607727,0.5967192053794861,0.11700857430696487},{0.0683831200003624,-0.4437177777290344,-0.3927735984325409,0.12209942936897278,-0.2848472595214844,0.1347954124212265,0.22277987003326416,0.2915513515472412,-0.0698053166270256,-0.1105075553059578,-0.29623985290527344,0.37010735273361206,-0.03966158628463745,0.4427781105041504,-0.07890103757381439,0.24623209238052368},{0.09800241142511368,-0.3487204909324646,-0.0813630223274231,0.18488548696041107,-0.15163175761699677,0.34884244203567505,0.42767226696014404,0.12718306481838226,-0.1735905408859253,0.09117230772972107,-0.31573522090911865,-0.10485541075468063,0.17067304253578186,-0.17322902381420135,0.29390570521354675,0.0890091061592102},{0.2611722946166992,-0.19897165894508362,0.2184072732925415,-0.10019379109144211,-0.27583742141723633,0.38299664855003357,-0.27505484223365784,0.10433721542358398,-0.30136147141456604,-0.135088711977005,0.24369966983795166,-0.27778396010398865,-0.17959024012088776,0.1382027417421341,0.22717705368995667,-0.15163403749465942},{-0.05698835849761963,0.15080022811889648,-0.20652860403060913,0.1482289731502533,-0.30896949768066406,0.3404862880706787,0.11099567264318466,-0.352255642414093,-0.14590074121952057,-0.16521507501602173,-0.11871843039989471,0.3141137957572937,0.15205150842666626,0.0800127163529396,0.3049605190753937,-0.015387015417218208}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.209065780043602,0.31807366013526917,0.3878481090068817,-0.3139665722846985,0.31107231974601746,0.10943485796451569,0.07599511742591858,-0.28293222188949585,-0.11125446856021881,-0.04984525218605995,0.07885384559631348,-0.0726311057806015,-0.3283212184906006,0.3566173315048218,-0.32414647936820984,0.4137243628501892},{0.3986368179321289,0.0932968482375145,0.36917856335639954,0.39535459876060486,-0.3617434799671173,-0.07706978917121887,-0.07958328723907471,0.4030520021915436,-0.11173991858959198,-0.07183729112148285,-0.3038308322429657,0.008256109431385994,0.13861913979053497,0.2206323742866516,-0.005508732050657272,0.08060478419065475},{-0.30924752354621887,-0.08054884523153305,0.06229545176029205,0.2844175398349762,0.19483688473701477,-0.17221206426620483,0.3320297598838806,0.05553632602095604,-0.0995267778635025,0.1034909337759018,0.01747649535536766,-0.2619283199310303,0.08863040059804916,0.21039371192455292,-0.1396939903497696,-0.17857828736305237},{-0.10048763453960419,0.31918466091156006,0.2602025866508484,-0.3008003532886505,0.08560556918382645,-0.4623103141784668,-0.15130580961704254,0.082905612885952,0.2777096927165985,-0.6184958219528198,-0.0826743021607399,-0.2978653013706207,0.3526890277862549,0.2740965783596039,-0.2202720195055008,0.29505300521850586},{-0.29294800758361816,-0.12756718695163727,0.04675331711769104,-0.24275052547454834,0.27741071581840515,-0.18393613398075104,0.04395449534058571,0.08806423842906952,0.27674025297164917,0.4737260341644287,-0.21757474541664124,0.2373243272304535,-0.214658722281456,-0.14483313262462616,-0.37622398138046265,0.25260844826698303},{0.42853692173957825,0.18757233023643494,0.17561930418014526,0.20205099880695343,-0.02573394402861595,-0.2507835328578949,0.06990477442741394,0.37430235743522644,-0.2741324305534363,0.45687931776046753,-0.32550710439682007,-0.2702289819717407,0.11427230387926102,-0.37433287501335144,0.3007332384586334,0.13006049394607544},{0.2664467692375183,-0.24210281670093536,0.15376827120780945,-0.2837163209915161,0.32460567355155945,0.3510032296180725,-0.2123875468969345,0.11123810708522797,0.0814024955034256,-0.017973029986023903,0.03154860809445381,0.10104026645421982,-0.22289279103279114,0.19243386387825012,0.2058684527873993,-0.19197791814804077},{-0.2797563672065735,0.12182842940092087,-0.30001258850097656,-0.03415346518158913,0.22748273611068726,0.28672143816947937,-0.1317843794822693,-0.4118349552154541,0.02136446349322796,0.1849364936351776,0.3677847385406494,-0.35110414028167725,0.1769818663597107,0.015148545615375042,0.3486908972263336,0.1440582275390625},{-0.037132807075977325,-0.07825938612222672,0.07571011036634445,0.330495148897171,0.25796759128570557,-0.3195054531097412,0.1994706690311432,-0.21456001698970795,-0.0990956574678421,0.41904377937316895,0.11573914438486099,0.0024561595637351274,-0.17910055816173553,0.20860524475574493,0.273790568113327,-0.003334814915433526},{0.03520095720887184,-0.3664422631263733,0.28021058440208435,-0.14385519921779633,0.3265438675880432,0.11790718883275986,-0.10719143599271774,0.1681697517633438,0.3457692861557007,-0.0016386235365644097,-0.02549533173441887,0.03400973603129387,0.35988906025886536,0.1413232386112213,-0.4258885085582733,0.4324197471141815},{-0.12623389065265656,0.22333654761314392,-0.1755773425102234,-0.41211754083633423,-0.34972962737083435,-0.06620902568101883,0.3649851083755493,-0.38328635692596436,-0.438850075006485,-0.15744814276695251,-0.22107625007629395,-0.028281934559345245,0.28222766518592834,0.2899489402770996,-0.37616199254989624,0.3775228261947632},{0.4385204315185547,0.14531223475933075,0.07095108926296234,-0.22435899078845978,0.20334388315677643,0.03301088884472847,-0.10893414169549942,0.29053786396980286,-0.3039518892765045,-0.23812486231327057,-0.28735560178756714,-0.1970776617527008,0.1326841115951538,-0.08396238833665848,-0.026777129620313644,0.1726546287536621},{-0.3725779056549072,-0.09509364515542984,0.17204952239990234,0.19075925648212433,0.43640342354774475,0.06875510513782501,0.04374467208981514,0.3906189203262329,-0.27196767926216125,-0.33515965938568115,-0.3425696790218353,0.25101444125175476,-0.2601407766342163,0.21904458105564117,0.05416551232337952,0.3626331388950348},{-0.2557469308376312,-0.03440376743674278,-0.3708841800689697,-0.4616946280002594,-0.240708589553833,-0.11675290018320084,-0.20915313065052032,0.2613179087638855,-0.2410237193107605,-0.4707745909690857,-0.022468218579888344,0.30117860436439514,-0.3783680200576782,0.35316166281700134,-0.3217645287513733,-0.1634901911020279},{0.27681171894073486,-0.36733752489089966,-0.05747797340154648,-0.10480770468711853,-0.2630956768989563,-0.19804103672504425,-0.44837021827697754,0.18906018137931824,0.327361136674881,-0.07312042266130447,0.03413086757063866,0.24908095598220825,-0.19384422898292542,0.17193761467933655,0.07027072459459305,-0.17690575122833252},{0.30100202560424805,0.32987621426582336,0.19305762648582458,0.1737934798002243,-0.01010764017701149,0.3497355580329895,0.2940927743911743,0.34264281392097473,-0.26525968313217163,-0.016430670395493507,0.25826460123062134,0.047653909772634506,0.4212236702442169,-0.27885007858276367,-0.07415591925382614,-0.14220058917999268}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.22702142596244812,-0.31275200843811035,0.09219670295715332,0.21712283790111542,-0.06223968416452408,-0.34356799721717834,-0.04458695650100708,-0.3103543817996979,0.31121891736984253,0.3316154181957245,-0.04944289103150368,-0.03283518925309181,-0.15324430167675018,-0.1796419471502304,-0.04518138989806175,-0.16282330453395844,0.26782330870628357,0.41736677289009094,-0.09095658361911774,-0.05266999080777168,0.08400878310203552,0.23866155743598938,-0.14782151579856873,-0.2187987118959427,0.17859667539596558,-0.23660928010940552,0.28879255056381226,-0.09324748069047928,0.25338515639305115,-0.25366392731666565,-0.08323080092668533,-0.011319709941744804},{-0.17546513676643372,-0.26963305473327637,0.22263798117637634,0.29396671056747437,-0.07912461459636688,-0.10548882186412811,0.07436363399028778,-0.03506707772612572,-0.21966886520385742,-0.2313215136528015,-0.06611564755439758,-0.011473102495074272,0.3577263355255127,0.24649597704410553,0.03416433185338974,-0.153482586145401,-0.02965756691992283,-0.1329846978187561,-0.25548499822616577,0.28285327553749084,-0.007803608197718859,-0.4086245894432068,0.07047746330499649,-0.15012258291244507,-0.2650573253631592,-0.22679875791072845,0.2829468250274658,0.38663482666015625,-0.21788501739501953,-0.1411730796098709,0.020687684416770935,-0.19263312220573425},{-0.1141839325428009,0.05874190479516983,0.12174896895885468,-0.13836050033569336,0.11012622714042664,0.2351835072040558,-0.2453908622264862,-0.30431243777275085,0.01957361027598381,-0.1204068660736084,-0.08856343477964401,-0.02944142557680607,-0.05087122693657875,-0.29040467739105225,0.19662146270275116,0.12373500317335129,-0.23615865409374237,-0.05358549952507019,-0.28284144401550293,0.175357848405838,0.11109157651662827,-0.14072711765766144,0.2942778170108795,-0.25860485434532166,-0.17090663313865662,-0.14234566688537598,-0.19038595259189606,0.2801337242126465,-0.07439578324556351,-0.11558883637189865,0.020806336775422096,-0.16749005019664764},{0.34738847613334656,-0.12444309890270233,-0.19196179509162903,0.2306312769651413,0.11859966814517975,-0.06533249467611313,0.10782311856746674,-0.2447468340396881,0.24049519002437592,-0.020251840353012085,-0.018584072589874268,-0.2626420855522156,-0.2893667221069336,0.03190125897526741,-0.14249998331069946,-0.007365466561168432,0.20620155334472656,0.3266061544418335,0.16475410759449005,0.14591854810714722,-0.022400066256523132,-0.12725882232189178,-0.08583170920610428,-0.021685170009732246,0.1483263224363327,0.18475858867168427,0.23181693255901337,0.018064135685563087,-0.015185254625976086,0.01357103418558836,-0.002140114549547434,-0.1809014081954956},{0.0921582356095314,-0.021031418815255165,-0.24230897426605225,-0.4168291687965393,-0.08550147712230682,0.15517380833625793,-0.189297154545784,0.21297265589237213,-0.21095877885818481,0.23955431580543518,0.08951229602098465,0.13867872953414917,-0.1946730613708496,0.17041254043579102,0.32854852080345154,0.18899103999137878,-0.011883915401995182,-0.057644814252853394,-0.10417890548706055,-0.08602068573236465,0.2931585907936096,-0.079668790102005,-0.026594340801239014,0.18124446272850037,0.1709357053041458,-0.27739155292510986,-0.10506237298250198,-0.06385739147663116,0.16886749863624573,0.13591571152210236,0.027344489470124245,-0.33631426095962524},{0.23645539581775665,-0.1794142872095108,0.04549511894583702,-0.1610047072172165,0.1357305943965912,0.08065244555473328,0.09483799338340759,0.3324073553085327,-0.008025916293263435,-0.07610109448432922,-0.16633065044879913,-0.24018216133117676,0.10087946057319641,-0.029844339936971664,0.19991159439086914,0.1882724016904831,0.084324911236763,0.27406856417655945,0.005091305822134018,0.33127322793006897,-0.05257198587059975,-0.12587541341781616,-0.2114662230014801,0.0023092878982424736,0.017063481733202934,-0.3109481632709503,-0.3322431445121765,-0.27479565143585205,-0.028047339990735054,-0.14438201487064362,-0.06388802081346512,0.06001255661249161},{-0.17630913853645325,0.2714312672615051,0.1219894140958786,0.3625951111316681,-0.29900091886520386,0.10907258093357086,-0.15836390852928162,0.08506828546524048,-0.10667114704847336,0.08769573271274567,-0.1944148987531662,0.18055371940135956,-0.30510538816452026,0.2881025969982147,0.10742029547691345,0.07181920856237411,0.09403941035270691,-0.31501710414886475,-0.24409779906272888,-0.07900816202163696,0.0395113080739975,0.0032861880026757717,-0.14274238049983978,0.25157490372657776,0.32275086641311646,-0.17797863483428955,-0.2562282383441925,0.1186448261141777,0.22449882328510284,-0.05079296603798866,0.15102405846118927,-0.08513575792312622},{-0.197313129901886,0.06106889992952347,-0.016435641795396805,-0.02339041605591774,-0.03787687048316002,0.17353853583335876,0.050503600388765335,0.35815882682800293,-0.06514645367860794,-0.2834652066230774,0.2841900587081909,0.09019243717193604,-0.08715236186981201,0.2924802005290985,0.039914824068546295,-0.17242713272571564,-0.09789437055587769,0.26509806513786316,-0.06706312298774719,-0.08799660205841064,-0.008076098747551441,-0.2928934395313263,0.023996304720640182,-0.17586511373519897,-0.1290929764509201,0.04137743264436722,0.07076216489076614,0.13917748630046844,0.13119235634803772,-0.1946386992931366,-0.24220789968967438,0.08524955809116364},{-0.19912531971931458,-0.2531754970550537,-0.2891840636730194,-0.33947598934173584,0.09721127152442932,0.16781754791736603,0.09863786399364471,-0.17522388696670532,0.2888667583465576,0.17798008024692535,-0.13102005422115326,-0.276228129863739,-0.17545565962791443,-0.36360442638397217,-0.07085179537534714,-0.218464195728302,0.3254358470439911,-0.013058198615908623,0.25826650857925415,0.22594177722930908,-0.13520877063274384,-0.03638129308819771,-0.06692346185445786,-0.049798041582107544,-0.15027278661727905,0.16755296289920807,0.042975302785634995,-0.20742887258529663,-0.17570911347866058,0.3773564398288727,0.33354535698890686,-0.0008582153241150081},{0.49083372950553894,0.06466234475374222,-0.09977930784225464,-0.02419297769665718,-0.16512617468833923,-0.3074939548969269,-0.32438865303993225,-0.08280306309461594,0.26909708976745605,0.14970089495182037,-0.13725623488426208,0.1787368357181549,-0.13501833379268646,0.3165501058101654,-0.049444105476140976,-0.2912718653678894,-0.2180294543504715,-0.05021984875202179,0.09445275366306305,-0.22869805991649628,-0.18965952098369598,0.07392402738332748,-0.40844765305519104,-0.19528281688690186,-0.20611701905727386,-0.19216392934322357,-0.14490918815135956,-0.06709645688533783,0.1714877188205719,-0.14280730485916138,-0.11464938521385193,-0.07917572557926178},{-0.07910391688346863,-0.18494288623332977,0.05755535885691643,0.12422091513872147,0.12792135775089264,-0.13984070718288422,-0.04013393446803093,-0.02123938500881195,0.26057755947113037,-0.2915472090244293,0.21489445865154266,0.06599795073270798,-0.13931888341903687,0.34001967310905457,-0.25345951318740845,0.1509985327720642,0.30345118045806885,0.10050152242183685,-0.01235263142734766,0.25756749510765076,0.07874821871519089,0.09684234857559204,-0.17320092022418976,-0.09316059947013855,-0.1662730723619461,0.08617670834064484,-0.2875366508960724,-0.23109284043312073,-0.39278456568717957,0.05203438177704811,0.2088642120361328,-0.0011905942810699344},{0.19487041234970093,0.19824032485485077,0.31405842304229736,0.12365902215242386,0.30650851130485535,0.2547352910041809,0.2593667209148407,0.3302916884422302,-0.4411371350288391,0.15047383308410645,-0.15908129513263702,0.15157470107078552,0.33239641785621643,0.13559144735336304,-0.18692646920681,-0.2432936131954193,0.08047069609165192,0.2821711003780365,-0.027202345430850983,-0.31589850783348083,-0.22091133892536163,-0.09694373607635498,0.19030757248401642,0.3097139298915863,-0.2674659192562103,0.11930305510759354,-0.26668983697891235,-0.08299894630908966,-0.013133024796843529,-0.2860177755355835,0.26801279187202454,-0.09747219830751419},{-0.1174996942281723,-0.18579158186912537,0.11341475695371628,0.11388897150754929,0.2787081301212311,0.17228171229362488,0.3116190731525421,-0.4581664204597473,0.31887468695640564,0.3333306908607483,-0.21861468255519867,0.2638288140296936,-0.2975563406944275,0.15094244480133057,0.000357974466169253,-0.25562581419944763,0.15535645186901093,-0.1363396793603897,0.05883999541401863,0.006170083303004503,-0.3380880653858185,-0.10305912792682648,-0.313905268907547,0.18869808316230774,-0.09526337683200836,-0.18383494019508362,0.3164770305156708,0.06061610206961632,0.3849774897098541,0.25751689076423645,0.013015211559832096,0.09830605238676071},{0.011059578508138657,-0.23732028901576996,-0.07473304122686386,-0.25495898723602295,-0.12718385457992554,-0.18960215151309967,-0.13614194095134735,0.2397596687078476,0.3578297197818756,-0.1957039088010788,0.03746284544467926,0.2011069357395172,0.220745250582695,0.271634578704834,-0.32962286472320557,-0.0011889656307175756,0.27238860726356506,-0.21493642032146454,0.13760438561439514,-0.22595293819904327,0.2830280065536499,0.02542724646627903,0.16280868649482727,0.039274152368307114,-0.20562906563282013,0.19848164916038513,0.0404193177819252,-0.19311471283435822,0.20724359154701233,0.27695411443710327,0.2567038834095001,-0.020749088376760483},{0.23759084939956665,0.23051990568637848,0.03788270801305771,0.03702569380402565,-0.2886427044868469,-0.01782367378473282,-0.073487289249897,0.12263820320367813,-0.02901940606534481,0.207320898771286,0.2688702642917633,-0.15506680309772491,0.2578471601009369,-0.06171427294611931,-0.25461527705192566,-0.2359432727098465,-0.14060094952583313,-0.18083466589450836,-0.135305717587471,0.23699145019054413,-0.29460984468460083,0.012061593122780323,0.16048723459243774,-0.20094525814056396,-0.18378996849060059,-0.29133421182632446,-0.06299065798521042,0.1501360833644867,-0.19309501349925995,0.17507965862751007,-0.21683821082115173,-0.13827095925807953},{-0.013980133458971977,0.04616802558302879,0.21544697880744934,-0.12139001488685608,0.2332233488559723,0.04125842824578285,-0.1398022323846817,0.05563182756304741,-0.2914656400680542,-0.30277931690216064,-0.157509908080101,0.13923370838165283,-0.1712551712989807,-0.1622225046157837,-0.20115314424037933,0.12728936970233917,-0.1291939914226532,0.15875713527202606,-0.010404886677861214,0.21989035606384277,0.2626836597919464,0.19107137620449066,-0.21856394410133362,-0.010821018368005753,-0.3045840263366699,-0.30534306168556213,-0.10076966881752014,0.10261940956115723,0.166794091463089,0.0187838077545166,0.13503096997737885,-0.01117159053683281},{-0.15635600686073303,-0.2596642076969147,0.11680962890386581,-0.28614306449890137,-0.1085769385099411,0.28879639506340027,-0.04183328151702881,-0.00790872611105442,-0.3002874553203583,-0.014829515479505062,0.18907630443572998,0.13472925126552582,-0.11616285890340805,0.2607981264591217,0.16402234137058258,0.21466445922851562,0.26031482219696045,-0.1137595921754837,0.29676005244255066,0.3298681378364563,0.15490135550498962,0.3043564558029175,0.02643696218729019,-0.332920640707016,-0.09207247197628021,0.1310010552406311,-0.10449215769767761,0.014623601920902729,-0.11159022152423859,0.10310456901788712,0.07549049705266953,-0.18660520017147064},{0.1727054864168167,0.0010218448005616665,-0.13969004154205322,-0.021835464984178543,-0.07804206758737564,-0.08163098990917206,-0.015402349643409252,-0.21186120808124542,-0.07013475149869919,-0.376201331615448,-0.10123439133167267,0.07272201776504517,-0.013463380746543407,-0.26417985558509827,0.205113485455513,-0.32805773615837097,-0.06476987898349762,-0.08938837051391602,-0.07898756861686707,-0.12240469455718994,0.21501897275447845,0.12506847083568573,-0.0662042647600174,-0.1861240267753601,0.3157826066017151,0.221628338098526,-0.20082750916481018,0.06368709355592728,0.09219241142272949,0.24845509231090546,-0.12241040915250778,0.43032723665237427},{-0.1511445790529251,-0.23043686151504517,-0.09988502413034439,-0.03495868295431137,-0.05475880578160286,-0.13095195591449738,-0.09998320788145065,-0.2989978492259979,-0.05934017151594162,0.08793999999761581,-0.1468038409948349,-0.11508352309465408,-0.15379300713539124,-0.16203121840953827,0.18186591565608978,0.34671762585639954,-0.14199286699295044,0.0329374261200428,-0.05822795256972313,-0.17726387083530426,0.002757038688287139,0.06598759442567825,-0.06968650221824646,0.18416862189769745,-0.10290192812681198,-0.3840828537940979,-0.11458111554384232,-0.20955625176429749,-0.19029605388641357,-0.18221381306648254,0.15363001823425293,0.04770578444004059},{0.18324527144432068,0.29326117038726807,-0.024395549669861794,-0.3704071044921875,-0.31650224328041077,-0.15629355609416962,-0.30754354596138,0.30641812086105347,-0.1666853278875351,0.08017607033252716,-0.17825323343276978,0.15385380387306213,-0.3047425150871277,-0.08234129846096039,0.26587051153182983,-0.35022735595703125,-0.25685226917266846,0.03950872644782066,-0.020324496552348137,0.0357438288629055,-0.15984199941158295,-0.032361965626478195,-0.11647263914346695,-0.27733004093170166,0.31714364886283875,0.0031795832328498363,0.08619070798158646,-0.15843947231769562,0.22781425714492798,0.3034832775592804,-0.31546127796173096,0.15151922404766083}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.3130323588848114,0.3162221312522888,-0.08931931853294373,0.358804851770401},{-0.20129980146884918,0.2526085376739502,0.017677750438451767,-0.061100270599126816},{0.16527052223682404,0.17746120691299438,0.19058269262313843,-0.18882198631763458},{-0.2657643258571625,-0.36272335052490234,0.2636355757713318,-0.1382773220539093},{-0.15588319301605225,0.008513947017490864,-0.1698787659406662,-0.303230345249176},{-0.27266842126846313,0.06542672961950302,0.06968759000301361,-0.2657736539840698},{-0.3035062849521637,0.02121231146156788,0.05078078806400299,-0.09213656187057495},{-0.2314421832561493,-0.29381218552589417,0.2872669994831085,0.2656088173389435},{0.16270646452903748,0.17076508700847626,-0.2626764178276062,-0.2704174816608429},{-0.010379532352089882,0.1170959621667862,0.19056232273578644,0.03641867637634277},{-0.29921388626098633,-0.21614627540111542,-0.2684331238269806,0.2216339409351349},{-0.14374230802059174,-0.019319377839565277,-0.2809109687805176,0.028867371380329132},{0.12761498987674713,-0.04078886657953262,-0.2890321910381317,-0.28574880957603455},{0.36226028203964233,0.11168455332517624,-0.0007352011161856353,0.2772003710269928},{0.3230845630168915,0.08707573264837265,0.2958875000476837,-0.19935396313667297},{-0.23672612011432648,-0.155740424990654,-0.1519140601158142,-0.11696670204401016},{0.18975070118904114,-0.16871775686740875,-0.3053519129753113,-0.07127385586500168},{0.23915547132492065,0.23736204206943512,0.19408786296844482,-0.19147196412086487},{-0.08071369677782059,0.010278791189193726,0.010606871917843819,0.09022116661071777},{0.2748245298862457,0.3275129795074463,-0.1755610853433609,-0.40943238139152527},{-0.008157344534993172,0.20840883255004883,-0.308036744594574,-0.18202610313892365},{-0.002047322690486908,0.10612798482179642,0.05512747913599014,-0.04885268583893776},{0.09702648222446442,-0.23722027242183685,-0.2530983090400696,-0.1770852953195572},{0.21400345861911774,-0.21660210192203522,-0.12337386608123779,0.13125377893447876},{-0.028131702914834023,-0.044344257563352585,0.25064942240715027,0.2264232188463211},{-0.028623394668102264,-0.10703897476196289,0.2963070869445801,-0.2623085379600525},{0.17910146713256836,-0.19214686751365662,-0.01162932813167572,0.2352040559053421},{0.15015538036823273,-0.2573070824146271,0.21601799130439758,0.06571707129478455},{-0.2815091013908386,0.20217370986938477,0.035177577286958694,0.009121761657297611},{-0.06018209829926491,-0.3033159375190735,-0.2663058042526245,0.07296057790517807},{-0.3442770838737488,-0.03402433171868324,0.17245589196681976,-0.041986625641584396},{-0.012012524530291557,-0.182371124625206,-0.1347421556711197,0.003112661186605692}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.06411928683519363,-0.0464995875954628,-0.15450425446033478,0.0718739777803421,0.016689838841557503,0.012161379680037498,-0.040648192167282104,0.05758753418922424,-0.0688265711069107,-0.008680250495672226,-0.07016308605670929,0.05818683281540871,0.02524743601679802,0.08530991524457932,0.02711205556988716,-0.03846650570631027};
static const float actor_encoder_self_encoder_2_bias[16] = {0.047858670353889465,0.010802331380546093,-0.05188434198498726,-0.026139888912439346,0.0928487628698349,0.02854560688138008,-0.015725310891866684,0.01736382395029068,0.10063353180885315,-0.011077669449150562,-0.07730116695165634,-0.019259454682469368,0.017890358343720436,-0.0017062764381989837,-0.05046939104795456,-0.0005997518892399967};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.02139638550579548,-0.031189756467938423,0.018281690776348114,-0.06881548464298248,0.0158355925232172,-0.028016382828354836,0.02854696288704872,0.08789914846420288,0.001664192066527903,0.02777944877743721,-0.017413070425391197,-0.028184054419398308,-0.004620208404958248,0.0232828538864851,0.02985231578350067,-0.0252139363437891,0.010013380087912083,0.02731895074248314,-0.006754602771252394,0.035470880568027496,-9.972140833269805e-05,0.007000411860644817,-0.0013836434809491038,-0.009550744667649269,-0.0031254792120307684,0.017113303765654564,0.04474746808409691,0.018257025629281998,-0.050203800201416016,-0.018768321722745895,-0.019961191341280937,-0.0021139218006283045};
static const float action_parameterization_distribution_linear_bias[4] = {0.020398249849677086,0.009633169509470463,0.0036705126985907555,-0.012567185796797276};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.0574912391602993,0.24138838052749634,-0.2921704649925232,-0.18451716005802155},{-0.3164141774177551,-0.13446636497974396,-0.15832743048667908,0.28652024269104004},{-0.20309872925281525,0.18632832169532776,-0.3223521411418915,-0.025841524824500084},{0.12606456875801086,0.03507068008184433,0.18113359808921814,-0.44521158933639526},{-0.562464714050293,-0.394869863986969,0.2102762907743454,-0.6195313930511475},{0.04205453395843506,-0.07451536506414413,-0.42672479152679443,-0.2742109000682831},{-0.22141684591770172,-0.3042546510696411,-0.39031508564949036,0.16322652995586395},{-0.18717706203460693,0.03454432263970375,-0.3698813319206238,-0.5014936923980713},{-0.3309555649757385,-0.4269179403781891,-0.3289133608341217,0.4181174337863922},{-0.546383798122406,-0.10724768787622452,0.3373773992061615,-0.11791306734085083},{0.15437647700309753,-0.019042115658521652,-0.3736725449562073,-0.5089397430419922},{-0.5973007082939148,-0.5079418420791626,-0.2862755358219147,-0.08679863810539246},{-0.4811042249202728,0.3199906051158905,-0.5685842633247375,0.018029585480690002},{0.2911686599254608,-0.5370876789093018,-0.5229162573814392,0.09745128452777863},{0.42548003792762756,-0.2247823178768158,0.40811049938201904,0.25484439730644226},{-0.07804606854915619,0.3483980894088745,-0.4372369349002838,0.22155000269412994}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.3334043025970459,-0.5225539803504944,0.3002166748046875,-0.12318940460681915},{-0.49777713418006897,0.7221033573150635,0.12588638067245483,-0.6398339867591858},{-0.5795203447341919,-0.7163081169128418,-0.15746405720710754,-0.37791526317596436},{0.06359347701072693,0.5307797789573669,-0.23529231548309326,-0.7508935928344727}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.09254433214664459,-0.10034778714179993,-0.02325202152132988,-0.08048787713050842};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.05812430381774902,-0.003267955267801881,0.03456100821495056,-0.007514672819525003};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

