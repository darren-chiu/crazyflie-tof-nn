
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.15741799771785736,-0.15645091235637665,-0.11072594672441483,-0.12016193568706512,-0.03787481412291527,0.025882629677653313,-0.2901301980018616,0.001057981513440609,0.09974750131368637,0.0022003198973834515,-0.32863375544548035,-0.16588766872882843,0.04491156339645386,-0.5460579991340637,0.19376425445079803,0.012737656012177467},{0.2194102555513382,0.14916355907917023,0.09806367009878159,-0.08260385692119598,-0.046050116419792175,0.41617095470428467,0.15728504955768585,-0.1235262006521225,0.20358805358409882,0.009303832426667213,-0.04598820582032204,-0.08612280339002609,-0.16474881768226624,-0.3199251592159271,0.23790991306304932,0.07323656231164932},{0.30290377140045166,0.2739163935184479,0.3260364532470703,-0.41287240386009216,-0.02153569459915161,-0.5466256737709045,-0.0955546647310257,0.4060140550136566,0.20054525136947632,-0.685518205165863,0.11375431716442108,0.09179528057575226,-0.09182501584291458,0.06586922705173492,0.27654632925987244,-0.17286023497581482},{-0.2752073407173157,-0.09417005628347397,0.413685142993927,0.30939218401908875,-0.03480282053351402,-0.07391323894262314,0.1589505672454834,-0.09107059240341187,0.133009135723114,0.014727248810231686,-0.41833287477493286,-0.2260373830795288,-0.05112594738602638,-0.04976233094930649,-0.1588655263185501,0.20970366895198822},{-0.030385520309209824,0.14453475177288055,-0.049335140734910965,-0.25449830293655396,-0.14716997742652893,0.03735307604074478,0.14506985247135162,0.09281657636165619,0.08216995000839233,0.2611798942089081,-0.16679257154464722,-0.03232022374868393,-0.1730477660894394,-0.2759939432144165,0.09369106590747833,0.23688597977161407},{-0.058149371296167374,0.1374710351228714,0.3320198953151703,-0.1212620809674263,0.09061761945486069,-0.3539634943008423,0.10570412874221802,-0.14350171387195587,0.48801326751708984,-0.2541109025478363,-0.0943400114774704,0.047704316675662994,0.05056874826550484,0.39761269092559814,0.15360863506793976,-0.037819188088178635},{-0.03459581732749939,-0.1622939258813858,-0.14687727391719818,-0.17744921147823334,0.32121995091438293,0.24872000515460968,0.48657602071762085,-0.03749309107661247,-0.007757601793855429,0.04073555767536163,-0.32244354486465454,-0.04380770027637482,-0.2044171541929245,0.24756458401679993,0.12918035686016083,-0.26609086990356445},{0.27630549669265747,0.19467943906784058,-0.14363975822925568,0.19450631737709045,-0.08872959762811661,0.36612528562545776,0.037479422986507416,0.13705740869045258,0.33158981800079346,-0.24850156903266907,0.34248486161231995,0.20188230276107788,0.2940429449081421,0.2222551554441452,0.3086734414100647,-0.255479097366333},{-0.20227693021297455,-0.9299314618110657,0.37070369720458984,0.2802867293357849,-0.1434686779975891,-0.32865315675735474,0.1253669410943985,0.1457131803035736,-0.19828951358795166,-0.12616442143917084,-0.016058314591646194,-0.9287773966789246,0.116579070687294,0.19318877160549164,0.29542168974876404,0.4159758687019348},{0.07657801359891891,0.2755487859249115,-0.3786812424659729,0.24484765529632568,-0.09892682731151581,0.1339309960603714,0.0268058180809021,0.27329522371292114,-0.08472984284162521,-0.014039913192391396,-0.3613760769367218,0.09054548293352127,0.18249498307704926,-0.1823665201663971,0.28627824783325195,-0.03874729946255684},{0.45836371183395386,-0.10071069002151489,0.2100123167037964,-0.14863163232803345,0.3980723023414612,0.07832693308591843,0.10217977315187454,-0.019059350714087486,-0.26297441124916077,0.5082343220710754,-0.6307827830314636,0.14635725319385529,0.6093118786811829,-0.08418814837932587,-0.0889958068728447,0.3316901922225952},{0.43293794989585876,-0.25014549493789673,0.6242547631263733,-0.36829277873039246,0.23375791311264038,0.12231947481632233,-0.230146124958992,-0.2866593897342682,0.5643643736839294,0.46417006850242615,0.3577018082141876,0.06516673415899277,-0.45237213373184204,-0.27173614501953125,0.5316258072853088,0.8386032581329346},{0.12323727458715439,-0.4522536098957062,-0.17923690378665924,0.22479313611984253,0.1807255893945694,0.15794017910957336,0.33799538016319275,0.36745211482048035,-0.4806919991970062,-0.07771993428468704,-0.26027676463127136,-0.6418601274490356,0.2868913412094116,0.09939742088317871,-0.20987796783447266,-0.4399983584880829},{-0.05704309046268463,-0.3643222153186798,0.39777079224586487,-0.15954649448394775,0.6464030146598816,0.45694679021835327,0.031601112335920334,0.07242827117443085,0.34496450424194336,-0.22507363557815552,-0.24528320133686066,-0.4128749966621399,-0.3479563891887665,-0.1017865315079689,0.2427409440279007,0.18498004972934723},{-0.42228496074676514,-0.056316375732421875,0.45749929547309875,-0.2559283375740051,-0.050480566918849945,0.2990231513977051,0.11453625559806824,0.1353045403957367,-0.14361457526683807,-0.2994099259376526,0.13929110765457153,0.1711937040090561,-0.3327837884426117,0.16199132800102234,-0.06171991303563118,-0.4253268837928772},{-0.4063904285430908,-0.1251562535762787,0.1523933857679367,0.16521023213863373,0.15399350225925446,-0.24875770509243011,0.22961203753948212,-0.33381766080856323,0.2421865165233612,-0.08507510274648666,-0.018138393759727478,-0.1703399270772934,-0.17830385267734528,0.08411972969770432,-0.04597284272313118,0.11126868426799774},{0.05805535241961479,0.157521054148674,0.06709017604589462,-0.203372523188591,0.08789604902267456,-0.1970023810863495,-0.07889379560947418,-0.2235679030418396,0.13258588314056396,0.27189013361930847,0.15749697387218475,0.013180424459278584,-0.10502484440803528,0.034319423139095306,0.13925102353096008,0.07889887690544128},{-0.10609200596809387,0.1125146746635437,0.017563102766871452,-0.02177596092224121,-0.2120303511619568,0.19052590429782867,-0.3454210162162781,-0.2606179118156433,-0.31821560859680176,-0.315617173910141,0.2152402400970459,-0.025433391332626343,-0.0936550423502922,-0.3015560209751129,0.1724035143852234,-0.0659816712141037}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.4353393316268921,-0.3021508753299713,-0.12068378180265427,0.3280913829803467,-0.3701314628124237,-0.34348824620246887,0.10145094990730286,-0.056611645966768265,0.17246894538402557,-0.3886057734489441,-0.3629917502403259,0.39240336418151855,0.30054259300231934,-0.19138461351394653,-0.19875013828277588,0.21249954402446747},{-0.13926935195922852,-0.3044617176055908,0.380466103553772,-0.23127172887325287,0.07672126591205597,0.04702635481953621,0.1729813814163208,0.33302104473114014,0.24628500640392303,-0.3823879063129425,-0.3166522979736328,-0.11138683557510376,-0.2511981427669525,-0.09310639649629593,0.17048029601573944,-0.1910741776227951},{0.13311193883419037,-0.25187113881111145,0.3826819956302643,-0.055727191269397736,0.22021888196468353,-0.340992271900177,0.15892335772514343,-0.33490779995918274,0.002389750210568309,-0.5501466989517212,0.29893049597740173,0.12947435677051544,-0.3537370562553406,-0.29470178484916687,-0.3853908181190491,-0.015504284761846066},{0.047084394842386246,-0.2806183099746704,-0.1293613612651825,0.3997464179992676,0.1213236004114151,0.41279336810112,-0.0588410310447216,-0.20288722217082977,0.12453867495059967,0.08080501109361649,-0.16350825130939484,0.3644096851348877,-0.062206581234931946,-0.06635931879281998,0.3779824376106262,0.13252051174640656},{-0.13171231746673584,0.0918465256690979,0.13850966095924377,0.36207136511802673,-0.11811576783657074,-0.14935746788978577,0.18826541304588318,-0.2219686359167099,0.3382553458213806,0.21966353058815002,-0.24461671710014343,-0.25876301527023315,0.11424510926008224,0.07132329046726227,-0.4512978196144104,-0.153983473777771},{-0.2579050660133362,-0.2332414835691452,0.4028213620185852,-0.03076486848294735,0.3873274326324463,0.0015000980347394943,-0.11464527994394302,0.022966293618083,-0.25603362917900085,0.10440844297409058,0.019667144864797592,-0.18617714941501617,0.13339416682720184,-0.20243476331233978,-0.39027830958366394,-0.11500709503889084},{-0.3455677926540375,-0.039353735744953156,0.28806766867637634,0.23891326785087585,-0.21796640753746033,-0.39424261450767517,0.1509699672460556,0.08535977452993393,-0.16042673587799072,0.35001760721206665,-0.2592787742614746,-0.4379926919937134,0.0918089896440506,-0.06440795212984085,-0.32826119661331177,-0.31498414278030396},{0.27861136198043823,-0.034404437988996506,-0.27819153666496277,0.09844600409269333,-0.30591508746147156,-0.2738191783428192,-0.20701973140239716,-0.013233055360615253,-0.4009800851345062,-0.026079727336764336,0.3361026346683502,0.3265218436717987,-0.3480854332447052,-0.05445420742034912,-0.3519477844238281,-0.37629422545433044},{0.16096097230911255,0.420980840921402,0.05092858895659447,0.2841934263706207,-0.3802117109298706,-0.1623571813106537,-0.34716692566871643,0.4233623147010803,0.16140221059322357,-0.045253075659275055,0.03569585084915161,0.27677932381629944,-0.18137788772583008,-0.22509482502937317,0.04359371215105057,0.22111672163009644},{-0.2507084608078003,-0.23337306082248688,-0.3167293965816498,0.0033550409134477377,0.3501397371292114,0.13791880011558533,-0.3243449926376343,-0.09425431489944458,0.30238232016563416,0.4221307933330536,-0.22074979543685913,-0.004488990176469088,-0.2430780529975891,-0.06438418477773666,-0.10408082604408264,-0.0508493110537529},{-0.22835750877857208,0.27830663323402405,0.320035845041275,-0.34500283002853394,0.3449794352054596,0.3021080195903778,-0.243621826171875,-0.02825462445616722,-0.25133559107780457,0.24941223859786987,0.32148200273513794,-0.10141457617282867,-0.09944222867488861,-0.04980107396841049,0.14262256026268005,0.2249472439289093},{-0.45315662026405334,-0.32812991738319397,-0.09835273772478104,-0.14937496185302734,0.026073750108480453,-0.213827982544899,-0.2086268812417984,0.25257381796836853,-0.06596621125936508,-0.034371268004179,0.009028729051351547,0.20495443046092987,-0.40852978825569153,0.0652145966887474,0.010591731406748295,-0.003336899448186159},{0.03214088827371597,-0.2655900716781616,-0.06206373870372772,0.2747586965560913,-0.3451624810695648,0.13699521124362946,0.13840000331401825,0.237553209066391,0.24726517498493195,0.3911217153072357,0.027240125462412834,0.25143685936927795,0.1680620163679123,-0.25994086265563965,-0.03462043032050133,-0.06684420257806778},{-0.09748425334692001,0.051464375108480453,-0.37249284982681274,0.2133525162935257,-0.4494388997554779,0.023456916213035583,-0.03808571770787239,0.27829858660697937,-0.15647850930690765,-0.2327095866203308,-0.15308360755443573,0.17559914290905,0.039010655134916306,0.15961061418056488,-0.150061696767807,-0.4091285169124603},{0.09951785951852798,-0.2169812172651291,-0.1657673567533493,-0.3246922194957733,-0.09953561425209045,0.12771861255168915,-0.22164325416088104,0.05208755284547806,0.41176968812942505,0.1213475689291954,0.39930012822151184,-0.065299391746521,-0.35747984051704407,0.33758971095085144,-0.23072372376918793,-0.01927250809967518},{0.01835314929485321,0.12881805002689362,0.11572258919477463,0.2556605637073517,0.30005577206611633,-0.30789217352867126,-0.17429609596729279,-0.1469360589981079,0.057749513536691666,0.34330055117607117,-0.17914000153541565,-0.285660982131958,-0.2993103265762329,0.3737483322620392,-0.491874635219574,0.13614675402641296}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{-0.023553449660539627,-0.04568435624241829,-0.05193739011883736,0.0420038141310215,0.09918700158596039,-0.06815014034509659,-0.3735826909542084,-0.1891421377658844,0.16646665334701538,-0.25836044549942017,0.19982971251010895,-0.10735955834388733,0.2970321476459503,0.18296095728874207,0.2536551058292389,-0.11544112116098404,-0.08242937922477722,0.08199291676282883,0.3217295706272125,-0.13741923868656158,0.1596405804157257,0.08715663105249405,-0.3367123007774353,0.019028598442673683,-0.09989950060844421,0.13919511437416077,0.22028645873069763,-0.2660082280635834,-0.012225690297782421,0.11643234640359879,0.18972739577293396,-0.21844720840454102},{0.12501707673072815,-0.15963782370090485,-0.05870911106467247,-0.1543627679347992,-0.22783079743385315,-0.28403782844543457,0.024403855204582214,-0.04549182578921318,-0.09045230597257614,0.26318949460983276,-0.10142973065376282,0.27658480405807495,-0.302127867937088,0.18392004072666168,-0.2543467879295349,-0.05368446931242943,0.002081640064716339,0.023841233924031258,0.19552533328533173,0.2773764729499817,0.2139246165752411,-0.026769332587718964,0.21520176529884338,0.2721918821334839,0.0005305208615027368,0.05389152839779854,0.2012859731912613,0.26430046558380127,0.039746928960084915,0.05779193714261055,-0.2976563274860382,-0.007068155333399773},{-0.09632085263729095,-0.09876552224159241,-0.17042779922485352,-0.16202369332313538,-0.11393977701663971,0.3171960115432739,0.02620917372405529,0.025493614375591278,0.029696982353925705,0.00512214470654726,0.030000844970345497,0.06990635395050049,-0.22703342139720917,0.06613954901695251,0.21676048636436462,-0.1688142716884613,0.3187626302242279,-0.17457836866378784,-0.16610264778137207,-0.18244481086730957,0.25757458806037903,0.1745140701532364,-0.2563929855823517,-0.10380665212869644,-0.21979640424251556,-0.3440864384174347,0.2384762167930603,0.1874271184206009,0.07758262753486633,-0.04538946598768234,-0.08004191517829895,-0.07135802507400513},{-0.19163721799850464,-0.22046251595020294,-0.08440978825092316,0.2072983980178833,0.11427498608827591,0.03148666024208069,-0.11198098212480545,-0.10560797154903412,0.03642832860350609,-0.2640295624732971,0.13251695036888123,-0.12476371228694916,0.10524259507656097,0.18649566173553467,0.24069704115390778,-0.11272484809160233,-0.15300671756267548,0.06860855966806412,0.0920729786157608,0.1733139455318451,0.14592941105365753,0.1868172585964203,0.0018434262601658702,-0.21985599398612976,-0.04263070598244667,0.1607205867767334,-0.046225111931562424,-0.21572743356227875,-0.14951014518737793,-0.07868269085884094,-0.11626766622066498,-0.35091501474380493},{0.06593497842550278,0.24189552664756775,0.0003513772680889815,-0.018107496201992035,0.26050040125846863,-0.1984909623861313,0.2726314067840576,0.17485222220420837,0.04543457180261612,-0.07285191863775253,0.26963868737220764,-0.38468825817108154,0.05885499715805054,-0.05658259242773056,-0.2294539511203766,0.1668567955493927,-0.2936917841434479,0.2783851623535156,0.16338719427585602,-0.12617073953151703,-0.09124686568975449,0.19204793870449066,0.24912559986114502,-0.054208774119615555,0.0988934114575386,-0.02762797474861145,0.26622265577316284,0.08436214923858643,0.06189725175499916,0.2827669084072113,0.0612918995320797,0.0002521740971133113},{-0.2846723794937134,0.2222692221403122,-0.2391648143529892,0.2389528751373291,0.4261346459388733,-0.3652060925960541,-0.3183945417404175,0.3672470152378082,0.19918681681156158,0.04935290664434433,-0.20407305657863617,-0.16474545001983643,-0.049355678260326385,0.15578460693359375,0.05901454761624336,-0.16333448886871338,-0.3284304738044739,-0.20939815044403076,-0.19970101118087769,0.08238627761602402,0.031571969389915466,0.33346694707870483,-0.010031014680862427,-0.13768914341926575,0.03757622092962265,-0.05943567305803299,-0.16983923316001892,0.0012346882140263915,0.19629937410354614,0.2484552413225174,-0.12488347291946411,0.36902961134910583},{-0.1976441890001297,0.24509721994400024,-0.24540585279464722,0.20517104864120483,-0.1274755895137787,-0.29650458693504333,-0.20407570898532867,-0.11085692793130875,-0.01543017290532589,-0.03813225030899048,0.32652127742767334,-0.21591544151306152,-0.0711570531129837,0.10545094311237335,-0.1492304503917694,-0.1841103583574295,0.2246691733598709,-0.24562190473079681,-0.10040592402219772,-0.278079092502594,0.24755218625068665,-0.4017048478126526,-0.26107603311538696,0.1917949765920639,0.2642475366592407,0.09540149569511414,-0.07367458939552307,0.09204205125570297,-0.1201467290520668,-0.09751670062541962,-0.20569218695163727,0.09779909253120422},{-0.3297799229621887,-0.03707052767276764,-0.12808562815189362,-0.04900861158967018,0.003109144512563944,0.09422567486763,0.2965300381183624,0.16467708349227905,-0.1368751972913742,-0.3222133219242096,-0.14712996780872345,0.06773112714290619,-0.2999022901058197,0.2021658569574356,-0.05657064542174339,0.27760937809944153,-0.2548314929008484,-0.39923661947250366,-0.32363298535346985,-0.06361062824726105,0.17702054977416992,-0.2740166187286377,-0.3032505214214325,-0.08334578573703766,-0.21179841458797455,0.057516343891620636,0.15127964317798615,-0.0015855389647185802,-0.3212466239929199,-0.14694716036319733,0.2826394736766815,-0.07044918835163116},{-0.1370316594839096,0.0018043587915599346,-0.013022414408624172,0.01563158631324768,-0.29373231530189514,-0.10117227584123611,0.22260524332523346,-0.019358500838279724,0.20600751042366028,0.16245931386947632,0.19268247485160828,0.30467087030410767,-0.38034000992774963,0.009178120642900467,0.029206136241555214,0.04417622834444046,-0.08465728908777237,0.1260634809732437,0.12461239844560623,0.29894816875457764,-0.11945170164108276,-0.06904838979244232,0.03631046414375305,0.2209567427635193,-0.0907614603638649,-0.167819544672966,0.2851605713367462,0.07239437103271484,0.04796062037348747,0.05320616811513901,0.14611884951591492,0.2417249232530594},{-0.27423208951950073,0.07418927550315857,-0.16648812592029572,-0.20089665055274963,0.016621556133031845,-0.15759500861167908,0.21605902910232544,0.12868724763393402,0.18136630952358246,-0.0771981030702591,-0.17806494235992432,-0.3072813153266907,-0.07709115743637085,-0.33906111121177673,0.14662256836891174,0.20831283926963806,0.2431521862745285,-0.12486118823289871,0.01842205971479416,-0.2679329812526703,0.29600876569747925,0.21754316985607147,-0.17008335888385773,0.17785660922527313,-0.17074629664421082,0.11903335899114609,-0.23214057087898254,0.08689567446708679,-0.09953846782445908,-0.17424866557121277,-0.25850704312324524,-0.16763746738433838},{0.2289963960647583,-0.181647390127182,0.16020342707633972,0.31423062086105347,-0.16098760068416595,-0.21687628328800201,-0.15822084248065948,0.15182632207870483,0.12425842881202698,0.2846246361732483,-0.27704715728759766,0.17654399573802948,0.2591489255428314,0.004656354431062937,-0.1164054274559021,0.26515159010887146,-0.1929037719964981,-0.15855294466018677,0.11217892915010452,0.18944793939590454,-0.2154562622308731,-0.021319935098290443,0.08689523488283157,0.17204630374908447,0.30676108598709106,-0.11483501642942429,0.2614895701408386,-0.344135582447052,-0.039233237504959106,0.1593218296766281,-0.08054221421480179,-0.057494498789310455},{0.21795813739299774,0.16990405321121216,0.20957458019256592,-0.10335300117731094,0.16642309725284576,0.24152302742004395,-0.32943060994148254,-0.09511344879865646,0.2091907262802124,-0.2919435203075409,-0.26839810609817505,-0.040348321199417114,0.08149377256631851,0.09726119041442871,-0.28959769010543823,-0.08879483491182327,0.33710727095603943,0.26563560962677,-0.15897540748119354,-0.19739553332328796,0.2909674048423767,0.05026112124323845,0.1343715786933899,-0.01566634513437748,0.3364492356777191,0.34035882353782654,-0.059677138924598694,-0.23441967368125916,0.12776824831962585,-0.2613585293292999,-0.20339570939540863,0.20810440182685852},{0.03072279877960682,-0.16117127239704132,-0.18741126358509064,0.19834570586681366,0.04347243532538414,-0.03928663581609726,-0.2022225558757782,-0.08308379352092743,-0.14498493075370789,-0.1146126240491867,0.23260369896888733,-0.3077923059463501,0.08131074905395508,0.1991737186908722,0.16131919622421265,0.02302802912890911,-0.16345474123954773,-0.052816830575466156,0.2937524616718292,0.08437404781579971,0.2443816065788269,0.16165785491466522,-0.02985173463821411,0.1650533229112625,0.3293774127960205,0.2788541316986084,0.036476895213127136,0.2706107795238495,0.026229742914438248,-0.11041790246963501,0.025313621386885643,0.33359041810035706},{0.23725272715091705,-0.1928272843360901,0.16417944431304932,0.08519928902387619,0.1259421557188034,0.23202472925186157,-0.1543896645307541,0.09321609139442444,0.006899707950651646,0.006369100883603096,-0.09053964167833328,-0.3419032692909241,-0.09532254934310913,0.12076837569475174,0.22036108374595642,0.26623642444610596,0.0868324562907219,-0.12811432778835297,0.10508889704942703,-0.27344200015068054,-0.2858441174030304,-0.28597313165664673,0.1581476777791977,-0.09124663472175598,0.3219747245311737,0.14097842574119568,-0.29341429471969604,-0.14416231215000153,-0.2751092314720154,0.18106940388679504,0.19292712211608887,0.22550003230571747},{0.17300820350646973,-0.0675143450498581,-0.22600336372852325,0.27266058325767517,0.23728635907173157,0.20461392402648926,0.16997908055782318,-0.19811153411865234,-0.04366609826683998,-0.2584160566329956,0.1678631752729416,0.12253959476947784,0.372079074382782,0.06030029430985451,-0.014730953611433506,-0.23944148421287537,0.015566477552056313,-0.016921326518058777,-0.32174018025398254,-0.21391476690769196,-0.2923630475997925,0.13597372174263,-0.06667891889810562,-0.3013162910938263,0.21489425003528595,0.18815933167934418,-0.006687205284833908,0.05843433365225792,-0.15842320024967194,-0.1267452836036682,-0.2322067767381668,0.3795435428619385},{-0.3156343400478363,-0.4014517664909363,0.010180373676121235,-0.2560597062110901,0.004136202856898308,-0.24039602279663086,0.02007474936544895,0.15632538497447968,0.3036215603351593,0.2531519830226898,0.17545484006404877,-0.2267216145992279,-0.02567192167043686,0.33528268337249756,0.29639917612075806,-0.07615254074335098,0.004780150484293699,-0.15839312970638275,-0.15059451758861542,-0.26829010248184204,0.2124687135219574,-0.048251256346702576,-0.1773044764995575,0.019288601353764534,-0.27260154485702515,-0.35993772745132446,-0.10173531621694565,0.3658616244792938,-0.091444231569767,0.30365803837776184,0.06155656278133392,-0.26384469866752625},{-0.009071401320397854,-0.022190706804394722,0.22331681847572327,0.06385712325572968,0.09950678050518036,0.17359693348407745,-0.07567828893661499,-0.17552067339420319,-0.18341213464736938,0.28728020191192627,0.17852316796779633,0.06702116131782532,0.18292099237442017,-0.11756213009357452,0.34314239025115967,0.03231017291545868,0.1667691022157669,-0.0370824821293354,0.1940322071313858,-0.09460242837667465,0.28382477164268494,-0.14281152188777924,-0.23195935785770416,-0.23576456308364868,-0.142907053232193,-0.138655886054039,-0.2516472339630127,-0.38141199946403503,-0.0922304317355156,-0.07209138572216034,0.09521611779928207,0.0386342816054821},{-0.040386687964200974,0.07874546945095062,0.05932826176285744,0.12760545313358307,0.03825009986758232,-0.05203478783369064,0.35714903473854065,0.23202739655971527,-0.18119609355926514,0.3308142423629761,-0.06528820842504501,0.024079851806163788,0.0662098377943039,0.3010713756084442,-0.07399483770132065,-0.00642350735142827,0.23887881636619568,0.17529910802841187,0.10976614058017731,0.024601509794592857,0.05420631170272827,0.054751086980104446,0.06743617355823517,-0.2670137286186218,0.07073734700679779,-0.36849379539489746,-0.11846397072076797,-0.12981033325195312,-0.04327556490898132,0.37290158867836,-0.23195137083530426,-0.2103833705186844},{-0.23110276460647583,-0.011087953113019466,-0.4201754927635193,0.06675270944833755,-0.18477430939674377,0.25901830196380615,0.2980445921421051,0.23814831674098969,-0.0019338070414960384,-0.18680040538311005,-0.08069254457950592,0.04021036624908447,0.16399268805980682,0.11024395376443863,0.0793529748916626,0.03835795819759369,-0.2785697877407074,0.14202824234962463,0.02084217220544815,-0.21556127071380615,-0.12301696836948395,0.04969378188252449,-0.17558158934116364,0.11030542850494385,-0.20019079744815826,-0.12920358777046204,-0.09604602307081223,0.2253715544939041,-0.19847647845745087,0.19750240445137024,-0.19905808568000793,0.04561049863696098},{0.0620834045112133,0.19245922565460205,0.3016980290412903,0.026173241436481476,0.006258229725062847,0.18496796488761902,-0.2288421392440796,-0.0490352027118206,-0.2539254128932953,0.2668548822402954,-0.12048263847827911,-0.2572440803050995,0.07013525068759918,0.23427577316761017,0.06404930353164673,0.15898291766643524,0.22276732325553894,-0.18258891999721527,-0.23835153877735138,0.10819077491760254,0.1765674501657486,-0.1971755176782608,0.11500385403633118,0.31151968240737915,0.2205367386341095,-0.24013814330101013,-0.13475574553012848,-0.013996613211929798,0.21629612147808075,-0.19503575563430786,-0.03725115954875946,0.2542957663536072}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.02561240829527378,-0.12225724756717682,0.33077412843704224,-0.10691051185131073},{-0.26544973254203796,0.06657377630472183,0.3142401874065399,0.2375766783952713},{0.1361999809741974,-0.32195818424224854,-0.24383053183555603,0.3261655569076538},{-0.26239871978759766,0.20384572446346283,0.07253945618867874,-0.19278964400291443},{0.21007221937179565,0.1697220504283905,0.254878431558609,0.1600344479084015},{0.0987725481390953,-0.030435089021921158,-0.2634173631668091,0.12810859084129333},{-0.06534691900014877,-0.03189076483249664,0.25888434052467346,0.4040989279747009},{0.1287112534046173,0.3475549519062042,-0.24404795467853546,0.2969171404838562},{0.34161147475242615,0.3367556035518646,-0.31681331992149353,0.0292923916131258},{0.3153076767921448,0.1553354114294052,-0.17533323168754578,0.03824114054441452},{0.23972061276435852,0.1057116687297821,-0.17313149571418762,0.010864393785595894},{-0.24713730812072754,-0.20742854475975037,-0.12199521064758301,-0.22807243466377258},{0.015159610658884048,0.13361014425754547,0.06766069680452347,0.025065535679459572},{0.24582841992378235,-0.19200661778450012,0.09146817773580551,-0.04111327975988388},{-0.0025450249668210745,0.028395522385835648,0.07838989049196243,-0.14162743091583252},{0.20990245044231415,-0.19049839675426483,0.23115739226341248,0.024513715878129005},{-0.22124987840652466,-0.08007896691560745,-0.2188180387020111,-0.08323226124048233},{0.24688170850276947,0.1939084529876709,-0.32886022329330444,-0.10297771543264389},{0.009116406552493572,0.24914857745170593,-0.32987329363822937,-0.10526439547538757},{-0.24087676405906677,0.22075463831424713,-0.17691637575626373,-0.2825950086116791},{-0.05189390480518341,0.11381074041128159,-0.14030387997627258,0.25053831934928894},{0.28485095500946045,0.14148250222206116,0.1388617306947708,0.2391282320022583},{-0.0824253186583519,0.011407313868403435,-0.20180653035640717,0.19509007036685944},{-0.08311513811349869,0.1978820562362671,-0.2775191366672516,-0.27958476543426514},{-0.10732147842645645,0.23095254600048065,0.11875639110803604,-0.21794649958610535},{-0.22183012962341309,0.13763275742530823,-0.21687543392181396,0.3149937093257904},{0.014917561784386635,-0.14096100628376007,0.05652996897697449,-0.08878614753484726},{0.22160635888576508,-0.18055394291877747,-0.2647295296192169,0.021648013964295387},{0.03338015824556351,-0.015155884437263012,0.030114565044641495,0.08933477103710175},{0.0013648176100105047,0.1681913286447525,0.2007903754711151,0.0297603290528059},{-0.03213246539235115,-0.19178996980190277,-0.26302388310432434,-0.047252316027879715},{-0.2747068703174591,0.19119401276111603,0.08398552983999252,0.21356821060180664}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.04545200988650322,-0.006064485292881727,0.06489686667919159,0.06154680252075195,-0.1694755107164383,-0.02656537853181362,-0.18081803619861603,-0.1328919529914856,0.02429085038602352,0.08340148627758026,0.01917983405292034,0.013695759698748589,-0.041463203728199005,0.03984353318810463,0.12050813436508179,-0.04398426041007042};
static const float actor_encoder_self_encoder_2_bias[16] = {0.010511714965105057,0.01868458092212677,0.06458744406700134,0.01588047668337822,0.04923393577337265,0.07489824295043945,-0.023165790364146233,0.028213026002049446,-0.01860405132174492,0.002080784412100911,-0.00025411194656044245,-0.048209190368652344,-0.036547139286994934,-0.028233632445335388,0.01692546345293522,0.0751909390091896};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01695806160569191,0.024373212829232216,0.014982614666223526,-0.04918600618839264,0.06710731238126755,0.010969772934913635,0.0540289580821991,-0.00045528722694143653,0.014240412041544914,0.023618651553988457,0.010307117365300655,-0.02792852185666561,0.06338926404714584,0.0025890390388667583,0.0017145152669399977,0.0191961657255888,-0.05327816307544708,-0.0048339106142520905,0.03340442106127739,-0.02425658330321312,0.023700525984168053,0.04711032286286354,-0.036670658737421036,-0.006460671778768301,-0.010246176272630692,-0.042307741940021515,0.02345808781683445,0.017833562567830086,0.0317634716629982,0.05490327626466751,-0.014322180300951004,0.0028174712788313627};
static const float action_parameterization_distribution_linear_bias[4] = {0.023771200329065323,0.021632978692650795,0.02446012571454048,0.02020343579351902};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{-0.3372671604156494,-0.3498220443725586,0.2533720135688782,-0.639876127243042},{-0.1514737904071808,-0.2037276327610016,-0.18545322120189667,-0.4081091284751892},{0.003922902047634125,-0.45862746238708496,0.008599430322647095,0.3771244287490845},{-0.4374171197414398,-0.15394718945026398,0.033823996782302856,0.09927701950073242},{0.06636656820774078,0.2663480341434479,0.05745227262377739,0.16424301266670227},{0.3563957214355469,0.0023581802379339933,0.2535809278488159,-0.03378063067793846},{0.08348988741636276,-0.5252289772033691,-0.0685979351401329,-0.5930218696594238},{0.49813276529312134,-0.47688668966293335,-0.04036657512187958,-0.382434606552124},{0.23087871074676514,0.19565078616142273,-0.1325899362564087,-0.570992648601532},{-0.45667868852615356,-0.4836810827255249,-0.5226287841796875,-0.4662579298019409},{-0.24030135571956635,-0.4398179352283478,-0.22235961258411407,0.05895435810089111},{-0.15651552379131317,-0.3295038938522339,0.42428621649742126,-0.27948006987571716},{0.13913722336292267,0.5191260576248169,-0.48519325256347656,0.40770187973976135},{-0.04033299535512924,-0.1586664766073227,-0.44268274307250977,-0.5268436074256897},{0.41603270173072815,-0.22875061631202698,-0.6405421495437622,-0.5950121879577637},{0.03891558572649956,-0.37277287244796753,-0.06380782276391983,0.4132517874240875}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.6604286432266235,0.7690495848655701,-0.5785639882087708,-0.1585526019334793},{0.6951010227203369,-0.21330535411834717,0.23118698596954346,0.2209312617778778},{0.16299447417259216,-0.2988855242729187,-0.8179311156272888,-0.30813053250312805},{-0.831242024898529,-0.6524719595909119,0.3936449885368347,0.2162013202905655}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.02470799721777439,-0.0030693865846842527,-0.09699460119009018,-0.12402654439210892};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.04182041436433792,-0.02246556617319584,-0.03836211562156677,0.0830073207616806};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

