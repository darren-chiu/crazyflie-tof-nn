
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 16},{16, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[16];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.041853614151477814,0.290507435798645,-0.082042396068573,-0.019114797934889793,0.08843781799077988,0.1355355829000473,-0.3099101781845093,-0.11269456893205643,0.23637329041957855,0.18406172096729279,-0.016394684091210365,0.40687453746795654,-0.28999367356300354,0.04264170303940773,-0.4311539828777313,0.22683332860469818},{0.13971950113773346,0.13237032294273376,-0.13531270623207092,-0.11610129475593567,0.044744983315467834,0.07316306233406067,-0.28935813903808594,0.39798295497894287,-0.1272864192724228,0.27471789717674255,0.023170098662376404,0.38859105110168457,0.3622540831565857,0.02656010538339615,0.3193238079547882,-0.09796948730945587},{0.25267142057418823,-0.34968775510787964,-0.06903482973575592,-0.28738561272621155,0.33046191930770874,0.3619696795940399,0.19074872136116028,0.43873199820518494,0.15545323491096497,-0.12646089494228363,0.06665229052305222,0.43199533224105835,0.3577441871166229,-0.38584885001182556,-0.02004777267575264,0.2090914398431778},{-0.07763949781656265,0.4037947654724121,-0.2390584945678711,0.2621150016784668,0.03736632689833641,0.40923404693603516,-0.1954704374074936,0.03141637146472931,0.38646817207336426,0.21464413404464722,-0.29703593254089355,0.02356632612645626,-0.002285526366904378,0.37180691957473755,-0.14146442711353302,0.06869150698184967},{0.013311414048075676,-0.32341721653938293,0.07424437999725342,0.22830036282539368,0.2192637175321579,-0.27587762475013733,-0.27351388335227966,-0.19577229022979736,0.07143689692020416,0.016036557033658028,-0.0912172868847847,0.30491432547569275,-0.022105609998106956,-0.5491341352462769,-0.06846624612808228,0.02645195461809635},{0.04562428593635559,0.04740564525127411,-0.3766615390777588,-0.03994351252913475,0.24021397531032562,0.29386255145072937,-0.03125983476638794,-0.18015599250793457,-0.15337777137756348,-0.5219330787658691,0.1241447851061821,0.03589213639497757,0.2303503155708313,-0.07223498076200485,-0.005394146777689457,0.2354186624288559},{-0.13922499120235443,0.2670976221561432,0.38108956813812256,0.12042433768510818,-0.4619162082672119,0.29600855708122253,-0.02460922859609127,0.3549628257751465,0.19954416155815125,-0.1925281584262848,-0.024871451780200005,0.3336639106273651,-0.05673997849225998,0.039931971579790115,-0.1419399380683899,0.30331510305404663},{0.18925808370113373,0.09962168335914612,-0.4215119779109955,-0.3626865744590759,-0.23158954083919525,-0.03128750994801521,-0.23422633111476898,-0.3126506209373474,0.3045937716960907,-0.2931399345397949,-0.28526821732521057,-0.34282392263412476,-0.2177763134241104,-0.10357899963855743,0.6340469121932983,0.4175098240375519},{0.36173155903816223,0.031059861183166504,0.22223657369613647,0.2497878223657608,0.01003338024020195,0.633768618106842,-0.5711176991462708,0.18917694687843323,0.22630657255649567,-0.21564754843711853,-0.5703889727592468,0.16913960874080658,0.19514088332653046,-0.029646463692188263,-0.0385686531662941,0.07967798411846161},{0.06030276417732239,0.2980383336544037,-0.21746188402175903,-0.07241040468215942,-0.3125101625919342,0.28704607486724854,0.05140765383839607,0.4855687618255615,-0.7065748572349548,-0.09916087985038757,-0.1980372667312622,-0.17859414219856262,0.18909886479377747,0.22512315213680267,-0.24063588678836823,-0.13155196607112885},{-0.10240249335765839,-0.1069929227232933,0.14004099369049072,0.3473455607891083,-0.21268334984779358,-0.05083634331822395,0.08890429884195328,0.04977446421980858,-0.4364458918571472,0.10031240433454514,0.05772775411605835,-0.23268264532089233,-0.11460281163454056,-0.10787927359342575,-0.02211884595453739,0.5075411796569824},{0.17679676413536072,-0.23187221586704254,-0.15845604240894318,0.34180670976638794,0.6224296689033508,-0.14936098456382751,0.32615792751312256,0.11127613484859467,-0.4172990024089813,-0.14776787161827087,-0.07244978845119476,-0.009360226802527905,-0.38209137320518494,-0.1393907517194748,-0.10311394184827805,-0.0779472142457962},{-0.3184874951839447,0.25637879967689514,-0.15274938941001892,0.24236589670181274,0.7698655128479004,-0.8055195808410645,0.18234828114509583,-0.10729452222585678,-0.09490946680307388,0.533500075340271,0.37880635261535645,0.033248595893383026,-0.4158884286880493,0.16854272782802582,-0.1426050215959549,0.32010677456855774},{0.10428553819656372,0.157471165060997,0.4932556748390198,-0.7468447089195251,0.15770825743675232,0.08357655256986618,-0.05368093401193619,-0.48166680335998535,-0.28844958543777466,0.4427050054073334,0.46615251898765564,-0.570024311542511,0.5456563830375671,0.6630685925483704,0.3138655126094818,0.6171510815620422},{-0.4330746829509735,-0.05197649449110031,-0.12071449309587479,-0.18216322362422943,-0.33116334676742554,0.17388007044792175,-0.023973165079951286,0.1387104094028473,0.25298014283180237,-0.09731686115264893,0.02259085886180401,-0.16833490133285522,-0.3651238679885864,-0.18868771195411682,0.2343154102563858,0.1576833724975586},{0.4158400893211365,-0.24513596296310425,0.22876611351966858,-0.16464313864707947,-0.14370231330394745,-0.050382986664772034,0.31848105788230896,-0.42423132061958313,-0.11269639432430267,0.0366780161857605,0.05615239590406418,-0.1844939887523651,-0.2821285128593445,0.10765011608600616,-0.13718479871749878,0.17268812656402588},{0.1446172595024109,-0.3546639680862427,-0.262435644865036,-0.018748382106423378,-0.22034852206707,0.3097701072692871,-0.04720965772867203,-0.262005090713501,0.3352850079536438,-0.015834596008062363,0.05896094813942909,0.04719506949186325,0.14440244436264038,-0.1321786642074585,-0.07239395380020142,-0.2858825623989105},{0.2489127218723297,0.1244821697473526,0.20822660624980927,0.20991456508636475,0.029324375092983246,-0.10509790480136871,-0.31025007367134094,0.20520344376564026,-0.2620759904384613,-0.34044143557548523,-0.14239437878131866,-0.03836614638566971,0.14104732871055603,0.33677321672439575,-0.3582841753959656,0.11971378326416016}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.3524381220340729,-0.022113308310508728,-0.051184769719839096,-0.10632207989692688,-0.14967240393161774,-0.00961397122591734,-0.024522880092263222,-0.10099968314170837,0.2579912841320038,-0.1408018171787262,0.25748100876808167,0.28618893027305603,0.14824278652668,0.28484901785850525,-0.05102359503507614,0.015045475214719772},{0.2578447759151459,0.10408850014209747,0.22760014235973358,0.06870999932289124,0.15307866036891937,0.4462752044200897,0.1419895440340042,-0.18485504388809204,-0.14109517633914948,-0.12646542489528656,0.23395682871341705,0.0790664404630661,0.05147920921444893,-0.19506148993968964,-0.1641743779182434,-0.07654507458209991},{-0.35244083404541016,0.050356291234493256,0.331638902425766,-0.0029026747215539217,-0.42453470826148987,-0.08926264941692352,0.0955578088760376,0.38736119866371155,0.3689076900482178,0.12425028532743454,0.2918923497200012,-0.10353947430849075,0.3366089463233948,-0.1754598170518875,0.22985470294952393,0.19319963455200195},{-0.33533531427383423,0.26179733872413635,-0.4271531403064728,-0.018769515678286552,-0.22849413752555847,-0.27969250082969666,0.2653205096721649,0.2372399866580963,0.23428313434123993,-0.019446957856416702,0.4047650396823883,-0.3817221224308014,-0.2992951273918152,-0.3293430507183075,-0.23233292996883392,0.4130660891532898},{0.037590209394693375,0.07729493081569672,-0.2700916826725006,-0.49902671575546265,0.007640682626515627,-0.43514618277549744,0.19474245607852936,0.12984447181224823,-0.309472918510437,0.4631793200969696,-0.3817238211631775,-0.43537837266921997,0.43884673714637756,-0.4422161877155304,0.07403100281953812,-0.12024518102407455},{-0.3569570779800415,0.3780592679977417,0.12040437757968903,0.43766599893569946,-0.5073347091674805,0.04005225747823715,0.23265011608600616,0.10645277798175812,-0.2346280813217163,-0.19620224833488464,-0.095878466963768,0.19242991507053375,-0.1223345398902893,-0.22202493250370026,-0.03238262981176376,-0.24301593005657196},{-0.04752872884273529,-0.4339330792427063,0.15923909842967987,0.38267675042152405,0.09870628267526627,-0.14929509162902832,0.25393497943878174,0.3760868310928345,0.21022185683250427,0.16679802536964417,-0.30781590938568115,-0.20382316410541534,-0.2000962346792221,-0.3721121549606323,0.06092973053455353,-0.1345919966697693},{-0.10412468761205673,-0.2275662124156952,-0.03964637964963913,0.40050843358039856,0.22566726803779602,0.4140198826789856,0.24005119502544403,-0.06292630732059479,-0.06508377939462662,0.25184494256973267,0.017924079671502113,0.17829389870166779,-0.20284457504749298,0.08819028735160828,-0.4476812779903412,0.2611866295337677},{-0.2169182002544403,0.16741648316383362,0.11465974152088165,-0.44182950258255005,0.24411199986934662,0.04985036328434944,-0.5084003806114197,-0.0038969337474554777,-0.14334914088249207,-0.10939380526542664,-0.12460900098085403,-0.29612573981285095,-0.46777284145355225,0.2762987017631531,0.09770699590444565,-0.39734452962875366},{0.17803029716014862,-0.1918821930885315,0.15191984176635742,0.20316633582115173,-0.07100306451320648,-0.13703013956546783,-0.391599178314209,-0.09660408645868301,-0.05412370711565018,-0.11555978655815125,0.3936748206615448,-0.2999480366706848,0.28804507851600647,-0.03115232288837433,0.021377040073275566,0.42512059211730957},{0.01985548995435238,-0.183724507689476,-0.2965300679206848,-0.35959309339523315,-0.1845894455909729,0.1383136659860611,-0.3010706901550293,-0.3202908933162689,0.28566429018974304,-0.10739616304636002,-0.40706318616867065,-0.11252287030220032,0.40053385496139526,0.15749922394752502,0.5454826951026917,0.321758896112442},{0.3191256523132324,0.41271355748176575,-0.2636756896972656,0.11870717257261276,-0.06499940156936646,-0.11365467309951782,0.17640817165374756,0.09765422344207764,-0.35095730423927307,0.3057631552219391,-0.2706817090511322,0.26069170236587524,-0.11668163537979126,0.3971364200115204,-0.058629315346479416,0.2022320181131363},{0.3531018793582916,-0.4168130159378052,-0.23477791249752045,-0.16337256133556366,-0.335428386926651,-0.0536295585334301,0.05279562622308731,0.06740303337574005,-0.20626182854175568,-0.0750686302781105,-0.03199337422847748,0.3504822850227356,0.18247851729393005,0.3793940842151642,0.27234259247779846,-0.37340623140335083},{-0.32947391271591187,0.4196561276912689,0.2614501416683197,-0.2433704137802124,0.30669307708740234,0.05432724207639694,-0.23197835683822632,-0.21441088616847992,-0.1451059877872467,-0.23278890550136566,-0.061498187482357025,-0.12681879103183746,0.28858616948127747,0.24895691871643066,0.11476938426494598,0.09628652781248093},{0.361830472946167,-0.29347339272499084,0.23565533757209778,0.07677609473466873,0.1593828648328781,-0.19978775084018707,-0.3895551860332489,-0.2111344039440155,-0.35587814450263977,-0.3800027370452881,-0.16422079503536224,-0.4424031376838684,-0.4296579957008362,-0.22362518310546875,-0.10067272931337357,0.2011738121509552},{0.21609871089458466,-0.3563065826892853,-0.45167702436447144,0.26707255840301514,-0.28434067964553833,0.3131471276283264,0.2479432225227356,-0.2700479030609131,0.23868288099765778,-0.3866595923900604,-0.4679073691368103,0.09017761051654816,-0.1977226883172989,-0.2464185357093811,0.20350421965122223,0.42388370633125305}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{0.2642165422439575,0.05830805376172066,-0.23341335356235504,0.03559163212776184,-0.08478324860334396,-0.20146118104457855,-0.08349187672138214,0.3389076292514801,0.04858975484967232,0.09044990688562393,0.08672153204679489,-0.12210875004529953,0.3442574739456177,-0.14938867092132568,0.14311714470386505,-0.33616873621940613,-0.3391122817993164,-0.1194152906537056,0.11440065503120422,0.06599258631467819,-0.09482947736978531,-0.24351581931114197,-0.2975772023200989,-0.1817133128643036,0.2242221087217331,-0.11053655296564102,0.20312903821468353,-0.2657913267612457,0.25071853399276733,0.22656473517417908,0.02103373035788536,0.05795380473136902},{-0.10821957886219025,-0.3029189109802246,-0.02680971473455429,0.277418315410614,-0.16111189126968384,0.15843504667282104,0.3616843819618225,0.039616841822862625,-0.31886470317840576,-0.19378361105918884,-0.27056339383125305,-0.12473370134830475,-0.26563239097595215,-0.13309317827224731,-0.11505046486854553,0.09733611345291138,-0.19849351048469543,-0.24289746582508087,-0.07486037909984589,-0.10798154771327972,-0.04781864956021309,0.23552305996418,0.11169707030057907,0.23972390592098236,0.20138874650001526,-0.21908196806907654,0.05541553720831871,0.2753397524356842,0.16967318952083588,0.21313922107219696,-0.17955584824085236,0.05848458781838417},{0.009346535429358482,-0.2891564965248108,-0.04564604535698891,0.18834790587425232,0.03435816615819931,-0.04829992726445198,-0.1496403068304062,0.3013986647129059,0.0894373282790184,-0.30958646535873413,-0.28816142678260803,0.2800167500972748,-0.22441379725933075,0.20059356093406677,-0.14169034361839294,-0.08101879805326462,0.35877346992492676,-0.10605505108833313,0.1787697672843933,-0.3397219479084015,-0.00032868795096874237,0.1412409394979477,-0.24462451040744781,0.12665507197380066,0.355866938829422,0.037075258791446686,0.05085033178329468,0.04083269461989403,0.387287974357605,0.3474026322364807,-0.060852207243442535,0.1896621286869049},{0.26655179262161255,-0.07954567670822144,0.10599815100431442,-0.16722461581230164,-0.003805977525189519,0.23671233654022217,-0.28885412216186523,0.2627495527267456,0.04477393627166748,0.28871771693229675,-0.044128257781267166,0.24483105540275574,0.2404717653989792,-0.04888838157057762,-0.3922920525074005,0.2592647671699524,0.17311017215251923,-0.05486512929201126,0.013146479614078999,-0.04941481724381447,0.24709336459636688,-0.0757160410284996,-0.19647933542728424,-0.21708367764949799,-0.05331050604581833,-0.003181329695507884,0.2381284385919571,-0.1945090889930725,0.11083964258432388,-0.11159753799438477,-0.003014804795384407,-0.3379230201244354},{0.11282097548246384,0.3325377106666565,-0.1535922884941101,-0.25511282682418823,-0.05349563807249069,0.19876407086849213,0.249921515583992,0.0460321269929409,0.3314545154571533,-0.2592000365257263,-0.05838053673505783,-0.24825118482112885,-0.32160013914108276,0.2276345044374466,-0.09794308245182037,0.1245107501745224,-0.10909613221883774,0.10971403867006302,-0.18720360100269318,0.13268128037452698,-0.1168040931224823,0.15580062568187714,-0.236460343003273,0.11901290714740753,-0.3500237464904785,-0.03531486541032791,0.08684377372264862,0.2501479387283325,-0.2841836214065552,-0.22675269842147827,0.02857375517487526,0.05123848840594292},{0.2681676149368286,-0.04416246339678764,-0.22867996990680695,0.20378297567367554,0.33519574999809265,-0.25044283270835876,-0.017712406814098358,-0.015727778896689415,0.148764505982399,0.13803599774837494,0.21674548089504242,0.06402900815010071,-0.25415506958961487,0.09343875199556351,-0.05822013318538666,-0.10109826177358627,0.032104991376399994,-0.14906378090381622,0.15226466953754425,-0.1560114622116089,0.0659463033080101,-0.09923462569713593,0.040642015635967255,-0.13740308582782745,-0.29687681794166565,-0.20118939876556396,0.04877346754074097,0.1616014987230301,-0.1080850213766098,0.20229247212409973,-0.13514204323291779,0.2786356508731842},{-0.06690912693738937,-0.012876521795988083,-0.050601452589035034,0.17876996099948883,0.0807296633720398,-0.060227055102586746,0.03575682267546654,0.10182872414588928,-0.28461652994155884,0.28842684626579285,0.1921277791261673,0.18083448708057404,0.11693355441093445,-0.3885783851146698,0.06862644851207733,-0.15499478578567505,0.2724495530128479,0.08947590738534927,0.10956531018018723,-0.16672247648239136,-0.18268510699272156,0.0012457598932087421,0.19939503073692322,-0.06369954347610474,-0.16492794454097748,-0.17906925082206726,0.11310305446386337,0.09669153392314911,-0.04799744114279747,0.2739560306072235,-0.19976022839546204,-0.11849179118871689},{0.03773244097828865,-0.2520947754383087,0.01141997892409563,0.1826646476984024,0.2450244277715683,0.26244232058525085,-0.22804492712020874,-0.34428533911705017,-0.054419778287410736,0.24266837537288666,-0.1700836420059204,-0.3440767526626587,0.020486770197749138,0.14395831525325775,0.04267780855298042,-0.2766783833503723,0.07811503857374191,0.2628032863140106,0.25223779678344727,0.12188450247049332,0.18463121354579926,0.019729947671294212,0.2411235272884369,-0.2325383722782135,0.23746654391288757,-0.28886860609054565,-0.25234559178352356,0.23282936215400696,-0.19633598625659943,0.34971892833709717,-0.14148904383182526,0.3263833522796631},{0.11815168708562851,0.07003378123044968,-0.32323506474494934,-0.05707147344946861,0.24580004811286926,0.1101321280002594,-0.1403621882200241,-0.11009150743484497,-0.07436109334230423,0.06732058525085449,-0.0780504122376442,-0.2134288102388382,0.07733966410160065,-0.028929181396961212,-0.20451410114765167,-0.3035080134868622,0.3060324788093567,0.1633852869272232,-0.02551482804119587,-0.2570999562740326,0.01924067735671997,-0.11568272858858109,0.2658340632915497,0.1824350506067276,0.19097794592380524,0.04259458929300308,0.016315940767526627,0.16469761729240417,0.0824476033449173,0.13059383630752563,0.049657296389341354,-0.2246752232313156},{0.058463387191295624,-0.0013286045286804438,-0.22098815441131592,0.024585377424955368,-0.26172757148742676,0.23888255655765533,-0.0886182114481926,0.13003462553024292,-0.14399798214435577,0.36675673723220825,-0.08831271529197693,-0.2370826005935669,0.030429374426603317,-0.15346667170524597,0.32969239354133606,-0.17529763281345367,-0.07476712763309479,0.30488473176956177,0.0965757817029953,0.21565930545330048,-0.09948574751615524,0.3280559182167053,-0.20280082523822784,0.18079079687595367,-0.25332000851631165,-0.04647032544016838,-0.2853822708129883,-0.3476889133453369,-0.07610086351633072,0.25667086243629456,-0.016924722120165825,0.12956511974334717},{-0.060402337461709976,0.3527217507362366,0.053232818841934204,-0.07441505044698715,0.07594968378543854,0.329873263835907,-0.12002658098936081,0.1386910229921341,0.023692365735769272,-0.3157023787498474,0.06466079503297806,-0.08918947726488113,-0.22352845966815948,-0.18124915659427643,-0.2878665626049042,-0.3040199279785156,0.052476320415735245,-0.2206186205148697,0.30572980642318726,-0.46754947304725647,0.1922300159931183,-0.21071667969226837,-0.2562040388584137,0.2714111804962158,-0.2000584751367569,-0.0703207403421402,-0.2933918237686157,-0.012531397864222527,-0.081788569688797,0.35013362765312195,0.15953460335731506,-0.15033839643001556},{-0.09052519500255585,0.08281627297401428,0.18260635435581207,-0.024819908663630486,-0.054961226880550385,0.10435469448566437,0.18762359023094177,0.07364573329687119,-0.0381336472928524,0.07904018461704254,-0.13777586817741394,0.34663042426109314,0.007826917804777622,0.05822928994894028,-0.23909050226211548,-0.038614869117736816,0.19709351658821106,0.3156192898750305,-0.330072283744812,0.09911452978849411,0.19928254187107086,-0.24537883698940277,-0.09064546972513199,-0.18235862255096436,-0.01482101809233427,-0.08370500802993774,0.20265915989875793,0.21165181696414948,-0.18185333907604218,-0.2831099033355713,-0.2637993395328522,-0.23355646431446075},{-0.0151188550516963,0.17831724882125854,-0.1886216104030609,0.19974762201309204,0.20441444218158722,-0.01981245167553425,-0.18479226529598236,0.42814701795578003,-0.30532774329185486,-0.30219078063964844,0.21407954394817352,0.02812599018216133,-0.3034951388835907,-0.06905779242515564,0.21301999688148499,0.0910840630531311,0.2630462646484375,-0.03202442079782486,-0.5322748422622681,-0.17267923057079315,-0.3459368646144867,-0.08684270083904266,0.3037601113319397,-0.04549404978752136,-0.059854473918676376,-0.3581853210926056,0.07609860599040985,0.1766439527273178,-0.24716411530971527,-0.006844605319201946,-0.2780589163303375,-0.2561209499835968},{0.03788578137755394,-0.10020984709262848,0.11992091685533524,0.13960157334804535,0.2591537535190582,0.11729833483695984,-0.1543998122215271,0.34294337034225464,0.014226308092474937,0.13512498140335083,-0.25642967224121094,0.21748699247837067,0.05719447508454323,0.0507938489317894,0.2555524408817291,0.10424673557281494,0.16380436718463898,-0.34443041682243347,-0.2527768313884735,-0.0454789400100708,0.2628362476825714,0.024371981620788574,-0.3914433419704437,0.20875521004199982,0.25631576776504517,0.08098762482404709,0.001760351238772273,-0.03541327640414238,-0.08542665094137192,-0.02139810472726822,-0.19028212130069733,-0.13504697382450104},{0.15793846547603607,0.19727365672588348,-0.15835051238536835,-0.02656526491045952,0.013731268234550953,0.1073603481054306,-0.1339711993932724,0.027327334508299828,0.014053353108465672,-0.20615316927433014,-0.04332121089100838,0.1967463344335556,-0.21882623434066772,0.21201974153518677,-0.06477395445108414,-0.33014386892318726,-0.22265107929706573,-0.04967917129397392,0.19583052396774292,0.19931888580322266,-0.25255313515663147,0.06435155123472214,0.03124629519879818,-0.28304192423820496,0.2338784784078598,-0.04975679889321327,-0.02119915746152401,0.018157193437218666,-0.13525666296482086,-0.3029973804950714,0.3251815140247345,-0.039316531270742416},{0.34065213799476624,0.22327721118927002,0.15393316745758057,0.14737509191036224,-0.12808550894260406,0.05427834019064903,0.16748714447021484,-0.20262502133846283,-0.01713043637573719,0.13483431935310364,0.11866077035665512,0.35674789547920227,-0.025590430945158005,-0.21611027419567108,-0.2913753390312195,0.049780603498220444,0.29214680194854736,-0.24158383905887604,-0.3874911069869995,-0.22149229049682617,0.2759040892124176,-0.31654274463653564,-0.23921887576580048,-0.27095291018486023,0.17588545382022858,-0.1947299838066101,0.005523002240806818,-0.3256473243236542,-0.041007693856954575,-0.130290687084198,-0.41399499773979187,0.36121654510498047},{-0.19533418118953705,-0.3033595383167267,0.3474583625793457,-0.11293598264455795,0.023236200213432312,-0.13022580742835999,-0.05010746791958809,0.2823283076286316,-0.19450072944164276,0.13882789015769958,0.26308149099349976,0.19309879839420319,-0.26475921273231506,-0.21865157783031464,0.051871247589588165,0.30666384100914,0.15132132172584534,-0.15646058320999146,-0.03877783566713333,-0.07382238656282425,0.23681102693080902,0.2759648263454437,0.2744303345680237,0.2875896394252777,0.17689643800258636,-0.028813878074288368,-0.1855538785457611,-0.18460746109485626,0.005640356335788965,0.15811921656131744,0.09464576840400696,-0.34357574582099915},{0.17332054674625397,0.2444976419210434,0.18618637323379517,-0.1699870079755783,0.09978476166725159,0.09706137329339981,0.06972727924585342,-0.21553072333335876,-0.19620689749717712,0.07497554272413254,0.07473558187484741,-0.2918430268764496,0.1556279957294464,0.28398406505584717,0.1798679679632187,0.28058189153671265,0.16835631430149078,-0.25231030583381653,-0.395534485578537,-0.004051828291267157,-0.26197534799575806,0.2474188506603241,0.054453253746032715,-0.2858070731163025,0.027463460341095924,-0.16872531175613403,0.013550993986427784,-0.23948614299297333,0.22512996196746826,-0.23706208169460297,-0.028199689462780952,-0.08752736449241638},{0.2121303677558899,-0.20619000494480133,-0.335582971572876,-0.318502813577652,0.045192599296569824,-0.24445867538452148,-0.13781076669692993,0.026571569964289665,-0.2442915290594101,0.29557308554649353,-0.2736736238002777,-0.07482168078422546,0.21324695646762848,0.2267308235168457,-0.12641194462776184,0.17015795409679413,0.12113582342863083,-0.08358276635408401,0.03301750868558884,-0.2973044514656067,0.09273318201303482,-0.045727916061878204,0.19354234635829926,-0.14722032845020294,0.11027567833662033,0.2052076756954193,0.07799699157476425,-0.09377940744161606,-0.038448404520750046,-0.33519625663757324,0.27956536412239075,-0.14734208583831787},{-0.07320115715265274,0.06526269018650055,0.12565311789512634,0.11365939676761627,0.1982002854347229,0.0723063200712204,0.21683476865291595,0.23392215371131897,0.29602721333503723,-0.26259490847587585,-0.35855698585510254,-0.24493072926998138,0.06576953828334808,-0.07482372969388962,-0.14194360375404358,0.06742671877145767,-0.16015887260437012,0.22654646635055542,-0.3394624590873718,-0.27827218174934387,-0.3235848844051361,-0.026927275583148003,0.1432037055492401,-0.19934822618961334,-0.21864357590675354,-0.29052552580833435,0.18425960838794708,-0.22215068340301514,-0.19921962916851044,0.22222894430160522,0.2932531237602234,0.10821018368005753},{-0.01019294187426567,0.09810476005077362,-0.19109447300434113,-0.2453286349773407,-0.30050215125083923,0.25175026059150696,-0.1888381540775299,0.4226643443107605,-0.06309787929058075,-0.27574679255485535,0.23209019005298615,0.1591511219739914,-0.060512471944093704,-0.2676350176334381,-0.06798399984836578,-0.0007195653161033988,-0.07715906947851181,-0.03770369291305542,-0.29411330819129944,0.10560429841279984,-0.30885666608810425,-0.08785203844308853,-0.11861260235309601,-0.10287640243768692,0.2411363422870636,0.12572665512561798,0.2748996317386627,-0.11016266793012619,0.010715176351368427,0.14869238436222076,0.31059983372688293,0.038730401545763016},{-0.35314878821372986,-0.07713878899812698,0.2743455469608307,0.21751652657985687,-0.16436830163002014,0.2362898290157318,-0.17803548276424408,-0.14841634035110474,0.06314554065465927,0.2463705688714981,0.20867480337619781,0.07900303602218628,-0.07859880477190018,-0.05917087197303772,-0.0039009000174701214,-0.171775221824646,-0.10877007246017456,0.1589018851518631,0.10574503988027573,0.17679698765277863,0.0987163707613945,0.04619617015123367,-0.08744975179433823,-0.17387418448925018,0.10683687031269073,0.34266993403434753,-0.06505247205495834,-0.26017823815345764,-0.21490544080734253,-0.32989075779914856,-0.23845867812633514,0.07494448870420456},{-0.274671345949173,0.24381273984909058,0.11910887807607651,0.11152128130197525,0.15771779417991638,0.18846862018108368,0.06837383657693863,0.272848904132843,-0.23634196817874908,-0.0021728980354964733,0.11603059619665146,-0.3156304955482483,-0.20926345884799957,-0.004257523454725742,-0.20246970653533936,0.19362281262874603,-0.2510282099246979,-0.05411774665117264,-0.05307400971651077,-0.18069182336330414,-0.029339607805013657,0.3538365662097931,0.1375328004360199,-0.18228180706501007,0.19566692411899567,-0.11010585725307465,-0.2030574381351471,0.08354522287845612,-0.11139634996652603,0.20515216886997223,0.3004244565963745,0.08000676333904266},{-0.32338979840278625,-0.30712148547172546,0.10218528658151627,0.24364879727363586,-0.22132012248039246,-0.24845296144485474,0.24250805377960205,0.22663480043411255,0.04829738289117813,-0.3240206241607666,-0.21865098178386688,0.12748399376869202,0.19494204223155975,0.1721285879611969,-0.09975481778383255,0.020563410595059395,0.0990554541349411,0.07189882546663284,-0.09582114219665527,0.10367386043071747,0.11572230607271194,-0.18844063580036163,-0.08242078870534897,0.03751242905855179,0.11424697190523148,-0.12188921123743057,-0.10527769476175308,0.3437775671482086,-0.05492211505770683,0.2940532863140106,-0.01887129247188568,0.17200730741024017}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2748536467552185,0.24782578647136688,0.18453224003314972,-0.42823559045791626},{-0.10270698368549347,0.05198630690574646,0.2869775593280792,0.23290129005908966},{-0.06362840533256531,-0.36024707555770874,0.04870885983109474,0.11762683838605881},{0.17482532560825348,-0.18894442915916443,-0.04379677027463913,0.053328510373830795},{-0.2814165949821472,-0.038262467831373215,-0.16076502203941345,-0.18016818165779114},{0.2551039457321167,-0.31094303727149963,0.21144390106201172,0.19998732209205627},{-0.03626207634806633,-0.33272942900657654,0.08776399493217468,0.22137746214866638},{0.267845094203949,0.039530545473098755,-0.2064729779958725,-0.3295939564704895},{0.3000403046607971,0.20596086978912354,0.31709733605384827,0.3036072254180908},{-0.16666240990161896,-0.4704679846763611,0.2673758566379547,-0.43851423263549805},{-0.08295153081417084,-0.10302814841270447,-0.07047591358423233,-0.02831488847732544},{0.21144916117191315,0.03128928318619728,0.09235158562660217,-0.3595447242259979},{-0.2985183894634247,-0.4401601552963257,-0.1709834784269333,0.3350183665752411},{0.25903990864753723,0.07044187933206558,-0.3590744733810425,0.35984280705451965},{-0.3274572491645813,0.25252971053123474,-0.01830304227769375,0.21809083223342896},{0.3392598628997803,-0.229685440659523,-0.06909430027008057,-0.11377852410078049},{0.33459407091140747,0.0847349688410759,0.17997100949287415,-0.36036360263824463},{-0.3155533969402313,0.14447639882564545,-0.3715994656085968,-0.3078143298625946},{0.08111172914505005,-0.4166088104248047,0.07446365058422089,0.4302171468734741},{-0.10632951557636261,-0.15726986527442932,-0.21531282365322113,-0.2483518272638321},{0.3670893907546997,-0.22539184987545013,-0.19574114680290222,0.3777002692222595},{-0.2888713479042053,-0.2634902000427246,-0.14984583854675293,0.31870895624160767},{0.2866329550743103,0.010852789506316185,-0.1325659602880478,-0.2699318528175354},{0.1960681825876236,-0.10218068212270737,0.1291670948266983,0.08714346587657928},{0.30233240127563477,-0.0321471132338047,-0.35891687870025635,0.04804135859012604},{0.046101536601781845,-0.2482597380876541,-0.40787407755851746,0.23979321122169495},{-0.0734206885099411,-0.25983887910842896,-0.2748548090457916,-0.15785397589206696},{0.32996928691864014,-0.021581850945949554,-0.13351064920425415,0.05693206563591957},{-0.09118674695491791,0.10938235372304916,-0.15456806123256683,0.010813819244503975},{0.22584061324596405,-0.3521978259086609,0.4314129650592804,0.08755164593458176},{0.18730680644512177,0.07912765443325043,-0.14386418461799622,0.28557202219963074},{-0.21929457783699036,0.38497650623321533,0.25491049885749817,0.2149311751127243}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09205986559391022,0.028512902557849884,-0.026471348479390144,0.027790825814008713,0.03921704739332199,-0.18718746304512024,-0.04759934917092323,0.031773291528224945,-0.01722722128033638,-0.047063879668712616,0.051597144454717636,0.02702397294342518,0.05362844839692116,0.04493037983775139,-0.06751613318920135,0.11816506087779999};
static const float actor_encoder_self_encoder_2_bias[16] = {0.026433035731315613,0.0010222136043012142,-0.017442487180233,-0.02116060070693493,0.01715047098696232,0.06143232434988022,0.029750848188996315,0.01530853658914566,-0.060213472694158554,0.01100526936352253,0.044887371361255646,0.018024498596787453,-0.05171908810734749,0.0315336249768734,-0.00932825542986393,0.06475735455751419};
static const float actor_encoder_feed_forward_0_bias[32] = {0.022191323339939117,0.06632133573293686,-0.011495090089738369,-0.0055893538519740105,-0.02011258900165558,-0.0154918497428298,-0.026754068210721016,-0.025793183594942093,0.04337038844823837,0.02712760679423809,-0.013281595893204212,0.041893430054187775,0.0011345407692715526,-0.030218590050935745,0.016596967354416847,-0.03626706078648567,0.039269909262657166,-0.05476349964737892,0.03639057278633118,-0.06744633615016937,0.0633213222026825,-0.025783753022551537,0.0030798122752457857,0.01499931886792183,-0.04923267662525177,-0.012112604454159737,-0.036648381501436234,0.006323156878352165,-0.03093509003520012,-0.005568329244852066,-0.01706179603934288,0.05280634015798569};
static const float action_parameterization_distribution_linear_bias[4] = {0.0016322574811056256,0.0011563855223357677,0.0502680279314518,0.02025834657251835};
static const float actor_encoder_obstacle_encoder_0_weight[16][16] = {{0.043758559972047806,0.18238845467567444,0.04250367730855942,-0.049852803349494934,0.2061653584241867,-0.2070888876914978,0.15494786202907562,0.04225991293787956,0.24737930297851562,-0.08878263086080551,0.4571518003940582,-0.1716679483652115,-0.2946951687335968,-0.06240536645054817,-0.2613619863986969,0.04169929772615433},{0.49758291244506836,-0.1170533299446106,0.3738365173339844,0.12246590107679367,0.042609959840774536,0.23865234851837158,0.20547184348106384,-0.3404730558395386,0.2478303164243698,-0.16836124658584595,-0.3406354784965515,0.6093422174453735,0.20330703258514404,0.12252012640237808,-0.34280285239219666,-0.3046343922615051},{0.19309677183628082,-0.14343379437923431,0.07614912837743759,0.4474344253540039,-0.03476925194263458,-0.05684851482510567,-0.1779773235321045,0.08787143230438232,-0.22329673171043396,0.2575276494026184,-0.19156958162784576,-0.23343029618263245,0.33574584126472473,-0.2587847411632538,-0.14177896082401276,-0.33670946955680847},{-0.21459007263183594,-0.47483643889427185,0.1027299240231514,0.5511084794998169,-0.06887860596179962,0.07869797945022583,-0.3235706686973572,-0.057815201580524445,-0.1569875329732895,0.19270063936710358,-0.31380513310432434,0.5678582191467285,0.2641521394252777,0.04469187930226326,-0.2974381744861603,-0.5826957821846008},{-0.31111711263656616,0.21463948488235474,0.058131493628025055,0.10708843171596527,0.40293267369270325,-0.5075278282165527,-0.21588720381259918,0.026096327230334282,-0.39986124634742737,0.1286250352859497,0.020054331049323082,0.29578155279159546,0.490913987159729,-0.21841014921665192,0.030291516333818436,-0.2806028127670288},{-0.35904744267463684,-0.17948448657989502,-0.07542005926370621,0.24850820004940033,0.03967742249369621,-0.015387112274765968,0.06528099626302719,0.34385889768600464,-0.2363583892583847,0.11703551560640335,0.3103518784046173,0.14105193316936493,0.26334911584854126,0.32995301485061646,-0.11068630963563919,-0.09383872151374817},{-0.12686340510845184,0.08758009970188141,0.20751747488975525,0.35583847761154175,-0.2987019419670105,-0.27648934721946716,-0.21694883704185486,0.20341306924819946,-0.3311464190483093,0.39971688389778137,0.05653546378016472,0.006106088869273663,-0.012802050448954105,-0.45837700366973877,0.15305520594120026,0.1799422651529312},{0.06732212007045746,0.013298101723194122,-0.3866470158100128,0.1394210308790207,0.19792671501636505,-0.2938295900821686,0.2827458083629608,0.47010985016822815,0.08685087412595749,-0.38923218846321106,-0.5021471977233887,0.393951416015625,0.2878710925579071,0.3035697340965271,-0.13403378427028656,-0.07506118714809418},{0.06746767461299896,-0.00963174644857645,-0.12165360152721405,0.14022862911224365,-0.3271983861923218,-0.28107669949531555,0.32062312960624695,-0.004027654882520437,0.24787352979183197,0.31322816014289856,0.11527658998966217,-0.04130113124847412,-0.25973135232925415,0.0742330327630043,-0.398599237203598,-0.05725155770778656},{0.2436797022819519,-0.37023982405662537,-0.26610371470451355,0.3761271834373474,0.3527733385562897,-0.13785888254642487,0.23962320387363434,0.2900823652744293,-0.3641124665737152,0.3481441140174866,-0.4373791217803955,0.45872819423675537,-0.10790909826755524,0.32071346044540405,-0.48806893825531006,-0.11372561752796173},{-0.07242978364229202,0.38383615016937256,0.11544603109359741,0.005197127349674702,-0.1491706371307373,-0.30661964416503906,0.1795589178800583,-0.03905666247010231,-0.03777717426419258,-0.43633830547332764,-0.474018931388855,0.47436630725860596,0.22487202286720276,0.08078695833683014,-0.384945273399353,0.2719208002090454},{0.2744370400905609,-0.16044576466083527,0.1770123988389969,0.3800331950187683,-0.4903765022754669,0.028008347377181053,0.37313780188560486,0.33964377641677856,0.2610320746898651,0.002728990977630019,0.20712222158908844,0.24193745851516724,-0.14092031121253967,0.38528263568878174,-0.3117219805717468,-0.34582072496414185},{0.3435547649860382,0.4949752986431122,-0.02359651029109955,-0.072670578956604,0.021278297528624535,0.34356361627578735,0.31744226813316345,-0.2779853343963623,0.15783236920833588,0.21664120256900787,-0.3794265389442444,-0.031831469386816025,-0.39935821294784546,0.12205170094966888,-0.1508297324180603,0.4045190215110779},{-0.29487520456314087,0.09952688962221146,0.18299411237239838,-0.10666217654943466,-0.37892618775367737,-0.03488576039671898,-0.08240322023630142,0.2105826437473297,0.28650015592575073,-0.28591084480285645,0.22186818718910217,0.14367501437664032,0.3066886365413666,0.2643730640411377,-0.12854155898094177,-0.2750614881515503},{0.38889870047569275,-0.10895631462335587,-0.21762126684188843,0.33196720480918884,0.015710610896348953,-0.30708685517311096,0.27289626002311707,-0.36827144026756287,0.4288139045238495,0.19124779105186462,0.07021237909793854,0.41718918085098267,-0.2708359956741333,-0.363301545381546,-0.1484120637178421,0.13774928450584412},{0.30337318778038025,0.4160882234573364,0.31398528814315796,0.23782870173454285,0.3085867166519165,0.258158802986145,-0.08447442948818207,0.04770984500646591,0.49444031715393066,-0.16298893094062805,0.08478454500436783,0.4381679892539978,-0.07024074345827103,-0.1419381946325302,-0.23222826421260834,0.21144041419029236}};
static const float actor_encoder_obstacle_encoder_2_weight[16][8] = {{-0.17265354096889496,-0.3227141499519348,-0.09942859411239624,0.42712652683258057,-0.33432790637016296,0.47898903489112854,-0.21912303566932678,-0.33807551860809326},{0.24389450252056122,-0.34336572885513306,-0.04194842278957367,0.02152818813920021,-0.55350661277771,0.14246511459350586,-0.2431974560022354,0.16531804203987122},{-0.4203019142150879,-0.17557653784751892,-0.35774675011634827,0.3746820390224457,-0.271318644285202,-0.14788180589675903,-0.11357472836971283,-0.3856818974018097},{-0.36490291357040405,0.4278240203857422,-0.4956939220428467,0.04606953635811806,0.24836815893650055,-0.289420485496521,0.1367979198694229,-0.045556649565696716},{-0.15863478183746338,0.33668917417526245,0.18965815007686615,0.5211575627326965,-0.15527097880840302,-0.102543905377388,-0.3437381088733673,0.0786009132862091},{0.10422094911336899,0.31704428791999817,-0.0862058699131012,0.4822600781917572,-0.47231921553611755,-0.3394830822944641,0.3702894151210785,0.4243125915527344},{0.25218307971954346,-0.3125512897968292,0.2877071499824524,-0.22069816291332245,-0.27927225828170776,-0.027004828676581383,0.2060093730688095,-0.16859526932239532},{-0.489834189414978,-0.04946499317884445,-0.1641910821199417,-0.4350244104862213,0.0332629568874836,-0.2089427262544632,0.03304685652256012,0.12556374073028564},{-0.11099936813116074,0.21993757784366608,-0.029107101261615753,-0.16484235227108002,-0.35349950194358826,0.09644393622875214,-0.0814734548330307,-0.0683882087469101},{0.3647608458995819,0.15316273272037506,0.19623488187789917,-0.12157989293336868,-0.3207147717475891,-0.2975614368915558,-0.06438250839710236,-0.16328668594360352},{0.33870023488998413,-0.18522624671459198,-0.21735528111457825,0.07932492345571518,0.1839035004377365,-0.12699617445468903,0.15708838403224945,-0.4505467116832733},{-0.45671647787094116,0.14893797039985657,-0.2683223783969879,0.34022006392478943,-0.14957191050052643,-0.18988719582557678,0.17882782220840454,0.3479367792606354},{-0.22883081436157227,-0.5308123230934143,0.5074477195739746,-0.08046862483024597,-0.0656457245349884,0.06825675815343857,-0.22925569117069244,-0.42917704582214355},{0.004457585047930479,-0.26926809549331665,0.33634209632873535,0.3541673719882965,-0.0867079645395279,0.37371161580085754,0.2914547920227051,0.15694516897201538},{-0.18307828903198242,-0.15161839127540588,-0.484556645154953,0.17091073095798492,0.11076802015304565,0.45902326703071594,0.18576377630233765,-0.30576664209365845},{0.20093578100204468,-0.10579763352870941,-0.4209780991077423,0.4065869450569153,-0.511288583278656,-0.36329734325408936,0.1991949826478958,0.40196046233177185}};
static const float actor_encoder_obstacle_encoder_0_bias[16] = {-0.010922917164862156,0.0004193834902253002,-0.005040503107011318,0.052375756204128265,-0.01695738174021244,0.04423993453383446,0.01100948080420494,-0.026438964530825615,-0.059423863887786865,-0.0330781489610672,-0.060643166303634644,0.16629964113235474,-0.10492654144763947,-0.016476090997457504,-0.06184106320142746,-0.017180167138576508};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.06548210978507996,0.0011368767591193318,0.0023065342102199793,-0.03525901213288307,0.012816236354410648,0.02346520684659481,-0.010489634238183498,0.009794712997972965};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

