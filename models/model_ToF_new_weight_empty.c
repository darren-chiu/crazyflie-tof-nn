
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.12091391533613205,-0.06440991163253784,-0.08883585035800934,-0.01171674020588398,0.11759275197982788,0.45344340801239014,-0.12765157222747803,0.45075005292892456,-0.1310270130634308,-0.017039833590388298,-0.018511319532990456,-0.29495567083358765,-0.12485428154468536,0.34867560863494873,0.0405455157160759,-0.05806960165500641},{0.25823450088500977,0.0747838243842125,0.2572914958000183,-0.287652850151062,0.08511026203632355,-0.5602196455001831,0.35794246196746826,0.2958979904651642,-0.01645435392856598,-0.08871883153915405,0.12897826731204987,0.1045486181974411,0.022315749898552895,0.2702510356903076,-0.1519537717103958,-0.10378853231668472},{-0.2875294089317322,-0.015515909530222416,-0.027714312076568604,0.08466336131095886,0.4305554926395416,-0.21675920486450195,0.012161029502749443,0.10344979912042618,-0.2626120150089264,-0.24406512081623077,-0.44070523977279663,0.15323412418365479,0.1918640434741974,-0.6047249436378479,-0.3083159625530243,0.3839559257030487},{-0.10072032362222672,1.1326867934258189e-05,-0.3119405508041382,0.2924753427505493,0.14299705624580383,0.07095625251531601,0.2803041934967041,0.131591334939003,0.08488952368497849,0.16457298398017883,0.2879297137260437,-0.043501462787389755,0.20186227560043335,0.13961206376552582,0.16238102316856384,-0.2062319666147232},{0.22744715213775635,0.1221037432551384,0.02547992393374443,0.021276935935020447,0.048686761409044266,-0.08284161239862442,-0.008900946006178856,0.17110060155391693,-0.004034457728266716,-0.22913174331188202,0.07521305978298187,0.44681814312934875,0.10003171116113663,0.20455098152160645,-0.1502431035041809,0.16949594020843506},{-0.41338860988616943,0.18893876671791077,0.2127351462841034,0.042035073041915894,0.25590991973876953,0.19020868837833405,-0.11108723282814026,-0.20828889310359955,-0.24898764491081238,-0.14338335394859314,0.03738582879304886,-0.28741052746772766,0.23045611381530762,-0.15714040398597717,-0.29560115933418274,-0.16429707407951355},{0.5896053910255432,-0.2015887051820755,-0.27545008063316345,-0.11080962419509888,-0.03592267632484436,-0.06802782416343689,-0.4257845878601074,0.2448331117630005,-0.480599045753479,0.014858150854706764,0.24754023551940918,0.054237570613622665,0.07427380979061127,0.14772731065750122,-0.533037006855011,-0.7801846265792847},{0.3149155378341675,-0.1945936232805252,-0.009758268482983112,-0.021811341866850853,-0.288336843252182,-0.37119072675704956,0.4011738896369934,0.515175461769104,0.17002654075622559,0.21813717484474182,0.015019889920949936,0.01678541675209999,0.11286497116088867,0.27397531270980835,-0.5450021028518677,-0.013814684003591537},{-0.14055503904819489,-0.06342746317386627,-0.02536018192768097,-0.10748157650232315,0.5016570091247559,0.45677369832992554,-0.3281608521938324,0.3443984091281891,0.1765071600675583,-0.11322987824678421,0.6500282883644104,0.13608025014400482,-0.3293934166431427,-0.04552679881453514,0.6127945184707642,-0.1543428897857666},{0.275543212890625,-0.2739925682544708,0.3162674605846405,0.5779109597206116,-0.09993144869804382,0.17320290207862854,0.1095738336443901,-0.2856258451938629,-0.07835078984498978,-0.05162503942847252,-0.12028699368238449,-0.131318598985672,0.3861645460128784,-0.1932561844587326,0.07088194042444229,0.3970283269882202},{0.7475795745849609,-0.40065208077430725,-0.302971214056015,0.076397605240345,0.4255976378917694,0.2861493229866028,-0.2937967777252197,-0.5089536905288696,-0.07622246444225311,0.09184816479682922,-0.380675733089447,0.24589771032333374,-0.09598568081855774,-0.45748329162597656,-0.2522258758544922,-0.7157437205314636},{0.488219678401947,0.5397571921348572,0.2311895340681076,-0.15370982885360718,0.2118579000234604,0.11104314774274826,0.44872549176216125,-0.03516799211502075,-0.1370164006948471,-0.4523596167564392,-0.1055867150425911,-0.1369832456111908,-0.06934335082769394,0.4173898696899414,0.1165359765291214,0.3307008743286133},{0.338153213262558,0.0014346425887197256,0.306570440530777,0.17013633251190186,-0.052391692996025085,0.0728430524468422,0.041488565504550934,0.3733389675617218,0.0466255359351635,-0.18238966166973114,-0.29092127084732056,-0.25251492857933044,0.2573988437652588,0.37973567843437195,-0.3635682463645935,0.3210190534591675},{0.06769835203886032,0.0021327324211597443,0.024354441091418266,0.6652655601501465,-0.4507444500923157,-0.40535661578178406,-0.3470897972583771,-0.2944170832633972,-0.0580664798617363,-0.21995314955711365,-0.39853358268737793,-0.3735530972480774,0.37452584505081177,-0.010886667296290398,-0.6369360685348511,0.1114756166934967},{-0.1572824865579605,0.061525680124759674,0.08770699799060822,-0.3251226246356964,0.018749987706542015,0.0916716530919075,0.2017483413219452,-0.26566582918167114,-0.3866186738014221,0.36078768968582153,-0.245425283908844,0.4050861895084381,-0.013275984674692154,-0.3782294690608978,-0.3899264931678772,-0.049580011516809464},{0.09458257257938385,-0.06166410073637962,0.17402593791484833,0.13383714854717255,-0.16853131353855133,0.07287946343421936,-0.038468435406684875,-0.017881551757454872,-0.2668510377407074,-0.14275795221328735,-0.23538200557231903,0.15597335994243622,-0.06929490715265274,-0.1230325996875763,-0.20786747336387634,0.16876383125782013},{-0.168436199426651,-0.11817842721939087,-0.15797950327396393,-0.0641866996884346,0.0009261400555260479,-0.18955998122692108,-0.3460255265235901,0.11081698536872864,0.3486189544200897,0.12217376381158829,-0.031464558094739914,0.1391303688287735,-0.18461103737354279,-0.08215989917516708,0.003178791608661413,0.18408271670341492},{0.17472681403160095,-0.15724636614322662,-0.04006762430071831,-0.17043638229370117,-0.04086854308843613,0.012486988678574562,0.05532905459403992,-0.32373201847076416,-0.1320379376411438,-0.07337388396263123,0.06956493109464645,-0.3785567581653595,0.2234536111354828,0.24853011965751648,-0.20228612422943115,-0.30958643555641174}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.20003186166286469,0.722791314125061,-0.3594777286052704,0.18735767900943756,-0.44203245639801025,0.7304908037185669,0.011577833443880081,0.07671049982309341,-0.2463286966085434,0.526485025882721,-0.04827718809247017,-0.0508415661752224,0.18267713487148285,0.24607157707214355,0.1765049248933792,0.15896432101726532},{-0.46898868680000305,0.02717248722910881,0.32382896542549133,-0.15218977630138397,-0.4195038676261902,-0.1781911700963974,0.34657105803489685,0.43302300572395325,-0.20587536692619324,-0.1681278645992279,-0.1416894942522049,-0.10517076402902603,-0.06510293483734131,0.09491971135139465,-0.3329843580722809,-0.5338217616081238},{0.2755161225795746,-0.3363250195980072,0.2299877554178238,0.2908756136894226,-0.19947318732738495,-0.04340515658259392,-0.10382994264364243,0.12581978738307953,0.2819932699203491,-0.04845350608229637,-0.1457669734954834,-0.16795803606510162,0.12933579087257385,0.31932875514030457,-0.1595829427242279,-0.17731516063213348},{-0.15103493630886078,-0.19052152335643768,0.07029605656862259,-0.37140220403671265,-0.03297026827931404,0.0036265060771256685,0.06497497111558914,-0.050583019852638245,0.1480124443769455,0.22270698845386505,-0.2768160402774811,-0.07734610140323639,0.0033806064166128635,0.05705531686544418,-0.06134200841188431,-0.12968431413173676},{0.11074965447187424,0.0411190465092659,-0.46096667647361755,0.07011249661445618,0.12449260801076889,0.2689915597438812,0.15966176986694336,0.49670642614364624,0.09576812386512756,0.19943858683109283,-0.0696672722697258,-0.37054532766342163,-0.14158301055431366,-0.19721536338329315,0.2673342823982239,0.45920470356941223},{-0.27524369955062866,0.12274307012557983,-0.4440419375896454,-0.07323367148637772,0.11570106446743011,0.23922409117221832,-0.09531881660223007,-0.384845107793808,-0.14778545498847961,0.21022368967533112,-0.10115865617990494,-0.029800113290548325,-0.1411757618188858,-0.3774320185184479,-0.01042248960584402,-0.0321749784052372},{-0.2808726131916046,-0.17880579829216003,-0.04704686254262924,0.21060897409915924,-0.07524685561656952,0.029202984645962715,0.212583526968956,0.19945646822452545,0.33687624335289,-0.1600910872220993,-0.3571186065673828,0.43275976181030273,-0.23264993727207184,0.04731898382306099,0.27263468503952026,-0.1454547792673111},{0.09295278787612915,0.2886791229248047,0.26401767134666443,-0.27186915278434753,-0.012549986131489277,-0.03947204723954201,0.028934700414538383,0.2299140989780426,-0.06150602549314499,-0.4634276330471039,-0.34368619322776794,0.41777098178863525,-0.38129135966300964,-0.08306865394115448,-0.00857625249773264,-0.38898077607154846},{0.38578224182128906,-0.3492385745048523,-0.28562697768211365,0.12705707550048828,-0.30913275480270386,0.14763152599334717,-0.421701043844223,-0.17107312381267548,0.3425080478191376,0.33869144320487976,-0.2752852439880371,-0.1553887575864792,0.2035333216190338,-0.18800890445709229,-0.2922869920730591,0.15003840625286102},{-0.10800874978303909,0.4341895580291748,0.06895964592695236,0.10522677004337311,0.24055349826812744,0.22953607141971588,-0.4312034249305725,-0.3569644093513489,-0.09275086224079132,-0.3879892826080322,-0.19173668324947357,0.08729349076747894,-0.1742037981748581,-0.174378901720047,-0.17240889370441437,-0.09731877595186234},{0.04152103513479233,0.4458777904510498,-0.310701459646225,0.23078428208827972,-0.4316774308681488,0.0475541427731514,-0.44673049449920654,0.186355322599411,0.2314995676279068,-0.48770973086357117,-0.2644352912902832,-0.44645828008651733,-0.025519611313939095,0.0900263711810112,-0.4570542275905609,0.04222538322210312},{0.3279712200164795,0.19962647557258606,0.2667558193206787,-0.09198568761348724,-0.266409307718277,0.26550889015197754,0.11890802532434464,-0.0727560892701149,0.10091178119182587,-0.17979677021503448,-0.08906420320272446,0.388033926486969,0.17210285365581512,-0.3331066370010376,-0.0197064857929945,0.03065447323024273},{0.33785855770111084,0.0120891984552145,0.02065996080636978,0.11797081679105759,-0.019044118002057076,0.17267145216464996,0.19933730363845825,-0.09690793603658676,-0.3060961663722992,0.06377017498016357,0.17883837223052979,-0.3896844685077667,-0.19012050330638885,0.12074952572584152,0.2513912618160248,0.14100493490695953},{-0.08500326424837112,0.2631244957447052,-0.07296685874462128,-0.02903568372130394,0.04110950976610184,-0.02285909838974476,-0.16607250273227692,0.11244603991508484,-0.31203603744506836,0.04449835419654846,-0.42167240381240845,-0.2840304374694824,-0.1567581743001938,0.3731791377067566,-0.14502866566181183,0.13013990223407745},{0.46130651235580444,-0.07771269232034683,-0.47370094060897827,0.13569940626621246,0.03954043611884117,-0.09152168780565262,0.30871862173080444,-0.35600560903549194,-0.49045708775520325,0.15389114618301392,-0.12973080575466156,-0.48342517018318176,-0.3624444007873535,0.18752580881118774,-0.4730745851993561,-0.09916841983795166},{0.11937658488750458,-0.5315728783607483,-0.3333527743816376,-0.22631868720054626,-0.016425633803009987,-0.390625923871994,0.023854399099946022,0.3032625913619995,0.3437327444553375,-0.11705197393894196,-0.11137013137340546,-0.34819337725639343,-0.37695056200027466,0.4764522910118103,-0.3370407819747925,0.051494721323251724}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.19921767711639404,-0.3643285930156708,0.18616360425949097,-0.32495811581611633,-0.32824742794036865,0.33151838183403015,0.295095294713974,-0.2586611211299896,0.35050833225250244,0.1374397575855255,0.05574660748243332,0.4330097436904907,-0.25036370754241943,-0.04700831323862076,-0.034862220287323,0.25246673822402954,-0.2142203152179718,0.07001060247421265,0.32211557030677795,-0.05050213634967804,0.3350013196468353,0.28812265396118164,0.18342064321041107,0.30385881662368774},{0.1035551205277443,-0.08389145880937576,-0.2996934950351715,-0.09960327297449112,-0.15518423914909363,0.14124442636966705,0.018727034330368042,0.09757710248231888,-0.3347228765487671,-0.05682887136936188,-0.5231521129608154,-0.042187005281448364,0.4417016804218292,-0.25202280282974243,-0.16787707805633545,0.23751682043075562,-0.20450584590435028,-0.02321900613605976,-0.2361338585615158,-0.20247574150562286,0.4063945412635803,0.07920540869235992,-0.2690916061401367,0.14847689867019653},{-0.09327830374240875,-0.0059570809826254845,0.16283807158470154,-0.23916327953338623,0.29579636454582214,0.22135373950004578,-0.10773959755897522,0.4532284736633301,-0.3705703914165497,0.2329045981168747,-0.19811998307704926,-0.24424420297145844,-0.30563220381736755,0.09436190873384476,0.3826967775821686,0.20703309774398804,0.035432979464530945,0.20552343130111694,0.030803479254245758,0.05642549693584442,0.22948580980300903,-0.1932246834039688,-0.14131350815296173,0.021767398342490196},{0.15057431161403656,-0.23996952176094055,0.12456014752388,0.043132234364748,0.03549860045313835,0.45768097043037415,0.05360710248351097,-0.34036490321159363,-0.29289117455482483,-0.15381070971488953,-0.30365556478500366,0.23082540929317474,0.0974683165550232,-0.19438345730304718,0.37338951230049133,-0.3259795010089874,-0.12913022935390472,-0.12957151234149933,-0.3119603395462036,-0.10481595993041992,-0.07754096388816833,-0.36083099246025085,-0.3340286910533905,0.09335410594940186},{-0.2575160562992096,-0.3481382727622986,0.23097211122512817,0.03931989520788193,0.02903256192803383,-0.34145602583885193,0.06850136071443558,-0.25980839133262634,0.053544510155916214,0.1817290037870407,-0.1994955837726593,0.28785547614097595,0.24231275916099548,0.2556850016117096,0.17129456996917725,-0.20703405141830444,-0.16620101034641266,0.06520425528287888,0.11770262569189072,0.15541762113571167,0.13258148729801178,-0.40614789724349976,-0.33150818943977356,-0.29081135988235474},{0.16410884261131287,0.3143528699874878,-0.33631670475006104,-0.09128803759813309,-0.17352886497974396,0.3223138451576233,-0.13168208301067352,-0.18775713443756104,-0.18590234220027924,-0.08652176707983017,0.04753672331571579,-0.1697600930929184,0.0002231766702607274,0.24305693805217743,0.3509596586227417,-0.37865471839904785,0.10533700883388519,0.1573060005903244,-0.5071969628334045,0.039173759520053864,-0.19363607466220856,-0.004500888288021088,0.16061317920684814,-0.05675455555319786},{0.09150220453739166,-0.0077436682768166065,0.41394492983818054,0.25465303659439087,0.31774643063545227,0.12429901212453842,-0.21343190968036652,0.3101653754711151,-0.08893093466758728,-0.25577664375305176,-0.197611004114151,0.2567804753780365,-0.24804042279720306,0.22023168206214905,0.13191822171211243,-0.2423521727323532,0.02173873968422413,-0.0321374386548996,0.2674042880535126,-0.1544962227344513,0.012613561004400253,0.12846989929676056,-0.10923028737306595,0.007120713125914335},{-0.018789328634738922,-0.3042355179786682,0.012729303911328316,0.0024349363520741463,0.12110979855060577,0.4105089008808136,-0.3134545683860779,-0.2241481989622116,0.29653242230415344,-0.04496021941304207,0.21433480083942413,0.12810029089450836,-0.48358553647994995,-0.07568837702274323,-0.20294725894927979,-0.31757327914237976,-0.29589730501174927,-0.29434892535209656,-0.2973754405975342,0.09089834243059158,0.2387106567621231,0.332915335893631,-0.2535461187362671,0.06655050814151764},{0.1915106326341629,-0.19531528651714325,0.09353920817375183,-0.16161438822746277,0.23460477590560913,0.3609752655029297,0.09450911730527878,-0.2192913293838501,-0.23850570619106293,0.1743432581424713,0.3568805158138275,0.038243863731622696,-0.011116285808384418,0.27323776483535767,-0.21724779903888702,0.3402499556541443,0.058764610439538956,0.004103480372577906,-0.15705788135528564,0.11094781011343002,0.08857227861881256,0.11645612120628357,-0.034183602780103683,-0.20729278028011322},{-0.2050309032201767,-0.07338933646678925,-0.3569552004337311,-0.37913408875465393,-0.014341429807245731,-0.2565144896507263,-0.10475893318653107,0.2967538833618164,-0.21008151769638062,-0.008070188574492931,0.215098038315773,0.08958999812602997,-0.0335007980465889,-0.19840720295906067,0.11995130777359009,0.21100838482379913,-0.020796792581677437,-0.2652144134044647,0.18302637338638306,-0.4685726761817932,-0.3285217881202698,0.253698468208313,-0.3131311535835266,0.0676477700471878},{0.1388092339038849,-0.14604122936725616,-0.0826277881860733,0.18235021829605103,0.023960096761584282,-0.03643650934100151,-0.14410777390003204,-0.08378414809703827,-0.0753161832690239,-0.03659864515066147,0.4054323434829712,-0.2559954524040222,-0.15175721049308777,-0.2292446345090866,-0.4561345875263214,0.0785045176744461,0.09586319327354431,0.05774587392807007,-0.20621365308761597,0.00044094177428632975,-0.14777104556560516,0.18108215928077698,-0.009238469414412975,-0.10698362439870834},{0.18142175674438477,-0.22013598680496216,-0.19127114117145538,-0.25857144594192505,0.07847315073013306,0.3080657422542572,0.2840133309364319,0.37658703327178955,-0.2997837960720062,-0.2259739339351654,0.2159135490655899,-0.24916031956672668,0.05812843143939972,-0.0394580215215683,0.23590786755084991,-0.09673318266868591,0.10687370598316193,0.19669543206691742,0.18011735379695892,-0.019185097888112068,-0.34202250838279724,-0.27932611107826233,0.2398308515548706,0.23124714195728302},{0.09584584832191467,0.13085103034973145,0.26335498690605164,0.3130471408367157,0.33918866515159607,-0.18013718724250793,-0.03924716264009476,-0.11311258375644684,-0.2577161192893982,-0.26609861850738525,0.028633790090680122,-0.04567927494645119,-0.18013976514339447,-0.17990955710411072,0.17162658274173737,0.2584889829158783,-0.029224177822470665,0.00901699997484684,-0.3365643620491028,-0.3001556992530823,0.06872403621673584,-0.17032809555530548,-0.16262370347976685,-0.3011830151081085},{0.1451391726732254,-0.16551509499549866,-0.23922279477119446,0.06036011874675751,0.21329578757286072,0.10503991693258286,0.19596423208713531,-0.07315201312303543,0.2387925386428833,0.4134303629398346,-0.09472540020942688,0.015769178047776222,0.33216625452041626,-0.39380890130996704,0.2157006561756134,0.03310607373714447,0.13904233276844025,-0.28911489248275757,0.4767824709415436,-0.0838930606842041,-0.14020417630672455,0.12822136282920837,0.3164559602737427,-0.01997581124305725},{-0.01069444790482521,0.35062235593795776,0.2822486162185669,0.22868986427783966,0.029319806024432182,-0.26784664392471313,0.29953816533088684,0.16941168904304504,-0.05678267404437065,-0.24060168862342834,0.3327643573284149,-0.140648752450943,-0.1250026971101761,0.1709146499633789,-0.362497478723526,-0.10295823961496353,-0.2827077805995941,-0.18627333641052246,-0.07833994925022125,0.03851170837879181,-0.24392464756965637,0.21526660025119781,0.03671795502305031,0.2211012840270996},{-0.1532280445098877,-0.3712053596973419,0.10125772655010223,-0.3225618600845337,0.06916063278913498,-0.11747488379478455,0.049176961183547974,-0.10922670364379883,-0.1746373325586319,0.21438761055469513,0.14747042953968048,0.20155635476112366,-0.16091035306453705,0.3779498040676117,0.15734870731830597,0.062037404626607895,-0.11516433954238892,0.0025113162118941545,-0.21350444853305817,-0.23568350076675415,0.014234567061066628,-0.2199987769126892,-0.37087008357048035,-0.23696494102478027},{0.21843650937080383,-0.08716118335723877,0.14925409853458405,0.3253774344921112,-0.15251292288303375,-0.00344846211373806,0.04415689781308174,0.2616264820098877,0.24165749549865723,-0.153297558426857,-0.09658241271972656,0.0498867891728878,-0.2665082812309265,-0.12212444841861725,-0.023248841986060143,0.26103147864341736,0.2569728493690491,-0.11423108726739883,0.16014070808887482,0.05977770686149597,0.11307263374328613,0.06591179221868515,0.07582514733076096,-0.013228449039161205},{0.17682375013828278,0.10842292010784149,-0.04819060117006302,-0.31983616948127747,0.19590328633785248,0.15095697343349457,0.30069923400878906,0.3591309189796448,0.17203961312770844,-0.008379826322197914,0.2767926752567291,-0.38445279002189636,0.0549781359732151,-0.01339560467749834,-0.12376362085342407,-0.23284290730953217,-0.21314236521720886,-0.07961830496788025,-0.3379831612110138,0.3429199755191803,0.027276670560240746,-0.3432881534099579,0.2393241822719574,0.1637727916240692},{0.16975556313991547,-0.12171158194541931,-0.08141830563545227,-0.2423219233751297,0.049429893493652344,-0.14693963527679443,-0.26251131296157837,-0.16816303133964539,-0.3075524866580963,-0.35292065143585205,-0.3043510317802429,0.05865391716361046,-0.268602192401886,-0.24720847606658936,0.2033201903104782,0.3568294942378998,0.18237604200839996,-0.24036726355552673,-0.2516990303993225,0.20065197348594666,0.3297646641731262,-0.00021730476873926818,-0.06826456636190414,0.1406494677066803},{0.24714557826519012,0.3724988102912903,-0.11725713312625885,0.25110292434692383,0.19869710505008698,-0.40815848112106323,-0.12556256353855133,0.25639811158180237,0.0799943208694458,-0.1489640474319458,0.3119823932647705,-0.05379723012447357,0.0020010704174637794,0.09848849475383759,0.02730274759232998,-0.045367203652858734,0.311543732881546,0.26343753933906555,-0.2547089159488678,-0.1664014309644699,0.015111500397324562,0.10312889516353607,0.013656592927873135,0.06610094755887985},{-0.15467342734336853,0.3962680697441101,-0.16036774218082428,0.04435691609978676,-0.10799336433410645,0.13964059948921204,0.027286646887660027,0.15079578757286072,0.07380327582359314,0.2819468379020691,0.20505765080451965,-0.2905265688896179,-0.10193316638469696,0.11824306100606918,-0.14199784398078918,0.10650167614221573,-0.3216463327407837,0.1841438114643097,0.01969483122229576,0.3366730213165283,0.11123032867908478,0.006605098489671946,0.04769561439752579,0.14767470955848694},{-0.03534631431102753,0.39059847593307495,0.36177858710289,-0.20114025473594666,-0.3090534210205078,0.11270304024219513,0.00019662878185044974,0.008865383453667164,-0.34017816185951233,-0.3119404911994934,-0.23910239338874817,-0.014419342391192913,0.16546231508255005,-0.012410731986165047,0.053680405020713806,-0.32335492968559265,-0.11352738738059998,0.0768505334854126,-0.023998521268367767,-0.20039266347885132,-0.11537158489227295,-0.07951295375823975,0.03932297229766846,-0.26960062980651855},{-0.02980596385896206,-0.3309144079685211,-0.05169923976063728,-0.09460558742284775,0.1254081428050995,0.008558320812880993,0.10009538382291794,-0.28824475407600403,-0.16022302210330963,0.20520181953907013,-0.28511616587638855,-0.05032758787274361,-0.12191612273454666,0.23583446443080902,-0.23176120221614838,0.03161211311817169,0.30593207478523254,0.08168932050466537,-0.2559843957424164,-0.19484972953796387,0.037877585738897324,0.14629699289798737,0.09619645029306412,0.2933706045150757},{0.24157221615314484,0.12613333761692047,-0.1939624696969986,-0.35494348406791687,0.181613489985466,0.33740296959877014,0.22123946249485016,0.03898593410849571,-0.2228660136461258,-0.2916512191295624,0.2529529929161072,-0.12842358648777008,-0.10613346844911575,-0.29666051268577576,0.30313587188720703,-0.19587098062038422,-0.034896403551101685,0.043987203389406204,0.35926318168640137,0.14626777172088623,0.027037659659981728,-0.10299725830554962,-0.3443804383277893,0.008249437436461449}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.322029173374176,0.4682735800743103,-0.339385449886322,0.0326266884803772},{-0.17891520261764526,0.23099403083324432,0.15055036544799805,0.08101211488246918},{-0.2864235043525696,-0.02989066205918789,-0.37459129095077515,-0.13032305240631104},{-0.15339037775993347,0.013617158867418766,-0.02183685079216957,-0.09255143254995346},{0.29813212156295776,0.08802176266908646,-0.237921342253685,-0.32001787424087524},{-0.04886755347251892,0.2546910047531128,0.0637381449341774,-0.055272575467824936},{0.36090490221977234,-0.2977391183376312,-0.09720452129840851,0.23748749494552612},{-0.19001096487045288,0.1719030737876892,0.12171594798564911,-0.08349652588367462},{-0.4402483403682709,0.3664047122001648,0.14021283388137817,0.42331841588020325},{0.19864849746227264,0.396452397108078,-0.304707407951355,0.2355296015739441},{-0.15947462618350983,-0.006177052855491638,-0.16197896003723145,-0.21638251841068268},{-0.26621946692466736,-0.4116300046443939,-0.28753048181533813,0.1990329772233963},{0.3245905935764313,0.11195317655801773,0.41529133915901184,0.27161726355552673},{-0.017725618556141853,-0.399721622467041,-0.2414260059595108,-0.16368210315704346},{-0.09286287426948547,0.3040878176689148,0.15649031102657318,0.00736497575417161},{0.40249958634376526,0.22937726974487305,0.10360695421695709,-0.07076919078826904},{0.3077820837497711,0.2464420646429062,-0.4024163484573364,0.04029638692736626},{-0.34422001242637634,0.034530360251665115,-0.3452872037887573,0.3696143627166748},{-0.425269216299057,0.4124702513217926,-0.10700730234384537,-0.017126280814409256},{-0.22337643802165985,-0.13799504935741425,-0.43793249130249023,0.30414459109306335},{-0.3346048891544342,-0.29570311307907104,0.2133958488702774,0.29891058802604675},{-0.2767004668712616,-0.22155342996120453,0.25923463702201843,-0.434858500957489},{0.27739107608795166,0.3307924270629883,0.038926176726818085,0.22340965270996094},{-0.3085261285305023,-0.09677056223154068,0.15367121994495392,0.004537450149655342}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.003158071544021368,0.08461938053369522,-0.00971442461013794,-0.032506220042705536,-0.05035988241434097,0.027744406834244728,0.10788200050592422,0.08521892130374908,-0.14892026782035828,0.011274431832134724,0.11119776219129562,0.15789170563220978,0.00924055464565754,0.012444695457816124,-0.1056848093867302,-0.11774103343486786};
static const float actor_encoder_self_encoder_2_bias[16] = {0.002185973571613431,0.1184057891368866,-0.0007980550872161984,-0.023109925910830498,-0.05333590880036354,-0.00202383566647768,-0.04773445427417755,0.017288217321038246,-0.02238370105624199,-0.06228020414710045,0.01067868061363697,0.07613024860620499,0.04149191454052925,-0.02027316205203533,-0.0369478315114975,-0.08994849771261215};
static const float actor_encoder_feed_forward_0_bias[24] = {0.03720812126994133,0.1257995367050171,0.02744917757809162,0.024519359692931175,-0.05105281621217728,-0.04429672658443451,-0.018469098955392838,0.05235769972205162,-0.06620997190475464,-0.009093988686800003,0.0013920549536123872,-0.05431379750370979,-0.04659684747457504,0.007008611690253019,0.019448811188340187,0.022130580618977547,0.007759768050163984,-0.0005680302274413407,-0.029379593208432198,0.01066990103572607,-0.0019669511821120977,-0.0053068362176418304,0.014854063279926777,-0.002785532036796212};
static const float action_parameterization_distribution_linear_bias[4] = {-0.012279401533305645,0.015056522563099861,-0.0029532252810895443,-0.008176174946129322};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{-0.016078056767582893,-0.4192509353160858,-0.6025384664535522,-0.26864421367645264,0.46658703684806824,-0.03247445076704025,0.5310171842575073,0.44379952549934387},{-0.37220796942710876,-0.34041133522987366,-0.02441342920064926,-0.4268333613872528,0.3848946988582611,-0.1207260861992836,0.1348206251859665,0.25524383783340454},{-0.09699086844921112,0.1120227575302124,-0.5810518860816956,0.3117845356464386,0.5453817248344421,-0.3312237858772278,-0.3983035683631897,0.36435145139694214},{0.49602434039115906,-0.19190829992294312,0.0888783261179924,0.2737763226032257,-0.03179262951016426,-0.3587525188922882,0.5073777437210083,-0.32770591974258423},{-0.36075395345687866,0.4066278636455536,-0.2730913758277893,0.037869442254304886,0.22554855048656464,-0.10392738878726959,0.045383043587207794,0.030510665848851204},{-0.3446962237358093,-0.4814280867576599,0.0033461798448115587,0.33376753330230713,0.04499967768788338,-0.33486539125442505,-0.16962642967700958,0.321333110332489},{-0.5456400513648987,-0.5467196106910706,-0.281963974237442,0.17027734220027924,-0.35117191076278687,-0.35001516342163086,-0.17470571398735046,0.03732011839747429},{-0.049792513251304626,0.37027785181999207,0.017541466280817986,-0.5136086344718933,0.3037542402744293,-0.09785591810941696,0.5209544897079468,0.04423833638429642},{-0.5778210163116455,-0.5481442809104919,-0.12641118466854095,-0.09425470232963562,-0.2400512397289276,-0.09192943572998047,0.1249207854270935,0.2904905676841736},{-0.3562898337841034,0.3169229328632355,0.05430978536605835,-0.15281668305397034,-0.08242956548929214,-0.3331085741519928,0.38310185074806213,-0.33080676198005676},{0.3883274793624878,0.04724714532494545,-0.29509854316711426,-0.3830118179321289,-0.1288800686597824,0.2645241320133209,0.42579150199890137,-0.08565805107355118},{0.1351589560508728,-0.552056610584259,-0.45205944776535034,0.07170960307121277,-0.3839350938796997,0.39242756366729736,-0.05595998838543892,0.29063230752944946},{0.24757513403892517,0.33544090390205383,-0.08447923511266708,-0.26140934228897095,0.1068967878818512,-0.37097451090812683,0.13206259906291962,0.36902621388435364},{0.07375910878181458,-0.2110985964536667,-0.4709278345108032,-0.3569234609603882,0.17583996057510376,0.19434629380702972,-0.255806028842926,0.582575261592865},{-0.43608081340789795,-0.2655295431613922,-0.4845065474510193,-0.12022553384304047,0.06490805000066757,-0.27153798937797546,0.47176867723464966,0.029697148129343987},{-0.24008317291736603,-0.45032167434692383,-0.6532309651374817,-0.4620051383972168,0.467708557844162,-0.07076731324195862,-0.21542902290821075,0.22401781380176544}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.27893638610839844,0.11058447510004044,-0.325304239988327,-0.20563291013240814,-0.5727885365486145,0.5712007880210876,-0.10866086184978485,0.11460341513156891},{-0.07451915740966797,0.007180686108767986,-0.6194671988487244,0.35820868611335754,0.12103725224733353,0.26635462045669556,0.5170962810516357,0.31228795647621155},{-0.28291112184524536,-0.4727858901023865,-0.5949349403381348,0.4415528178215027,0.21615523099899292,-0.40430301427841187,0.45171916484832764,-0.21790482103824615},{0.4951854944229126,0.15335890650749207,0.20671409368515015,-0.4752139747142792,-0.22820129990577698,-0.5408421158790588,-0.3344479203224182,0.2158382385969162},{-0.12655450403690338,-0.16027088463306427,-0.2502005398273468,0.36708009243011475,0.4685046970844269,-0.3339711129665375,-0.20557264983654022,0.09336584061384201},{0.26709192991256714,-0.4716031849384308,-0.2843199670314789,-0.1700405329465866,-0.5033612251281738,-0.18867890536785126,-0.033575430512428284,0.12203379720449448},{0.31425049901008606,0.5268478989601135,-0.33137083053588867,0.6359380483627319,-0.1986803114414215,0.3744869828224182,0.16076025366783142,0.36229968070983887},{0.08983536809682846,-0.10970439016819,0.5259049534797668,0.3570912778377533,0.5859634280204773,0.23316790163516998,0.023567093536257744,-0.05616474896669388}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.009775403887033463,-0.1281755268573761,-0.1673087179660797,-0.0800127238035202,0.08932308852672577,-0.03249243646860123,0.10380088537931442,0.057425666600465775};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.019904758781194687,-0.038507409393787384,0.02564273774623871,0.051373545080423355,0.0028570545837283134,0.03761448711156845,0.02417159639298916,0.10712520778179169};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

