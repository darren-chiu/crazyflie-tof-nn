
#include <random>
#include <vector>
#include <iostream>
#include <algorithm>
#include <cstring> 


typedef struct control_t_n {
	float thrust_0;
	float thrust_1;
	float thrust_2;
	float thrust_3;
} control_t_n;

void networkEvaluate(control_t_n* control_n, const float* state_array);

static const int NEIGHBORS = 0;
static const int NBR_DIM = 0; 

static const int NUM_OBSTACLES = 2; 
static const int OBST_DIM = 8;


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.4493153989315033,0.14564469456672668,0.1514274775981903,-0.326703816652298,-0.21927708387374878,0.27485528588294983,0.16202346980571747,0.026910977438092232,-0.12213867157697678,0.27702558040618896,0.2427208125591278,-0.12605050206184387,0.05435233190655708,0.11676131933927536,0.0963473916053772,0.1831803321838379},{0.39888134598731995,-0.037784408777952194,0.03175690025091171,0.167441725730896,0.258274108171463,0.1253506988286972,-0.17961899936199188,0.23888219892978668,-0.1880963295698166,0.026972129940986633,-0.45418721437454224,-0.08699598163366318,-0.1794385015964508,-0.28670328855514526,-0.04763359948992729,0.09327523410320282},{0.10374359041452408,0.2242935746908188,-0.501086950302124,-0.008175430819392204,-0.24700966477394104,0.036586638540029526,0.41002699732780457,0.2629678249359131,-0.11626313626766205,-0.06880922615528107,-0.13335514068603516,-0.10998356342315674,-0.011649323627352715,-0.3099766969680786,-0.5981966853141785,-0.3702438175678253},{0.0298478901386261,-0.1386212557554245,-0.012450017035007477,0.03510790318250656,-0.021129930391907692,-0.044778626412153244,0.334756463766098,-0.20093679428100586,-0.348551869392395,-0.13734906911849976,0.30924656987190247,0.5067934393882751,0.16222842037677765,-0.028736082836985588,0.13282714784145355,-0.33195987343788147},{0.22997617721557617,0.23541812598705292,0.172836035490036,-0.23714272677898407,0.09463246911764145,-0.07263043522834778,0.002130584791302681,0.126260444521904,-0.1981714814901352,-0.04855998232960701,-0.5259144902229309,-0.15377405285835266,-0.35453295707702637,-0.2303638756275177,-0.17741501331329346,0.030264882370829582},{-0.27559056878089905,0.3868670165538788,-0.07789165526628494,0.4859353005886078,0.024170253425836563,0.26329466700553894,-0.2280559539794922,0.11618171632289886,0.057203467935323715,-0.04227086901664734,-0.13393466174602509,-0.3002987504005432,0.28064772486686707,0.2838154733181,-0.2486199587583542,0.3943658471107483},{0.21306340396404266,0.41789498925209045,0.0753956288099289,-0.11158421635627747,0.27434685826301575,-0.3346387445926666,0.43316206336021423,-0.2180328220129013,0.13283881545066833,0.08738034963607788,0.43302011489868164,0.1830632984638214,-0.5124945640563965,0.5298857092857361,0.031530480831861496,-0.08121991157531738},{0.1860073059797287,0.3626212477684021,-0.36367854475975037,-0.16259831190109253,0.22762177884578705,-0.15646548569202423,0.2575152814388275,0.20750439167022705,0.29264166951179504,-0.15765447914600372,-0.3685097098350525,0.21853113174438477,-0.04033467918634415,0.1753891557455063,-0.3564983010292053,-0.29580414295196533},{-0.453366219997406,-0.04438252002000809,-0.4038430154323578,-0.08666534721851349,-0.0356924869120121,0.11105628311634064,0.2041611671447754,0.11587024480104446,-0.7248554825782776,0.4961686134338379,-0.10567692667245865,0.2993239164352417,-0.060989927500486374,0.21107721328735352,0.1035565659403801,0.02897823601961136},{0.043526917695999146,0.322170615196228,0.12827323377132416,0.2355811595916748,0.38515207171440125,-0.03578833118081093,0.30160653591156006,0.24206042289733887,0.3037916421890259,0.4309311509132385,-0.2213408648967743,-0.26818734407424927,-0.038501542061567307,0.29596659541130066,-0.12567353248596191,0.2993021011352539},{-0.1762010157108307,0.4394310414791107,-0.16261610388755798,-0.3826289474964142,0.40160441398620605,0.385547935962677,0.3938435912132263,-0.2261497676372528,0.33284100890159607,-0.16410024464130402,0.0969482809305191,-0.0013691234635189176,-0.31812962889671326,-0.04167526215314865,0.09649346768856049,-0.0019771119114011526},{0.40641939640045166,0.09727557748556137,0.46126845479011536,0.005409564822912216,0.36225035786628723,0.2907033860683441,-0.2745042145252228,0.2930569648742676,-0.33581939339637756,-0.12469889968633652,-0.048394881188869476,-0.3917538523674011,0.301207572221756,0.2712145745754242,-0.10473152995109558,0.16400186717510223},{0.3958563506603241,0.1290844976902008,0.7248204946517944,-0.12588736414909363,0.7444915771484375,0.5282214879989624,0.23184415698051453,0.03518116474151611,-0.4751811921596527,-0.19174407422542572,0.057820968329906464,0.3246973752975464,-0.3747551441192627,0.4684520661830902,0.3071584105491638,0.22024430334568024},{0.23868799209594727,-0.0716884434223175,0.22174780070781708,-0.1678963005542755,0.4144522249698639,-0.13342086970806122,-0.5089249014854431,0.34512513875961304,0.1486266404390335,-0.5986185073852539,0.09003275632858276,-0.07591883838176727,0.025420594960451126,-0.08235977590084076,-0.34290772676467896,-0.4411986470222473},{-0.28319957852363586,-0.2841254770755768,-0.25042325258255005,-0.1386490911245346,0.06809621304273605,0.31083303689956665,-0.41539737582206726,-0.20529140532016754,-0.28198960423469543,0.17227576673030853,0.18791218101978302,0.13184644281864166,-0.4304778277873993,0.4078328013420105,0.14570403099060059,-0.320272833108902},{-0.01336679607629776,0.05494178459048271,0.07962041348218918,-0.09911628812551498,0.09009597450494766,0.12022645771503448,-0.3467473089694977,0.3340214490890503,0.18844527006149292,-0.06507529318332672,-0.18801534175872803,-0.31727519631385803,-0.07341308891773224,-0.4071245491504669,0.08331722021102905,-0.11367429047822952},{0.17769023776054382,-0.2372429370880127,-0.10572992265224457,-0.36111629009246826,-0.1895584911108017,-0.48767170310020447,0.18610788881778717,-0.33362630009651184,0.13977555930614471,0.2525869309902191,0.21486201882362366,0.09118808060884476,-0.23528578877449036,-0.2269826978445053,-0.376931756734848,-0.17871920764446259},{-0.21174828708171844,0.15023787319660187,-0.11927730590105057,-0.12135832011699677,0.25546109676361084,-0.07535675913095474,-0.2508150041103363,0.027668293565511703,0.056097209453582764,0.34698107838630676,0.10254697501659393,-0.1926640421152115,-0.3288126587867737,0.3129632771015167,-0.1833224892616272,0.015217251144349575}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.30718380212783813,-0.42693251371383667,-0.1386341154575348,-0.15683810412883759,-0.08833815902471542,0.21312110126018524,-0.17385916411876678,-0.06861501932144165,-0.15990164875984192,-0.16057828068733215,0.4773367941379547,0.014951007440686226,0.22681477665901184,-0.027958214282989502,-0.05023305490612984,0.10718714445829391},{0.1475542187690735,-0.39333194494247437,-0.4971875250339508,0.3313203752040863,0.29044538736343384,0.2871314287185669,0.2847442924976349,-0.05451694130897522,0.032924555242061615,0.24280880391597748,-0.11902227997779846,-0.22129876911640167,-0.07232239842414856,0.1424761265516281,-0.17595893144607544,-0.44290363788604736},{0.3570994734764099,-0.13192836940288544,0.47792646288871765,0.1279444545507431,0.3395330011844635,0.4029155671596527,-0.41050219535827637,-0.20736917853355408,0.3552870750427246,-0.22558949887752533,-0.14524264633655548,0.28637710213661194,-0.12854982912540436,0.43570923805236816,-0.21122074127197266,0.4125025272369385},{-0.32719850540161133,0.24599866569042206,0.025501666590571404,0.16927741467952728,-0.10629159212112427,0.22563718259334564,-0.12942926585674286,0.2437639832496643,0.4800088703632355,-0.21156133711338043,0.3826984465122223,-0.1223977729678154,0.14957073330879211,-0.4109865128993988,-0.1096305325627327,-0.28928521275520325},{-0.056127578020095825,-0.33722102642059326,0.21524126827716827,0.29051995277404785,0.5297108292579651,0.19421544671058655,0.12639360129833221,-0.38961875438690186,0.12625160813331604,0.42244309186935425,0.42516687512397766,0.4225660562515259,0.01829654350876808,0.20814310014247894,0.2171865999698639,-0.32259878516197205},{-0.08943811804056168,-0.3053451478481293,-0.2592252790927887,-0.1516185849905014,-0.2763943076133728,-0.008067026734352112,0.025811295956373215,0.04966411739587784,-0.4174119830131531,0.3068569600582123,-0.003042251570150256,0.11983279883861542,0.4103531241416931,0.11452655494213104,-0.3000473976135254,-0.23839803040027618},{0.3434712588787079,-0.134719580411911,-0.3562655746936798,0.3831399381160736,0.4633392095565796,0.38074398040771484,-0.28030914068222046,0.060417186468839645,0.3669511377811432,-0.28544872999191284,-0.03135424479842186,-0.3289748728275299,0.14870215952396393,-0.19977734982967377,-0.06868322938680649,0.06692720204591751},{-0.07120921462774277,-0.16758479177951813,-0.18790262937545776,-0.07399255037307739,-0.17351673543453217,-0.21783748269081116,-0.13670174777507782,0.38928481936454773,-0.17942695319652557,-0.06548820436000824,-0.3907376825809479,-0.10185815393924713,0.14949966967105865,-0.15493085980415344,-0.11650321632623672,0.19818612933158875},{0.09692229330539703,-0.10256753116846085,0.0686102882027626,-0.00023590140335727483,0.20556342601776123,-0.464316189289093,0.07237883657217026,0.30212730169296265,0.26344576478004456,-0.44178304076194763,-0.3521416485309601,-0.0604991689324379,-0.3679310381412506,-0.3202681541442871,0.398180216550827,0.019208615645766258},{-0.29066669940948486,-0.04443015158176422,-0.30492085218429565,-0.1921670287847519,0.26512423157691956,0.4020792841911316,-0.013022365048527718,-0.2226533740758896,0.17792323231697083,-0.15695685148239136,-0.1835518330335617,-0.14497844874858856,0.014151917770504951,0.1420315057039261,-0.15246300399303436,0.13646560907363892},{0.060962557792663574,-0.1924246996641159,-0.1165190115571022,-0.0015394369838759303,-0.16266290843486786,0.028413156047463417,0.15409418940544128,-0.0006560614565387368,-0.32282185554504395,0.030036499723792076,-0.5404341220855713,0.003037332557141781,0.1153537929058075,0.14226709306240082,0.0042127505876123905,0.3774569630622864},{-0.16917280852794647,-0.014349563978612423,-0.3824153542518616,-0.35818353295326233,-0.14113479852676392,0.09911128878593445,0.3115125000476837,-0.35016000270843506,-0.47806835174560547,0.14824029803276062,0.16141173243522644,-0.31998151540756226,0.128623366355896,0.10132347792387009,-0.06763951480388641,-0.34048888087272644},{0.13009724020957947,0.05093265324831009,-0.1642429679632187,-0.3636924624443054,0.15260568261146545,-0.01798960380256176,-0.41701024770736694,0.11323972791433334,0.26825472712516785,-0.22136758267879486,-0.15341144800186157,-0.08388599753379822,-0.19328166544437408,-0.384305477142334,-0.22011087834835052,0.09844665229320526},{-0.15093474090099335,-0.18214218318462372,-0.013895388692617416,0.2008429765701294,0.2527841627597809,0.18285003304481506,-0.17305831611156464,0.05402255803346634,-0.2172122448682785,0.34682708978652954,-0.11741359531879425,-0.31025782227516174,0.16258378326892853,-0.2013472318649292,0.1467646211385727,0.23519131541252136},{0.4988566040992737,0.06976156681776047,-0.04753924161195755,-0.58534175157547,0.38753876090049744,0.35084104537963867,0.1435469388961792,-0.13714994490146637,0.25099483132362366,0.05831989645957947,0.07507512718439102,0.03432748094201088,0.005387621931731701,0.45216140151023865,0.1599736511707306,0.3528873920440674},{0.29059451818466187,0.22727088630199432,0.18134690821170807,0.02365715801715851,-0.10556710511445999,0.2817690670490265,-0.23832757771015167,-0.2879110276699066,0.3559880554676056,-0.25891759991645813,-0.009470025077462196,-0.010238591581583023,0.15744121372699738,-0.311079740524292,0.19262045621871948,0.20142501592636108}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.09625092148780823,0.16224800050258636,-0.2603088617324829,0.12174204736948013,-0.21843108534812927,-0.24100784957408905,-0.17478635907173157,0.08317778259515762,0.22375157475471497,0.24852225184440613,-0.04935494437813759,0.22857676446437836,-0.16372966766357422,-0.09040731936693192,0.15316808223724365,0.2659958004951477,0.16771382093429565,-0.11268825083971024,-0.02389383316040039,-0.19636371731758118,-0.10027992725372314,-0.3448446989059448,0.0007865879451856017,0.20728683471679688,0.1782427579164505,0.13894182443618774,0.16255047917366028,-0.09269747138023376,-0.06483559310436249,-0.12083548307418823,-0.2836800515651703,0.2861665189266205},{-0.297992467880249,-0.036705128848552704,0.02673538587987423,0.2563352584838867,-0.38411736488342285,0.16909080743789673,-0.3154522180557251,-0.1421191394329071,-0.30090469121932983,-0.30711209774017334,-0.2249293327331543,0.10302994400262833,0.40796566009521484,-0.36306604743003845,0.20945779979228973,0.1494503617286682,-0.08317303657531738,0.21199822425842285,-0.143765389919281,-0.004226003773510456,0.02602148987352848,-0.020251784473657608,0.1243768259882927,-0.0996975526213646,0.2734428644180298,0.09632858633995056,-0.2510036528110504,-0.075876884162426,0.16556471586227417,-0.10580425709486008,-0.17115096747875214,0.10037404298782349},{-0.17002977430820465,-0.11609628051519394,-0.3373664319515228,-0.07252169400453568,-0.06613428890705109,-0.010184158571064472,-0.15046663582324982,0.3020067512989044,-0.08730104565620422,-0.2054513841867447,0.0008115230011753738,0.215904101729393,-0.16398681700229645,0.30880239605903625,0.2538072466850281,0.223411425948143,-0.1900491863489151,0.031705934554338455,-0.0886869952082634,-0.30659452080726624,-0.2895083427429199,-0.2442755103111267,0.3096897304058075,0.2889164090156555,0.2667568325996399,0.20751319825649261,-0.15807345509529114,0.09236835688352585,-0.20758762955665588,0.0717206820845604,-0.23803964257240295,0.17955927550792694},{-0.1396610140800476,0.3506469428539276,0.3471178412437439,-0.0314917229115963,0.10070942342281342,0.25107666850090027,0.4191342890262604,0.2009068727493286,0.24340248107910156,0.33580437302589417,-0.31328192353248596,-0.20786459743976593,-0.25479647517204285,-0.2586696743965149,-0.37702783942222595,0.27909019589424133,-0.02059476263821125,-0.4089049696922302,-0.30568164587020874,0.2926592528820038,-0.07695409655570984,0.20078985393047333,0.33235082030296326,0.14021551609039307,-0.19218477606773376,-0.07314277440309525,-0.3060251474380493,-0.09257128089666367,-0.3485592305660248,0.04288816079497337,-0.13021767139434814,-0.0523318275809288},{-0.2196951061487198,0.050968289375305176,-0.27335816621780396,-0.33013197779655457,0.32493120431900024,0.298613965511322,0.27740931510925293,-0.1448771059513092,-0.3658078908920288,-0.033241868019104004,0.02131180837750435,0.0714103952050209,0.20961250364780426,-0.03273813799023628,-0.17306925356388092,-0.1078912690281868,-0.15579256415367126,0.36260566115379333,-0.27967557311058044,0.045289527624845505,-0.07258792966604233,0.26109686493873596,-0.3013055920600891,0.09118754416704178,0.3233306109905243,0.132449671626091,0.3797701895236969,-0.26377156376838684,-0.06034833565354347,-0.21838903427124023,-0.0649075135588646,0.3722771108150482},{-0.09787410497665405,0.09340652078390121,-0.12216278165578842,0.26225441694259644,0.1429217904806137,-0.3709564805030823,0.07879931479692459,0.21668869256973267,0.2892727851867676,-0.14137442409992218,0.0215882807970047,0.3180919289588928,0.23451398313045502,-0.1372705101966858,0.02867022529244423,-0.29976120591163635,-0.17605647444725037,0.1869392693042755,0.24398067593574524,0.1250613033771515,0.15664392709732056,-0.17705602943897247,0.2325315773487091,-0.0338960736989975,-0.27538296580314636,-0.14921805262565613,-0.24291269481182098,-0.28448307514190674,0.0332019180059433,0.3276461958885193,-0.2052348554134369,0.2634839415550232},{-0.04899778962135315,-0.2993523180484772,-0.21457453072071075,0.2433193027973175,-0.06302584707736969,0.2171536386013031,0.06179402768611908,0.059204380959272385,-0.32280847430229187,0.1782451570034027,-0.015828050673007965,-0.06888674944639206,-0.17772679030895233,-0.20708154141902924,-0.11495733261108398,-0.18792109191417694,-0.04819825291633606,0.21809884905815125,0.17372563481330872,0.25705868005752563,-0.1304730921983719,-0.09895181655883789,0.1426386833190918,-0.25653618574142456,0.2807614505290985,0.3204759955406189,0.06856614351272583,-0.2023261934518814,0.012161636725068092,0.11466926336288452,0.0022067963145673275,-0.2746692895889282},{-0.29039090871810913,0.31109359860420227,0.3290266990661621,-0.22825273871421814,0.13527919352054596,0.05600771680474281,-0.18242113292217255,0.0863613411784172,-0.0945468619465828,0.1800103783607483,0.3149682879447937,0.09015578031539917,-0.23016318678855896,-0.23096440732479095,-0.1426825374364853,0.10035393387079239,0.26617977023124695,-0.25623783469200134,-0.09658149629831314,0.2854481041431427,0.0019701921846717596,-0.08236104995012283,-0.17512086033821106,-0.2923089265823364,-0.315324068069458,-0.3696663975715637,0.02682860754430294,-0.310308039188385,0.06832366436719894,-0.273903489112854,0.1779005378484726,-0.03922612965106964},{-0.16042880713939667,0.11956171691417694,0.05214351788163185,-0.19554828107357025,-0.23440231382846832,0.14927828311920166,0.36396586894989014,-0.12948726117610931,0.04558098316192627,-0.15824812650680542,0.27845948934555054,-0.16028104722499847,0.27910974621772766,0.09741555154323578,-0.23870888352394104,-0.21047724783420563,-0.291742742061615,-0.11671869456768036,0.21621187031269073,-0.265927255153656,0.2113613486289978,-0.08303284645080566,-0.11257883906364441,-0.25612959265708923,-0.21961350739002228,0.19692817330360413,0.22131532430648804,0.19119909405708313,0.2751827538013458,-0.25044113397598267,-0.25809571146965027,-0.06365271657705307},{0.08534905314445496,-0.12087637931108475,-0.30967459082603455,-0.23558561503887177,-0.19526682794094086,0.27013662457466125,0.07883091270923615,-0.15683743357658386,0.15021610260009766,-0.248207226395607,-0.1280340999364853,0.29398223757743835,0.27029916644096375,0.2689521610736847,-0.22686323523521423,0.29324856400489807,-0.12726621329784393,-0.01921224035322666,0.11706028133630753,0.03408043086528778,-0.1156846359372139,0.2339727282524109,0.17124474048614502,0.10201594233512878,-0.03915972635149956,-0.11836421489715576,0.27872028946876526,0.18378347158432007,-0.3044869005680084,0.37832537293434143,-0.029828932136297226,0.2672246992588043},{0.18481284379959106,0.2989271581172943,-0.26729583740234375,0.20147444307804108,-0.0741652324795723,-0.09220882505178452,0.22172920405864716,-0.17076057195663452,0.1505977213382721,0.15769311785697937,0.12000208348035812,0.18812143802642822,-0.05839599296450615,0.20062397420406342,0.09640177339315414,0.03524813801050186,0.22764232754707336,0.24159179627895355,-0.026861798018217087,0.05065169557929039,-0.04442991316318512,-0.2878183126449585,-0.2886827290058136,-0.1668052226305008,0.03773113712668419,-0.13468609750270844,-0.09247543662786484,-0.20619851350784302,-0.13026021420955658,-0.05909499526023865,-0.1605110913515091,0.26825276017189026},{-0.05705814063549042,0.3218977153301239,-0.13534148037433624,-0.3892569839954376,0.2507641911506653,-0.23825699090957642,-0.22207659482955933,0.14117573201656342,-0.1409895122051239,-0.08099135011434555,0.26716727018356323,0.27460822463035583,-0.1970343291759491,-0.2733463943004608,0.05816372483968735,-0.21271604299545288,0.11433219164609909,0.27506881952285767,-0.18426711857318878,0.07662218809127808,-0.25536784529685974,0.01800909824669361,0.16486971080303192,0.23678594827651978,0.05858646333217621,-0.08867340534925461,0.0021288073621690273,-0.021237092092633247,-0.17965517938137054,-0.2758176624774933,-0.31336307525634766,-0.31211283802986145},{0.23146240413188934,0.05883462354540825,0.0471467599272728,0.28851673007011414,0.08443744480609894,0.06379962712526321,-0.013556969352066517,-0.08771821856498718,0.16016672551631927,0.2136078178882599,0.08622150868177414,0.0860091894865036,-0.07412659376859665,0.33039548993110657,0.03698904439806938,0.09862540662288666,-0.2501356899738312,-0.24755489826202393,0.2868519425392151,-0.18587186932563782,-0.11707399040460587,-0.09587124735116959,0.004148067440837622,0.12611597776412964,-0.007822921499609947,0.06205461174249649,-0.2248951494693756,-0.2572863698005676,0.09270203858613968,0.31480318307876587,0.23377084732055664,-0.2845377027988434},{-0.027708930894732475,0.1948467493057251,-0.4804551899433136,0.1884511262178421,-0.1422932744026184,-0.27769705653190613,0.23253214359283447,0.09538489580154419,0.22857387363910675,-0.09309326857328415,0.11796748638153076,0.21353591978549957,-0.16084620356559753,0.15205912292003632,0.2222987413406372,-0.15808163583278656,-0.06455554068088531,-0.20257216691970825,-0.13296662271022797,0.03710796684026718,0.018513772636651993,0.1670338362455368,0.10196352005004883,0.2852463126182556,-0.17586669325828552,-0.03663305193185806,0.056356217712163925,-0.11882203072309494,0.3338185250759125,0.09697901457548141,0.23465880751609802,-0.049844373017549515},{0.019330982118844986,-0.3036668598651886,-0.0789981409907341,0.12151467055082321,0.26766419410705566,0.07658671587705612,0.13632351160049438,-0.30471521615982056,-0.24053439497947693,0.36796310544013977,-0.30134132504463196,0.1741979867219925,-0.25039684772491455,0.2034260332584381,0.16122056543827057,-0.028431765735149384,-0.15105563402175903,0.17767928540706635,0.2838281989097595,-0.19844728708267212,0.0926620215177536,-0.11112368106842041,-0.2518429756164551,-0.0464475154876709,-0.062135614454746246,0.008627639152109623,0.1726016104221344,0.2063767910003662,0.1571241170167923,-0.28011637926101685,-0.27292749285697937,0.2789081335067749},{-0.20815715193748474,-0.25053417682647705,-0.22992132604122162,0.11459390819072723,-0.2397749423980713,0.15356974303722382,-0.14097702503204346,-0.17779798805713654,0.09341490268707275,-0.057238027453422546,0.32875528931617737,0.15635359287261963,0.028698347508907318,0.24173720180988312,0.32900649309158325,0.01627504825592041,-0.016461020335555077,0.1982838660478592,0.14182469248771667,0.12611718475818634,0.03716422989964485,-0.2657105624675751,0.10852386802434921,0.034403782337903976,0.10673844069242477,-0.00018198846373707056,-0.31388622522354126,-0.019044890999794006,-0.1254519820213318,0.15086059272289276,0.22143416106700897,-0.15001678466796875},{-0.027988575398921967,0.18201155960559845,-0.092595674097538,0.3649440407752991,0.1841687113046646,-0.04611099883913994,-0.20341289043426514,0.019885562360286713,0.040728192776441574,0.21047519147396088,-0.33565500378608704,0.09422656893730164,0.2079116851091385,-0.08392684161663055,0.31211233139038086,-0.21482276916503906,0.3476465046405792,0.057528525590896606,0.38798749446868896,0.2693181037902832,-0.46696561574935913,-0.023400871083140373,-0.08153372257947922,0.041845716536045074,-0.07068216800689697,-0.22148999571800232,0.07119692862033844,0.08320783078670502,0.0776686742901802,-0.18064376711845398,-0.21400578320026398,-0.2653121054172516},{0.320910781621933,-0.1769239902496338,-0.07168441265821457,-0.245644673705101,0.20881320536136627,-0.05532277375459671,0.12037916481494904,0.28645673394203186,0.23100963234901428,-0.22639715671539307,-0.24137240648269653,-0.2168963998556137,0.26940983533859253,-0.11012159287929535,-0.24451792240142822,-0.3763517141342163,0.013716913759708405,0.23890885710716248,0.1257713884115219,0.290876179933548,-0.15028449892997742,-0.19828811287879944,0.1386023610830307,-0.26603588461875916,-0.14138534665107727,-0.17909744381904602,0.2489176094532013,0.28414538502693176,0.0002897009253501892,-0.25979313254356384,-0.3067658543586731,0.10409665107727051},{0.09813021868467331,-0.20654882490634918,0.13483303785324097,-0.14519213140010834,0.1559595912694931,-0.1762663573026657,0.038133636116981506,0.05696851760149002,0.03943837061524391,0.26771223545074463,-0.3897494077682495,-0.2554805874824524,0.30893924832344055,-0.09888602793216705,-0.15026846528053284,-0.3586784899234772,0.031704485416412354,0.01186404563486576,-0.252310574054718,-0.18134863674640656,-0.04452162981033325,-0.2546824812889099,-0.18768784403800964,-0.09608399122953415,0.11003672331571579,-0.17796173691749573,-0.36621469259262085,0.1313294619321823,0.3125401735305786,-0.2715260982513428,0.1768309623003006,0.2228989452123642},{0.294168621301651,-0.020595073699951172,-0.250620037317276,-0.11325838416814804,0.031293127685785294,0.10517806559801102,0.0426793172955513,0.022262949496507645,0.15030992031097412,0.08201785385608673,0.219420924782753,0.12906329333782196,0.08178143948316574,-0.28649258613586426,-0.0784352645277977,-0.2543943524360657,-0.20063835382461548,0.1187908872961998,-0.2368071973323822,0.2675018608570099,0.19894006848335266,0.01948685571551323,0.046428781002759933,-0.13721583783626556,0.23351632058620453,0.034101586788892746,-0.005192550830543041,0.058316007256507874,-0.10144692659378052,0.18812227249145508,-0.047007448971271515,0.11863519251346588}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.019420528784394264,-0.17855413258075714,-0.01892363280057907,-0.0757526233792305},{0.12585705518722534,-0.037866391241550446,-0.06554897129535675,-0.23959915339946747},{-0.12938305735588074,-0.15261688828468323,-0.13976018130779266,-0.12125784903764725},{0.1824164241552353,-0.3434719145298004,0.09793251007795334,-0.1123223826289177},{0.22569039463996887,0.0161688681691885,0.025316940620541573,-0.3676229417324066},{0.31991949677467346,-0.2723895013332367,-0.28897252678871155,0.25002267956733704},{0.2324707806110382,-0.020626991987228394,0.24471569061279297,-0.39623960852622986},{0.2679901719093323,0.11268862336874008,-0.0924178957939148,-0.0911264643073082},{-0.3078809082508087,-0.01514439471065998,-0.07416228204965591,-0.021916424855589867},{0.11522163450717926,-0.2739328444004059,-0.22612887620925903,-0.0434778593480587},{-0.014683680608868599,0.16943635046482086,-0.09483889490365982,-0.011094700545072556},{0.018974971026182175,0.43453553318977356,0.3215142488479614,0.05940364673733711},{-0.27278122305870056,-0.18465444445610046,0.284960001707077,0.06174326688051224},{0.38875529170036316,0.3885839283466339,-0.240483358502388,-0.3187396228313446},{0.330091655254364,0.20209014415740967,-0.22021935880184174,0.23859935998916626},{-0.112550288438797,0.024976244196295738,0.23828798532485962,-0.44312581419944763},{0.15907928347587585,-0.067621149122715,-0.3407950699329376,-0.08904828131198883},{0.2536844313144684,-0.09027089923620224,0.014425153844058514,0.192962646484375},{0.1604110300540924,-0.28481537103652954,0.3265027105808258,-0.027568411082029343},{0.031375184655189514,-0.030999749898910522,0.09068319201469421,-0.14524699747562408},{-0.26342520117759705,-0.17110924422740936,-0.28159937262535095,0.2943565249443054},{-0.15143230557441711,-0.2640242874622345,0.18713007867336273,-0.23969852924346924},{0.10506129264831543,-0.21103975176811218,-0.17821750044822693,0.08922678232192993},{-0.005482543259859085,0.08443813025951385,0.32238301634788513,0.35363829135894775},{0.15527930855751038,-0.24096404016017914,0.24707186222076416,0.24677222967147827},{0.04558362811803818,0.10409574210643768,0.164781391620636,0.06300508975982666},{0.43755877017974854,-0.08968110382556915,0.34985649585723877,0.08990462124347687},{0.1446605920791626,-0.05477249249815941,-0.23248176276683807,0.12205081433057785},{-0.037434421479701996,0.14877450466156006,-0.059311654418706894,0.33100441098213196},{-0.10675527155399323,0.04665445536375046,0.20102594792842865,0.20941922068595886},{0.14382591843605042,0.05827956274151802,0.22682294249534607,-0.07391808927059174},{0.33730584383010864,0.20564094185829163,0.04670553281903267,0.23548078536987305}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.09724346548318863,0.024822404608130455,-0.011192329227924347,0.04827658087015152,-0.0704866424202919,0.028941651806235313,0.010982013307511806,0.09549640864133835,0.013720262795686722,-0.0865931436419487,-0.002972489921376109,0.017646659165620804,0.0052698212675750256,0.05629213899374008,-0.0005148234195075929,-0.03689034283161163};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.01904304139316082,0.016087966039776802,0.07777544856071472,-0.0387505441904068,-0.0176276545971632,-0.10010606795549393,-0.014222019352018833,-0.008155684918165207,-0.12652119994163513,0.06799773126840591,0.009225567802786827,-0.022007839754223824,0.03159486874938011,-0.10030445456504822,0.06858053058385849,0.027290048077702522};
static const float actor_encoder_feed_forward_0_bias[32] = {0.007657590322196484,-0.02041320875287056,-0.021626124158501625,-0.010695829056203365,0.01577407494187355,0.01709064468741417,0.0037600535433739424,0.026080403476953506,-0.08087874203920364,0.0028404882177710533,-0.009942376054823399,0.013354293070733547,0.0012391554191708565,-0.0039293197914958,0.058284249156713486,0.04449395462870598,0.010744319297373295,0.023733658716082573,0.025521287694573402,0.03798719495534897,-0.048016976565122604,-0.02981092967092991,-0.012686686590313911,0.05529008060693741,0.029441775754094124,0.05203022435307503,0.04888109862804413,0.004240305628627539,0.009960975497961044,0.10218057036399841,0.05606023222208023,0.03681272640824318};
static const float action_parameterization_distribution_linear_bias[4] = {0.043607279658317566,0.02305733971297741,0.04022207856178284,0.011005899868905544};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.3384961187839508,-0.3704538643360138,-0.07507386803627014,-0.21302230656147003},{0.5110483765602112,0.05945213884115219,-0.22162657976150513,-0.15633882582187653},{-0.0035883442033082247,0.04120180010795593,0.31449636816978455,0.35482847690582275},{0.2162444144487381,-0.2862958610057831,0.15647637844085693,0.5109639167785645},{0.4915712773799896,0.5907222032546997,0.19420702755451202,0.5409405827522278},{0.4314712882041931,0.1532454639673233,-0.05178835242986679,-0.3683624863624573},{0.289035826921463,-0.3748037815093994,-0.1094433069229126,0.14884379506111145},{-0.347758024930954,0.006936588324606419,0.33379989862442017,0.05388738214969635},{0.12523110210895538,0.09407395124435425,0.23874768614768982,0.1497008502483368},{0.12389868497848511,0.30219995975494385,-0.1313980221748352,-0.2515845000743866},{0.40675729513168335,-0.2022959440946579,0.02320234104990959,-0.3444911241531372},{-0.07459831237792969,0.32677069306373596,0.40920591354370117,0.24173486232757568},{0.01162534300237894,0.4496138095855713,0.13401299715042114,0.0709327682852745},{-0.37008070945739746,0.286836713552475,0.41530030965805054,0.18424537777900696},{-0.3921445906162262,-0.27236056327819824,0.21225759387016296,-0.0015985079808160663},{-0.3701310455799103,-0.41586849093437195,-0.3338741660118103,-0.022684255614876747}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.5657892227172852,-0.40365293622016907,-0.6621022820472717,-0.7083653211593628},{0.46086394786834717,0.6158900856971741,-0.14148131012916565,-0.0003796920063905418},{0.6618274450302124,-0.6597229242324829,0.3620404601097107,0.6279807686805725},{-0.5740728974342346,-0.593120813369751,0.2517454922199249,-0.29313918948173523}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.06870779395103455,0.017541222274303436,0.058865465223789215,0.07991229742765427};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.025141863152384758,-0.044457387179136276,0.010645941831171513,-0.01065121591091156};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }



int main(const float *self_indatav, float *obst_indatav, float *obst_outdata, float *outdatav)
{
    size_t i;
    control_t_n motorThrusts;

    obstacleEmbedder(obst_indatav);

    for (int i = 0; i < D_MODEL; i++) {
        obst_outdata[i] = obstacle_embeds[i];
    }

    networkEvaluate(&motorThrusts, self_indatav);

    outdatav[0] = motorThrusts.thrust_0;
    outdatav[1] = motorThrusts.thrust_1;
    outdatav[2] = motorThrusts.thrust_2;
    outdatav[3] = motorThrusts.thrust_3;

    return EXIT_SUCCESS; 
}

