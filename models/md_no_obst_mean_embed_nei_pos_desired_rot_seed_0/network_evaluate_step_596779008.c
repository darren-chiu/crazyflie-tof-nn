#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.156326025724411,0.23298829793930054,0.14675450325012207,-0.14348478615283966,0.07340741157531738,-0.2935616970062256,-0.00858128909021616,-0.5488681793212891,-0.018571386113762856,-0.2444525957107544,-0.13336420059204102,0.13084723055362701,-0.26464951038360596,0.10152199864387512,0.2674524188041687,-0.16666671633720398},{-0.025904418900609016,-0.027501016855239868,-0.029707182198762894,-0.18073159456253052,0.3410662114620209,0.11622332036495209,0.08208397775888443,0.012124566361308098,-0.16491328179836273,0.024022936820983887,-0.18224559724330902,0.08418475836515427,0.2510720193386078,-0.010145468637347221,0.08179839700460434,-0.09944062680006027},{-0.2549278438091278,-0.33328133821487427,0.29939568042755127,-0.091311976313591,-0.13467280566692352,0.3682998716831207,-0.462367981672287,0.3829195201396942,-0.40567031502723694,-0.4602239429950714,-0.29904448986053467,-0.3289256691932678,-0.2940070629119873,0.07033632695674896,-0.41915565729141235,-0.4559153914451599},{-0.3280359208583832,-0.07871046662330627,-0.004592247772961855,0.16047240793704987,0.1360430270433426,-0.0012180409394204617,0.27053302526474,-0.17362913489341736,-0.15664970874786377,0.040475033223629,-0.32204148173332214,-0.052014634013175964,-0.14927485585212708,0.4011615812778473,-0.23459786176681519,0.0379539392888546},{0.0904369205236435,-0.051626574248075485,0.12048890441656113,-0.3211349844932556,0.38062646985054016,0.44560885429382324,-0.07330674678087234,-0.11282969266176224,-0.005744976457208395,0.31070801615715027,0.058363430202007294,-0.004793043714016676,0.22722484171390533,0.009382916614413261,-0.21277989447116852,-0.25908610224723816},{0.10297112911939621,0.13520507514476776,0.16154462099075317,-0.10900363326072693,-0.16571849584579468,-0.05691682547330856,-0.16140352189540863,0.11633723229169846,-0.170013427734375,0.20634669065475464,-0.21061618626117706,-0.3026913106441498,-0.10311754047870636,0.03526940196752548,-0.2404738813638687,0.014553483575582504},{-0.3488602638244629,-0.5063932538032532,0.05490738898515701,-0.27124908566474915,-0.3227286636829376,-0.0653214305639267,0.2946721911430359,0.3160867989063263,-0.6134299635887146,-0.07465117424726486,-0.10673793405294418,0.08823582530021667,-0.4116050601005554,-0.060520097613334656,0.3054690659046173,0.08525530993938446},{-0.07307519763708115,0.5389927625656128,0.37316039204597473,0.27179914712905884,-0.24424409866333008,0.24411797523498535,0.5042442083358765,0.6430601477622986,0.0881674662232399,0.06222839653491974,0.09283385425806046,0.16732536256313324,-0.13622890412807465,-0.5087279677391052,0.22527340054512024,0.45620304346084595},{-0.4396655559539795,-0.027316153049468994,0.17652593553066254,-0.13195745646953583,0.07532255351543427,0.17133162915706635,0.13956116139888763,-0.23088788986206055,-0.23377273976802826,-0.39049503207206726,0.0038351037073880434,0.2578108608722687,0.04239678010344505,0.27577438950538635,0.24196641147136688,-0.18292097747325897},{0.6837104558944702,-0.09628566354513168,-0.6417363882064819,-0.18031716346740723,0.188348650932312,0.04681054502725601,-0.6235294342041016,-0.7632769346237183,-0.5380672216415405,0.39012089371681213,0.08466456085443497,0.45063701272010803,-0.5538593530654907,0.5526837706565857,-0.6515374779701233,-0.10341791063547134},{0.4138966500759125,-0.2701932489871979,0.018351111561059952,0.3888280987739563,-0.3141304850578308,0.28143614530563354,0.37968558073043823,0.3429386019706726,-0.3626493215560913,-0.3079201877117157,-0.39375537633895874,0.30133840441703796,-0.2656794488430023,-0.2945541739463806,-0.18813882768154144,0.21355371177196503},{0.18764205276966095,-0.22355318069458008,-0.17886146903038025,-0.5905135273933411,0.33901160955429077,0.04424789547920227,-0.17552600800991058,-0.3839716911315918,-0.34346476197242737,-0.5136584639549255,-0.523493766784668,-0.29452529549598694,0.1266602873802185,-0.32715001702308655,0.45554038882255554,0.3723793625831604},{0.06432490795850754,-0.5860636830329895,-0.3530527949333191,0.051636889576911926,0.2017344832420349,0.1399674117565155,0.24703924357891083,-0.342573344707489,0.11022192984819412,-0.47453299164772034,0.07120201736688614,-0.32996881008148193,0.4477934241294861,-0.798371434211731,-0.21986044943332672,-0.09684757143259048},{0.05987328290939331,-0.30721232295036316,-0.5357909202575684,0.5961881279945374,-0.17090295255184174,0.011034181341528893,-0.03900303691625595,-0.04217258095741272,-0.10291024297475815,-0.26304712891578674,0.20462846755981445,-0.0767495334148407,-0.4799425005912781,0.008725181221961975,0.3326024115085602,-0.546960711479187},{-0.14040297269821167,-0.02909514121711254,-0.28260916471481323,0.24327874183654785,0.38160398602485657,-0.2529360353946686,0.30874374508857727,0.22092266380786896,-0.25499144196510315,0.06690648943185806,0.2354837954044342,0.11634131520986557,-0.186471626162529,-0.43740808963775635,0.10549988597631454,0.17624478042125702},{-0.2635573744773865,0.13124048709869385,-0.15675319731235504,0.2760363221168518,-0.030107857659459114,-0.2806999385356903,0.2262464165687561,0.12878753244876862,-0.0021021172869950533,-0.12484895437955856,0.006780647672712803,-0.043818458914756775,-0.23159369826316833,-0.14450067281723022,-0.27080202102661133,-0.211505725979805},{-0.2607460618019104,0.1571905016899109,0.054157812148332596,0.006927950773388147,-0.3134605586528778,0.10245874524116516,-0.21737100183963776,0.08999961614608765,-0.23665447533130646,0.10716177523136139,-0.014760485850274563,0.2949543297290802,0.20225733518600464,0.27607324719429016,0.36860889196395874,-0.24703921377658844},{0.2189772129058838,-0.2974886894226074,-0.18946096301078796,-0.040039390325546265,-0.3416368365287781,-0.29391658306121826,-0.3129372298717499,-0.21706409752368927,-0.18355108797550201,-0.007469212636351585,-0.303894966840744,0.06191082298755646,-0.0038165294099599123,0.180260568857193,-0.11514341086149216,-0.3322901129722595}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.16025526821613312,0.24252364039421082,0.0368306003510952,0.46017986536026,0.1411827802658081,-0.09522300958633423,-0.19820329546928406,-0.3418646454811096,-0.058724209666252136,-0.09968166798353195,0.224131241440773,0.03335145115852356,0.3524048328399658,0.0818919762969017,-0.43331900238990784,-0.3736265301704407},{-0.25436094403266907,0.2443588823080063,-0.23571570217609406,-0.05066452547907829,0.14442698657512665,-0.007543467916548252,-0.46381884813308716,0.11767171323299408,0.30357059836387634,0.115139439702034,-0.0074866521172225475,-0.006626025307923555,-0.2045191377401352,-0.09034160524606705,-0.3146763741970062,-0.06575417518615723},{0.5183586478233337,0.37877368927001953,-0.38751399517059326,-0.5830259323120117,0.2906859517097473,-0.29312652349472046,-0.5405344367027283,0.2407206892967224,0.3261242210865021,-0.2783729135990143,0.20352725684642792,-0.3284743130207062,-0.12469091266393661,-0.15939059853553772,0.4617066979408264,0.40318596363067627},{0.2937987148761749,-0.12671397626399994,-0.2927030622959137,0.3202025890350342,-0.2492062896490097,0.2396361082792282,0.08317838609218597,-0.08462276309728622,-0.08629172295331955,0.2923867404460907,0.3423665165901184,-0.4551333785057068,0.1230989620089531,-0.27548670768737793,-0.3755568265914917,0.025962283834815025},{0.0977630540728569,0.23755110800266266,0.003255960764363408,-0.05933913588523865,0.036819636821746826,0.025606712326407433,-0.17003951966762543,0.21889716386795044,-0.1820218563079834,-0.3447270095348358,-0.32391032576560974,0.23508155345916748,0.23458021879196167,-0.11851765960454941,0.2508835792541504,0.0923178642988205},{0.38500750064849854,0.0976458191871643,-0.229251891374588,-0.11082302778959274,0.18729852139949799,0.23382523655891418,-0.16254271566867828,-0.3595740795135498,-0.11953487992286682,0.16622500121593475,-0.08763972669839859,-0.03284963220357895,-0.28791990876197815,0.3657809793949127,0.13954506814479828,-0.13166211545467377},{0.24679416418075562,-0.36016660928726196,-0.386070191860199,-0.26765650510787964,-0.019796665757894516,0.28257837891578674,-0.3527262806892395,0.02242015115916729,0.15824110805988312,0.13443131744861603,-0.029802994802594185,0.3482434153556824,0.29324570298194885,-0.14297333359718323,0.22957202792167664,0.30941641330718994},{-0.31990233063697815,0.3352152705192566,-0.12696991860866547,0.4279211759567261,-0.0074787200428545475,0.08413632959127426,0.41355159878730774,0.4051975905895233,-0.10666132718324661,-0.23929862678050995,0.31649377942085266,-0.38077160716056824,-0.0723286047577858,-0.20599640905857086,-0.24305623769760132,-0.09063499420881271},{0.010912470519542694,-0.3001578748226166,-0.01523333415389061,0.15110933780670166,0.12697482109069824,0.1957056224346161,-0.00044292479287832975,0.47007983922958374,0.07136304676532745,0.19189655780792236,-0.27002769708633423,-0.1668027639389038,0.2301722764968872,-0.4228532016277313,0.28694358468055725,0.05223751813173294},{-0.08870905637741089,-0.07227620482444763,-0.1665399670600891,0.25357529520988464,-0.34598425030708313,-0.003619325812906027,0.32374289631843567,0.2338743805885315,0.190410315990448,-0.20661619305610657,-0.17533954977989197,0.019787965342402458,-0.20664943754673004,0.05626564845442772,-0.4110858142375946,-0.04244918376207352},{-0.1195083037018776,-0.15296432375907898,0.14635057747364044,0.28255602717399597,-0.16390074789524078,-0.2268308699131012,0.32406991720199585,-0.1093045100569725,-0.17083361744880676,0.015045799314975739,-0.04877155274152756,-0.3232905864715576,-0.35775673389434814,-0.52276611328125,-0.3260163962841034,-0.03044530190527439},{-0.022748546674847603,-0.5331105589866638,0.29507267475128174,-0.13168050348758698,0.10248909890651703,0.10191910713911057,-0.3349812924861908,-0.28339144587516785,0.20445959270000458,0.16271552443504333,-0.5045839548110962,0.38186120986938477,-0.19951148331165314,-0.1093335822224617,0.2004246860742569,0.09295151382684708},{-0.14646336436271667,0.07918243110179901,-0.3390597999095917,0.14252020418643951,0.166378915309906,0.06268473714590073,0.3318464756011963,-0.2592547833919525,-0.12861432135105133,-0.09358794242143631,-0.3708948791027069,0.40575674176216125,0.4013817012310028,0.19119936227798462,0.043437447398900986,0.3084273338317871},{-0.3501138687133789,-0.03176547586917877,0.29193705320358276,-0.35822075605392456,0.406253844499588,-0.5252645611763,-0.11003021150827408,-0.16467660665512085,0.27163437008857727,0.21307118237018585,0.2986135184764862,0.3559243083000183,-0.20725077390670776,-0.22190335392951965,-0.2707673907279968,0.2569715678691864},{-0.10690980404615402,-0.18049275875091553,-0.3141907751560211,0.2039128690958023,-0.059102751314640045,0.4547956883907318,0.25181102752685547,0.30390095710754395,0.19571496546268463,0.015946894884109497,-0.18566836416721344,-0.2004394233226776,0.25272274017333984,0.14196152985095978,-0.005514311604201794,0.16144676506519318},{-0.1621665358543396,0.2662242352962494,-0.08493191003799438,-0.22153161466121674,0.057390760630369186,0.013544132933020592,0.1521759182214737,0.2385047972202301,-0.15868327021598816,-0.13104476034641266,-0.1857443004846573,0.26565784215927124,0.10920526087284088,-0.22279928624629974,-0.3562242090702057,0.08712029457092285}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.057366374880075455,0.017240693792700768,0.04181551933288574,0.20409487187862396,0.37798798084259033,-0.09102435410022736,-0.13749238848686218,0.043892692774534225,-0.2178240567445755,-0.06416735053062439,0.006324283313006163,0.1918441504240036,0.25511789321899414,-0.08193996548652649,0.22653250396251678,0.08614780753850937,0.20756736397743225,0.06092613935470581,0.024144785478711128,0.009855592623353004,0.2672799527645111,-0.21089890599250793,-0.27705222368240356,-0.2737206220626831,-0.13467761874198914,0.11788421124219894,-0.27923861145973206,-0.22033749520778656,0.21819451451301575,-0.13057175278663635,-0.2773800492286682,-0.17271094024181366},{0.23801125586032867,0.08822762966156006,0.280441015958786,0.33047881722450256,0.41810664534568787,-0.02373020350933075,0.15940527617931366,-0.374034583568573,0.18240921199321747,0.12344756722450256,-0.08789984881877899,-0.2710862457752228,-0.19537153840065002,-0.13553254306316376,-0.3054251968860626,0.3513985276222229,0.18644532561302185,-0.2771616578102112,0.14503951370716095,0.14482779800891876,-0.011618226766586304,0.2541685700416565,-0.24004969000816345,0.13837668299674988,0.05954868718981743,-0.37776899337768555,-0.1898474395275116,0.37731844186782837,-0.22251774370670319,0.03616528958082199,0.2678363025188446,-0.1206192672252655},{0.2105051428079605,-0.02114933915436268,-0.1693526953458786,-0.2866326868534088,-0.31646695733070374,-0.15396277606487274,-0.33395037055015564,0.08913164585828781,-0.412384957075119,-0.15730994939804077,0.08904291689395905,0.3478146195411682,0.11261971294879913,-0.07234736531972885,-0.20731115341186523,0.08035735785961151,0.2918281853199005,-0.20610859990119934,-0.18096387386322021,0.2864125370979309,-0.25509488582611084,-0.06080973520874977,0.004789205268025398,-0.08850754052400589,-0.041803836822509766,0.41436463594436646,-0.3294573426246643,0.2551211714744568,-0.4920341670513153,-0.1086200550198555,0.058234088122844696,0.04886971041560173},{0.2217845469713211,-0.333356112241745,-0.09512487798929214,0.1847745180130005,0.1299496591091156,-0.1820552796125412,0.289066344499588,0.08097971975803375,0.12316801398992538,-0.051370035856962204,0.04446820914745331,-0.06650031358003616,0.3214088976383209,0.19285540282726288,-0.1734098196029663,-0.17673160135746002,-0.15660405158996582,0.15882347524166107,0.18798667192459106,-0.01786695420742035,0.023318707942962646,0.35735243558883667,-0.06742063164710999,-0.19831296801567078,0.0746760442852974,0.13009361922740936,0.12981556355953217,0.06048671901226044,-0.368510901927948,-0.33972087502479553,0.1056135892868042,0.19274668395519257},{-0.058611441403627396,0.1781337708234787,0.023113813251256943,0.06150798127055168,0.08677223324775696,0.26468250155448914,0.20755259692668915,-0.16205784678459167,-0.04967515170574188,0.06977195292711258,-0.15072035789489746,0.06323252618312836,-0.25655120611190796,0.18087035417556763,0.017995251342654228,0.26173537969589233,0.06878568232059479,0.011583651416003704,0.050106294453144073,0.10177823901176453,0.1445063203573227,-0.08122219890356064,-0.2778420150279999,-0.24454495310783386,0.023620901629328728,0.1423245668411255,0.14602364599704742,0.02557040937244892,0.18956275284290314,-0.17093494534492493,-0.1925947666168213,0.26492035388946533},{-0.2732293903827667,0.2238236367702484,-0.01514288317412138,-0.03356015309691429,-0.31547999382019043,-0.2781601846218109,-0.12547066807746887,0.08733732253313065,0.24991898238658905,-0.16430610418319702,0.09904711693525314,-0.3728901147842407,-0.1080515906214714,0.04601708799600601,0.09222006797790527,-0.13905389606952667,-0.18728233873844147,0.05261890962719917,0.1267022341489792,-0.36343029141426086,0.2156931310892105,-0.042169030755758286,0.014281758107244968,-0.1403561681509018,0.1864486038684845,0.06696315109729767,0.008054946549236774,0.07568969577550888,0.10116052627563477,-0.05930729955434799,-0.3332265019416809,-0.22729235887527466},{0.036206867545843124,-0.06371143460273743,0.08056273311376572,-0.1897219717502594,-0.19078455865383148,0.11001341789960861,-0.27423182129859924,-0.09501326084136963,-0.11841186881065369,0.24495171010494232,-0.21014389395713806,0.03984786570072174,0.2671271562576294,0.056036677211523056,-0.2915426194667816,-0.16279900074005127,0.027018973603844643,0.14435873925685883,0.10058017820119858,0.24859216809272766,-0.24540568888187408,0.15195629000663757,-0.006110523361712694,0.08789631724357605,0.23592427372932434,-0.1406158208847046,-0.036564625799655914,0.30377569794654846,0.017346400767564774,-0.25019165873527527,-0.3055041432380676,0.24297603964805603},{0.07685606181621552,0.2220962643623352,0.11947906762361526,0.12504710257053375,-0.15442131459712982,-0.3400392234325409,0.17817668616771698,-0.2497408390045166,-0.07654325664043427,-0.20690390467643738,0.25976988673210144,-0.09475746005773544,-0.05800801143050194,-0.08819093555212021,0.2638610303401947,0.12687379121780396,0.08652932941913605,-0.03943563252687454,-0.32288989424705505,0.086009681224823,-0.29821962118148804,-0.05781976878643036,-0.2162838876247406,0.18605415523052216,0.0398092195391655,-0.03360985964536667,0.17440544068813324,0.013136884197592735,0.07743246853351593,-0.18631726503372192,-0.1787092089653015,0.2671999931335449},{0.19385844469070435,0.39774471521377563,-0.15348933637142181,0.25649014115333557,-0.001511982874944806,0.13531239330768585,0.47107651829719543,-0.30579426884651184,-0.07850201427936554,-0.09707082808017731,0.1951807737350464,-0.14012746512889862,-0.005794114898890257,0.2872197926044464,-0.07940852642059326,0.25418588519096375,0.23061411082744598,0.23890246450901031,0.18075795471668243,0.16219525039196014,-0.24773521721363068,-0.21839375793933868,0.10982103645801544,0.2093236893415451,0.12248396128416061,0.29301902651786804,-0.3553414046764374,-0.3493116796016693,-0.07220324873924255,0.25077012181282043,0.02126937173306942,0.2053406983613968},{0.09372441470623016,0.025270387530326843,0.02619394101202488,-0.2906058728694916,-0.1081351786851883,-0.2612292766571045,0.14220771193504333,0.321856290102005,-0.24958452582359314,-0.30204784870147705,0.10664528608322144,-0.11150050908327103,0.023188931867480278,0.14222215116024017,-0.1827087104320526,0.27970340847969055,0.028107646852731705,-0.2964118421077728,0.18070925772190094,0.02879473753273487,0.18590547144412994,-0.32856690883636475,0.30106234550476074,-0.06480266153812408,0.14990966022014618,0.2762303650379181,0.2571791708469391,0.24019092321395874,-0.12047160416841507,0.26376187801361084,0.0021580704487860203,0.0025152808520942926},{0.19791150093078613,0.03923255205154419,0.3498128056526184,-0.32732176780700684,0.17586329579353333,-0.17188440263271332,-0.15337280929088593,-0.2662229537963867,0.03924545273184776,0.3838421106338501,0.16929642856121063,-0.03294266760349274,0.11528262495994568,0.1501578539609909,0.00792474765330553,0.30310991406440735,-0.06165774539113045,-0.28693774342536926,-0.08970218896865845,-0.006909341551363468,-0.1769854724407196,0.148482546210289,0.019238315522670746,-0.21794475615024567,-0.1094197928905487,-0.19807201623916626,-0.15317252278327942,0.03864848241209984,-0.20185166597366333,-0.001640861271880567,0.3329152464866638,0.3643280863761902},{0.23782120645046234,0.057332899421453476,-0.18823355436325073,-0.3603615164756775,-0.21937227249145508,-0.27823173999786377,0.21346475183963776,0.08694835007190704,-0.16738003492355347,0.22328774631023407,-0.3485472500324249,-0.06759648025035858,-0.12158281356096268,-0.1386580467224121,-0.11448477953672409,-0.22034253180027008,-0.3868679106235504,-0.30539369583129883,0.11452264338731766,0.18419033288955688,-0.06076619774103165,0.34696337580680847,-0.17743618786334991,-0.11406611651182175,0.18060150742530823,0.3226223289966583,0.2031911313533783,-0.16872745752334595,-0.1672932654619217,-0.29095110297203064,-0.2813294231891632,0.1261916160583496},{-0.06816411763429642,-0.07607491314411163,-0.19692958891391754,0.031045209616422653,0.21860961616039276,-0.1185699999332428,0.19910044968128204,0.3522767126560211,0.1468861699104309,0.25158581137657166,-0.12110380828380585,-0.29750293493270874,0.08371952921152115,0.11783001571893692,0.19369661808013916,0.19468922913074493,-0.38303712010383606,-0.2018449455499649,-0.1552538424730301,0.2145886868238449,-0.0716736689209938,-0.3214232623577118,-0.2615451514720917,-0.10698702186346054,0.1771625429391861,0.28928637504577637,0.2512037456035614,0.08922375738620758,-0.15833427011966705,-0.14755958318710327,0.10411623865365982,-0.19283023476600647},{0.27909624576568604,-0.051453087478876114,-0.28990909457206726,-0.07910577207803726,0.02172676846385002,0.06169067323207855,-0.04246954992413521,-0.06600864231586456,0.15466170012950897,0.341220885515213,-0.3644558787345886,0.2673541009426117,0.17142464220523834,-0.25700584053993225,0.05101288482546806,-0.2619912326335907,-0.10629289597272873,0.18632738292217255,-0.1461694836616516,0.36296865344047546,0.12552614510059357,-0.14551785588264465,-0.22045359015464783,-0.13957487046718597,-0.34349265694618225,0.09872017055749893,0.0009010603534989059,0.21224139630794525,-0.02941362001001835,0.13346095383167267,0.3385891616344452,-0.20762361586093903},{0.18807817995548248,-0.1827343851327896,0.14431032538414001,-0.0758441910147667,-0.2364841103553772,-0.2432687133550644,0.18203559517860413,-0.2552326023578644,0.19834142923355103,0.17371149361133575,-0.16733363270759583,0.1359310746192932,-0.045734405517578125,0.05960633233189583,-0.13025756180286407,-0.05606115236878395,0.09440301358699799,-0.09270758926868439,-0.028717244043946266,-0.1722559630870819,0.023798350244760513,-0.23837792873382568,-0.17680346965789795,-0.3784791827201843,0.010873288847506046,-0.20210577547550201,0.08864407241344452,0.12691056728363037,0.20311880111694336,0.08424138277769089,0.05871612951159477,0.007750428281724453},{0.20289939641952515,-0.13472160696983337,-0.2695658802986145,0.2825874090194702,-0.1583436131477356,0.09163926541805267,0.34216418862342834,-0.29601234197616577,-0.04449467360973358,-0.32930701971054077,-0.21501345932483673,-0.33987221121788025,-0.2504405975341797,-0.2620757222175598,0.05987599119544029,0.3709092140197754,0.2967081069946289,-0.20416206121444702,0.06561526656150818,-0.0977395623922348,-0.12966150045394897,-0.15873108804225922,-0.23868466913700104,0.2198464423418045,-0.140579491853714,-0.08228793740272522,-0.14260530471801758,-0.11719874292612076,-0.1556011289358139,-0.11485104262828827,-0.19080957770347595,-0.20948264002799988},{0.2627280056476593,0.43918147683143616,-0.2272317111492157,-0.14679469168186188,-0.07116732746362686,0.3972782790660858,0.32082971930503845,0.11553994566202164,-0.049422696232795715,-0.28747496008872986,0.023010414093732834,0.21376684308052063,-0.05751451477408409,0.02879648096859455,0.1323084831237793,0.11412567645311356,-0.18053297698497772,-0.031183451414108276,-0.22995074093341827,-0.17230817675590515,-0.051698021590709686,0.04448333755135536,-0.06666641682386398,-0.29055604338645935,-0.14397560060024261,0.12873530387878418,0.07581119984388351,-0.18548935651779175,0.0966789573431015,-0.18295590579509735,0.2910580635070801,-0.18293672800064087},{-0.34449484944343567,-0.11274243146181107,0.16187231242656708,0.0069795832969248295,0.23631155490875244,0.13653433322906494,0.16951657831668854,-0.26705530285835266,0.0027331418823450804,0.12541165947914124,0.20406688749790192,0.1737826019525528,-0.1860625445842743,-0.007288946770131588,-0.28314003348350525,-0.23494228720664978,0.24268415570259094,-0.08888190239667892,0.02994547225534916,0.11777298152446747,0.2359950989484787,0.24500013887882233,0.023927107453346252,-0.3345244228839874,0.019710326567292213,0.023046547546982765,0.3076324462890625,0.26300933957099915,-0.03412070870399475,-0.1737309694290161,0.11616676300764084,0.18040831387043},{0.23192664980888367,-0.12739679217338562,-0.1723438948392868,-0.020796265453100204,-0.07258396595716476,0.28995493054389954,-0.2703179121017456,0.1366010159254074,-0.38075771927833557,-0.29149189591407776,0.1824014037847519,-0.02404426783323288,-0.05478956177830696,-0.1536339968442917,-0.03857431933283806,-0.08550217002630234,0.16555550694465637,0.01209831703454256,-0.08664097636938095,0.19778692722320557,0.08714254200458527,-0.09676901251077652,0.1377757489681244,0.2659474313259125,0.0997680053114891,-0.3188149631023407,-0.11516854166984558,0.12759757041931152,-0.12585504353046417,-0.05305144563317299,0.15724341571331024,0.17782653868198395},{0.2946370840072632,0.21721549332141876,0.17803113162517548,-0.07652552425861359,-0.25295355916023254,0.08284200727939606,-0.154052272439003,0.19072189927101135,0.0951591432094574,0.051211997866630554,-0.09980104863643646,0.0870017483830452,0.1683201640844345,0.19271375238895416,-0.07801074534654617,-0.2861025631427765,-0.32467734813690186,0.3277361989021301,0.37446343898773193,-0.3131099343299866,-0.23658041656017303,0.27025964856147766,0.19401612877845764,-0.21870547533035278,0.16539709270000458,0.012944401241838932,0.29832619428634644,0.09235860407352448,0.13206595182418823,0.016529712826013565,-0.2197728306055069,0.18439644575119019},{-0.39434677362442017,-0.01019259076565504,-0.2232174128293991,-0.051973629742860794,-0.11375588178634644,-0.2374858409166336,0.0009150861878879368,-0.0380060113966465,-0.12486699968576431,0.16243334114551544,0.22996100783348083,-0.0027672848664224148,0.049883510917425156,-0.333210825920105,-0.2594410181045532,0.08912957459688187,-0.26984477043151855,0.018302956596016884,-0.20532025396823883,-0.009994696825742722,-0.039743345230817795,0.1949271410703659,0.22026850283145905,-0.021924223750829697,-0.14339427649974823,-0.04896233230829239,0.0740094929933548,0.18588724732398987,0.048882052302360535,-0.2529659569263458,-0.08615178614854813,-0.061330873519182205},{0.01586104743182659,0.32162946462631226,0.05800381675362587,0.14934568107128143,0.17457252740859985,0.10532357543706894,0.12158472836017609,0.13976342976093292,-0.34484902024269104,0.07438170164823532,-0.08729080110788345,0.1556929647922516,-0.22693079710006714,0.44360020756721497,-0.01613963395357132,-0.017150424420833588,0.11069570481777191,0.08587482571601868,-0.04413381591439247,0.24387726187705994,-0.30227184295654297,0.07327376306056976,-0.0425194576382637,0.23836562037467957,0.12030934542417526,0.07258825749158859,0.16807354986667633,-0.13189008831977844,0.271363228559494,0.2742410898208618,-0.13433338701725006,-0.1535566747188568},{-0.22182504832744598,0.3291165828704834,0.03519712761044502,0.01629127934575081,-0.23267266154289246,0.26067018508911133,0.004027486778795719,0.09862446784973145,0.052055153995752335,-0.3151921033859253,-0.10583281517028809,-0.2841830253601074,-0.11865274608135223,0.12921643257141113,0.029105087742209435,-0.19180575013160706,0.11230947822332382,0.10052527487277985,0.2796146869659424,0.14185191690921783,-0.1795443445444107,-0.3091266453266144,-0.09491938352584839,0.3439285457134247,0.37676841020584106,0.20883364975452423,0.10619384795427322,-0.03419061005115509,0.023590104654431343,0.038132134824991226,-0.312908411026001,0.23182949423789978},{-0.08075199276208878,-0.0475446991622448,-0.10347835719585419,-0.25964847207069397,0.07925388216972351,0.1290980577468872,0.15009331703186035,0.012719235382974148,0.25449544191360474,0.09311001002788544,0.1475718766450882,-0.17949099838733673,-0.01800611801445484,-0.05146688222885132,-0.3069685399532318,-0.1286856234073639,-0.28805655241012573,-0.19108258187770844,-0.12515726685523987,-0.3171800374984741,-0.08034426718950272,0.12465572357177734,0.0603448785841465,0.21768571436405182,0.19522210955619812,0.04399023577570915,0.2795840799808502,-0.38314488530158997,-0.14451287686824799,-0.15151798725128174,0.003131346544250846,-0.026212424039840698}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.3079959750175476,-0.06018577888607979,-0.32010912895202637,-0.20762744545936584},{0.11463240534067154,-0.16506724059581757,-0.05784699693322182,0.3182978630065918},{0.03757014498114586,0.04015371948480606,-0.1798015534877777,-0.12946687638759613},{-0.27657556533813477,0.05261313170194626,0.05132555589079857,0.15005750954151154},{-0.31801217794418335,0.06258680671453476,-0.1172671988606453,-0.2777010500431061},{0.24781087040901184,-0.24384979903697968,-0.35874438285827637,0.14382468163967133},{0.1306537687778473,0.05970747023820877,-0.05365260690450668,0.4136858880519867},{0.39613330364227295,0.29078683257102966,0.13033999502658844,0.07279035449028015},{-0.3646772503852844,0.2757473289966583,0.18811729550361633,0.01945069618523121},{-0.2150195837020874,-0.2252824604511261,-0.21733659505844116,-0.2803814113140106},{-0.009927457198500633,0.2894965410232544,-0.2305678427219391,-0.25505906343460083},{-0.18586626648902893,-0.288291335105896,0.17571230232715607,0.15663626790046692},{0.2301373928785324,0.25901326537132263,-0.1389259248971939,-0.36176446080207825},{0.3479101359844208,-0.05915579944849014,-0.13988177478313446,0.055499397218227386},{0.31776222586631775,0.33456951379776,-0.4286384880542755,-0.30963361263275146},{0.027313005179166794,0.1247047409415245,-0.2180269956588745,0.04934744909405708},{-0.3732205927371979,-0.12161532789468765,-0.39419418573379517,-0.31350424885749817},{-0.10894277691841125,0.1695747971534729,0.10651430487632751,0.16040176153182983},{0.059526048600673676,0.3127991557121277,0.23231279850006104,0.04833387956023216},{-0.07546748220920563,-0.33611243963241577,0.10820028185844421,-0.19974112510681152},{0.10730668157339096,0.16681788861751556,-0.2182544469833374,-0.13183778524398804},{-0.17647063732147217,0.21832960844039917,0.3757019639015198,-0.21974851191043854},{0.33468514680862427,-0.018938472494482994,-0.24564823508262634,-0.12661808729171753},{0.27582940459251404,0.2167605459690094,-0.1844729781150818,-0.0655113011598587},{0.3638201951980591,0.3379254937171936,0.20031185448169708,0.0764540433883667},{0.29196688532829285,-0.2884518504142761,0.22690673172473907,-0.06739693880081177},{-0.1919388473033905,0.27166351675987244,0.3010205924510956,0.08902207016944885},{-0.16691750288009644,-0.24938976764678955,-0.07180771231651306,-0.28449076414108276},{-0.2569368779659271,0.21925847232341766,-0.25700968503952026,0.3357252776622772},{0.13771100342273712,-0.26583653688430786,-0.4134235978126526,-0.16554860770702362},{-0.02913079410791397,-0.1311236172914505,0.011660255491733551,0.137635737657547},{0.10078151524066925,0.023855993524193764,-0.2699443995952606,-0.2322232872247696}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.00424976646900177,-0.07167157530784607,0.005027592182159424,-0.03148233890533447,0.06807117164134979,0.05043797567486763,0.04526618868112564,0.04926189407706261,0.09550178796052933,0.02632870338857174,0.0745091661810875,-0.01928831823170185,-0.06598272919654846,0.01099037379026413,-0.14468657970428467,-0.04335813596844673};
static const float actor_encoder_self_encoder_2_bias[16] = {0.037169042974710464,0.003672744380310178,0.01829901523888111,-0.022292261943221092,0.011288556270301342,0.018513964489102364,-0.007701058406382799,0.026380520313978195,-0.016303734853863716,-0.0264499019831419,0.019135132431983948,0.005478674080222845,-0.04041857272386551,0.011465628631412983,-0.02819763496518135,-0.0030477759428322315};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.014177903532981873,0.017266064882278442,0.030618110671639442,-0.012025448493659496,-0.03826623782515526,0.014324340969324112,0.014838001690804958,0.010627934709191322,0.00493776286020875,-0.03057130053639412,-0.02152630314230919,0.003344419412314892,0.002698722528293729,-0.03245893865823746,0.025771595537662506,0.014336425811052322,-0.04008284956216812,-0.007545305881649256,0.009192079305648804,-0.022692186757922173,-0.015171082690358162,-0.002510911086574197,-0.025268027558922768,0.023267174139618874,0.023511739447712898,-0.028023846447467804,0.0008862814866006374,-0.029161926358938217,-0.0026921110693365335,-0.0019299009582027793,0.042940571904182434,-0.023367322981357574};
static const float action_parameterization_distribution_linear_bias[4] = {0.016453955322504044,0.016781555488705635,0.014365946874022484,0.020012138411402702};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.138803482055664,1.1350535154342651,-0.17163395881652832,0.6623536348342896,0.829782247543335,0.00531114311888814,0.6907910108566284,-0.8298916220664978},{0.44150471687316895,0.6999343037605286,1.4555782079696655,-0.6680989265441895,0.30825182795524597,-0.419821560382843,0.23711234331130981,0.6844828724861145},{0.3989383280277252,0.5151907801628113,-0.6582696437835693,-0.14581398665905,-0.48694270849227905,0.3598955571651459,-1.4637726545333862,0.0005021406104788184}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.3699857294559479,-0.7613862156867981,0.1830626279115677,-0.7236242294311523,1.0935707092285156,-0.6803979873657227,0.07625795155763626,0.36888813972473145},{0.2266150861978531,-0.24876385927200317,-0.339847207069397,-0.6227530241012573,-0.33054211735725403,0.6706496477127075,-0.6765939593315125,-0.48772644996643066},{-0.299149751663208,-0.004091702867299318,-0.3547542095184326,-0.56841641664505,1.101914405822754,0.938949465751648,0.5888354778289795,0.1241433396935463},{-0.24437332153320312,0.4245743453502655,-0.5699084401130676,-0.1091729998588562,-1.2087769508361816,0.0850912556052208,-0.30548182129859924,0.6545198559761047},{-0.7663506269454956,-0.022959398105740547,0.24330295622348785,0.14983083307743073,-0.5546637177467346,0.6586894392967224,-0.07573055475950241,0.5870568156242371},{0.4408114552497864,-0.4289783835411072,-0.3714810013771057,-0.21680034697055817,-0.08647286146879196,0.2738642990589142,-0.456302285194397,-0.16441239416599274},{0.28461575508117676,-0.3771664500236511,0.1025475338101387,0.18772093951702118,-0.34057778120040894,0.9655120968818665,-0.15153290331363678,0.8317447304725647},{-0.1790444254875183,0.38455015420913696,-0.04729621857404709,-0.26920366287231445,1.1120108366012573,-0.6010597944259644,0.24150852859020233,0.12574493885040283}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.007972914725542068,-0.02191411331295967,0.02902369014918804,-0.02704671211540699,0.021164601668715477,-0.01087102945894003,0.013278095051646233,0.02771945297718048};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.005178993567824364,-0.00590319512411952,-0.017385272309184074,-0.006402627564966679,0.019793743267655373,0.016282537952065468,0.00906328484416008,0.0002623834880068898};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
