#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.15755009651184082,0.25670745968818665,0.15543998777866364,-0.14400164783000946,0.06905070692300797,-0.2721530497074127,-0.01122781541198492,-0.569182276725769,-0.01895803213119507,-0.18974371254444122,-0.144341379404068,0.1177900955080986,-0.26865172386169434,0.07732511311769485,0.28871414065361023,-0.16731689870357513},{0.010600368492305279,-0.045903079211711884,-0.01540781743824482,-0.18048085272312164,0.30233147740364075,0.11667507886886597,0.04770635813474655,-0.01619926653802395,-0.13685105741024017,0.05803218483924866,-0.14039459824562073,0.09276966005563736,0.2424626350402832,-0.014814911410212517,0.09029529243707657,-0.08764642477035522},{-0.2347833514213562,-0.31082427501678467,0.32481899857521057,-0.10314881056547165,-0.15347006916999817,0.38463613390922546,-0.5166090726852417,0.39510244131088257,-0.43671104311943054,-0.47851282358169556,-0.29306697845458984,-0.348916232585907,-0.32815223932266235,0.08490027487277985,-0.43698906898498535,-0.48411113023757935},{-0.350460022687912,-0.06545840948820114,0.00039284786907956004,0.18033066391944885,0.13508328795433044,-0.010011746548116207,0.24278166890144348,-0.1820831298828125,-0.13985037803649902,7.865243969717994e-05,-0.30124780535697937,-0.04726182296872139,-0.14664924144744873,0.4136184751987457,-0.23644311726093292,0.036629971116781235},{0.06571920961141586,-0.03103793039917946,0.12866893410682678,-0.28713080286979675,0.3900074064731598,0.4411030411720276,-0.09135709702968597,-0.07887439429759979,0.014891626313328743,0.2919071614742279,0.012490613386034966,-0.029978808015584946,0.22760815918445587,0.0023914442863315344,-0.22200775146484375,-0.2679145932197571},{0.07747004926204681,0.12913121283054352,0.1552261859178543,-0.1153884157538414,-0.1655023992061615,-0.06037694215774536,-0.17814376950263977,0.1321355700492859,-0.17646536231040955,0.18817104399204254,-0.20115196704864502,-0.2906063497066498,-0.10979397594928741,0.04428093135356903,-0.24864795804023743,0.020536266267299652},{-0.2729608714580536,-0.49762704968452454,0.04198131337761879,-0.2777480483055115,-0.3180309534072876,-0.11404170840978622,0.2290412038564682,0.35481736063957214,-0.6537311673164368,-0.07472502440214157,-0.10308900475502014,0.09654030948877335,-0.3976570963859558,-0.09209758043289185,0.31618380546569824,0.09280044585466385},{-0.15984652936458588,0.6058850884437561,0.43653929233551025,0.2697192430496216,-0.2676520347595215,0.23488016426563263,0.5062566995620728,0.7054865956306458,0.14681516587734222,0.04053593799471855,0.13372603058815002,0.13440275192260742,-0.19436833262443542,-0.530352771282196,0.2746564745903015,0.47017765045166016},{-0.44753819704055786,-0.03275258094072342,0.21155047416687012,-0.1884084939956665,0.08123017847537994,0.17270535230636597,0.11394818872213364,-0.23925381898880005,-0.26158633828163147,-0.44251659512519836,-0.061834026128053665,0.26400426030158997,0.02762029692530632,0.34057918190956116,0.20161166787147522,-0.20286838710308075},{0.7699927687644958,-0.13311848044395447,-0.6623985171318054,-0.17330138385295868,0.23462346196174622,0.04561302065849304,-0.6843938827514648,-0.7866615056991577,-0.5878715515136719,0.40534645318984985,0.061156824231147766,0.4343912601470947,-0.5725664496421814,0.5685933232307434,-0.6774091124534607,-0.11085028201341629},{0.4875856935977936,-0.2760077714920044,-0.04018047824501991,0.32010364532470703,-0.34943655133247375,0.23465853929519653,0.3000880777835846,0.334955096244812,-0.46392637491226196,-0.33890295028686523,-0.4424159824848175,0.3372408449649811,-0.22424960136413574,-0.2796860337257385,-0.21449272334575653,0.1828966587781906},{0.2246444970369339,-0.29684171080589294,-0.21613943576812744,-0.643786609172821,0.42402195930480957,0.008201622404158115,-0.18081635236740112,-0.3629907965660095,-0.35262033343315125,-0.5396113395690918,-0.5363697409629822,-0.257175087928772,0.12941326200962067,-0.31050723791122437,0.4732148051261902,0.35496631264686584},{0.06204129010438919,-0.5336518883705139,-0.3750591278076172,0.08071668446063995,0.22512812912464142,0.14867152273654938,0.3005634844303131,-0.388866126537323,0.13483375310897827,-0.44981226325035095,0.06542637944221497,-0.30709245800971985,0.48477497696876526,-0.838279664516449,-0.166312113404274,-0.07880233973264694},{0.029716160148382187,-0.26747000217437744,-0.5483363270759583,0.6772599220275879,-0.22024792432785034,-0.05221899598836899,-0.021457061171531677,-0.08055334538221359,-0.07524668425321579,-0.24834901094436646,0.23536989092826843,-0.06896591186523438,-0.5231223702430725,0.02083401568233967,0.3159438371658325,-0.5194967985153198},{-0.12364248186349869,-0.019144318997859955,-0.25822019577026367,0.1984120011329651,0.42275646328926086,-0.27338889241218567,0.2379702627658844,0.26026594638824463,-0.26361405849456787,0.04068833589553833,0.20833909511566162,0.1066867858171463,-0.17108745872974396,-0.4292028844356537,0.12176532298326492,0.16652917861938477},{-0.2226809561252594,0.12843534350395203,-0.16904504597187042,0.26169973611831665,-0.05893401429057121,-0.2812073230743408,0.193089559674263,0.10968440771102905,0.008147063665091991,-0.14332279562950134,0.004365626722574234,-0.0593947134912014,-0.2264954298734665,-0.12487684935331345,-0.21992187201976776,-0.2068074643611908},{-0.19564954936504364,0.11451469361782074,0.04812048748135567,0.004378677345812321,-0.34015363454818726,0.12273592501878738,-0.1685953587293625,0.12219446152448654,-0.2565695643424988,0.06040778011083603,-0.014890371821820736,0.2925430238246918,0.1918664276599884,0.25063571333885193,0.3451954126358032,-0.2611370384693146},{0.19957956671714783,-0.24043463170528412,-0.16991466283798218,-0.03259002044796944,-0.3218494653701782,-0.3176104724407196,-0.3376085162162781,-0.22676695883274078,-0.1484409123659134,-0.004646269138902426,-0.3114668130874634,0.028857197612524033,-0.04314665123820305,0.22391155362129211,-0.1299613118171692,-0.3228757679462433}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.1274299919605255,0.24363698065280914,0.02996833436191082,0.4633139669895172,0.12427756190299988,-0.0989631935954094,-0.18417608737945557,-0.34587618708610535,-0.0596420019865036,-0.09590176492929459,0.2311391681432724,0.047307711094617844,0.3298214375972748,0.07635056227445602,-0.4148804545402527,-0.3090340793132782},{-0.22584858536720276,0.24084562063217163,-0.23386017978191376,-0.04970739409327507,0.12251561135053635,0.01638873852789402,-0.4387819468975067,0.08727378398180008,0.26921728253364563,0.12325797975063324,-0.01779220625758171,3.6188102967571467e-06,-0.20779378712177277,-0.10405223816633224,-0.34919723868370056,-0.06037115305662155},{0.5418756604194641,0.38264766335487366,-0.37478286027908325,-0.609110414981842,0.250517338514328,-0.29967060685157776,-0.550722599029541,0.2517893612384796,0.32703351974487305,-0.2778325080871582,0.20980821549892426,-0.35265612602233887,-0.1956987977027893,-0.17450430989265442,0.45910772681236267,0.4473486542701721},{0.24623671174049377,-0.13020280003547668,-0.2736666202545166,0.3151223957538605,-0.19394642114639282,0.2309497892856598,0.06605151295661926,-0.10448838770389557,-0.07955942302942276,0.28417080640792847,0.32262933254241943,-0.44208306074142456,0.14542609453201294,-0.2455659657716751,-0.38651135563850403,-0.030300602316856384},{0.06578660011291504,0.25724413990974426,-0.010857965797185898,-0.05326339229941368,0.06522003561258316,0.01523467805236578,-0.1803392618894577,0.18800599873065948,-0.16335652768611908,-0.35135021805763245,-0.3294772803783417,0.21772323548793793,0.22528861463069916,-0.096576988697052,0.2508702874183655,0.06321872025728226},{0.35684552788734436,0.07865359634160995,-0.23712636530399323,-0.12313262373209,0.1781160533428192,0.24684767425060272,-0.19188541173934937,-0.32074499130249023,-0.10439132899045944,0.1798671931028366,-0.0926002487540245,-0.024684933945536613,-0.2695355713367462,0.34392601251602173,0.14900770783424377,-0.14186440408229828},{0.23589865863323212,-0.3396388590335846,-0.3922473192214966,-0.26010411977767944,0.026165662333369255,0.2841247320175171,-0.3591339588165283,0.004658288788050413,0.14394408464431763,0.10793421417474747,-0.04096150025725365,0.3318229615688324,0.2912167012691498,-0.12734203040599823,0.22904618084430695,0.2571451663970947},{-0.3059055507183075,0.3414435386657715,-0.09901423752307892,0.40191391110420227,0.0012898838613182306,0.06582228094339371,0.4065014719963074,0.40689003467559814,-0.11421141028404236,-0.24927684664726257,0.33207595348358154,-0.4053754508495331,-0.10088140517473221,-0.197217658162117,-0.22542710602283478,-0.101584292948246},{-0.0031308908946812153,-0.31574782729148865,-0.030743589624762535,0.16231918334960938,0.1069776639342308,0.22861045598983765,-0.0014682189794257283,0.42769142985343933,0.06697776168584824,0.2059294581413269,-0.2952066957950592,-0.1567634493112564,0.23848864436149597,-0.42714041471481323,0.2609664499759674,0.04333734139800072},{-0.06948714703321457,-0.07229605317115784,-0.16344092786312103,0.2343003898859024,-0.32400771975517273,0.0035151720512658358,0.31625035405158997,0.20776218175888062,0.16745391488075256,-0.19917984306812286,-0.1624683141708374,0.007453974336385727,-0.17708320915699005,0.05003843083977699,-0.38129758834838867,-0.06464742869138718},{-0.10762900859117508,-0.1524987816810608,0.12723591923713684,0.2668322026729584,-0.17531028389930725,-0.20658302307128906,0.309244841337204,-0.09014564752578735,-0.16405551135540009,0.026453059166669846,-0.06300902366638184,-0.3145599365234375,-0.34867483377456665,-0.5269693732261658,-0.3331548273563385,-0.004778516013175249},{-0.004191617015749216,-0.49533188343048096,0.30784091353416443,-0.13591639697551727,0.06796694546937943,0.09208088368177414,-0.32841068506240845,-0.2534361481666565,0.18132393062114716,0.1561783254146576,-0.4798508882522583,0.3808511197566986,-0.20194751024246216,-0.10139848291873932,0.20593193173408508,0.059111494570970535},{-0.12299597263336182,0.08251550048589706,-0.33654093742370605,0.13875767588615417,0.13107222318649292,0.0845600962638855,0.2937854826450348,-0.25457772612571716,-0.16249917447566986,-0.09660593420267105,-0.36612391471862793,0.39673009514808655,0.4155208468437195,0.15731298923492432,0.03933776542544365,0.2581585645675659},{-0.3595777153968811,-0.037431500852108,0.2681051790714264,-0.36723726987838745,0.4108674228191376,-0.5121193528175354,-0.13457538187503815,-0.1643131822347641,0.2741512656211853,0.21313995122909546,0.3101194202899933,0.3511533737182617,-0.18951711058616638,-0.2303248792886734,-0.2556833028793335,0.22009103000164032},{-0.10565675795078278,-0.190068319439888,-0.29072168469429016,0.1965911090373993,-0.07379298657178879,0.46043089032173157,0.2488529533147812,0.2834078073501587,0.19808152318000793,0.02644059807062149,-0.19295872747898102,-0.17265105247497559,0.24513013660907745,0.13319933414459229,-0.004951218608766794,0.1885225474834442},{-0.15750104188919067,0.2537742555141449,-0.06886724382638931,-0.22154487669467926,0.05757676437497139,0.018677180632948875,0.14501671493053436,0.16456937789916992,-0.1526726931333542,-0.11951602250337601,-0.18057839572429657,0.2664332091808319,0.0857221931219101,-0.22137390077114105,-0.34514951705932617,0.05510925129055977}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07275755703449249,0.023400794714689255,0.012065047398209572,0.1923733502626419,0.36195364594459534,-0.0825342983007431,-0.11914724111557007,0.05034583806991577,-0.22233837842941284,-0.07834115624427795,-0.013017605058848858,0.21240568161010742,0.24300332367420197,-0.05365731939673424,0.22159400582313538,0.058741699904203415,0.19058279693126678,0.06750454008579254,0.030514966696500778,0.015013915486633778,0.2506820559501648,-0.22600096464157104,-0.2717643976211548,-0.27635979652404785,-0.12054960429668427,0.14054818451404572,-0.27844589948654175,-0.21666932106018066,0.1904824674129486,-0.14234863221645355,-0.2377868890762329,-0.17226813733577728},{0.25501495599746704,0.08523564040660858,0.2778233587741852,0.30497708916664124,0.41384750604629517,-0.0032203448936343193,0.16509953141212463,-0.3527427017688751,0.164029061794281,0.11312811821699142,-0.06758303195238113,-0.30219462513923645,-0.17588460445404053,-0.09481045603752136,-0.29024738073349,0.3785187005996704,0.20597027242183685,-0.28197181224823,0.14232781529426575,0.11656206846237183,0.013255484402179718,0.22462210059165955,-0.2049603909254074,0.1874525099992752,0.0652240589261055,-0.39230474829673767,-0.23421534895896912,0.37161073088645935,-0.2145591378211975,0.05680007487535477,0.23650269210338593,-0.09511643648147583},{0.21834959089756012,-0.05255024880170822,-0.16281364858150482,-0.2546643614768982,-0.28254327178001404,-0.16639617085456848,-0.3406834006309509,0.08949830383062363,-0.3869975805282593,-0.13895604014396667,0.12152516096830368,0.30947068333625793,0.13244548439979553,-0.09598491340875626,-0.18062061071395874,0.10827002674341202,0.3075912296772003,-0.19184370338916779,-0.16575010120868683,0.2689038813114166,-0.2433639019727707,-0.07380348443984985,0.005882868077605963,-0.08525130152702332,-0.036179132759571075,0.37768232822418213,-0.3203382194042206,0.26481953263282776,-0.4677272439002991,-0.11094249784946442,0.029464909806847572,0.06250321120023727},{0.23095230758190155,-0.31027281284332275,-0.0896930918097496,0.18624120950698853,0.11475268751382828,-0.17315301299095154,0.3041616976261139,0.07287415862083435,0.1167484000325203,-0.03909467160701752,0.040129903703927994,-0.052810363471508026,0.30588507652282715,0.1726984679698944,-0.18028680980205536,-0.15861260890960693,-0.15935546159744263,0.15124879777431488,0.172927126288414,-0.019512850791215897,0.015909932553768158,0.3348768949508667,-0.06327883899211884,-0.2076118141412735,0.060553085058927536,0.12498538941144943,0.11856300383806229,0.05222306773066521,-0.3508184254169464,-0.3329303562641144,0.12082294374704361,0.18323977291584015},{-0.043807003647089005,0.143123060464859,0.048192188143730164,0.03423754870891571,0.09742318838834763,0.24059799313545227,0.17085541784763336,-0.13004562258720398,-0.05092822387814522,0.04414462298154831,-0.10592616349458694,-0.0040634009055793285,-0.1922532469034195,0.1698821634054184,0.03896564617753029,0.25242409110069275,0.07641076296567917,0.007951253093779087,0.07868494838476181,0.075405053794384,0.17189821600914001,-0.022459570318460464,-0.2437441051006317,-0.2020471841096878,0.06251377612352371,0.1374366283416748,0.14118418097496033,-0.0015229363925755024,0.16691185534000397,-0.1651049703359604,-0.26964083313941956,0.27628931403160095},{-0.2627817690372467,0.24589665234088898,-0.0010987176792696118,-0.05597234517335892,-0.3393367826938629,-0.2557908892631531,-0.11486640572547913,0.07340271025896072,0.23472732305526733,-0.16017289459705353,0.08327460289001465,-0.3429924249649048,-0.12448347359895706,0.049067556858062744,0.09101282060146332,-0.14894768595695496,-0.19283802807331085,0.03387998417019844,0.10387007892131805,-0.3448171317577362,0.20870083570480347,-0.05557001382112503,0.01847764477133751,-0.16261956095695496,0.17575876414775848,0.08698912709951401,0.0051289820112288,0.07611633092164993,0.07922690361738205,-0.0523526556789875,-0.29404783248901367,-0.2272387593984604},{0.03135630860924721,-0.01709400862455368,0.06280115246772766,-0.18946313858032227,-0.22662273049354553,0.11536113172769547,-0.21968986093997955,-0.08078886568546295,-0.13069549202919006,0.22947929799556732,-0.22671906650066376,0.05177722126245499,0.24765819311141968,0.06139805540442467,-0.2828369140625,-0.11573009192943573,0.00905806664377451,0.1525493711233139,0.10200192034244537,0.21656574308872223,-0.23823799192905426,0.139848530292511,-0.007352585904300213,0.07502912729978561,0.24429772794246674,-0.1686290204524994,-0.0267898291349411,0.26203641295433044,0.05950741097331047,-0.2572350800037384,-0.28931209444999695,0.22228625416755676},{0.07689830660820007,0.23171992599964142,0.10702060163021088,0.09681237488985062,-0.1840793937444687,-0.32290884852409363,0.1636779010295868,-0.24700604379177094,-0.09984423220157623,-0.2280510812997818,0.21856480836868286,-0.05643871799111366,-0.08368757367134094,-0.06807009875774384,0.22963030636310577,0.0909852460026741,0.07379854470491409,-0.05268837884068489,-0.33667057752609253,0.1261892169713974,-0.3194115161895752,-0.048680104315280914,-0.2189001590013504,0.17840149998664856,0.021780967712402344,0.009571586735546589,0.1618649810552597,0.02231757901608944,0.039449479430913925,-0.17769266664981842,-0.15670740604400635,0.25060680508613586},{0.15801765024662018,0.3761513829231262,-0.15377488732337952,0.291672945022583,0.007747475057840347,0.0955347791314125,0.45109495520591736,-0.3015654683113098,-0.03338223323225975,-0.12043874710798264,0.2100062221288681,-0.1437164843082428,-0.0018107410287484527,0.23414212465286255,-0.10966318845748901,0.242107093334198,0.22690331935882568,0.2571713328361511,0.20055252313613892,0.15063245594501495,-0.25299233198165894,-0.16245470941066742,0.07430802285671234,0.19956161081790924,0.13502632081508636,0.283894419670105,-0.31877127289772034,-0.36990076303482056,-0.0632534995675087,0.21907415986061096,-0.011131352744996548,0.17852701246738434},{0.05941629037261009,0.024742895737290382,0.007565292529761791,-0.2561582326889038,-0.11087948828935623,-0.29093489050865173,0.16287273168563843,0.32738134264945984,-0.21766597032546997,-0.31671756505966187,0.0943123921751976,-0.08716055005788803,0.01237635500729084,0.10324419289827347,-0.19759109616279602,0.25800150632858276,-0.003858609590679407,-0.27955374121665955,0.20937031507492065,0.02201979048550129,0.17362524569034576,-0.2905297875404358,0.2639474868774414,-0.09858785569667816,0.17388829588890076,0.2753201723098755,0.3174695372581482,0.2160266488790512,-0.11677277833223343,0.21453744173049927,0.007206619717180729,-0.023880159482359886},{0.17391926050186157,0.04559394344687462,0.3115239143371582,-0.3159807324409485,0.17146611213684082,-0.15781088173389435,-0.14348238706588745,-0.26774710416793823,0.04239097982645035,0.3839804530143738,0.14992773532867432,-0.009664464741945267,0.09376994520425797,0.1729719191789627,-0.013795433565974236,0.3026634156703949,-0.049696389585733414,-0.2908020317554474,-0.09413205087184906,-0.008395394310355186,-0.1912117451429367,0.1172616109251976,0.008765616454184055,-0.2344920039176941,-0.1162666529417038,-0.19469532370567322,-0.1714891642332077,0.0507560633122921,-0.20484569668769836,-0.005880736745893955,0.34656909108161926,0.36455658078193665},{0.2524109482765198,0.05351397022604942,-0.15431994199752808,-0.35538366436958313,-0.18490272760391235,-0.2724073827266693,0.20106688141822815,0.06753163039684296,-0.17254053056240082,0.24597850441932678,-0.33760926127433777,-0.0886097103357315,-0.11634846776723862,-0.12787263095378876,-0.09053879976272583,-0.20863693952560425,-0.3687978684902191,-0.2998875677585602,0.10622504353523254,0.1891213357448578,-0.04704567790031433,0.35058385133743286,-0.18530598282814026,-0.10911133140325546,0.1617375612258911,0.3072124719619751,0.20307676494121552,-0.152201846241951,-0.1452275514602661,-0.2686777114868164,-0.2769220471382141,0.14209142327308655},{-0.0484786182641983,-0.07033779472112656,-0.17037630081176758,0.032885096967220306,0.24111542105674744,-0.09876735508441925,0.1871042251586914,0.3279455602169037,0.1388353407382965,0.2689967751502991,-0.11590718477964401,-0.30121496319770813,0.07094711810350418,0.12368576973676682,0.20378457009792328,0.20676986873149872,-0.36829403042793274,-0.18645694851875305,-0.1716793328523636,0.21835286915302277,-0.0775211751461029,-0.34847360849380493,-0.26388809084892273,-0.10205251723527908,0.14422358572483063,0.27771568298339844,0.23322948813438416,0.10457006841897964,-0.14689132571220398,-0.1299087107181549,0.13416443765163422,-0.1791551411151886},{0.2720652222633362,-0.06303668022155762,-0.30146512389183044,-0.081194207072258,0.022202778607606888,0.05623083561658859,-0.04227609559893608,-0.048508238047361374,0.16486579179763794,0.33593687415122986,-0.34190210700035095,0.2539345622062683,0.18697331845760345,-0.24275195598602295,0.06152057275176048,-0.24435943365097046,-0.09929045289754868,0.17753908038139343,-0.1412094235420227,0.3375312089920044,0.13143344223499298,-0.16310858726501465,-0.2127351462841034,-0.1305965781211853,-0.32511547207832336,0.0909564271569252,-0.01240809727460146,0.20690855383872986,-0.03355469927191734,0.12683112919330597,0.3296504616737366,-0.19753208756446838},{0.20111869275569916,-0.20009976625442505,0.14805524051189423,-0.10241547226905823,-0.2441394180059433,-0.22797466814517975,0.17377646267414093,-0.2457510381937027,0.18450963497161865,0.16500303149223328,-0.15065424144268036,0.12046336382627487,-0.020143162459135056,0.08644246309995651,-0.10531306266784668,-0.06262215226888657,0.09499835968017578,-0.10550466179847717,-0.029421651735901833,-0.17562757432460785,0.032612308859825134,-0.2550719082355499,-0.14325907826423645,-0.36258530616760254,0.030240891501307487,-0.19181376695632935,0.07919636368751526,0.13568632304668427,0.16311123967170715,0.08853620290756226,0.06454388797283173,0.031086238101124763},{0.20462776720523834,-0.1423688530921936,-0.25090694427490234,0.25688934326171875,-0.16049383580684662,0.08315989375114441,0.32872313261032104,-0.2867202162742615,-0.05578451231122017,-0.3441086709499359,-0.21014855802059174,-0.3568841218948364,-0.22516149282455444,-0.2532758116722107,0.07470080256462097,0.3631214201450348,0.2898215353488922,-0.20811069011688232,0.07391747087240219,-0.09558666497468948,-0.10810507088899612,-0.1104920282959938,-0.23043878376483917,0.225896418094635,-0.12304230034351349,-0.07684265822172165,-0.12276612967252731,-0.1280156522989273,-0.1737847775220871,-0.11666900664567947,-0.19958436489105225,-0.20714855194091797},{0.277739018201828,0.455133318901062,-0.20297524333000183,-0.14765597879886627,-0.05465559661388397,0.41691160202026367,0.33753207325935364,0.09894689917564392,-0.06150274723768234,-0.27217575907707214,0.02325195074081421,0.20321762561798096,-0.06953426450490952,0.010462257079780102,0.15621480345726013,0.11208043247461319,-0.17839719355106354,-0.043959811329841614,-0.2532557249069214,-0.17905879020690918,-0.04741227626800537,0.019811416044831276,-0.05983252823352814,-0.2638528048992157,-0.1586383432149887,0.1195053681731224,0.0650176927447319,-0.1840738207101822,0.11710093915462494,-0.17005743086338043,0.3088369071483612,-0.16105879843235016},{-0.30527305603027344,-0.1076088696718216,0.15838807821273804,0.02794506587088108,0.2272459864616394,0.14611001312732697,0.1978362798690796,-0.2793880105018616,0.005610086489468813,0.1251315176486969,0.23155033588409424,0.17730236053466797,-0.18348409235477448,0.025037862360477448,-0.2830010652542114,-0.18047280609607697,0.2552359998226166,-0.08498724550008774,0.015782246366143227,0.09866756200790405,0.2564321756362915,0.24072687327861786,0.032214730978012085,-0.3047347366809845,0.020981600508093834,-0.008824627846479416,0.30684974789619446,0.25936245918273926,-0.0032143827993422747,-0.16714516282081604,0.13490696251392365,0.18684156239032745},{0.2092897742986679,-0.17755885422229767,-0.15023766458034515,0.022927016019821167,-0.02640337496995926,0.256217360496521,-0.3029650151729584,0.11819778382778168,-0.33372047543525696,-0.2729420065879822,0.20441396534442902,-0.05137404054403305,-0.05117984116077423,-0.19310249388217926,-0.05228880047798157,-0.09754153341054916,0.2024850845336914,0.04157792404294014,-0.06787938624620438,0.17830562591552734,0.07966027408838272,-0.0806284174323082,0.10221777856349945,0.2459089607000351,0.08480732887983322,-0.35875004529953003,-0.10233954340219498,0.14256779849529266,-0.10605574399232864,-0.059391215443611145,0.1209387257695198,0.17369237542152405},{0.3324317932128906,0.20859850943088531,0.16759516298770905,-0.06746372580528259,-0.2578994333744049,0.079918272793293,-0.152650386095047,0.17644666135311127,0.09710083156824112,0.05226753652095795,-0.07968100160360336,0.09054293483495712,0.17334190011024475,0.2191118597984314,-0.08019347488880157,-0.25788307189941406,-0.31510046124458313,0.3276900053024292,0.36649027466773987,-0.3089390695095062,-0.22807304561138153,0.28131556510925293,0.195824533700943,-0.19294655323028564,0.16784091293811798,0.004528389312326908,0.29605257511138916,0.10352706909179688,0.13410517573356628,0.012559287250041962,-0.20900119841098785,0.18932121992111206},{-0.3902767300605774,-0.01777796447277069,-0.1769866943359375,-0.08597519993782043,-0.1103939563035965,-0.21600590646266937,0.0018402505666017532,-0.011341623030602932,-0.14681804180145264,0.16817063093185425,0.24972088634967804,-0.04532485082745552,0.08194976300001144,-0.322297066450119,-0.22961007058620453,0.09710637480020523,-0.26735928654670715,-0.0012749667512252927,-0.20281551778316498,-0.03546861559152603,-0.009643240831792355,0.17122696340084076,0.255842924118042,-0.014261793345212936,-0.13288041949272156,-0.05407380312681198,0.05443478748202324,0.17763331532478333,0.051278360188007355,-0.2258315533399582,-0.11845842003822327,-0.034102797508239746},{0.017567923292517662,0.2913600504398346,0.051496271044015884,0.14016412198543549,0.17333205044269562,0.094902403652668,0.09322187304496765,0.1432146579027176,-0.33575472235679626,0.07576680183410645,-0.06427503377199173,0.1545097380876541,-0.19936616718769073,0.4683685898780823,-0.01273789256811142,0.0020939221139997244,0.12835176289081573,0.08495716750621796,-0.03577296435832977,0.24557287991046906,-0.28313133120536804,0.08700736612081528,-0.036412257701158524,0.22873778641223907,0.1216004490852356,0.0648738369345665,0.16781891882419586,-0.11714931577444077,0.26020845770835876,0.27714911103248596,-0.14730419218540192,-0.144047349691391},{-0.25025781989097595,0.31724876165390015,0.05201849713921547,0.025287898257374763,-0.2228681445121765,0.2635384202003479,-0.0007259518024511635,0.090555340051651,0.05712483450770378,-0.3034786283969879,-0.11297320574522018,-0.28986531496047974,-0.12113309651613235,0.1253058910369873,0.0065976292826235294,-0.20727981626987457,0.12478867173194885,0.10062658041715622,0.27988195419311523,0.1367865949869156,-0.1881280094385147,-0.320781946182251,-0.10178110003471375,0.30477166175842285,0.36800140142440796,0.20918694138526917,0.09776661545038223,-0.02872611954808235,0.028716016560792923,0.05268629267811775,-0.3213479816913605,0.2255028784275055},{-0.07318992912769318,-0.04272022470831871,-0.11653979122638702,-0.26230326294898987,0.051576219499111176,0.14603552222251892,0.16106586158275604,0.003684126539155841,0.24188992381095886,0.09103366732597351,0.1489017754793167,-0.1653251200914383,-0.016956700012087822,0.0002556155086494982,-0.33464163541793823,-0.10414158552885056,-0.27213308215141296,-0.19185662269592285,-0.13332967460155487,-0.32294341921806335,-0.07896068692207336,0.10259608179330826,0.07235658168792725,0.19497092068195343,0.1862240582704544,0.049575235694646835,0.25074782967567444,-0.3713582158088684,-0.14428725838661194,-0.13563036918640137,0.04159637540578842,-0.0312705896794796}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2773779630661011,-0.04452170804142952,-0.2926862835884094,-0.19969792664051056},{0.06003960222005844,-0.10829491913318634,-0.04365360364317894,0.2223101407289505},{0.032284803688526154,0.022016476839780807,-0.1253509372472763,-0.09052634984254837},{-0.217962384223938,0.044988229870796204,0.06288745999336243,0.10780815035104752},{-0.29011988639831543,0.055834535509347916,-0.10346671938896179,-0.24958975613117218},{0.1978597640991211,-0.20170889794826508,-0.3081176280975342,0.13109563291072845},{0.12307202070951462,0.04870551452040672,-0.042367953807115555,0.3566158711910248},{0.3237155079841614,0.24639792740345,0.10991641879081726,0.06326724588871002},{-0.3060190677642822,0.19641688466072083,0.15114541351795197,0.039295975118875504},{-0.18357521295547485,-0.2010783851146698,-0.22702185809612274,-0.26405495405197144},{-0.009102831594645977,0.25843724608421326,-0.20022809505462646,-0.22638481855392456},{-0.17147767543792725,-0.23956961929798126,0.15308243036270142,0.14455966651439667},{0.20025713741779327,0.20314501225948334,-0.11512318253517151,-0.27788054943084717},{0.30898118019104004,-0.06291569769382477,-0.11256822943687439,0.06576893478631973},{0.28825002908706665,0.29451659321784973,-0.3678915202617645,-0.300710529088974},{0.037091828882694244,0.10745739936828613,-0.1610429883003235,0.037573374807834625},{-0.35192206501960754,-0.0730850100517273,-0.30219441652297974,-0.2993135154247284},{-0.0977792888879776,0.13803674280643463,0.10093995183706284,0.1432655304670334},{0.037274882197380066,0.27738597989082336,0.21284222602844238,0.051421552896499634},{-0.08351368457078934,-0.25466424226760864,0.0939822643995285,-0.19631873071193695},{0.10253309458494186,0.13814465701580048,-0.16650468111038208,-0.11131181567907333},{-0.16037152707576752,0.20143824815750122,0.2980789840221405,-0.19310857355594635},{0.290494441986084,0.0007017403258942068,-0.20065279304981232,-0.10077895224094391},{0.23953165113925934,0.2005041092634201,-0.1557733118534088,-0.06939467042684555},{0.3073021471500397,0.2917385399341583,0.17129398882389069,0.0816405713558197},{0.22254550457000732,-0.2549319267272949,0.20192497968673706,-0.060207709670066833},{-0.1742648184299469,0.2272355556488037,0.25003787875175476,0.08015831559896469},{-0.1253761202096939,-0.18782050907611847,-0.08267614245414734,-0.2441098392009735},{-0.19796308875083923,0.1908634454011917,-0.1977800577878952,0.2724635899066925},{0.11595464497804642,-0.2239508181810379,-0.3239275813102722,-0.17387984693050385},{-0.024783091619610786,-0.10684043169021606,-0.005707078613340855,0.12621843814849854},{0.06289756298065186,0.021850349381566048,-0.20133808255195618,-0.16908903419971466}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.009607050567865372,-0.07844829559326172,-0.0016163968248292804,-0.03880438581109047,0.058290980756282806,0.06436818838119507,0.04593276232481003,0.05105532333254814,0.07280108332633972,0.036072585731744766,0.06078014150261879,-0.03738410025835037,-0.061467863619327545,-0.008121935650706291,-0.14740999042987823,-0.043330542743206024};
static const float actor_encoder_self_encoder_2_bias[16] = {0.03142070025205612,0.007938208058476448,0.015696706250309944,-0.0224185548722744,0.008301694877445698,0.02176203392446041,-0.0005948939360678196,-0.01113123632967472,-0.01763742044568062,-0.018654419109225273,0.018926136195659637,0.003958445508033037,-0.026804478839039803,0.0253822673112154,-0.039685796946287155,-0.003635338507592678};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.016225453466176987,0.01512438990175724,0.03478414937853813,-0.011726556345820427,-0.03760755807161331,0.017638379707932472,0.01633838750422001,0.015276760794222355,0.003786964574828744,-0.032777030020952225,-0.02437892183661461,-0.006084708031266928,0.007363156881183386,-0.03465506434440613,0.030313575640320778,0.014414241537451744,-0.04723130166530609,-0.007413729093968868,0.007175693288445473,-0.020234137773513794,-0.008004561997950077,0.008374989032745361,-0.025266513228416443,0.027663251385092735,0.02347475476562977,-0.018541546538472176,0.003932830411940813,-0.029777150601148605,0.0005166355986148119,0.0018765428103506565,0.04806181788444519,-0.02437906339764595};
static const float action_parameterization_distribution_linear_bias[4] = {0.021420856937766075,0.019478842616081238,0.014607501216232777,0.02409193478524685};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.1868408918380737,1.2237861156463623,-0.1846633106470108,0.6753044724464417,0.8885592222213745,0.05636853352189064,0.7260271310806274,-0.8348545432090759},{0.5066550970077515,0.7251420021057129,1.6676063537597656,-0.734327495098114,0.3291477560997009,-0.40784040093421936,0.27483275532722473,0.6714009642601013},{0.41370418667793274,0.5556395053863525,-0.7863540053367615,-0.18004409968852997,-0.6818466782569885,0.4270504415035248,-1.6484260559082031,-0.010468398220837116}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.3758297860622406,-0.7638543844223022,0.1656658798456192,-0.7691426277160645,1.1070762872695923,-0.730496883392334,0.10570985823869705,0.3781526982784271},{0.1951192170381546,-0.27704450488090515,-0.29930198192596436,-0.651755690574646,-0.3094410002231598,0.613176167011261,-0.6315096020698547,-0.5282020568847656},{-0.28671500086784363,0.0031213080510497093,-0.3692212402820587,-0.6052468419075012,1.1360962390899658,1.005669116973877,0.6215839385986328,0.19746090471744537},{-0.2320195585489273,0.42756161093711853,-0.5602515339851379,-0.042532093822956085,-1.2140506505966187,0.10951824486255646,-0.3530866205692291,0.6272401213645935},{-0.7883973121643066,-0.03443468362092972,0.2693997323513031,0.1591258943080902,-0.5618575215339661,0.7833160758018494,-0.07312392443418503,0.6328142881393433},{0.4684242308139801,-0.4217255711555481,-0.36553025245666504,-0.18146689236164093,-0.07567805796861649,0.23027612268924713,-0.45809206366539,-0.2643604874610901},{0.2505425810813904,-0.36257803440093994,0.1331758052110672,0.1968347430229187,-0.35221484303474426,1.049162745475769,-0.1716710925102234,0.9078242182731628},{-0.18992093205451965,0.37485644221305847,-0.033507898449897766,-0.3385428786277771,1.0906683206558228,-0.603958010673523,0.2576914429664612,0.15007789433002472}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.018539734184741974,-0.0006396964890882373,0.0034556430764496326,-0.01530467439442873,0.02892954833805561,-0.007557480130344629,0.03818760812282562,0.006929719354957342};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.002535356441512704,-0.00306765572167933,-0.016059059649705887,-0.006998274475336075,-0.00966515764594078,0.05796363204717636,0.009158927015960217,0.0065280417911708355};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
