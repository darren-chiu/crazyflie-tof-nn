#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.1321021318435669,0.32984790205955505,0.14698436856269836,-0.14397986233234406,0.046477559953927994,-0.3535204529762268,-0.034234579652547836,-0.4658390283584595,0.006512354593724012,-0.14534106850624084,-0.08082199096679688,0.14278504252433777,-0.23983418941497803,0.1358424425125122,0.2961578667163849,-0.12501409649848938},{-0.03878933936357498,0.0009562911582179368,-0.054956842213869095,-0.19168886542320251,0.341389924287796,0.07734361290931702,0.08985592424869537,0.017283450812101364,-0.17271040380001068,-0.0012840484268963337,-0.19799575209617615,0.08330193907022476,0.17731285095214844,0.009108355268836021,0.05476376786828041,-0.09785693138837814},{-0.275078147649765,-0.31909194588661194,0.23462557792663574,-0.10479794442653656,-0.14211095869541168,0.27901729941368103,-0.44733795523643494,0.3457770049571991,-0.38202837109565735,-0.38590431213378906,-0.2911544144153595,-0.2882656753063202,-0.2575303912162781,0.06266294419765472,-0.32250112295150757,-0.42139220237731934},{-0.2571498155593872,-0.14658808708190918,-0.04393240809440613,0.18338236212730408,0.169862300157547,0.0022078482434153557,0.3478742837905884,-0.20860522985458374,-0.192135751247406,0.04174135625362396,-0.3402669131755829,-0.06556235998868942,-0.1967829018831253,0.4038255214691162,-0.2502666413784027,-0.016460439190268517},{0.10865066945552826,-0.0676436573266983,0.10287908464670181,-0.3142102062702179,0.4017150402069092,0.4300850033760071,-0.05041933432221413,-0.15492019057273865,0.023051824420690536,0.33351245522499084,0.13668103516101837,0.010966180823743343,0.20959852635860443,0.0011076399823650718,-0.21912214159965515,-0.3197585344314575},{0.1788548231124878,0.19098766148090363,0.14373451471328735,-0.12265824526548386,-0.20096875727176666,-0.08135364949703217,-0.17929822206497192,0.08119679242372513,-0.1531418412923813,0.2548002302646637,-0.2461475431919098,-0.3044417202472687,-0.06808816641569138,0.042501747608184814,-0.2941259443759918,0.08117547631263733},{-0.3725224733352661,-0.43333736062049866,0.06125646084547043,-0.29126405715942383,-0.23420919477939606,-0.04480091482400894,0.2706225514411926,0.2580246031284332,-0.5304931998252869,-0.03673577681183815,-0.12331736087799072,0.06941244751214981,-0.3080465495586395,-0.07140259444713593,0.2909016013145447,0.10097449272871017},{0.01562063954770565,0.4832991063594818,0.26288583874702454,0.18100324273109436,-0.3021963834762573,0.26165634393692017,0.40468165278434753,0.4962446987628937,-0.012119363993406296,0.09246077388525009,0.09264148026704788,0.1893770694732666,-0.1816571205854416,-0.4153910279273987,0.12164086103439331,0.39196133613586426},{-0.3792533278465271,-0.12241580337285995,0.10821717232465744,-0.17305105924606323,0.07741553336381912,0.1827302873134613,0.1165986880660057,-0.3050227761268616,-0.26679521799087524,-0.43834519386291504,-0.01821630634367466,0.2705589830875397,0.12310642004013062,0.2024860829114914,0.1925678253173828,-0.19004680216312408},{0.5940009355545044,-0.0659528523683548,-0.5359528064727783,-0.16608889400959015,0.22980865836143494,0.059880733489990234,-0.5298967361450195,-0.651756763458252,-0.45270296931266785,0.3443305790424347,0.005292446352541447,0.46893879771232605,-0.5006331205368042,0.4810760021209717,-0.5790535807609558,-0.043533213436603546},{0.4075208306312561,-0.17301444709300995,0.027679847553372383,0.3718312680721283,-0.2594863176345825,0.3080178201198578,0.3419348895549774,0.34037208557128906,-0.37280312180519104,-0.3313714861869812,-0.37230727076530457,0.23450206220149994,-0.2477993220090866,-0.2857024669647217,-0.23271150887012482,0.18867620825767517},{0.22547879815101624,-0.22478753328323364,-0.21458746492862701,-0.4472530782222748,0.277157187461853,-0.023866767063736916,-0.20636993646621704,-0.38746005296707153,-0.39165210723876953,-0.5423296093940735,-0.5522491335868835,-0.3270528018474579,0.0813230499625206,-0.27996405959129333,0.4785456657409668,0.3327387571334839},{0.03300784155726433,-0.5070592761039734,-0.30836212635040283,0.0531250424683094,0.23455365002155304,0.14768029749393463,0.27391529083251953,-0.26117104291915894,0.12904135882854462,-0.4263401925563812,0.08262994885444641,-0.35308000445365906,0.4252181351184845,-0.7453253865242004,-0.17762203514575958,-0.05550394207239151},{0.05541010946035385,-0.27092891931533813,-0.48156970739364624,0.4836277961730957,-0.1654137521982193,0.10445233434438705,0.004291357472538948,-0.056029897183179855,-0.03202713653445244,-0.2487836480140686,0.17786413431167603,-0.062813401222229,-0.4336811304092407,-0.032607950270175934,0.36438027024269104,-0.5103919506072998},{-0.14097966253757477,0.05874582380056381,-0.37383681535720825,0.26972243189811707,0.35728079080581665,-0.34686559438705444,0.30551326274871826,0.0691118985414505,-0.10781343281269073,0.15209120512008667,0.2599140405654907,0.15537816286087036,-0.13699452579021454,-0.35524263978004456,0.10731807351112366,0.2172222137451172},{-0.29904964566230774,0.14063674211502075,-0.17835940420627594,0.2903795838356018,-0.0019313786178827286,-0.3403160274028778,0.22953979671001434,0.12897081673145294,-0.02931291237473488,-0.14771048724651337,0.0011298742610961199,-0.02778574638068676,-0.30702728033065796,-0.1632210910320282,-0.2803804278373718,-0.2973375618457794},{-0.3000161647796631,0.20288453996181488,0.05055418238043785,0.03959718719124794,-0.3283018469810486,0.11040578782558441,-0.24710054695606232,0.10079687088727951,-0.2349083423614502,0.10176291316747665,0.012526866048574448,0.32722121477127075,0.2309894561767578,0.30549854040145874,0.40316587686538696,-0.23924130201339722},{0.25929948687553406,-0.31879016757011414,-0.16520263254642487,-0.1214824840426445,-0.3715830147266388,-0.2676973342895508,-0.2880990207195282,-0.21448826789855957,-0.1751737892627716,0.04103580489754677,-0.3170369863510132,0.043769821524620056,0.014644828625023365,0.20261621475219727,-0.07819842547178268,-0.348050594329834}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.14029203355312347,0.29665035009384155,0.05243156850337982,0.45615363121032715,0.17041921615600586,-0.09093669056892395,-0.19935233891010284,-0.34976962208747864,-0.07342386245727539,-0.15984199941158295,0.2279728353023529,0.0016692037461325526,0.3551091253757477,0.09648554027080536,-0.43115296959877014,-0.4120364487171173},{-0.25307199358940125,0.25886663794517517,-0.22384971380233765,-0.07383988052606583,0.1722097247838974,-0.019366921856999397,-0.47069135308265686,0.10727336257696152,0.34504833817481995,0.11300843954086304,0.0202429611235857,-0.06340867280960083,-0.23504294455051422,-0.06769362092018127,-0.30169931054115295,-0.06700024753808975},{0.4697560667991638,0.36755988001823425,-0.3604471683502197,-0.5519616007804871,0.33750084042549133,-0.2857228219509125,-0.5355333089828491,0.19406336545944214,0.35037022829055786,-0.29662176966667175,0.1640537828207016,-0.3075897693634033,-0.07622374594211578,-0.12155605107545853,0.38324323296546936,0.37439510226249695},{0.33246225118637085,-0.117466501891613,-0.3126166760921478,0.3000364601612091,-0.27520886063575745,0.21207250654697418,0.09715639054775238,-0.0607198067009449,-0.08642073720693588,0.30218634009361267,0.38844841718673706,-0.45634767413139343,0.08962561935186386,-0.2787780165672302,-0.33100929856300354,0.07666279375553131},{0.1011909767985344,0.20289430022239685,-0.017835740000009537,-0.0539579801261425,0.005022161640226841,0.056980110704898834,-0.1624722182750702,0.25200289487838745,-0.21399106085300446,-0.3356814980506897,-0.32009539008140564,0.29076892137527466,0.29507187008857727,-0.17146548628807068,0.2669944167137146,0.08720389008522034},{0.4120844900608063,0.0671602338552475,-0.23835571110248566,-0.1291240006685257,0.2257026731967926,0.20168310403823853,-0.18657346069812775,-0.3860510587692261,-0.1143675372004509,0.17469199001789093,-0.08572117984294891,-0.03220192715525627,-0.3049163818359375,0.39650651812553406,0.12036468088626862,-0.10427762567996979},{0.24445131421089172,-0.36499303579330444,-0.38042205572128296,-0.29353877902030945,-0.014752996154129505,0.2725217640399933,-0.3513864278793335,-0.0015083857579156756,0.15550006926059723,0.13988997042179108,-0.01999886892735958,0.3970053791999817,0.3002419173717499,-0.14681877195835114,0.2683299779891968,0.37469473481178284},{-0.3688676059246063,0.2944853901863098,-0.1309136599302292,0.4241008460521698,0.025485333055257797,0.06552285701036453,0.36150044202804565,0.4002806842327118,-0.08253810554742813,-0.22808986902236938,0.29175880551338196,-0.362431138753891,-0.07091770321130753,-0.17090116441249847,-0.24333728849887848,-0.025031378492712975},{0.05497906357049942,-0.2836160957813263,-0.023532316088676453,0.12849202752113342,0.11689221858978271,0.2004222720861435,-0.03887810558080673,0.5003069043159485,0.05678967759013176,0.19374091923236847,-0.23880723118782043,-0.19471748173236847,0.2287578582763672,-0.4672836363315582,0.3116097152233124,0.02256590500473976},{-0.07141995429992676,-0.12039563059806824,-0.18500225245952606,0.24547231197357178,-0.3425794243812561,-0.007620373275130987,0.28889989852905273,0.2100682109594345,0.2149268090724945,-0.17939165234565735,-0.16193918883800507,0.012416594661772251,-0.23520448803901672,0.04265693202614784,-0.4338289797306061,-0.022423284128308296},{-0.13345111906528473,-0.1721542477607727,0.15640681982040405,0.3040336072444916,-0.1516471654176712,-0.2004452347755432,0.3191356360912323,-0.12172828614711761,-0.20256495475769043,-0.01672476716339588,-0.08602053672075272,-0.3237461447715759,-0.32707521319389343,-0.524456262588501,-0.3241053521633148,-0.04353699833154678},{-0.043512795120477676,-0.5547762513160706,0.30377987027168274,-0.164175346493721,0.1863984763622284,0.0973004475235939,-0.34800007939338684,-0.345236212015152,0.2380240559577942,0.1572033017873764,-0.5492731928825378,0.38864877820014954,-0.2229006141424179,-0.08156036585569382,0.20864957571029663,0.1565343588590622},{-0.12000386416912079,0.07119873911142349,-0.3373560905456543,0.11558438092470169,0.21901856362819672,0.02503342367708683,0.29973411560058594,-0.3208030164241791,-0.10045308619737625,-0.08646512031555176,-0.36075764894485474,0.3827248215675354,0.35074087977409363,0.23523128032684326,0.056587863713502884,0.34070655703544617},{-0.3476455807685852,-0.07364697009325027,0.27053457498550415,-0.37160524725914,0.3976815938949585,-0.5285295844078064,-0.10684410482645035,-0.17819340527057648,0.2780356705188751,0.23510155081748962,0.3029075562953949,0.367555171251297,-0.2294396460056305,-0.22397124767303467,-0.28135910630226135,0.28765615820884705},{-0.10521693527698517,-0.17339393496513367,-0.3207179605960846,0.22948329150676727,-0.04645397514104843,0.46849653124809265,0.2684498429298401,0.2961364984512329,0.1912120282649994,0.0001730028016027063,-0.19965988397598267,-0.23093077540397644,0.2507426142692566,0.14923372864723206,-0.035160426050424576,0.1425560712814331},{-0.1629910171031952,0.29750460386276245,-0.0556398443877697,-0.23810234665870667,0.0733690932393074,-0.008602814748883247,0.152440145611763,0.1931704878807068,-0.16611120104789734,-0.14883354306221008,-0.1854286789894104,0.28034916520118713,0.1061902642250061,-0.1871698647737503,-0.3532804250717163,0.09829515963792801}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.036549948155879974,0.011691512539982796,0.057166773825883865,0.20386213064193726,0.3914981186389923,-0.076988585293293,-0.13359226286411285,0.028321173042058945,-0.21588070690631866,-0.048040375113487244,0.012980439700186253,0.16716277599334717,0.2708245813846588,-0.08464335650205612,0.24318401515483856,0.11360863596200943,0.22824205458164215,0.042191483080387115,0.005921429023146629,0.005681334994733334,0.3118577003479004,-0.21266287565231323,-0.26951879262924194,-0.25143057107925415,-0.1434541940689087,0.10914909839630127,-0.28751277923583984,-0.22520597279071808,0.22959361970424652,-0.10296045988798141,-0.31347936391830444,-0.1529223918914795},{0.2186189740896225,0.08831913769245148,0.25697875022888184,0.3372049033641815,0.41527989506721497,-0.025130892172455788,0.15543904900550842,-0.4135706424713135,0.19454365968704224,0.141718789935112,-0.0920228436589241,-0.21849361062049866,-0.21914958953857422,-0.18135079741477966,-0.31378063559532166,0.31237471103668213,0.1801048070192337,-0.29101628065109253,0.14218176901340485,0.18267686665058136,-0.04070216044783592,0.2699853181838989,-0.2730030119419098,0.09529447555541992,0.04052883759140968,-0.3616257309913635,-0.16045524179935455,0.4054623246192932,-0.24182280898094177,0.04002350568771362,0.31451815366744995,-0.13353855907917023},{0.19071932137012482,-0.07066959142684937,-0.1689731329679489,-0.35715657472610474,-0.314794659614563,-0.21231167018413544,-0.34813573956489563,0.1224026158452034,-0.400722473859787,-0.1901916265487671,0.11208253353834152,0.3153318166732788,0.16877974569797516,-0.0575837604701519,-0.19909314811229706,0.04676785692572594,0.2686060965061188,-0.20667341351509094,-0.13716496527194977,0.3012767732143402,-0.2478102743625641,0.005637334194034338,0.008641321212053299,-0.04011518508195877,-0.006718420889228582,0.4320811629295349,-0.29157671332359314,0.23911131918430328,-0.546288013458252,-0.12162744998931885,-0.017658554017543793,0.04378146678209305},{0.18274445831775665,-0.3865668475627899,-0.08483581244945526,0.19600747525691986,0.17110824584960938,-0.2449498027563095,0.2548975348472595,0.08870896697044373,0.1665683537721634,-0.04729670286178589,0.07611996680498123,-0.08599655330181122,0.34811222553253174,0.17125049233436584,-0.15658824145793915,-0.18038587272167206,-0.12815973162651062,0.18532633781433105,0.20025575160980225,-0.01555484440177679,0.018922237679362297,0.4076972007751465,-0.0993645116686821,-0.21539385616779327,0.06114727258682251,0.09381706267595291,0.15982690453529358,0.08349421620368958,-0.371574729681015,-0.3650878667831421,0.07937872409820557,0.19688956439495087},{-0.07848791778087616,0.22267483174800873,0.007961832918226719,0.09313662350177765,0.08856608718633652,0.2994486093521118,0.2333800196647644,-0.1965440958738327,-0.06403139233589172,0.08181135356426239,-0.17885325849056244,0.11037591844797134,-0.31834909319877625,0.19217728078365326,0.0035993338096886873,0.27136051654815674,0.06909293681383133,0.010575263760983944,0.025497693568468094,0.11084296554327011,0.12611374258995056,-0.10895366966724396,-0.30216681957244873,-0.2650551199913025,-0.00805254839360714,0.14316579699516296,0.13127762079238892,0.033943094313144684,0.21960651874542236,-0.1592114120721817,-0.14241479337215424,0.2558012902736664},{-0.2878628075122833,0.22059892117977142,-0.02945685386657715,0.021879613399505615,-0.28411513566970825,-0.3036733567714691,-0.1433819979429245,0.07742083072662354,0.2679321765899658,-0.16444815695285797,0.09058826416730881,-0.3783673346042633,-0.1278553307056427,0.050478775054216385,0.0727224349975586,-0.12990739941596985,-0.15773257613182068,0.07554368674755096,0.11166580766439438,-0.37400832772254944,0.2117893397808075,-0.030068745836615562,-0.002797082532197237,-0.16812939941883087,0.18016764521598816,0.045181985944509506,0.006855784449726343,0.0958586260676384,0.12539952993392944,-0.07402525842189789,-0.34604957699775696,-0.23885154724121094},{0.02137414924800396,-0.1086311787366867,0.087642602622509,-0.16827483475208282,-0.1625186949968338,0.07596738636493683,-0.2926326394081116,-0.07806719094514847,-0.08105653524398804,0.24409551918506622,-0.18465174734592438,0.04174485057592392,0.28896400332450867,0.0036275347229093313,-0.28717586398124695,-0.16901063919067383,0.02867809683084488,0.17871449887752533,0.10958316177129745,0.258989155292511,-0.25032952427864075,0.1627834588289261,-0.014635086059570312,0.07948503643274307,0.23417384922504425,-0.14212968945503235,-0.03456598520278931,0.31310057640075684,-0.0007934642489999533,-0.28000980615615845,-0.3048897981643677,0.25338616967201233},{0.11858442425727844,0.19220919907093048,0.14397503435611725,0.12365345656871796,-0.16111578047275543,-0.33687639236450195,0.17709749937057495,-0.21500928699970245,-0.06670726090669632,-0.2270071655511856,0.3274775445461273,-0.15901689231395721,-0.01130926888436079,-0.07250245660543442,0.3171205520629883,0.16407562792301178,0.08132418245077133,-0.03179017826914787,-0.28881382942199707,0.008572532795369625,-0.2629970610141754,-0.056882601231336594,-0.18744876980781555,0.21191257238388062,0.09151984751224518,-0.06598342955112457,0.191640242934227,-0.00717560900375247,0.09361337125301361,-0.1819435954093933,-0.21567967534065247,0.29536327719688416},{0.2355337291955948,0.4428775906562805,-0.13524334132671356,0.2402268648147583,-0.03448081389069557,0.19682547450065613,0.4974439740180969,-0.30095186829566956,-0.1331954449415207,-0.09540242701768875,0.1887519657611847,-0.13746152818202972,-0.020174305886030197,0.33754202723503113,-0.06004760041832924,0.27354276180267334,0.2206752449274063,0.21673642098903656,0.16659289598464966,0.15254761278629303,-0.24314628541469574,-0.26805222034454346,0.14944902062416077,0.23285013437271118,0.12140096724033356,0.3055903911590576,-0.4011576771736145,-0.3495309352874756,-0.055546171963214874,0.2713284194469452,0.05269967392086983,0.22708529233932495},{0.15665088593959808,0.030724408105015755,0.0972161814570427,-0.3141647279262543,-0.08168476819992065,-0.21691830456256866,0.13161857426166534,0.30642521381378174,-0.2945767939090729,-0.2636924684047699,0.13160604238510132,-0.15117722749710083,0.05237239971756935,0.1856025904417038,-0.15177945792675018,0.33787938952445984,0.08112972229719162,-0.3334493041038513,0.11412172764539719,0.032243430614471436,0.2388240098953247,-0.385490745306015,0.3638903796672821,-0.023132091388106346,0.10894850641489029,0.2597223222255707,0.17553898692131042,0.26401469111442566,-0.10257463902235031,0.31844595074653625,-0.011465472169220448,0.060061175376176834},{0.23973357677459717,0.04139843210577965,0.3806125521659851,-0.35458189249038696,0.17116594314575195,-0.145646333694458,-0.13981105387210846,-0.28274375200271606,0.030286705121397972,0.4018445611000061,0.2024773806333542,-0.03887851536273956,0.14334581792354584,0.13963443040847778,0.04393993318080902,0.31784963607788086,-0.05047326907515526,-0.3081074357032776,-0.10538800805807114,0.002282131463289261,-0.14895440638065338,0.1294918954372406,0.04332096502184868,-0.17929577827453613,-0.11763708293437958,-0.2016105055809021,-0.1613236665725708,0.04509234055876732,-0.20067398250102997,0.030834926292300224,0.3213745057582855,0.39818140864372253},{0.21989212930202484,0.10033642500638962,-0.23690970242023468,-0.33799007534980774,-0.2562273144721985,-0.2689536511898041,0.23073743283748627,0.10075319558382034,-0.16763170063495636,0.1995314359664917,-0.41222286224365234,-0.03440629690885544,-0.16489145159721375,-0.1418021023273468,-0.18394383788108826,-0.24879227578639984,-0.42332887649536133,-0.2852662205696106,0.12688955664634705,0.17331916093826294,-0.10718125849962234,0.31856000423431396,-0.18076454102993011,-0.15328285098075867,0.1973254382610321,0.33763471245765686,0.20513984560966492,-0.20956359803676605,-0.16415898501873016,-0.3156227767467499,-0.24728481471538544,0.07091338187456131},{-0.08091461658477783,-0.10203710198402405,-0.20874646306037903,0.03002590499818325,0.24823594093322754,-0.15479066967964172,0.1603141874074936,0.35571157932281494,0.16184642910957336,0.2510903775691986,-0.12053559720516205,-0.3069012463092804,0.1036333367228508,0.10590488463640213,0.17890335619449615,0.16742224991321564,-0.3683285713195801,-0.20671407878398895,-0.14149914681911469,0.20582138001918793,-0.07506338506937027,-0.27577972412109375,-0.27668294310569763,-0.1235886812210083,0.18856751918792725,0.27914664149284363,0.28083258867263794,0.1038479134440422,-0.17298847436904907,-0.15552634000778198,0.06760797649621964,-0.20991389453411102},{0.27347663044929504,-0.0513157919049263,-0.2943056523799896,-0.0846148282289505,0.031838733702898026,0.06343772262334824,-0.04234108701348305,-0.09155863523483276,0.14969639480113983,0.355814665555954,-0.3649078607559204,0.29381635785102844,0.1741180270910263,-0.2780819237232208,0.05265609920024872,-0.28102391958236694,-0.0997607633471489,0.18133200705051422,-0.1544695496559143,0.40453243255615234,0.13016483187675476,-0.13049641251564026,-0.23020942509174347,-0.13947872817516327,-0.36642688512802124,0.11114699393510818,0.006515852641314268,0.23734505474567413,-0.037919219583272934,0.1363484412431717,0.3542652726173401,-0.19562998414039612},{0.15942907333374023,-0.17419768869876862,0.11350054293870926,-0.06734298169612885,-0.24762122333049774,-0.26656198501586914,0.21577079594135284,-0.24734027683734894,0.20552165806293488,0.14493052661418915,-0.18735654652118683,0.12340141087770462,-0.056044574826955795,0.07711241394281387,-0.13181710243225098,-0.05184478312730789,0.07226311415433884,-0.07257240265607834,-0.0025816343259066343,-0.19689999520778656,0.042285505682229996,-0.20131339132785797,-0.19773556292057037,-0.3485957980155945,0.04051918163895607,-0.20208807289600372,0.12143543362617493,0.09402810037136078,0.21892327070236206,0.07655824720859528,0.021955685690045357,-0.008803601376712322},{0.21395006775856018,-0.07470352947711945,-0.2870413661003113,0.3300291895866394,-0.1843496412038803,0.13664978742599487,0.37486129999160767,-0.2972451448440552,-0.06059606745839119,-0.32951620221138,-0.2652781307697296,-0.30444419384002686,-0.3102053701877594,-0.26315838098526,0.02176596410572529,0.3813076317310333,0.2806089222431183,-0.1859130561351776,0.050675906240940094,-0.11969054490327835,-0.15120765566825867,-0.21745023131370544,-0.2359570413827896,0.2013011872768402,-0.14159885048866272,-0.07325926423072815,-0.17613495886325836,-0.1403057724237442,-0.1200786828994751,-0.11961103230714798,-0.14417247474193573,-0.23089027404785156},{0.2570142447948456,0.25176525115966797,-0.12988387048244476,-0.12770844995975494,0.11121666431427002,0.26806676387786865,0.12974822521209717,0.07128763943910599,0.0845443606376648,-0.20569902658462524,0.16992801427841187,0.10893560945987701,0.06657946109771729,-0.06102503463625908,0.1801784336566925,0.1522689014673233,-0.05688423663377762,-0.020150834694504738,-0.21896246075630188,-0.19535626471042633,0.026052560657262802,0.17983029782772064,-0.08956000208854675,-0.3187645971775055,-0.17419427633285522,-0.013178013265132904,0.14556239545345306,-0.08680249750614166,0.11551273614168167,-0.20496083796024323,0.10311762243509293,-0.12672337889671326},{-0.3031492531299591,-0.11096702516078949,0.2062215358018875,-0.14778369665145874,0.12943008542060852,0.19032414257526398,0.20539818704128265,-0.11922670155763626,-0.08445536345243454,0.06495775282382965,0.221420019865036,0.05592606961727142,-0.07800818979740143,0.11278403550386429,-0.18794620037078857,-0.21930575370788574,0.15299370884895325,-0.1356087177991867,0.0827893540263176,0.08757616579532623,0.3181348741054535,0.19972816109657288,0.12989410758018494,-0.21058252453804016,0.14471876621246338,0.10874499380588531,0.2685457766056061,0.20547325909137726,-0.11636833101511002,-0.1498558074235916,0.05618393421173096,0.2560012638568878},{0.14154848456382751,-0.1427764743566513,-0.2506047487258911,0.04458604380488396,-0.07864895462989807,0.2259719967842102,-0.24939359724521637,0.1363373100757599,-0.29138457775115967,-0.35806506872177124,0.1662115603685379,-0.00043426075717434287,-0.08026714622974396,-0.1907474249601364,-0.06545117497444153,-0.12061113119125366,0.11394145339727402,0.10180442780256271,-0.00898617971688509,0.15564683079719543,0.04263060539960861,0.003982167690992355,0.06501802057027817,0.24302804470062256,0.14725781977176666,-0.3515142500400543,0.009763652458786964,0.07394128292798996,-0.088633693754673,-0.12651561200618744,0.12228885293006897,0.10757755488157272},{0.270442932844162,0.24477720260620117,0.20123952627182007,-0.1344403326511383,-0.2744973599910736,0.11821949481964111,-0.10625014454126358,0.24270251393318176,0.06879086047410965,0.045794397592544556,-0.09441610425710678,0.0219869427382946,0.20470790565013885,0.21963723003864288,-0.024564066901803017,-0.2471604347229004,-0.34758806228637695,0.3153424859046936,0.37590619921684265,-0.35621798038482666,-0.176785409450531,0.22661979496479034,0.24364851415157318,-0.1833605021238327,0.19159166514873505,0.016721775755286217,0.2718607783317566,0.057367388159036636,0.13888591527938843,0.04216907173395157,-0.21911664307117462,0.2384694516658783},{-0.3296224772930145,-0.0005697817541658878,-0.201558455824852,-0.05252696946263313,-0.13127391040325165,-0.20557378232479095,-0.0002980416174978018,-0.061329059302806854,-0.14985647797584534,0.15372464060783386,0.23348908126354218,0.0004769573570229113,0.04586609825491905,-0.2684425413608551,-0.2399078756570816,0.10936210304498672,-0.2615611255168915,-0.0043075778521597385,-0.21675778925418854,-0.014992709271609783,-0.03614679351449013,0.1860194206237793,0.23967809975147247,0.016190921887755394,-0.14174625277519226,-0.04801833629608154,0.061135515570640564,0.18615855276584625,0.056695714592933655,-0.22173096239566803,-0.10323285311460495,-0.05837128683924675},{0.003466301131993532,0.31821584701538086,0.042275238782167435,0.15948143601417542,0.18976972997188568,0.07026094198226929,0.13512343168258667,0.1549932211637497,-0.33458372950553894,0.07020736485719681,-0.09182791411876678,0.18246474862098694,-0.24448974430561066,0.3744302988052368,-0.019840702414512634,-0.05009114369750023,0.09257232397794724,0.1070844903588295,-0.02937384322285652,0.26255789399147034,-0.3164738416671753,0.09094264358282089,-0.07176408916711807,0.24245880544185638,0.11799739301204681,0.09672228991985321,0.1812235713005066,-0.135358989238739,0.2520996928215027,0.23647679388523102,-0.10040611773729324,-0.16270378232002258},{-0.2423257827758789,0.3158755302429199,-0.006556835025548935,0.06835392862558365,-0.22527718544006348,0.2316800355911255,0.006891383323818445,0.06894493103027344,0.09998558461666107,-0.3436239957809448,-0.11918529868125916,-0.2427336573600769,-0.15186654031276703,0.11262749135494232,0.0207904651761055,-0.2253311425447464,0.09065357595682144,0.1375647634267807,0.31359660625457764,0.14272993803024292,-0.21907788515090942,-0.2434997707605362,-0.1520247906446457,0.34555715322494507,0.3857468068599701,0.20275530219078064,0.17955563962459564,-0.04758012294769287,0.030023952946066856,0.003268030472099781,-0.32607242465019226,0.18095961213111877},{-0.11064857989549637,-0.020546194165945053,-0.12418612837791443,-0.24383656680583954,0.08134929090738297,0.12616385519504547,0.20078280568122864,0.008195239119231701,0.2649299204349518,0.09007860720157623,0.12150827795267105,-0.15725351870059967,-0.05174187570810318,-0.09226648509502411,-0.2869293987751007,-0.14715993404388428,-0.31092536449432373,-0.1753806322813034,-0.11910726130008698,-0.3137193024158478,-0.0848686695098877,0.13255208730697632,0.03513193503022194,0.23185673356056213,0.18563880026340485,0.05753762274980545,0.2973721921443939,-0.40224355459213257,-0.13859616219997406,-0.16038794815540314,0.04597285017371178,-0.03149440884590149}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.3037912845611572,-0.05948285385966301,-0.36186155676841736,-0.23486673831939697},{0.11899831891059875,-0.1910676211118698,-0.08183933049440384,0.40675175189971924},{0.06904733926057816,0.040789879858493805,-0.23440779745578766,-0.1667182445526123},{-0.3414984345436096,0.03269610181450844,0.07068310678005219,0.20491591095924377},{-0.364932656288147,0.034397926181554794,-0.13837754726409912,-0.3446846902370453},{0.2360251545906067,-0.2700967490673065,-0.3774119019508362,0.1538655310869217},{0.13113245368003845,0.04415155574679375,-0.07821158319711685,0.49720755219459534},{0.41182801127433777,0.3628361225128174,0.16215886175632477,0.046230003237724304},{-0.43174970149993896,0.30621862411499023,0.20450609922409058,0.02428576536476612},{-0.21448329091072083,-0.2902959883213043,-0.23391245305538177,-0.30141061544418335},{0.004302094224840403,0.34075483679771423,-0.2825339734554291,-0.3086434304714203},{-0.1905621588230133,-0.3073190450668335,0.1924034059047699,0.12759998440742493},{0.27348190546035767,0.34490686655044556,-0.19838546216487885,-0.49565914273262024},{0.3761671185493469,-0.04482679069042206,-0.15378066897392273,0.03073306940495968},{0.3203109800815582,0.3865865170955658,-0.48466676473617554,-0.3420908749103546},{0.018995879217982292,0.10948333144187927,-0.32811981439590454,0.04704419523477554},{-0.38607335090637207,-0.15886232256889343,-0.4438776969909668,-0.34674450755119324},{-0.12708941102027893,0.22431901097297668,0.12326554954051971,0.16906455159187317},{0.09288845956325531,0.33379921317100525,0.2695404291152954,0.11416203528642654},{-0.0827118381857872,-0.39625194668769836,0.18178550899028778,-0.24489563703536987},{0.1127014234662056,0.15693224966526031,-0.30574584007263184,-0.1653362363576889},{-0.17907166481018066,0.2549409866333008,0.4331340193748474,-0.25071242451667786},{0.399175763130188,-0.0315004326403141,-0.307378888130188,-0.14163033664226532},{0.30911120772361755,0.22440969944000244,-0.16332560777664185,-0.026613155379891396},{0.4196949601173401,0.40968528389930725,0.28216850757598877,0.1309760957956314},{0.3477717638015747,-0.3191966116428375,0.26874443888664246,-0.09935084730386734},{-0.20755203068256378,0.35348984599113464,0.3639352321624756,0.10391184687614441},{-0.19557826220989227,-0.2780347168445587,-0.06554117053747177,-0.39648282527923584},{-0.2917191982269287,0.2337414026260376,-0.33729031682014465,0.4078783094882965},{0.16724126040935516,-0.33403846621513367,-0.4739505648612976,-0.17865625023841858},{-0.0657837837934494,-0.17193414270877838,-0.003714968916028738,0.08802229911088943},{0.16898411512374878,0.07346981018781662,-0.34626078605651855,-0.24666011333465576}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.023572871461510658,-0.10894708335399628,-0.008605153299868107,-0.04266941174864769,0.114751897752285,-0.006349355913698673,0.09631189703941345,0.02716798335313797,0.146953284740448,0.07794923335313797,0.07415397465229034,0.03869186341762543,-0.04029756039381027,0.012681796215474606,-0.08766494691371918,0.01032764557749033};
static const float actor_encoder_self_encoder_2_bias[16] = {0.002511685946956277,-0.01864611729979515,0.010529241524636745,-0.022454936057329178,0.018616629764437675,0.03766196593642235,-0.019013095647096634,0.042174164205789566,-0.02176877111196518,-0.021033966913819313,0.002091696485877037,0.051005661487579346,-0.026695502921938896,-0.024390393868088722,-0.026272742077708244,-0.012345761060714722};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.015199624001979828,0.021685505285859108,0.024314574897289276,-0.012699732556939125,-0.045248787850141525,0.0142958490177989,0.02799748070538044,0.030957121402025223,0.0014011119492352009,-0.047158848494291306,-0.028843993321061134,0.00161812047008425,-0.001259359298273921,-0.013976959511637688,0.012649547308683395,0.014363172464072704,-0.05547424778342247,0.0022395052947103977,0.02136208303272724,-0.04131050407886505,-0.026486126706004143,-0.0011890928726643324,-0.017916103824973106,0.022156724706292152,0.037361253052949905,-0.027066679671406746,0.0008950031478889287,-0.04996028542518616,-0.00012251664884388447,-0.007096060551702976,0.02257455699145794,-0.034061249345541};
static const float action_parameterization_distribution_linear_bias[4] = {0.027180636301636696,0.021616579964756966,0.020358966663479805,0.03315677121281624};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-0.6776106953620911,0.8529269099235535,-0.04910527542233467,0.4101763069629669,0.5800256133079529,-0.02141445130109787,0.5070291757583618,-0.6518012881278992},{0.20789453387260437,0.5249688625335693,0.7648240923881531,-0.407023161649704,0.29482725262641907,-0.35189157724380493,0.1861034333705902,0.6191200613975525},{0.2457587718963623,0.41399911046028137,-0.36456382274627686,0.08392617851495743,-0.18007174134254456,0.3634829521179199,-0.9159567356109619,0.01656511425971985}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.335183709859848,-0.6452785134315491,0.14822931587696075,-0.6259123682975769,0.7610573768615723,-0.46047163009643555,-0.04318244382739067,0.45905908942222595},{0.3016650974750519,-0.23949477076530457,-0.4413178265094757,-0.5994863510131836,-0.2616921663284302,0.6170915961265564,-0.6492633819580078,-0.4434019923210144},{-0.22576798498630524,-0.04323892667889595,-0.4084027409553528,-0.4949500262737274,0.7819055318832397,0.7133876085281372,0.5449093580245972,0.04674610495567322},{-0.29461267590522766,0.3221176564693451,-0.4574916660785675,-0.20808471739292145,-0.7609615325927734,0.03426028788089752,-0.1576930731534958,0.6053848266601562},{-0.6387492418289185,-0.0954277366399765,0.15860961377620697,0.1072932705283165,-0.49787214398384094,0.30143994092941284,0.0005926589947193861,0.5001484155654907},{0.26262348890304565,-0.3812026083469391,-0.2361016571521759,-0.2960057556629181,0.048264045268297195,0.4429016709327698,-0.4730052351951599,-0.122007817029953},{0.3426388204097748,-0.4350318908691406,0.03886367380619049,0.10573183745145798,-0.3339426815509796,0.5481376051902771,-0.15971118211746216,0.637761116027832},{-0.14484117925167084,0.5011087656021118,-0.1680445522069931,-0.15064749121665955,0.6403691172599792,-0.5511330366134644,0.10895490646362305,0.18462327122688293}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {0.025005435571074486,0.008069421164691448,-0.017720747739076614,-0.023146124556660652,0.013682423159480095,0.0069738044403493404,-0.005583126563578844,0.0047738682478666306};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {0.00493126455694437,-0.03971835598349571,-0.024447690695524216,-0.009578137658536434,-0.026704298332333565,-0.019987983629107475,0.00896113459020853,0.004769110586494207};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
