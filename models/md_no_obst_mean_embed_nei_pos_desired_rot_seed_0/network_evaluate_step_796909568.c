#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.16812695562839508,0.24113988876342773,0.1502274125814438,-0.13186992704868317,0.07803114503622055,-0.2791851758956909,-0.005592487286776304,-0.5590522289276123,-0.019498664885759354,-0.2115367352962494,-0.13153961300849915,0.12168727815151215,-0.25840628147125244,0.08238663524389267,0.28526219725608826,-0.17083047330379486},{-0.018445037305355072,-0.017976924777030945,-0.015886249020695686,-0.18925875425338745,0.32445356249809265,0.11023005098104477,0.058837275952100754,0.004721505101770163,-0.1497565507888794,0.03922921419143677,-0.16346459090709686,0.09296220541000366,0.2663562595844269,-0.02162904292345047,0.08264617621898651,-0.09361805766820908},{-0.236583411693573,-0.3387092351913452,0.3004750609397888,-0.09099096804857254,-0.14035990834236145,0.3683147728443146,-0.48315513134002686,0.3932398855686188,-0.43673643469810486,-0.4613043963909149,-0.2957072854042053,-0.3449356257915497,-0.309992253780365,0.09570008516311646,-0.43225017189979553,-0.460795521736145},{-0.33727017045021057,-0.08191105723381042,-0.005045544821768999,0.17171935737133026,0.1355137825012207,0.0008651022217236459,0.2512455880641937,-0.17523685097694397,-0.15154168009757996,0.004022480454295874,-0.3173980712890625,-0.056370895355939865,-0.139112651348114,0.40112191438674927,-0.24046263098716736,0.04188505932688713},{0.08459567278623581,-0.037102602422237396,0.13130071759223938,-0.3019239902496338,0.37828052043914795,0.4475674331188202,-0.084326833486557,-0.09439372271299362,0.004161763936281204,0.3098090887069702,0.037628527730703354,-0.020015917718410492,0.22650855779647827,-0.0026240802835673094,-0.21601688861846924,-0.2616013288497925},{0.08922958374023438,0.13194255530834198,0.15690715610980988,-0.11521950364112854,-0.17621369659900665,-0.06879942864179611,-0.17561206221580505,0.11127042025327682,-0.16804292798042297,0.19434484839439392,-0.20382052659988403,-0.29215243458747864,-0.10525742918252945,0.03977547213435173,-0.2288733571767807,0.020326092839241028},{-0.3206788897514343,-0.4710628390312195,0.06508839875459671,-0.2525397837162018,-0.34037184715270996,-0.11422406882047653,0.26581045985221863,0.3643929064273834,-0.6299469470977783,-0.08985419571399689,-0.09112441539764404,0.0891561508178711,-0.420917272567749,-0.06331402063369751,0.2996906638145447,0.06321901082992554},{-0.1201319471001625,0.60975182056427,0.4431404769420624,0.29668688774108887,-0.2721526324748993,0.23580196499824524,0.49159833788871765,0.6934601664543152,0.11261621862649918,0.03677256405353546,0.08593352138996124,0.15422509610652924,-0.151492178440094,-0.5401482582092285,0.24195317924022675,0.44605496525764465},{-0.46172645688056946,-0.01291405688971281,0.19505827128887177,-0.14889965951442719,0.06062370911240578,0.15756921470165253,0.14042845368385315,-0.22978486120700836,-0.24837644398212433,-0.4139898121356964,-0.013755074702203274,0.27569568157196045,0.03758317977190018,0.3135196566581726,0.2148798108100891,-0.18873430788516998},{0.7103202939033508,-0.1199946179986,-0.6364279985427856,-0.19722984731197357,0.212889164686203,0.04894820600748062,-0.6459398865699768,-0.8046537041664124,-0.5670644640922546,0.4039369821548462,0.09169846773147583,0.42113161087036133,-0.5877976417541504,0.5638633370399475,-0.6768521666526794,-0.08318978548049927},{0.449007511138916,-0.25579747557640076,-0.031150244176387787,0.3774382472038269,-0.34970414638519287,0.2458776980638504,0.35282930731773376,0.35819509625434875,-0.3982882797718048,-0.3235752284526825,-0.407466322183609,0.3330746591091156,-0.2359442263841629,-0.30229079723358154,-0.21294493973255157,0.20284581184387207},{0.19745606184005737,-0.27370160818099976,-0.2099590003490448,-0.6296452283859253,0.4029397666454315,0.04877018928527832,-0.1496669054031372,-0.375927597284317,-0.35176748037338257,-0.5409103631973267,-0.5291563272476196,-0.26907777786254883,0.12578852474689484,-0.3194175064563751,0.4590364694595337,0.3673325479030609},{0.07914260029792786,-0.5682455897331238,-0.3730376958847046,0.08735914528369904,0.23983962833881378,0.15508000552654266,0.2892245352268219,-0.3682222366333008,0.13194239139556885,-0.4454888105392456,0.06174507737159729,-0.32782691717147827,0.4745914041996002,-0.8392641544342041,-0.1797167956829071,-0.056438468396663666},{0.05452679842710495,-0.2893710732460022,-0.5419912338256836,0.648043155670166,-0.2163703739643097,-0.049774859100580215,-0.06149673089385033,-0.05664925277233124,-0.09856093674898148,-0.2455596923828125,0.22665932774543762,-0.08635001629590988,-0.498856782913208,-0.002097555436193943,0.3238735496997833,-0.5387768745422363},{-0.1294863522052765,0.001275563146919012,-0.2536817789077759,0.2540295422077179,0.3697424829006195,-0.29324808716773987,0.2778259813785553,0.2517072856426239,-0.2320871353149414,0.04472888261079788,0.23432327806949615,0.10027158260345459,-0.18629546463489532,-0.4150751233100891,0.1263740509748459,0.17742186784744263},{-0.2528318464756012,0.13347503542900085,-0.17019438743591309,0.2501305937767029,-0.03256577253341675,-0.2755836248397827,0.2059098333120346,0.13707956671714783,-0.012561404146254063,-0.13140583038330078,0.0024607521481812,-0.0375230498611927,-0.2283875048160553,-0.13547584414482117,-0.2452320158481598,-0.20454226434230804},{-0.23839545249938965,0.14137862622737885,0.057333726435899734,-0.006222110241651535,-0.33579206466674805,0.0997934639453888,-0.19231867790222168,0.12038720399141312,-0.23826086521148682,0.08266343176364899,-0.0358218215405941,0.29421669244766235,0.17562511563301086,0.2598945200443268,0.3730514943599701,-0.2707870304584503},{0.1980590671300888,-0.23192402720451355,-0.15681028366088867,-0.03340259566903114,-0.3250221312046051,-0.3003033697605133,-0.32825592160224915,-0.2008768916130066,-0.15960098803043365,0.0051901452243328094,-0.3306495249271393,0.024734634906053543,-0.03591534122824669,0.2175295501947403,-0.11856034398078918,-0.33476191759109497}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.1445731669664383,0.2486596256494522,0.034342896193265915,0.470027893781662,0.12952812016010284,-0.09677479416131973,-0.1819659173488617,-0.3591405749320984,-0.05430823937058449,-0.0984792411327362,0.22113899886608124,0.04517659172415733,0.33855485916137695,0.07697566598653793,-0.4219854772090912,-0.3421035408973694},{-0.25116878747940063,0.23656855523586273,-0.22125083208084106,-0.044210970401763916,0.13577935099601746,-0.004033091943711042,-0.4409295320510864,0.09632711857557297,0.2912733852863312,0.11794079840183258,-0.011165077798068523,-0.006368753965944052,-0.2079012095928192,-0.08128482848405838,-0.3175950050354004,-0.07099645584821701},{0.5359513759613037,0.37865298986434937,-0.3793727457523346,-0.5889973044395447,0.27724266052246094,-0.2914901673793793,-0.5367457270622253,0.2573988437652588,0.33593663573265076,-0.2766817808151245,0.20456461608409882,-0.34323766827583313,-0.14982293546199799,-0.1682153046131134,0.46367743611335754,0.4405990540981293},{0.2683537006378174,-0.1330895721912384,-0.27419230341911316,0.315512478351593,-0.2272825837135315,0.2283376306295395,0.07653267681598663,-0.10007408261299133,-0.09442295879125595,0.2909630835056305,0.33756986260414124,-0.4520788788795471,0.13734817504882812,-0.2489023059606552,-0.384366512298584,-0.009653541259467602},{0.08000384271144867,0.24965524673461914,-0.006076711695641279,-0.06529542803764343,0.05923858657479286,0.01842780038714409,-0.1845303177833557,0.20609180629253387,-0.1821414679288864,-0.3522995412349701,-0.32479289174079895,0.21736547350883484,0.23010887205600739,-0.10250696539878845,0.2536802589893341,0.05855702608823776},{0.36923813819885254,0.07743319123983383,-0.23947909474372864,-0.11323542892932892,0.18839971721172333,0.24574407935142517,-0.17544075846672058,-0.3396349549293518,-0.11187100410461426,0.18279163539409637,-0.0946100726723671,-0.019349483773112297,-0.26798298954963684,0.3494531214237213,0.13987275958061218,-0.13852784037590027},{0.2364024966955185,-0.3510935306549072,-0.38620132207870483,-0.27281057834625244,-0.004395134747028351,0.28192806243896484,-0.3593398332595825,0.02078929729759693,0.14928790926933289,0.12625914812088013,-0.028119612485170364,0.33232852816581726,0.2938360869884491,-0.13362543284893036,0.23238953948020935,0.26961761713027954},{-0.31524211168289185,0.33784323930740356,-0.09936868399381638,0.4152638912200928,-0.016127871349453926,0.07348868995904922,0.4265749156475067,0.40631958842277527,-0.1152639240026474,-0.23551850020885468,0.33740949630737305,-0.3909566104412079,-0.08009205013513565,-0.20151282846927643,-0.2498902529478073,-0.10880541801452637},{-6.675046461168677e-05,-0.32190707325935364,-0.028094284236431122,0.16443167626857758,0.1274898797273636,0.21159547567367554,0.0013986020348966122,0.4484378397464752,0.0650976300239563,0.20009763538837433,-0.2947700321674347,-0.16141338646411896,0.23834282159805298,-0.4190959334373474,0.2927019000053406,0.03786521404981613},{-0.08314507454633713,-0.06825695186853409,-0.16863958537578583,0.24443939328193665,-0.325957715511322,-0.006201904732733965,0.314994752407074,0.21576400101184845,0.1843099147081375,-0.21341797709465027,-0.16845254600048065,0.009960529394447803,-0.20020052790641785,0.05681232735514641,-0.396945059299469,-0.05865982174873352},{-0.12477486580610275,-0.1630062758922577,0.13993486762046814,0.28487536311149597,-0.16870494186878204,-0.21853527426719666,0.32863423228263855,-0.11129070818424225,-0.16192187368869781,0.031832125037908554,-0.055424828082323074,-0.3121292293071747,-0.3453892171382904,-0.5239553451538086,-0.3266957402229309,-0.030343225225806236},{-0.007861522026360035,-0.5072190165519714,0.3048768937587738,-0.13295604288578033,0.08377979695796967,0.09336786717176437,-0.33402934670448303,-0.2594314515590668,0.20034073293209076,0.15668772161006927,-0.4791417419910431,0.37953054904937744,-0.21245644986629486,-0.10547156631946564,0.20858703553676605,0.08480225503444672},{-0.15094523131847382,0.06710248440504074,-0.3353363871574402,0.1510448157787323,0.1572084277868271,0.07415057718753815,0.3226243555545807,-0.2576811611652374,-0.1398838758468628,-0.08996690064668655,-0.3688123822212219,0.41333532333374023,0.4061950743198395,0.1781076043844223,0.04156007990241051,0.275103896856308},{-0.353654146194458,-0.028719577938318253,0.28169703483581543,-0.3600975573062897,0.41770458221435547,-0.5235783457756042,-0.12667961418628693,-0.17183321714401245,0.2698896825313568,0.2045474797487259,0.30303460359573364,0.3648369014263153,-0.2007458209991455,-0.22065426409244537,-0.26248741149902344,0.2434927523136139},{-0.11030901223421097,-0.18881653249263763,-0.29825150966644287,0.20410190522670746,-0.06855670362710953,0.45599159598350525,0.2577349841594696,0.29918938875198364,0.2050500065088272,0.02456922084093094,-0.18643376231193542,-0.18270759284496307,0.25052547454833984,0.13896557688713074,-0.0031785869505256414,0.17791420221328735},{-0.16408716142177582,0.25495731830596924,-0.08841326832771301,-0.21578215062618256,0.06028464436531067,0.01994038000702858,0.1481039673089981,0.21899466216564178,-0.1493017077445984,-0.11736239492893219,-0.18168355524539948,0.2704526484012604,0.11191271990537643,-0.23609423637390137,-0.35702475905418396,0.06765107065439224}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.06561575084924698,0.0212382934987545,0.030959399417042732,0.1950835883617401,0.37012043595314026,-0.07962127774953842,-0.1259012669324875,0.052523378282785416,-0.22773055732250214,-0.06900528073310852,-0.0005802641971968114,0.19362719357013702,0.2525950074195862,-0.07542692124843597,0.22769132256507874,0.08167847990989685,0.19671103358268738,0.05945460870862007,0.02228184975683689,0.010782206431031227,0.25808003544807434,-0.22728337347507477,-0.27069419622421265,-0.27828821539878845,-0.12812218070030212,0.12822799384593964,-0.2815251052379608,-0.21677090227603912,0.20533370971679688,-0.1353166103363037,-0.2674827575683594,-0.16873176395893097},{0.240056574344635,0.08439986407756805,0.2663017511367798,0.31764230132102966,0.40974706411361694,-0.016947176307439804,0.16156698763370514,-0.3532191216945648,0.17027661204338074,0.11038913577795029,-0.08070733398199081,-0.2840959131717682,-0.18385004997253418,-0.1180621087551117,-0.30561360716819763,0.36920836567878723,0.18581455945968628,-0.2783130705356598,0.14740951359272003,0.13176223635673523,0.00020055925415363163,0.2450474500656128,-0.2268233448266983,0.15878815948963165,0.07003208249807358,-0.3788307309150696,-0.21421529352664948,0.37123504281044006,-0.22205515205860138,0.035952698439359665,0.25160685181617737,-0.1131439134478569},{0.20891383290290833,-0.024746717885136604,-0.17062033712863922,-0.26557081937789917,-0.29095086455345154,-0.1559305489063263,-0.3297775983810425,0.08773735910654068,-0.4047480523586273,-0.15176264941692352,0.09675741195678711,0.3273533582687378,0.11559325456619263,-0.08766620606184006,-0.2031867802143097,0.09932508319616318,0.293705016374588,-0.19931170344352722,-0.18140792846679688,0.27285826206207275,-0.2522943615913391,-0.07006817311048508,0.0035699752625077963,-0.08898848295211792,-0.041713181883096695,0.3945704400539398,-0.33049067854881287,0.25718072056770325,-0.46778836846351624,-0.10865965485572815,0.04731697961688042,0.05082952231168747},{0.22323966026306152,-0.32585468888282776,-0.09438907355070114,0.18554864823818207,0.11937978863716125,-0.182522252202034,0.2919033169746399,0.07842619717121124,0.12432219833135605,-0.04857070371508598,0.03878609463572502,-0.0551944337785244,0.3141464293003082,0.18636801838874817,-0.18458805978298187,-0.185207337141037,-0.15971165895462036,0.1549583226442337,0.1859532594680786,-0.010812857188284397,0.01144043542444706,0.35795706510543823,-0.0700032114982605,-0.20839102566242218,0.06814908236265182,0.13706718385219574,0.12955933809280396,0.05655805394053459,-0.36864370107650757,-0.3357376158237457,0.11670168489217758,0.18307723104953766},{-0.050994403660297394,0.1640186458826065,0.024924386292696,0.05106818303465843,0.08536926656961441,0.24473294615745544,0.1950475573539734,-0.1474052220582962,-0.04686775058507919,0.050242938101291656,-0.13665586709976196,0.04089239612221718,-0.23273660242557526,0.1848711520433426,0.023968519642949104,0.26076215505599976,0.06735093891620636,0.011944767087697983,0.06870725005865097,0.08943702280521393,0.1556454300880432,-0.05787229910492897,-0.2702586054801941,-0.22978563606739044,0.04786166176199913,0.14564770460128784,0.14236518740653992,0.006858089938759804,0.17581431567668915,-0.1779640018939972,-0.22889642417430878,0.26263296604156494},{-0.2578594982624054,0.22795748710632324,0.0030253310687839985,-0.051316507160663605,-0.3343150019645691,-0.2659299671649933,-0.12377556413412094,0.08285276591777802,0.24364972114562988,-0.15769939124584198,0.09907077252864838,-0.36612093448638916,-0.10700298845767975,0.05063719302415848,0.10232461243867874,-0.1485518515110016,-0.18386296927928925,0.03846984729170799,0.11671150475740433,-0.35230526328086853,0.21292035281658173,-0.05419561639428139,0.024438273161649704,-0.14956612884998322,0.18383720517158508,0.07518799602985382,0.014080752618610859,0.07878538221120834,0.08130505681037903,-0.05130411311984062,-0.32117316126823425,-0.22035302221775055},{0.042890481650829315,-0.0409390963613987,0.0731150433421135,-0.20044554769992828,-0.21700777113437653,0.11626458168029785,-0.249486044049263,-0.07449860870838165,-0.13073453307151794,0.23154878616333008,-0.21429654955863953,0.034858375787734985,0.2703132629394531,0.07761125266551971,-0.27295467257499695,-0.13339857757091522,0.011920868419110775,0.14410939812660217,0.10946633666753769,0.2267199009656906,-0.22521880269050598,0.15220406651496887,0.01035090908408165,0.10483094304800034,0.25247740745544434,-0.1497046798467636,-0.03482310473918915,0.27271220088005066,0.0404101125895977,-0.25393232703208923,-0.3062824010848999,0.24164153635501862},{0.07780271768569946,0.2185690551996231,0.11688337475061417,0.11223999410867691,-0.1681218445301056,-0.3383161127567291,0.1686430126428604,-0.2468678057193756,-0.08190491795539856,-0.21146942675113678,0.24662888050079346,-0.07487580925226212,-0.06300566345453262,-0.08415090292692184,0.25377705693244934,0.10686229169368744,0.08371137082576752,-0.04208265244960785,-0.3292643427848816,0.10626432299613953,-0.3051983118057251,-0.051355909556150436,-0.21905310451984406,0.18546508252620697,0.0342375673353672,-0.02659272588789463,0.1811710000038147,0.018714068457484245,0.05473565682768822,-0.18555840849876404,-0.17010065913200378,0.2598492503166199},{0.1737881749868393,0.38754454255104065,-0.16055098176002502,0.2849579155445099,0.001618985435925424,0.10808449238538742,0.4610769748687744,-0.32080167531967163,-0.042789675295352936,-0.10815291851758957,0.19693692028522491,-0.1278211772441864,-0.020678970962762833,0.2625023126602173,-0.10605243593454361,0.23901325464248657,0.2374090850353241,0.2540648281574249,0.19276024401187897,0.166591078042984,-0.2592286169528961,-0.1945560872554779,0.07712607830762863,0.1994747817516327,0.11605201661586761,0.287039190530777,-0.33943605422973633,-0.35311824083328247,-0.06788398325443268,0.2326056957244873,0.021674733608961105,0.18435533344745636},{0.07293682545423508,0.02588396519422531,0.008774046786129475,-0.2669529318809509,-0.11137855798006058,-0.28393909335136414,0.14753195643424988,0.3211348354816437,-0.22406631708145142,-0.313772052526474,0.09043789654970169,-0.08987566828727722,0.00548141822218895,0.11664199084043503,-0.19658152759075165,0.2537044286727905,0.00822495948523283,-0.28216078877449036,0.20077291131019592,0.03197028860449791,0.16823874413967133,-0.30624350905418396,0.2749982476234436,-0.08798408508300781,0.1551118940114975,0.27858495712280273,0.2952144742012024,0.22847819328308105,-0.1224224790930748,0.23166748881340027,0.010624063201248646,-0.019698483869433403},{0.18575499951839447,0.031566817313432693,0.3279489278793335,-0.32767966389656067,0.18572627007961273,-0.16768167912960052,-0.1635812371969223,-0.2620929777622223,0.03787560015916824,0.3797512948513031,0.16324244439601898,-0.029076596722006798,0.11245589703321457,0.14893539249897003,-0.002369558671489358,0.30963748693466187,-0.057460717856884,-0.2958197593688965,-0.09520218521356583,-0.004051157273352146,-0.1776522845029831,0.13835643231868744,0.016619009897112846,-0.22190633416175842,-0.11728452891111374,-0.19477275013923645,-0.1718151718378067,0.053127750754356384,-0.20558229088783264,-0.006579259410500526,0.33168357610702515,0.36910927295684814},{0.24354711174964905,0.056845758110284805,-0.1650952398777008,-0.354787677526474,-0.19351574778556824,-0.274400532245636,0.21069800853729248,0.07315022498369217,-0.16799724102020264,0.24175505340099335,-0.3408549427986145,-0.07667718082666397,-0.12081150710582733,-0.13546419143676758,-0.09401260316371918,-0.21238119900226593,-0.37148717045783997,-0.30084729194641113,0.10792237520217896,0.17987734079360962,-0.04756579175591469,0.3496771454811096,-0.17944051325321198,-0.10783941298723221,0.1737012267112732,0.3113517463207245,0.2069694697856903,-0.15972039103507996,-0.15077906847000122,-0.2738242745399475,-0.2798023223876953,0.1385297179222107},{-0.06309334188699722,-0.07231025397777557,-0.17976269125938416,0.03802366927266121,0.2388821393251419,-0.10807295143604279,0.19781634211540222,0.3395616412162781,0.14680856466293335,0.2660481631755829,-0.11882239580154419,-0.2999116778373718,0.07860047370195389,0.10696841776371002,0.20244130492210388,0.19461026787757874,-0.3718624711036682,-0.19092150032520294,-0.1678593009710312,0.2103457897901535,-0.07789667695760727,-0.3336932361125946,-0.26606735587120056,-0.11016613245010376,0.16459089517593384,0.2820810377597809,0.25405019521713257,0.09699506312608719,-0.1501038819551468,-0.1351085752248764,0.11407478153705597,-0.1860564947128296},{0.27568119764328003,-0.06126062572002411,-0.29881551861763,-0.08234112709760666,0.020556343719363213,0.059628941118717194,-0.04359985142946243,-0.052717626094818115,0.15758812427520752,0.3287309408187866,-0.3473834693431854,0.24794985353946686,0.184087336063385,-0.24870145320892334,0.058636005967855453,-0.24416448175907135,-0.10574798285961151,0.17663171887397766,-0.1414412558078766,0.3452770411968231,0.13723857700824738,-0.15426017343997955,-0.21406130492687225,-0.12735992670059204,-0.333612322807312,0.10336264222860336,-0.017540358006954193,0.21017974615097046,-0.025495639070868492,0.12951591610908508,0.32728368043899536,-0.1975945234298706},{0.19474032521247864,-0.1897473931312561,0.15004026889801025,-0.08974868059158325,-0.23798711597919464,-0.23222000896930695,0.17949265241622925,-0.2550143003463745,0.18765698373317719,0.17183524370193481,-0.1559690535068512,0.12045156955718994,-0.03314534202218056,0.06680361926555634,-0.11670289188623428,-0.05110728368163109,0.09658113867044449,-0.10311059653759003,-0.036829110234975815,-0.17751629650592804,0.025202030315995216,-0.26124221086502075,-0.16164860129356384,-0.3772951662540436,0.01618408039212227,-0.19970352947711945,0.08173104375600815,0.1376197636127472,0.1862250417470932,0.08812267333269119,0.04935170337557793,0.022500047460198402},{0.20599861443042755,-0.13885807991027832,-0.26326337456703186,0.2705317735671997,-0.16651852428913116,0.08227411657571793,0.3380905091762543,-0.2928757965564728,-0.04309805855154991,-0.3362388014793396,-0.21431384980678558,-0.3468813896179199,-0.24258281290531158,-0.25337374210357666,0.07705115526914597,0.3676029443740845,0.2929536998271942,-0.19988960027694702,0.07768673449754715,-0.0992920994758606,-0.11810588836669922,-0.13699354231357574,-0.23764464259147644,0.23116017878055573,-0.1270117461681366,-0.08255429565906525,-0.1241115853190422,-0.12750881910324097,-0.16440387070178986,-0.12248335033655167,-0.19883595407009125,-0.20898282527923584},{0.2734524607658386,0.4449383020401001,-0.20751702785491943,-0.1506490856409073,-0.06353659927845001,0.40915647149086,0.33369675278663635,0.10309962928295135,-0.054810866713523865,-0.2799074053764343,0.021779783070087433,0.2046089470386505,-0.06572636216878891,0.012776066549122334,0.1410101354122162,0.10473279654979706,-0.17451240122318268,-0.035552337765693665,-0.23468708992004395,-0.17586980760097504,-0.05666988715529442,0.03657437115907669,-0.06377628445625305,-0.28272250294685364,-0.14741934835910797,0.12401721626520157,0.06736545264720917,-0.18375322222709656,0.0955481231212616,-0.17131464183330536,0.2997954487800598,-0.17405469715595245},{-0.3280945122241974,-0.10179545730352402,0.15912730991840363,0.03487691655755043,0.23617179691791534,0.14872391521930695,0.18673714995384216,-0.29039207100868225,0.003619861090555787,0.13387396931648254,0.21633471548557281,0.17699754238128662,-0.19175457954406738,0.0057111093774437904,-0.2853667438030243,-0.19307872653007507,0.25830453634262085,-0.0877554714679718,0.006424112245440483,0.10868652164936066,0.2437409609556198,0.2311534285545349,0.025692757219076157,-0.32191601395606995,-0.0046493979170918465,-0.0028721492271870375,0.29424843192100525,0.26779553294181824,0.004385610576719046,-0.16339536011219025,0.14103195071220398,0.1857965886592865},{0.22736239433288574,-0.15638627111911774,-0.15783880650997162,-0.010360066778957844,-0.04987039417028427,0.27106451988220215,-0.2838599681854248,0.14015400409698486,-0.363653302192688,-0.2869138717651367,0.19953739643096924,-0.045416321605443954,-0.04806777834892273,-0.1776103526353836,-0.04109679162502289,-0.09250231832265854,0.1744186133146286,0.02603212557733059,-0.0717134103178978,0.1874542534351349,0.08754129707813263,-0.08759436756372452,0.1246517077088356,0.25923120975494385,0.10502903163433075,-0.3364376127719879,-0.10879910737276077,0.13002802431583405,-0.12910164892673492,-0.060848724097013474,0.12860262393951416,0.17583927512168884},{0.31293413043022156,0.2101524919271469,0.17555703222751617,-0.06811752915382385,-0.2539180517196655,0.08453493565320969,-0.15927013754844666,0.17256592214107513,0.09262993931770325,0.058262214064598083,-0.09047402441501617,0.08967260271310806,0.1746928095817566,0.20558351278305054,-0.07794161140918732,-0.2701517939567566,-0.3137802183628082,0.32083603739738464,0.3624819219112396,-0.30750730633735657,-0.23448322713375092,0.27791115641593933,0.19671067595481873,-0.20673100650310516,0.1556244194507599,0.008139487355947495,0.28937092423439026,0.10555047541856766,0.13755904138088226,0.022052377462387085,-0.20782366394996643,0.19148148596286774},{-0.38400882482528687,-0.011555975303053856,-0.19086207449436188,-0.07131249457597733,-0.10268276929855347,-0.22048388421535492,0.005904411431401968,-0.028498772531747818,-0.13497820496559143,0.17178158462047577,0.24835163354873657,-0.02943919412791729,0.06284468621015549,-0.3308562636375427,-0.23938603699207306,0.10033717006444931,-0.2595389187335968,0.010060877539217472,-0.20970548689365387,-0.025504373013973236,-0.017923975363373756,0.17355072498321533,0.23996302485466003,-0.01564023643732071,-0.14192357659339905,-0.06210817024111748,0.06017777696251869,0.18337322771549225,0.053541310131549835,-0.2345295399427414,-0.10690923780202866,-0.04235277697443962},{0.014984996058046818,0.3037514090538025,0.05126624181866646,0.14309310913085938,0.17346619069576263,0.09764336794614792,0.09857276827096939,0.14341838657855988,-0.3420887291431427,0.07770910859107971,-0.07475607097148895,0.15527641773223877,-0.2065133899450302,0.46314841508865356,-0.011969402432441711,-0.0038603167049586773,0.11751021444797516,0.07825855910778046,-0.04523559287190437,0.24649640917778015,-0.28645217418670654,0.08118650317192078,-0.03657055273652077,0.23971864581108093,0.12006077915430069,0.07226526737213135,0.1705879271030426,-0.12268971651792526,0.2691028118133545,0.2750878632068634,-0.1443217694759369,-0.14467895030975342},{-0.23409470915794373,0.3231652081012726,0.04286482557654381,0.02215096727013588,-0.22252926230430603,0.25991591811180115,0.0020335593726485968,0.09469307959079742,0.056437600404024124,-0.30931395292282104,-0.1082436814904213,-0.28704148530960083,-0.12638777494430542,0.11707088351249695,0.0157716516405344,-0.20109568536281586,0.11877115070819855,0.10587243735790253,0.2777482569217682,0.14278191328048706,-0.18694473803043365,-0.31974315643310547,-0.10314582288265228,0.3179785907268524,0.3703863322734833,0.2063072919845581,0.10192329436540604,-0.030267033725976944,0.022129468619823456,0.04106346145272255,-0.3198431730270386,0.22469282150268555},{-0.07985598593950272,-0.04527360945940018,-0.11920242756605148,-0.25853028893470764,0.05648205056786537,0.13595019280910492,0.15409724414348602,0.01907760091125965,0.24291691184043884,0.08504795283079147,0.14594852924346924,-0.17049279808998108,-0.014709982089698315,-0.01792883314192295,-0.3199564814567566,-0.11287027597427368,-0.293233186006546,-0.19077414274215698,-0.1316213756799698,-0.3234509825706482,-0.07751680165529251,0.11411803215742111,0.06766747683286667,0.2123330682516098,0.19494286179542542,0.050015587359666824,0.26609155535697937,-0.380967915058136,-0.14229430258274078,-0.14855507016181946,0.023379605263471603,-0.03113587759435177}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2918693721294403,-0.052100591361522675,-0.29846328496932983,-0.2078426480293274},{0.07418844848871231,-0.14133082330226898,-0.045295748859643936,0.2595381438732147},{0.03202825412154198,0.02925046905875206,-0.14894144237041473,-0.11341406404972076},{-0.25237929821014404,0.05231628194451332,0.06283766031265259,0.12692303955554962},{-0.30438947677612305,0.05532132089138031,-0.10362660139799118,-0.26072394847869873},{0.22756853699684143,-0.22499987483024597,-0.3266613781452179,0.1414635181427002},{0.11808240413665771,0.04945382475852966,-0.03694210574030876,0.3884941339492798},{0.3637443482875824,0.2637487053871155,0.11933667212724686,0.06667236238718033},{-0.333102822303772,0.23560987412929535,0.17615550756454468,0.025850310921669006},{-0.20335857570171356,-0.21081264317035675,-0.23188413679599762,-0.2737598419189453},{-0.015245521441102028,0.26862186193466187,-0.21472609043121338,-0.24145962297916412},{-0.18170876801013947,-0.2617568075656891,0.15466326475143433,0.14905939996242523},{0.21972942352294922,0.23172244429588318,-0.12981054186820984,-0.3209457993507385},{0.32539188861846924,-0.06651120632886887,-0.12370947748422623,0.05851497873663902},{0.309307336807251,0.3134888708591461,-0.39221495389938354,-0.3078806400299072},{0.03184173256158829,0.11904746294021606,-0.1777927130460739,0.046156417578458786},{-0.3639099895954132,-0.09461979568004608,-0.3354118764400482,-0.2971217632293701},{-0.10253003239631653,0.1526767611503601,0.10176908224821091,0.14746147394180298},{0.04433940351009369,0.2902536690235138,0.22666552662849426,0.048995018005371094},{-0.08193974941968918,-0.29029837250709534,0.09698941558599472,-0.19184421002864838},{0.10832817107439041,0.1496930867433548,-0.18862563371658325,-0.11897773295640945},{-0.16663697361946106,0.211478590965271,0.33199530839920044,-0.21319128572940826},{0.30537521839141846,-0.015644298866391182,-0.22653314471244812,-0.11460727453231812},{0.25632143020629883,0.21318846940994263,-0.1726401001214981,-0.0660240575671196},{0.3320673704147339,0.3113974928855896,0.19187791645526886,0.08279121667146683},{0.24103790521621704,-0.2796993851661682,0.2133101224899292,-0.05711087957024574},{-0.1895546317100525,0.24687965214252472,0.2707872986793518,0.08648296445608139},{-0.1436244249343872,-0.21764324605464935,-0.08453413099050522,-0.2630070149898529},{-0.2264823615550995,0.20988725125789642,-0.23816971480846405,0.29436445236206055},{0.11997564882040024,-0.2508386969566345,-0.3621197044849396,-0.16892895102500916},{-0.023835714906454086,-0.11938916891813278,0.005973377730697393,0.1343206912279129},{0.06908493489027023,0.01964900642633438,-0.23511289060115814,-0.20099495351314545}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.014056132175028324,-0.07296404987573624,0.002221160801127553,-0.040194328874349594,0.06229543313384056,0.06208885833621025,0.042825646698474884,0.05073002353310585,0.08315453678369522,0.03978794068098068,0.06735794991254807,-0.029059700667858124,-0.06678038835525513,0.00041643527220003307,-0.14980313181877136,-0.04501338303089142};
static const float actor_encoder_self_encoder_2_bias[16] = {0.03564551845192909,0.0011849465081468225,0.02042129449546337,-0.023372163996100426,0.00581183610484004,0.018558533862233162,-0.003097608918324113,0.001988912234082818,-0.019058281555771828,-0.020289381965994835,0.0159399826079607,0.003157723229378462,-0.03611766919493675,0.021138347685337067,-0.03934505209326744,-0.009065240621566772};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.017861485481262207,0.01760939508676529,0.030856844037771225,-0.011503852903842926,-0.04117956385016441,0.01669088751077652,0.0140942158177495,0.013409338891506195,0.003659251844510436,-0.03246910870075226,-0.026441482827067375,0.0022896367590874434,0.0039750197902321815,-0.0361490361392498,0.03043152391910553,0.008208733052015305,-0.044012006372213364,-0.007293100003153086,0.009147576987743378,-0.020737916231155396,-0.013741892762482166,0.005896228831261396,-0.02455098368227482,0.02503197081387043,0.024367820471525192,-0.02033522166311741,0.005618681665509939,-0.031111501157283783,-0.004823675844818354,0.0006539768073707819,0.05115825682878494,-0.026198290288448334};
static const float action_parameterization_distribution_linear_bias[4] = {0.021827029064297676,0.016614394262433052,0.017224963754415512,0.022173097357153893};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.1623203754425049,1.185882329940796,-0.16997791826725006,0.6711692810058594,0.8608747124671936,0.029749251902103424,0.7214441895484924,-0.8388139605522156},{0.5136244893074036,0.7064663171768188,1.5526047945022583,-0.7059557437896729,0.3225224018096924,-0.4125325083732605,0.2691614627838135,0.6701369881629944},{0.40901413559913635,0.5330269932746887,-0.7592499852180481,-0.1833232194185257,-0.602591872215271,0.40698498487472534,-1.5724586248397827,-0.021571233868598938}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.3779779374599457,-0.7625888586044312,0.16924148797988892,-0.7428914308547974,1.1053065061569214,-0.7114382982254028,0.08717044442892075,0.3772647976875305},{0.19691434502601624,-0.2667129933834076,-0.3104570209980011,-0.6276503205299377,-0.3368586003780365,0.6151588559150696,-0.6462165713310242,-0.5164973139762878},{-0.29176610708236694,0.004520870745182037,-0.3676300048828125,-0.5989533066749573,1.1138678789138794,0.9792503714561462,0.6056829690933228,0.1710611879825592},{-0.24126654863357544,0.42888468503952026,-0.5652121305465698,-0.07408635318279266,-1.199695348739624,0.09800361096858978,-0.33007732033729553,0.6348007917404175},{-0.7827882766723633,-0.03597617894411087,0.26444363594055176,0.14660021662712097,-0.5639629364013672,0.7248843312263489,-0.06320827454328537,0.6146168112754822},{0.4584377408027649,-0.43178901076316833,-0.36883240938186646,-0.1808430552482605,-0.07993443310260773,0.24149680137634277,-0.4552535116672516,-0.22567784786224365},{0.26621368527412415,-0.3680060803890228,0.12066201865673065,0.18252025544643402,-0.3502553105354309,1.0355314016342163,-0.16026562452316284,0.8810002207756042},{-0.18263636529445648,0.37962403893470764,-0.04129643365740776,-0.3120478689670563,1.0973800420761108,-0.5996283888816833,0.24535956978797913,0.14352893829345703}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.01260147150605917,0.0018613474676385522,0.015079122968018055,-0.02129795029759407,0.02319962903857231,-0.002088712528347969,0.018854664638638496,0.014326650649309158};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.003574285190552473,-0.004709465894848108,-0.016479751095175743,-0.013086329214274883,-0.0009556448203511536,0.044076066464185715,0.009220590814948082,-0.0006826185854151845};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
