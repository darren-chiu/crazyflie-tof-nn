
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 20},{20, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[20];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.6483627557754517,0.41098442673683167,-0.22149671614170074,0.0685345008969307,0.027869937941432,-0.055144160985946655,0.15274456143379211,-0.1163560301065445,0.09052377194166183,0.09837433695793152,0.010600954294204712,0.07314268499612808,-0.21774305403232574,4.642284329747781e-05,-0.18031159043312073,0.10372981429100037},{-0.30936843156814575,-0.15201961994171143,-0.11787708848714828,0.15253499150276184,-0.1173740029335022,0.47196972370147705,-0.10797202587127686,0.08367730677127838,0.15964168310165405,-0.2191612273454666,0.09227443486452103,0.34991535544395447,0.260242223739624,-0.13398690521717072,0.2671142816543579,-0.04217086359858513},{-0.26609179377555847,-0.00016604873235337436,-0.13121312856674194,-0.2779234051704407,0.3154158294200897,-0.40014946460723877,-0.7835196852684021,0.007018252741545439,0.1143285259604454,0.4343026876449585,-0.25100061297416687,0.10250203311443329,-0.11792563647031784,0.5658313035964966,0.4528158903121948,-0.1998983770608902},{-0.353851854801178,0.34134504199028015,-0.10912676900625229,0.048967957496643066,0.14651605486869812,0.02565435692667961,0.04159335047006607,-0.043706346303224564,0.24620091915130615,-0.02206484228372574,-0.048157911747694016,0.05170350894331932,0.0349346399307251,-0.3003736138343811,-0.0714443176984787,-0.007291797082871199},{-0.2042597234249115,-0.08610545843839645,-0.15448319911956787,0.08440308272838593,-0.2981628179550171,0.06946850568056107,-0.09571315348148346,-0.11421691626310349,0.04967568814754486,-0.0223805271089077,0.0683731660246849,0.3255853056907654,-0.20559072494506836,-0.18455654382705688,0.10747262090444565,0.2487601786851883},{0.002402735874056816,0.16612765192985535,-0.4588959515094757,-0.22080127894878387,0.2821001708507538,-0.047508660703897476,-0.5612874031066895,-0.034797586500644684,0.3385692238807678,-0.006263083312660456,-0.16889306902885437,-0.005078677553683519,-0.2623865008354187,0.3176608681678772,0.08914564549922943,-0.1292237490415573},{0.060188669711351395,-0.08915912359952927,-0.28309014439582825,0.44690293073654175,-0.16746453940868378,-0.2815374433994293,-0.31914621591567993,-0.282899409532547,-0.42936891317367554,-0.2902488112449646,-0.3188459575176239,-0.13117042183876038,0.09492041170597076,0.314316987991333,-0.1247088760137558,-0.15556207299232483},{0.2948065996170044,0.13571207225322723,-0.3299546539783478,-0.040621738880872726,-0.199756920337677,0.47326213121414185,-0.355077862739563,0.7588248252868652,-0.29734575748443604,0.45371130108833313,0.04112928360700607,-0.12881338596343994,-0.28712198138237,-0.16155557334423065,-0.023784803226590157,0.5894439816474915},{-0.704622209072113,0.23887799680233002,0.01924450322985649,1.0396790504455566,0.5122393369674683,0.15760235488414764,0.04321898892521858,0.23872599005699158,0.5094810128211975,0.1407839059829712,-0.5402811765670776,0.03546178340911865,0.41876155138015747,-0.10670773684978485,0.28077811002731323,-0.04387843608856201},{-0.17193977534770966,0.22099360823631287,-0.0567767433822155,-0.19759540259838104,0.02695125713944435,-0.3831630349159241,0.15553314983844757,-0.5087624788284302,-0.06715013086795807,-0.38232049345970154,-0.1781107634305954,0.38627153635025024,0.3342105448246002,0.25622913241386414,-0.27635595202445984,-0.665161669254303},{0.4093973636627197,-0.17634321749210358,-0.5670177340507507,0.5228802561759949,0.20204530656337738,-0.020917436107993126,0.23042641580104828,-0.4333108067512512,-0.4099428355693817,0.07264119386672974,-0.32615023851394653,-0.022776424884796143,-0.2938019633293152,-0.34874674677848816,0.08758667856454849,0.29308268427848816},{-0.534434974193573,-0.10485097020864487,-0.2764800190925598,-0.3366928696632385,0.10425130277872086,0.5714093446731567,-0.12272676825523376,-0.5200861096382141,-0.8033555746078491,-0.2963330149650574,-0.5492847561836243,0.8737466335296631,-0.2163805365562439,-0.08248834311962128,0.5697811841964722,0.3957773447036743},{-0.43254417181015015,0.19394230842590332,0.2162901759147644,0.5221682786941528,0.03220182657241821,0.2573464810848236,-0.004679747391492128,0.2011742889881134,-0.05802266299724579,-0.7802382707595825,-0.29967427253723145,-0.1578584611415863,0.38718390464782715,-0.21404188871383667,-0.07504668086767197,0.2717624008655548},{0.3380086421966553,0.24449598789215088,-0.273819237947464,0.2095353901386261,-0.24176786839962006,0.11766793578863144,-0.04337907209992409,-0.4872179627418518,-0.36847105622291565,-0.6419172286987305,-0.2023271918296814,0.6280322074890137,-0.2724866271018982,0.22122912108898163,0.3130592107772827,0.24790817499160767},{-0.3682796061038971,-0.2165002077817917,-0.2939111292362213,-0.3496667444705963,-0.12106145918369293,-0.4722054600715637,0.18270191550254822,0.5183667540550232,-0.4486740231513977,0.4176633656024933,-0.15334278345108032,-0.04832935333251953,-0.2055763453245163,0.47900843620300293,0.2664879262447357,0.298662930727005},{-0.032256416976451874,0.11053188890218735,-0.17647506296634674,0.027410956099629402,-0.17950892448425293,-0.15617749094963074,0.013295688666403294,-0.18495412170886993,-0.1997288018465042,-0.10360528528690338,0.010165641084313393,0.24235370755195618,0.3405814468860626,0.3692694306373596,0.09248237311840057,0.10498372465372086},{0.12648984789848328,-0.26398351788520813,0.15360726416110992,-0.11562901735305786,-0.12390461564064026,0.2300167679786682,0.060621269047260284,0.06437066197395325,-0.27566614747047424,0.3220045268535614,0.055388230830430984,-0.06628323346376419,-0.19986602663993835,0.11168013513088226,0.13874931633472443,-0.14002226293087006},{0.24079705774784088,0.06753094494342804,0.1445903331041336,0.1309170424938202,-0.0049778311513364315,0.21702279150485992,-0.22995822131633759,0.1433059722185135,-0.12884025275707245,0.3708187937736511,0.14021064341068268,0.20633018016815186,-0.40860193967819214,-0.21047498285770416,-0.04131348058581352,0.25579169392585754}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.02765330858528614,0.14560873806476593,-0.09266332536935806,-0.04839188605546951,-0.1741175651550293,-0.3103003203868866,0.4128868877887726,-0.2618752121925354,-0.4042012691497803,-0.16536304354667664,0.03436928614974022,-0.20636723935604095,-0.10053480416536331,0.20728816092014313,-0.1415661722421646,0.18007610738277435},{-0.15493513643741608,0.05713685601949692,0.1263589709997177,-0.0024817700032144785,-0.24915486574172974,-0.016083549708127975,-0.3917785584926605,0.2739478051662445,0.37576770782470703,-0.08247052878141403,0.1420183926820755,0.3085537254810333,0.12988078594207764,0.4503478407859802,-0.34346556663513184,-0.4695931375026703},{0.19691573083400726,0.17687882483005524,0.3606875538825989,-0.03497674688696861,-0.11419427394866943,-0.1580832600593567,0.13272720575332642,-0.2458667755126953,0.46890905499458313,0.26529356837272644,0.32828789949417114,-0.24089084565639496,0.05625409260392189,-0.3752972483634949,-0.15121349692344666,0.23347704112529755},{-0.153734490275383,0.05105847120285034,0.005904882214963436,0.27055731415748596,-0.2683091461658478,0.37192341685295105,0.15671800076961517,0.3978707492351532,-0.42462295293807983,-0.0093113724142313,-0.07975645363330841,0.07605443894863129,0.5603867173194885,0.14895081520080566,0.2755211591720581,0.367774099111557},{-0.19122754037380219,0.2572224736213684,0.1038217544555664,0.407310426235199,0.14592956006526947,0.34781068563461304,0.09172078222036362,-0.551648736000061,-0.027111219242215157,-0.021378472447395325,0.054107457399368286,0.15603598952293396,-0.060527995228767395,0.12123042345046997,-0.001737335929647088,0.05556773766875267},{0.13247202336788177,-0.057409413158893585,-0.267112672328949,-0.43192431330680847,-0.3520480990409851,0.0004903852823190391,0.201214998960495,0.02746756747364998,0.09525495767593384,-0.446280837059021,-0.21586652100086212,0.3612843155860901,0.11492972075939178,0.16470655798912048,0.24254660308361053,-0.23988188803195953},{-0.17072194814682007,0.3907288610935211,-0.09062067419290543,0.05614916607737541,-0.07009649276733398,0.2960149645805359,-0.29862046241760254,0.2935595214366913,0.12552987039089203,0.5939627289772034,-0.1738080531358719,0.3420284390449524,-0.20168329775333405,0.3541202247142792,0.31820330023765564,0.22249314188957214},{0.013807700015604496,-0.2918274998664856,-0.3360315263271332,0.4813742935657501,-0.4153023958206177,0.4934631288051605,-0.4389846622943878,0.27903878688812256,-0.3079847991466522,0.09336471557617188,-0.0944722443819046,-0.441188246011734,-0.39142951369285583,0.24314378201961517,0.09842079877853394,0.21697363257408142},{0.2790806293487549,-0.2571924328804016,0.30125871300697327,-0.13575910031795502,0.42750459909439087,-0.32648369669914246,-0.3638056516647339,0.1718081831932068,0.1769983470439911,0.2997865378856659,0.23407021164894104,-0.3867546021938324,0.053523167967796326,0.15831539034843445,0.06507547944784164,-0.36632880568504333},{0.053154107183218,-0.27744144201278687,0.36180904507637024,0.3628423810005188,-0.1679079234600067,-0.17583440244197845,-0.4410417079925537,0.2552421987056732,-0.15364974737167358,0.12130358815193176,0.06509179621934891,-0.41714170575141907,-0.13106830418109894,-0.34521743655204773,-0.20143109560012817,0.017206592485308647},{0.2090311199426651,-0.22302548587322235,-0.015001398511230946,-0.4414104223251343,-0.3285214900970459,-0.02189352922141552,-0.4427450895309448,0.38249629735946655,-0.09914563596248627,0.28826048970222473,0.21213270723819733,-0.27583712339401245,-0.3281669616699219,0.20709094405174255,0.3041106164455414,0.011944202706217766},{-0.34871095418930054,-0.16855496168136597,-0.08125805109739304,-0.12853968143463135,0.04246949777007103,-0.1637105494737625,0.0007073261658661067,0.34186989068984985,0.07066550850868225,-0.22420799732208252,-0.3867977559566498,-0.34577956795692444,-0.15242937207221985,0.2818051874637604,-0.02733202651143074,-0.25095105171203613},{0.2347780168056488,-0.35270529985427856,-0.07957969605922699,-0.0032603906001895666,-0.20642425119876862,0.09298739582300186,-0.0464315265417099,0.2248675674200058,0.1739964336156845,0.14093026518821716,-0.05252258479595184,-0.24896720051765442,0.10270895808935165,0.16672685742378235,-0.4093077480792999,0.37011969089508057},{-0.32228389382362366,0.07302389293909073,0.3347416818141937,0.28182488679885864,-0.15540920197963715,-0.43916013836860657,-0.22343498468399048,-0.3303614854812622,0.15606825053691864,0.1879235953092575,-0.23897455632686615,0.11896619945764542,0.007734747137874365,0.00035983978887088597,0.008688507601618767,0.052081331610679626},{-0.099278524518013,-0.5003080368041992,-0.4384670853614807,0.45221272110939026,0.23617537319660187,-0.10463391989469528,-0.25559261441230774,0.2915598452091217,0.4474697411060333,0.22732028365135193,-0.254630982875824,0.04663741961121559,0.14951100945472717,0.12222230434417725,-0.3414478600025177,-0.29122745990753174},{0.2708423137664795,0.2997618615627289,-0.13594384491443634,0.3245599567890167,0.09035743027925491,0.24677670001983643,0.4052543342113495,0.014714015647768974,0.333515465259552,-0.17328383028507233,-0.3616677224636078,-0.035867322236299515,-0.16273030638694763,-0.1887027472257614,-0.3910749852657318,-0.2177414894104004}};
static const float actor_encoder_feed_forward_0_weight[20][20] = {{0.14298272132873535,0.04171816259622574,0.0851234719157219,0.3944605588912964,-0.04290248081088066,0.3332470655441284,-0.10222022235393524,0.1759151816368103,0.025176893919706345,0.03247402235865593,0.0678504928946495,-0.04576198756694794,0.027717897668480873,-0.20734888315200806,-0.2922104597091675,0.01495814137160778,-0.24385768175125122,-0.15873029828071594,0.0678010955452919,0.18524296581745148},{0.059182778000831604,0.191401407122612,0.11365660279989243,0.4883667230606079,-0.2775801122188568,0.3543378412723541,0.33178243041038513,0.3731556832790375,-0.20972229540348053,-0.4467677175998688,-0.2756117582321167,0.026472706347703934,-0.07411395013332367,0.28296422958374023,-0.2873290777206421,-0.1677931547164917,0.09917023032903671,0.47087347507476807,-0.2020748108625412,0.19848258793354034},{0.16529931128025055,0.12838159501552582,0.14597247540950775,0.008745049126446247,-0.04466423764824867,-0.04162904620170593,-0.04177796468138695,-0.2841697335243225,0.3132822811603546,0.126114159822464,-0.3478736877441406,-0.10351800918579102,0.19609571993350983,-0.04648613557219505,0.18416595458984375,-0.4215242862701416,0.24485699832439423,0.2985830307006836,-0.0762791633605957,-0.30959227681159973},{0.3088341951370239,-0.09310901165008545,-0.0802646353840828,-0.5358895063400269,-0.32461386919021606,-0.4779110252857208,-0.3111077547073364,-0.29088732600212097,-0.16803120076656342,0.30585119128227234,-0.01620643027126789,-0.012449143454432487,0.10915853828191757,-0.264848917722702,-0.04839465394616127,0.2704211473464966,-0.2894839644432068,-0.01686284877359867,0.36781391501426697,-0.4304187297821045},{0.2869755029678345,0.329942911863327,-0.16830113530158997,-0.3688325881958008,0.18111366033554077,0.007897517643868923,0.3610009253025055,-0.012116529047489166,0.06817543506622314,0.39734581112861633,0.3588942885398865,-0.08648782223463058,-0.2698723375797272,0.060893554240465164,-0.3635896146297455,0.10411307960748672,0.18095064163208008,-0.08531094342470169,0.24967052042484283,0.31197041273117065},{-0.11215879768133163,-0.1202273964881897,-0.04213496297597885,0.4048348069190979,-0.3031263053417206,-0.03517322242259979,0.06563283503055573,-0.05619700625538826,-0.2021782547235489,-0.44360044598579407,-0.27661895751953125,0.3223809003829956,0.08721957355737686,-0.21807537972927094,0.005513059441000223,-0.21302734315395355,0.4205300807952881,0.012042681686580181,-0.030417082831263542,-0.14326682686805725},{0.271637499332428,-0.3616407811641693,0.33657291531562805,0.2658817768096924,0.2661769986152649,0.1987723410129547,-0.20027591288089752,-0.417356938123703,-0.04040411859750748,0.06705651432275772,-0.07052242010831833,0.2839246392250061,-0.08724994212388992,0.04573821648955345,-0.4176146388053894,-0.2868558466434479,0.2128540575504303,0.08531028032302856,-0.42291513085365295,0.16488057374954224},{0.216841921210289,-0.2385583221912384,0.5116264820098877,0.39515420794487,0.24232088029384613,-0.2741597592830658,-0.20255586504936218,0.08022618293762207,0.010776073671877384,0.11631397157907486,-0.45903852581977844,0.44490888714790344,0.09338417649269104,-0.21567225456237793,-0.009744253940880299,-0.03086513839662075,0.0884428396821022,0.13226953148841858,-0.04812081903219223,-0.3512411117553711},{-0.20252612233161926,-0.10637140274047852,-0.06624861806631088,-0.013745232485234737,-0.23718759417533875,0.4002726972103119,-0.3945416808128357,0.1586521416902542,0.46938979625701904,0.05477198213338852,-0.3074020743370056,0.3194817006587982,-0.07983892410993576,0.12971916794776917,-0.062216177582740784,-0.5409377217292786,0.11833440512418747,-0.40823128819465637,-0.15150907635688782,-0.20149604976177216},{-0.3899831175804138,0.16181452572345734,0.11538951843976974,-0.18150803446769714,0.30306994915008545,0.3834986686706543,-0.09689448773860931,0.32013168931007385,0.28701725602149963,-0.0344308577477932,-0.04356766492128372,0.06791185587644577,0.10008514672517776,-0.4623567461967468,-0.25585392117500305,-0.07556591182947159,0.29411375522613525,0.42686405777931213,0.39950379729270935,0.3064363896846771},{0.05228009447455406,-0.03813131898641586,0.06571292877197266,0.4097825586795807,0.43332183361053467,0.04975486174225807,0.35084331035614014,-0.22920428216457367,0.025838913396000862,0.072432741522789,-0.1892874836921692,-0.23672443628311157,0.2567610442638397,-0.42932334542274475,-0.11738599091768265,0.0510517954826355,0.07509415596723557,0.09398835897445679,-0.2659933865070343,-0.058549389243125916},{-0.18808558583259583,-0.2682878375053406,-0.0982726439833641,0.28903380036354065,-0.29700249433517456,0.041883815079927444,-0.046128902584314346,-0.125640869140625,0.40127280354499817,0.17410558462142944,-0.012376340106129646,-0.18626195192337036,-0.20410940051078796,0.31018200516700745,-0.24965906143188477,0.24469047784805298,-0.24493901431560516,0.2327231615781784,0.24095161259174347,0.5042843818664551},{0.00861395988613367,-0.22998662292957306,-0.00642328942194581,-0.049156371504068375,-0.22760716080665588,-0.2664693295955658,0.5450938940048218,-0.32486897706985474,-0.23565292358398438,0.03623432666063309,0.04678621515631676,-0.2992296516895294,0.024028770625591278,-0.2234533727169037,-0.38822486996650696,-0.351663202047348,0.39129459857940674,0.2221781611442566,0.34893783926963806,-0.08379654586315155},{0.3052811026573181,0.3618786633014679,0.36108818650245667,-0.07510320097208023,-0.15082018077373505,0.035893816500902176,0.4344855844974518,0.09417561441659927,0.21749304234981537,-0.2769315838813782,0.09211045503616333,-0.041042789816856384,-0.38559338450431824,0.08899732679128647,-0.22049783170223236,0.022889629006385803,-0.13236181437969208,0.29688262939453125,0.030016638338565826,-0.24014392495155334},{-0.31340491771698,0.1886494904756546,0.24750369787216187,0.2717028856277466,0.21630032360553741,0.13468684256076813,0.41863688826560974,0.022338399663567543,0.027430495247244835,0.08757844567298889,-0.2771265208721161,0.15800222754478455,-0.07380470633506775,0.04509265348315239,-0.09575765579938889,0.2384108304977417,-0.3170294761657715,-0.20984145998954773,0.2702491879463196,-0.33363479375839233},{-0.09347166121006012,0.2719653844833374,-0.1846514344215393,0.24793612957000732,0.17223796248435974,0.09267132729291916,0.47377800941467285,-0.05880361795425415,0.22918939590454102,-0.046226706355810165,0.06402961164712906,0.15535970032215118,-0.24292220175266266,0.37425678968429565,0.023804577067494392,-0.11298561096191406,-0.27194109559059143,0.39350736141204834,-0.024625374004244804,-0.16358613967895508},{0.4010734558105469,-0.1856469064950943,0.2581627368927002,-0.2967356741428375,0.14105984568595886,0.2371949851512909,-0.09819073230028152,-0.2447114884853363,-0.26673051714897156,0.0582578219473362,0.1719352751970291,0.1136879026889801,0.18576626479625702,-0.1006213128566742,0.29338428378105164,-0.10794366151094437,-0.059234898537397385,-0.052301403135061264,-0.16959384083747864,0.23832085728645325},{0.2400047481060028,0.15484406054019928,0.13088862597942352,0.31406623125076294,-0.366054505109787,0.019932512193918228,0.5009979009628296,-0.08419394493103027,-0.03711020201444626,-0.006536795292049646,0.21688222885131836,-0.2987426519393921,-0.2530952990055084,0.16760578751564026,0.3347463011741638,0.3299427926540375,0.12220966070890427,-0.24472428858280182,-0.13210156559944153,0.09090956300497055},{0.2375296950340271,0.26252952218055725,0.051602210849523544,-0.2071886509656906,-0.12143866717815399,-0.24563488364219666,0.17672395706176758,0.23304259777069092,0.07767762243747711,-0.11298982053995132,0.2236580103635788,-0.11339640617370605,0.08597981929779053,-0.22280706465244293,-0.26812589168548584,0.3148045539855957,-0.2552831470966339,0.08137062937021255,-0.06149004399776459,0.01939360611140728},{0.21400287747383118,-0.008564271032810211,-0.21049492061138153,-0.04909122362732887,0.36109787225723267,0.16966621577739716,-0.06691265851259232,-0.1138128787279129,-0.18331126868724823,0.06801030039787292,-0.09989750385284424,-0.11316189169883728,0.10174044966697693,0.2734815776348114,-0.19176800549030304,0.0801277682185173,0.2566344738006592,-0.38011932373046875,-0.2696317434310913,0.2741573750972748}};
static const float action_parameterization_distribution_linear_weight[20][4] = {{-0.1398298740386963,-0.1616194248199463,-0.3069174885749817,-0.33992692828178406},{-0.049714818596839905,-0.24677732586860657,0.20094281435012817,-0.061506010591983795},{0.1136917695403099,0.25647011399269104,0.09344986826181412,-0.1647508293390274},{0.2921505868434906,0.20523406565189362,0.3033534288406372,0.3376435339450836},{0.1278664767742157,0.09071939438581467,-0.3943321108818054,0.1318320482969284},{0.09981723129749298,-0.012512121349573135,-0.02464641071856022,0.21885235607624054},{-0.4558645188808441,-0.03211431950330734,-0.19404719769954681,0.328156441450119},{0.37547948956489563,-0.2238909900188446,-0.30885234475135803,0.5291246175765991},{-0.23337437212467194,0.5573540925979614,-0.35208550095558167,0.4033696949481964},{-0.06917118281126022,0.02896859124302864,-0.21665452420711517,-0.20488061010837555},{0.2904428541660309,-0.35075995326042175,-0.5361764430999756,0.23454684019088745},{0.5444544553756714,0.4037783145904541,-0.060321491211652756,-0.1276349276304245},{-0.09690362960100174,-0.42027023434638977,0.2541475296020508,0.122405044734478},{0.23112691938877106,0.3597644865512848,-0.2465086281299591,-0.2159627377986908},{0.3945375382900238,-0.33018019795417786,-0.472351610660553,0.12802982330322266},{0.13456425070762634,-0.5909495949745178,0.21851307153701782,0.1189485639333725},{0.0491938441991806,0.17968781292438507,0.08808150887489319,-0.04462948441505432},{0.2725962698459625,-0.26951438188552856,0.2564180791378021,0.19737635552883148},{-0.22239862382411957,0.09357693046331406,-0.23017342388629913,0.0829327404499054},{0.36601659655570984,0.3463169038295746,-0.4721679389476776,0.4796028137207031}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.026859965175390244,0.04551170766353607,0.002009078860282898,-0.12857908010482788,0.06077969819307327,-0.008839491754770279,0.1469942182302475,0.20273229479789734,-0.0627424493432045,0.09659948945045471,-0.08101561665534973,0.013791142031550407,0.0015258375788107514,0.06629828363656998,0.12438943237066269,-0.007213464472442865};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.10116424411535263,0.00620379950851202,0.009691481478512287,0.03506894409656525,-0.04241297394037247,0.060006316751241684,-0.12654119729995728,-0.02774617075920105,0.16712413728237152,0.12881264090538025,-0.056016672402620316,0.0636247768998146,-0.033228155225515366,-0.021843547001481056,0.06736791133880615,0.029060307890176773};
static const float actor_encoder_feed_forward_0_bias[20] = {-0.04677477478981018,-0.015294183045625687,-0.026538843289017677,8.95093398867175e-05,-0.016550147905945778,0.016675470396876335,-0.10871749371290207,-0.006730586290359497,0.05095768719911575,0.00198862561956048,0.0016480557387694716,0.016967274248600006,0.0444827564060688,-0.09877515584230423,0.03146344795823097,0.0041633849032223225,0.025276124477386475,0.07403432577848434,0.03485212102532387,-0.06777120381593704};
static const float action_parameterization_distribution_linear_bias[4] = {-0.004415500909090042,0.003235533135011792,0.026312945410609245,0.022302739322185516};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.05413583666086197,-0.26071837544441223,0.37693530321121216,-0.5510522127151489},{0.09722836315631866,-0.16627246141433716,-0.33828914165496826,0.4024469256401062},{-0.3212094306945801,-0.4007326066493988,0.3051176071166992,-0.24364794790744781},{0.4406442940235138,0.1237778514623642,-0.21856491267681122,-0.1977159082889557},{0.5343768000602722,0.16070452332496643,-0.20892822742462158,-0.42371001839637756},{0.3011215627193451,-0.3038243353366852,-0.3310073912143707,-0.3631143569946289},{0.43207618594169617,-0.1477663666009903,-0.49946358799934387,-0.160482257604599},{0.41558319330215454,-0.5872871279716492,-0.5453267693519592,-0.6235167980194092},{0.26558464765548706,-0.04595686122775078,-0.5238149166107178,-0.6699617505073547},{0.5385143160820007,-0.2911023199558258,0.17875109612941742,0.05022341012954712},{-0.32714754343032837,-0.6378881335258484,0.10422838479280472,0.03713005781173706},{0.15578074753284454,0.28488150238990784,-0.06524010002613068,-0.584646463394165},{0.4925287365913391,-0.05891980603337288,0.0032407783437520266,-0.13474611937999725},{-0.3263522982597351,0.20200438797473907,0.2970971465110779,0.14069296419620514},{0.2812299430370331,0.2082422524690628,-0.29356324672698975,0.3298165500164032},{0.41301262378692627,-0.5263119339942932,0.2291475087404251,-0.2815145254135132}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.7381497025489807,-0.24624130129814148,-0.6194746494293213,0.2312755137681961},{-0.42843887209892273,0.8741397857666016,0.1620018631219864,0.6734347939491272},{-0.4998323321342468,0.23131851851940155,-0.20364435017108917,0.11815747618675232},{0.8035365343093872,0.42651841044425964,0.5392616987228394,0.7632433176040649}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.16802610456943512,-0.19749245047569275,0.026548977941274643,-0.16291095316410065};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.026610128581523895,-0.09838590025901794,0.04000592231750488,-0.12090837210416794};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }
