
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{16, 16},{16, 4}};
static const int obst_structure [0][2] = };
static float output_0[16];
static float output_1[16];
static float output_2[16];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.24071979522705078,0.14241215586662292,0.32341963052749634,-0.10775388032197952,0.3980437219142914,-0.2476816475391388,-0.2874479591846466,-0.04632330685853958,-0.22069932520389557,-0.1507590413093567,0.2548403739929199,-0.17263467609882355,-0.4591928720474243,-0.21375922858715057,-0.06453259289264679,-0.35623201727867126},{0.5849299430847168,0.42466220259666443,-0.12225533276796341,-0.29528456926345825,0.18760916590690613,-0.03711294010281563,-0.07853782176971436,-0.40025004744529724,0.10651005059480667,0.312512069940567,0.11063558608293533,-0.053517747670412064,0.07805722206830978,0.11880715191364288,-0.11947287619113922,0.1010594293475151},{0.12558870017528534,0.3137357532978058,0.5474967360496521,0.07533879578113556,-0.599378764629364,0.2674406170845032,-0.09331010282039642,0.4801948666572571,-0.5304268598556519,0.2903325855731964,0.19382864236831665,-0.16065636277198792,0.24870824813842773,-0.2016839236021042,-0.41497620940208435,-0.0381133146584034},{-0.3841816484928131,-0.0375908724963665,0.17108465731143951,0.2111387997865677,-0.0420168898999691,-0.1318623274564743,-0.07591923326253891,0.16537544131278992,-0.33588430285453796,-0.35367223620414734,-0.19356562197208405,-0.16012383997440338,0.24237225949764252,0.16491585969924927,-0.05144834518432617,0.005382129456847906},{0.4058738946914673,-0.09620460122823715,-0.14550907909870148,-0.157603457570076,-0.25615301728248596,-0.17752596735954285,0.06586779654026031,0.25243112444877625,0.12298549711704254,0.31282898783683777,-0.025576982647180557,0.019585836678743362,-0.03340249881148338,0.34208378195762634,0.15794987976551056,0.10858550667762756},{0.42067766189575195,0.12469493597745895,0.04783574491739273,0.13702474534511566,-0.20454668998718262,0.1897519826889038,-0.1264936923980713,0.14263737201690674,-0.32218319177627563,-0.035935502499341965,0.3352532982826233,-0.003140335436910391,-0.23039916157722473,-0.07342320680618286,-0.09199216961860657,-0.2193218320608139},{0.37926599383354187,0.012868260033428669,0.5554260611534119,0.44178202748298645,-0.009092497639358044,-0.2586834132671356,-0.1134747564792633,0.26487842202186584,-0.21420280635356903,-0.13713839650154114,0.12629613280296326,-0.06984609365463257,-0.17994481325149536,-0.35155409574508667,0.3579583764076233,-0.03204430267214775},{0.2351393699645996,-0.10798349976539612,-0.0002126613981090486,-0.2323637306690216,-0.0013411197578534484,0.23196260631084442,0.08432157337665558,0.008845455944538116,0.2867441773414612,-0.15228234231472015,-0.3265729546546936,-0.2353183627128601,-0.1295732855796814,-0.24265526235103607,-0.3854323625564575,0.20155131816864014},{-0.2828581631183624,0.24836695194244385,0.493375301361084,0.11722839623689651,-0.16000619530677795,-0.7300100326538086,0.5078027844429016,-0.15983137488365173,-0.5406659841537476,-0.2108185887336731,0.2874000072479248,-0.032924819737672806,0.009512771852314472,0.4453282654285431,0.05176316946744919,-0.24397730827331543},{0.2848510444164276,0.04895668476819992,0.18433813750743866,0.5531259775161743,0.038915347307920456,-0.0019109511049464345,-0.0733490064740181,-0.2691826820373535,0.1723012924194336,0.3592989444732666,0.42363977432250977,0.06858611851930618,0.18667887151241302,-0.3860893249511719,0.36319172382354736,-0.3320360481739044},{-0.16233079135417938,-0.2529970407485962,-0.1710442304611206,-0.1884501725435257,-0.2625730037689209,-0.27614516019821167,0.037730224430561066,0.020282452926039696,0.21941830217838287,0.23886968195438385,0.05149325355887413,0.4056650996208191,-0.32632675766944885,-0.23685066401958466,-0.4153999984264374,0.1058214083313942},{0.11580821871757507,0.2104797065258026,0.04444265365600586,0.15233413875102997,-0.35700690746307373,0.0986207127571106,0.2985506057739258,-0.13288995623588562,-0.08745630830526352,0.5080076456069946,0.17797482013702393,-0.010488263331353664,-0.049940407276153564,0.31597912311553955,0.4922812581062317,-0.17035678029060364},{-0.21121209859848022,0.007608385756611824,0.5033254623413086,-0.22175316512584686,0.04199504852294922,-0.12383599579334259,0.3423003554344177,-0.26477763056755066,-0.07626686245203018,-0.3586121201515198,-0.13763269782066345,0.2366970330476761,0.6688586473464966,-0.4841724634170532,-0.05618339031934738,-0.41251927614212036},{0.013140534982085228,0.42071959376335144,-0.2835029363632202,0.36265963315963745,-0.1265232414007187,-0.47340691089630127,0.13409021496772766,0.3026675283908844,-0.11347737163305283,0.09888466447591782,0.329551100730896,-0.36861956119537354,0.6048079133033752,0.45280492305755615,-0.18888218700885773,-0.16996292769908905},{-0.006172611378133297,-0.14524398744106293,-0.3012852370738983,0.21597526967525482,-0.04980305954813957,-0.4591623842716217,-0.37597891688346863,-0.34737902879714966,-0.15715354681015015,-0.05721158906817436,0.274529367685318,0.2903364300727844,0.536347508430481,-0.2900254726409912,0.08310076594352722,0.38452091813087463},{-0.23332585394382477,0.18239636719226837,-0.13219374418258667,-0.15852124989032745,0.13119181990623474,-0.054430071264505386,0.2557627558708191,-0.16646504402160645,-0.15965470671653748,0.1014476865530014,-0.01800064742565155,-0.1221153512597084,0.25886237621307373,0.13180850446224213,-0.17740781605243683,0.3425377905368805},{0.2437894642353058,0.12595032155513763,-0.22303666174411774,0.23535236716270447,0.05055464059114456,0.11921238154172897,0.11961318552494049,0.049106400460004807,0.12943848967552185,0.1031932681798935,0.11091617494821548,0.12487789988517761,-0.21346572041511536,0.04645339399576187,0.05092568323016167,0.2452416568994522},{-0.36769095063209534,0.1286812722682953,-0.42388179898262024,0.2436341643333435,0.24019773304462433,0.008869240991771221,-0.33516889810562134,-0.09525122493505478,0.01628825254738331,0.060119207948446274,-0.17921067774295807,-0.3959468901157379,0.4789057672023773,-0.13450907170772552,-0.26210537552833557,-0.2444341629743576}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.01581256091594696,0.18563848733901978,0.4080456793308258,0.1698334962129593,-0.06515374034643173,0.2713298201560974,0.19659578800201416,-0.4142128825187683,0.1668410748243332,0.0876859575510025,-0.5155417919158936,-0.054511722177267075,0.33612751960754395,-0.29288989305496216,-0.27663400769233704,-0.2887174189090729},{0.13511177897453308,0.014935227110981941,-0.4054465889930725,0.13232935965061188,-0.13075795769691467,0.14329101145267487,0.038651224225759506,0.07857590913772583,0.10379645228385925,0.11709094792604446,-0.328321635723114,0.4198465943336487,0.19865761697292328,0.03016231395304203,-0.15144164860248566,-0.030346475541591644},{0.24960504472255707,-0.08361165225505829,-0.18830668926239014,0.17830143868923187,-0.028181854635477066,-0.394564151763916,-0.1954624354839325,-0.10042457282543182,0.28479570150375366,-0.43047091364860535,0.1643764078617096,-0.027505289763212204,-0.32784974575042725,-0.20869003236293793,-0.3300536572933197,-0.26611608266830444},{-0.08289627730846405,-0.2163912057876587,-0.28110751509666443,-0.23641645908355713,-0.20721600949764252,-0.28557053208351135,-0.3455597758293152,0.44748392701148987,0.09554845839738846,0.08163781464099884,-0.10952874273061752,0.128952756524086,-0.3543885052204132,-0.0530351884663105,-0.16477586328983307,0.02439461648464203},{-0.056670818477869034,0.1939300298690796,0.173641636967659,-0.40894070267677307,-0.3451157808303833,0.12929575145244598,-0.0749979093670845,0.19745077192783356,-0.1492318958044052,0.05593680217862129,0.041884686797857285,-0.4662535488605499,-0.402071475982666,0.17725522816181183,0.23863302171230316,-0.444100946187973},{-0.4203621447086334,-0.0900978073477745,-0.044465918093919754,-0.49146971106529236,0.030475609004497528,-0.30898958444595337,0.4234424829483032,-0.3565954864025116,0.3400042951107025,-0.37783873081207275,0.5376689434051514,0.3349355161190033,0.4421095848083496,0.15622077882289886,0.1486692726612091,-0.17805159091949463},{0.1718137264251709,0.23633748292922974,-0.29490241408348083,0.14988864958286285,0.33113351464271545,-0.19647300243377686,0.2685829997062683,-0.35216665267944336,-0.15666750073432922,0.046978339552879333,0.2572496831417084,0.30542486906051636,-0.22095423936843872,-0.0402211956679821,0.14514051377773285,-0.4825437366962433},{-0.09621444344520569,0.09610141813755035,0.11990372836589813,0.004116957075893879,0.18596957623958588,0.27048856019973755,-0.05257042124867439,-0.19664262235164642,-0.12217269837856293,0.060849785804748535,0.2571662366390228,0.3664891719818115,0.02286534570157528,-0.03960398584604263,0.006750009022653103,-0.05945409834384918},{-0.24150896072387695,0.5081228613853455,-0.2846124470233917,-0.22616039216518402,-0.16998882591724396,0.4744996428489685,0.47165411710739136,-0.26255911588668823,0.15030646324157715,-0.22824731469154358,0.2182839959859848,-0.45879682898521423,0.1769738644361496,0.48437267541885376,0.309425413608551,0.2915950417518616},{0.27181196212768555,0.055347077548503876,-0.04794561117887497,0.23648662865161896,-0.22476699948310852,-0.41880351305007935,0.30745577812194824,0.07417967915534973,-0.25451087951660156,0.05536830797791481,0.3886241912841797,0.4618319571018219,0.34185656905174255,-0.11489760130643845,-0.1085803434252739,0.2429637610912323},{0.48036709427833557,-0.051196470856666565,-0.29797160625457764,0.23645104467868805,0.1006336361169815,-0.19491279125213623,-0.20465080440044403,0.2040223777294159,0.36716610193252563,-0.158075213432312,0.20330636203289032,0.445568710565567,-0.24836526811122894,0.12772491574287415,0.05841495096683502,-0.003197677666321397},{0.44673436880111694,-0.12459023296833038,0.06094665080308914,-0.016042435541749,0.20381145179271698,-0.4209520220756531,-0.22195878624916077,0.5156658291816711,0.05132633447647095,-0.02064189501106739,-0.4385092258453369,0.1460663229227066,-0.3873277008533478,-0.396711528301239,0.24156585335731506,0.0444231815636158},{0.023817582055926323,-0.3432372212409973,0.15944650769233704,-0.04540357366204262,-0.069725401699543,0.10859346389770508,0.14294061064720154,0.1882755309343338,-0.13256539404392242,0.22326868772506714,-0.2539425492286682,0.25484636425971985,-0.08550435304641724,0.19058585166931152,-0.32195234298706055,-0.40870094299316406},{0.4076933264732361,-0.13929125666618347,-0.43816083669662476,-0.06211854889988899,-0.011258671060204506,0.0347190797328949,0.33424314856529236,-0.2905210852622986,-0.019535159692168236,-0.03284763544797897,0.21823370456695557,-0.04999636486172676,-0.030847838148474693,0.2833811342716217,-0.10647393763065338,-0.10344556719064713},{0.4200494587421417,0.36451131105422974,-0.18988703191280365,-0.06937256455421448,0.2010185867547989,-0.34018728137016296,0.018169619143009186,0.5266330242156982,-0.25984829664230347,0.49611786007881165,-0.05936189368367195,0.021059144288301468,-0.1256946623325348,-0.2607744038105011,0.4635661542415619,0.28405866026878357},{-0.2454495131969452,0.06923826783895493,0.21769212186336517,0.3068110942840576,0.25281405448913574,-0.003378497203812003,0.06615117937326431,0.19663746654987335,-0.18315201997756958,-0.056249551475048065,-0.06741052865982056,-0.19859488308429718,0.09810114651918411,0.18737441301345825,0.2591104209423065,-0.23812612891197205}};
static const float actor_encoder_feed_forward_0_weight[16][16] = {{-0.4743295907974243,-0.1375747174024582,-0.00036363289109431207,0.23439455032348633,-0.40700459480285645,-0.31653812527656555,0.24911902844905853,0.4226178526878357,0.45794329047203064,0.012709897011518478,0.07884044945240021,-0.04653751850128174,0.14486455917358398,-0.5276726484298706,0.3415209949016571,-0.38527989387512207},{0.5052427649497986,-0.10802387446165085,-0.156175896525383,-0.007113345433026552,-0.0668603852391243,0.39971208572387695,0.007513638120144606,0.01760142110288143,-0.38830411434173584,0.23186266422271729,0.2391120046377182,-0.08631326258182526,-0.036148007959127426,-0.4135245680809021,-0.2288108468055725,0.20565222203731537},{-0.36235111951828003,0.2766380310058594,-0.3496098220348358,0.36894598603248596,-0.2221367359161377,0.04003070294857025,-0.21788355708122253,0.02358095347881317,-0.0716225877404213,-0.3765002191066742,-0.32287201285362244,-0.2793623208999634,-0.1480567306280136,-0.051772430539131165,-0.19428177177906036,0.3505904972553253},{-0.543814480304718,-0.00636035343632102,0.11571399122476578,-0.12946239113807678,-0.22145427763462067,0.03078274615108967,-0.3897775113582611,0.29572728276252747,0.39346492290496826,-0.4522385895252228,-0.508019208908081,-0.30854490399360657,0.33175352215766907,-0.13129913806915283,-0.0805075541138649,-0.026241768151521683},{0.3342095911502838,-0.33786267042160034,0.33297717571258545,0.25039589405059814,0.21444150805473328,-0.49880340695381165,-0.20880678296089172,-0.06406571716070175,0.14089809358119965,-0.2682385742664337,0.43152469396591187,0.09349305927753448,0.017258355394005775,0.05318528041243553,0.25863155722618103,0.07004411518573761},{0.39012736082077026,-0.08551742881536484,0.09865085780620575,-0.30124300718307495,-0.15161067247390747,0.5626680254936218,-0.13597500324249268,0.003314361674711108,0.3517110049724579,-0.10849523544311523,-0.1166287288069725,-0.058791328221559525,0.31573188304901123,0.2633846402168274,0.20417489111423492,-0.36030539870262146},{0.30613255500793457,-0.2885705530643463,-0.31799978017807007,0.03355737775564194,0.029027434065937996,0.18683840334415436,-0.2521074414253235,-0.2289597988128662,0.06449621170759201,0.4711487591266632,0.3192383646965027,0.012694456614553928,-0.46002236008644104,-0.40909186005592346,-0.18447370827198029,-0.20739340782165527},{-0.30498796701431274,0.1168426051735878,-0.24271637201309204,0.48054519295692444,0.28057077527046204,-0.2613341212272644,-0.3728261888027191,0.23722133040428162,0.2854544520378113,-0.20133943855762482,0.5069556832313538,0.04478742554783821,0.5131068229675293,-0.30536189675331116,0.03425854071974754,-0.0932164341211319},{-0.2579767405986786,-0.339997798204422,0.0934198796749115,-0.13725939393043518,-0.00862458162009716,-0.07551351934671402,0.20305465161800385,-0.20927754044532776,-0.04735451936721802,0.3928345739841461,0.16986311972141266,-0.057083576917648315,-0.09684543311595917,0.1417521834373474,-0.319956511259079,0.27445554733276367},{-0.06757563352584839,0.09898236393928528,0.33879339694976807,-0.06489701569080353,-0.1130245178937912,0.3436312973499298,0.2812255918979645,0.03736291453242302,0.47787508368492126,-0.03363821282982826,0.030738774687051773,0.2761363089084625,0.39361637830734253,-0.2773631513118744,-0.3196799159049988,-0.0331089049577713},{0.35704532265663147,-0.1393444985151291,-0.0551125593483448,-0.217075914144516,-0.21864144504070282,0.07530190050601959,0.3921240270137787,0.260718435049057,-0.4231235384941101,0.22557808458805084,-0.3213253617286682,-0.004304114729166031,-0.38815605640411377,-0.26183170080184937,-0.3232366144657135,0.09865414351224899},{-0.05329124629497528,-0.3068837523460388,0.34848150610923767,0.0362173356115818,-0.13996616005897522,-0.24923376739025116,0.2627061903476715,0.21606464684009552,0.07370497286319733,-0.3711067736148834,-0.042252108454704285,0.40232759714126587,0.24945297837257385,0.40077313780784607,-0.357329785823822,0.41893869638442993},{-0.12240877002477646,-0.36082786321640015,-0.28042519092559814,-0.018671633675694466,0.06833818554878235,-0.4616481065750122,0.27853530645370483,-0.3506597578525543,0.432019978761673,-0.37516722083091736,0.1318005472421646,0.157013937830925,-0.4025026559829712,-0.2810172438621521,0.269549697637558,0.0733659639954567},{0.2830811142921448,-0.22985497117042542,-0.0693698450922966,-0.03954401612281799,-0.15468254685401917,-0.3673758804798126,0.3897511065006256,-0.4159505069255829,-0.2892250418663025,0.1250200718641281,0.1406484842300415,-0.116620734333992,0.17888370156288147,-0.30530357360839844,0.4553426504135132,0.2478843480348587},{-0.14777332544326782,-0.0775238424539566,-0.3567212224006653,0.37173351645469666,-0.40149763226509094,0.22683851420879364,0.07223044335842133,0.45465466380119324,-0.2509675621986389,0.567693293094635,-0.03363172337412834,0.37680551409721375,0.1369839906692505,0.10969357937574387,0.20839360356330872,0.20021674036979675},{0.2825206518173218,-0.25621166825294495,-0.330361008644104,0.43656790256500244,0.44037511944770813,0.233756884932518,-0.20327146351337433,-0.3222200572490692,-0.21769806742668152,-0.04362843558192253,0.044628169387578964,-0.1639617383480072,-0.07691942900419235,-0.23412126302719116,-0.2495151162147522,0.03823595866560936}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{0.4821341633796692,-0.1525103598833084,0.46355122327804565,-0.10268618911504745},{0.3286360502243042,0.36749961972236633,0.3578067719936371,-0.22447791695594788},{-0.5461609959602356,0.42453479766845703,-0.22617220878601074,-0.16802404820919037},{-0.2815091609954834,0.3429650068283081,0.32291358709335327,0.647881031036377},{-0.26331910490989685,-0.1968926340341568,0.026954589411616325,0.05043699964880943},{-0.01908516138792038,0.5771783590316772,0.5537204146385193,-0.39638516306877136},{0.4577427804470062,-0.35926082730293274,-0.008494562469422817,-0.4867750108242035},{-0.03397790715098381,0.2565438747406006,-0.17798011004924774,0.5297008156776428},{0.16372188925743103,0.5248587727546692,-0.5114592909812927,-0.24962808191776276},{0.30177825689315796,0.22884942591190338,0.04102127254009247,0.3412723243236542},{0.41859927773475647,-0.14629192650318146,-0.008151046000421047,0.5246171951293945},{0.05481824278831482,-0.25664469599723816,-0.3998728394508362,-0.2841716408729553},{-0.1269463747739792,0.30114462971687317,0.06551342457532883,0.5103200674057007},{-0.3629121780395508,-0.5927503705024719,0.3674784004688263,-0.35873648524284363},{0.4069106876850128,0.23162321746349335,0.4307295083999634,0.06089763715863228},{0.005857059732079506,-0.453288197517395,-0.11385444551706314,0.3430468440055847}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.061812158674001694,0.1187845841050148,-0.0025623824913054705,0.11433406919240952,-0.09739352762699127,-0.015254073776304722,0.008408776484429836,-0.022217603400349617,-0.11300056427717209,0.03905202075839043,0.07432077080011368,0.13856303691864014,0.1263195127248764,-0.10700029879808426,0.042652759701013565,0.04927222058176994};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0013673146022483706,0.009300797246396542,-0.023304149508476257,0.06311231851577759,0.09309256076812744,-0.09032955020666122,-0.018627889454364777,0.035486672073602676,0.04435209184885025,-0.013769076205790043,-0.014334460720419884,0.0327402763068676,0.05320485308766365,-0.02729976363480091,0.035241540521383286,-0.09761884808540344};
static const float actor_encoder_feed_forward_0_bias[16] = {-0.038856033235788345,-0.05044468864798546,0.03980506584048271,0.05547073110938072,0.007223913446068764,-0.02800026908516884,0.01886957697570324,0.06852129846811295,0.0004302225133869797,0.03753277286887169,0.06628712266683578,0.014265250414609909,0.03969593718647957,-0.004615879617631435,-0.04878587648272514,0.09841263294219971};
static const float action_parameterization_distribution_linear_bias[4] = {-0.014692157506942749,-0.03786845505237579,-0.025571847334504128,0.07308762520551682};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

