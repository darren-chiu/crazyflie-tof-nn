
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.5076699256896973,0.02235480397939682,0.12334249913692474,-0.2742098569869995,-0.30985310673713684,0.13274140655994415,0.10377398878335953,0.02031322382390499,-0.08551371842622757,0.5601091384887695,0.23524339497089386,-0.20885136723518372,0.03818700462579727,0.012734656222164631,-0.0017321789637207985,0.3457588851451874},{0.42972710728645325,-0.04858538880944252,-0.07650598883628845,0.21962879598140717,0.18071015179157257,0.07552038878202438,-0.13167208433151245,0.28715622425079346,-0.16351154446601868,0.14023545384407043,-0.4100115895271301,0.07999303936958313,-0.17136825621128082,-0.256668359041214,-0.07144728302955627,0.1522410809993744},{-0.06541047245264053,0.22455915808677673,-0.47759348154067993,0.14771343767642975,-0.305834025144577,-0.0062050893902778625,0.05058283358812332,0.44100749492645264,-0.09406983107328415,-0.14634358882904053,-0.23508909344673157,-0.18357035517692566,0.023800885304808617,-0.19244511425495148,-0.5974428653717041,-0.5751327872276306},{-0.07983749359846115,-0.21671847999095917,-0.18616661429405212,-0.004343685228377581,-0.10066214948892593,-0.14674699306488037,0.32915034890174866,-0.21165700256824493,-0.26331862807273865,0.15369798243045807,0.4504935145378113,0.4158368408679962,0.07077822089195251,-0.14483468234539032,-0.054941415786743164,-0.16171810030937195},{0.27132493257522583,0.24003060162067413,0.18861378729343414,-0.10870952904224396,-0.09511595964431763,-0.08256761729717255,0.1783096343278885,0.26160570979118347,-0.2590023875236511,0.06647884845733643,-0.5420316457748413,-0.11924629658460617,-0.15078620612621307,-0.29151180386543274,-0.18941372632980347,0.13987629115581512},{-0.3388417959213257,0.4063910245895386,-0.16446861624717712,0.4348278045654297,0.09849284589290619,0.2516306936740875,-0.316659152507782,0.031285762786865234,0.05267496407032013,-0.11213330924510956,-0.02731977216899395,-0.2797912061214447,0.17826217412948608,0.32389870285987854,-0.28908979892730713,0.2712368071079254},{0.35272449254989624,0.37375354766845703,0.10990724712610245,-0.04172626510262489,0.16159389913082123,-0.3286633789539337,0.32962846755981445,-0.15252122282981873,0.09180528670549393,0.0374189056456089,0.4379163980484009,0.17649804055690765,-0.5089821815490723,0.4611128866672516,-0.03232009708881378,0.061008207499980927},{0.15637996792793274,0.29126542806625366,-0.301669180393219,-0.19851550459861755,0.026644757017493248,-0.09978967905044556,0.1795220822095871,0.2009621262550354,0.1778014451265335,-0.08680355548858643,-0.5740137696266174,0.20582148432731628,0.10900843143463135,0.048354439437389374,-0.30252477526664734,-0.16878613829612732},{-0.25088387727737427,-0.18494760990142822,-0.7399377822875977,-0.2986541986465454,-0.06971665471792221,-0.0937889963388443,0.0757514089345932,-0.011015559546649456,-0.6473537087440491,0.494798481464386,0.02991296537220478,0.33035677671432495,-0.1887536346912384,-0.03840881586074829,-0.05993485450744629,0.1300220638513565},{0.08348305523395538,0.3990933299064636,0.04433625563979149,0.2738851308822632,0.49214714765548706,-0.09795688092708588,0.39252325892448425,0.2521912455558777,0.3737061321735382,0.3958077132701874,-0.07225321978330612,-0.23124854266643524,-0.13208071887493134,0.4181966185569763,-0.16450510919094086,0.24832488596439362},{-0.025710755959153175,0.44383788108825684,-0.11770539730787277,-0.33935439586639404,0.31992825865745544,0.46652811765670776,0.30725938081741333,-0.22748714685440063,0.24842411279678345,-0.18476122617721558,0.09970035403966904,0.010507497005164623,-0.3301393687725067,-0.1575241982936859,0.005196846090257168,0.20569781959056854},{0.4326431155204773,0.1384364515542984,0.010871012695133686,0.1942078173160553,0.19864659011363983,0.39878982305526733,-0.03920457884669304,0.2904815673828125,-0.35470759868621826,0.23674626648426056,-0.015148160047829151,-0.061245061457157135,0.518221914768219,0.4376552402973175,-0.21608802676200867,0.403072327375412},{0.25153422355651855,0.07264210283756256,0.6387953162193298,0.05218522250652313,0.5819255113601685,0.5770388245582581,0.3653203248977661,0.15229661762714386,-0.2588493525981903,-0.13280487060546875,-0.14558689296245575,0.20682866871356964,-0.20008695125579834,0.5085040330886841,0.12343350797891617,0.22115781903266907},{0.06543458998203278,-0.19131827354431152,0.2840501368045807,-0.09656772762537003,0.29585760831832886,-0.24514852464199066,-0.6222270727157593,0.07259723544120789,0.22141538560390472,-0.40130624175071716,0.16586218774318695,0.12818863987922668,0.025920821353793144,-0.09033142775297165,-0.2213774472475052,-0.4024721682071686},{-0.31805291771888733,-0.33426526188850403,-0.30596694350242615,-0.20188754796981812,-0.008289407938718796,0.42483118176460266,-0.44835978746414185,-0.21934150159358978,-0.34419533610343933,0.2555365562438965,0.13715235888957977,0.12170484662055969,-0.40616375207901,0.3158089518547058,0.09708285331726074,-0.301327645778656},{0.004608863033354282,0.045407045632600784,0.027582505717873573,-0.15114057064056396,0.1732252985239029,0.008056892082095146,-0.36960089206695557,0.2041349560022354,0.2644323706626892,0.028835870325565338,-0.2793721556663513,-0.38524219393730164,-0.1328866332769394,-0.2679031491279602,0.10131599009037018,-0.1083507090806961},{0.2627291977405548,-0.2379395067691803,-0.15816417336463928,-0.3083617687225342,-0.128323495388031,-0.4222749173641205,0.23085074126720428,-0.37276530265808105,0.17485637962818146,0.1593347191810608,0.13661473989486694,0.030575759708881378,-0.27097946405410767,-0.11230409145355225,-0.2540048360824585,-0.14519362151622772},{-0.08068583905696869,0.13821950554847717,-0.12225908786058426,-0.10421808063983917,0.3022643029689789,-0.03985653445124626,-0.17530544102191925,-0.06868395209312439,0.05423939973115921,0.2800137996673584,0.09444869309663773,0.03909938037395477,-0.4748915731906891,0.39929625391960144,-0.312224417924881,0.031451739370822906}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.3132619261741638,-0.40314650535583496,-0.17214950919151306,-0.19206391274929047,-0.014679674059152603,0.2714623212814331,-0.19549089670181274,-0.12538374960422516,-0.2059399038553238,0.022820094600319862,0.3658239245414734,-0.09106941521167755,0.365695595741272,-0.08045878261327744,-0.02802344784140587,-0.020620716735720634},{0.07226748019456863,-0.39177316427230835,-0.4880580008029938,0.35356780886650085,0.2276626080274582,0.27136313915252686,0.23628085851669312,-0.003763392334803939,-0.10942725092172623,0.298971563577652,-0.11828351765871048,-0.1598544418811798,-0.03477277606725693,0.14093613624572754,-0.2700684070587158,-0.3034960627555847},{0.3809129297733307,-0.16043297946453094,0.48305872082710266,0.1330210268497467,0.556753933429718,0.31168168783187866,-0.4480085074901581,-0.20810216665267944,0.4399048984050751,-0.09687060117721558,-0.07515954971313477,0.23261067271232605,-0.08564148098230362,0.4347236454486847,-0.2305353879928589,0.39795807003974915},{-0.25050047039985657,0.1600845903158188,0.029480846598744392,0.23039597272872925,-0.0296564269810915,0.1478901356458664,-0.09117463231086731,0.19661955535411835,0.3897164762020111,-0.17372116446495056,0.3188971281051636,-0.19432519376277924,0.24876216053962708,-0.4541509747505188,-0.03814839944243431,-0.42157089710235596},{-0.02154303900897503,-0.31365054845809937,0.16846254467964172,0.33355212211608887,0.5226168036460876,0.19475187361240387,0.1268550306558609,-0.47083377838134766,0.10704030841588974,0.4701825678348541,0.3753388822078705,0.29583796858787537,0.08057527244091034,0.10090691596269608,0.20635908842086792,-0.34580492973327637},{-0.002108744578436017,-0.3363952338695526,-0.24873676896095276,-0.14453916251659393,-0.27487286925315857,-0.021156489849090576,0.03156416490674019,0.0583011694252491,-0.4100409150123596,0.27508819103240967,0.020016057416796684,0.11864380538463593,0.35688209533691406,0.20712687075138092,-0.33135807514190674,-0.13810588419437408},{0.35895657539367676,-0.039209794253110886,-0.3180023729801178,0.3471347987651825,0.4465906620025635,0.31940966844558716,-0.32939016819000244,0.06002006679773331,0.38397184014320374,-0.21056658029556274,-0.0022443500347435474,-0.3491651117801666,0.09465885162353516,-0.40529128909111023,0.0031004915945231915,0.12344203889369965},{0.026179101318120956,-0.18826498091220856,-0.16922034323215485,-0.11331130564212799,-0.08724862337112427,-0.21542569994926453,-0.1565568745136261,0.32689714431762695,-0.20091575384140015,-0.05658678337931633,-0.4196687936782837,-0.21255970001220703,0.21211691200733185,-0.20694921910762787,-0.10441043227910995,0.16885943710803986},{0.019315725192427635,-0.12491874396800995,0.1102491095662117,0.047490376979112625,0.20496223866939545,-0.45709463953971863,0.01170105766505003,0.30445876717567444,0.33472222089767456,-0.23926863074302673,-0.2522514760494232,-0.034582193940877914,-0.2994896471500397,-0.19309303164482117,0.3880328834056854,0.0005441027460619807},{-0.23703604936599731,0.022000310942530632,-0.29227790236473083,-0.22430424392223358,0.4047551453113556,0.42068421840667725,0.05403419956564903,-0.2996326684951782,0.08845945447683334,-0.08250384777784348,-0.31377092003822327,-0.24523115158081055,0.04136411473155022,0.05136410519480705,-0.12303604930639267,0.11815191805362701},{-0.0415860153734684,-0.21452781558036804,-0.14366289973258972,0.12355877459049225,-0.05504315346479416,-0.11176854372024536,0.38438528776168823,-0.02306555211544037,-0.3674280643463135,0.05134258419275284,-0.5640402436256409,0.0383206270635128,0.03659471869468689,0.03843916952610016,0.13662873208522797,0.43634146451950073},{-0.15788134932518005,-0.05911660194396973,-0.36215534806251526,-0.38236546516418457,-0.20240570604801178,0.14675742387771606,0.23913532495498657,-0.30994027853012085,-0.38274696469306946,0.1272914558649063,0.12694519758224487,-0.2693740427494049,0.1459931582212448,0.1852099895477295,-0.11231397837400436,-0.4413233697414398},{0.10235265642404556,-0.023509856313467026,-0.22205159068107605,-0.26373597979545593,0.18571363389492035,-0.06815709173679352,-0.43175241351127625,0.12170247733592987,0.3306855857372284,-0.26257917284965515,-0.048401471227407455,-0.08999547362327576,-0.21683673560619354,-0.37365826964378357,-0.20798930525779724,0.10060173273086548},{-0.20602980256080627,-0.16600170731544495,-0.027470143511891365,0.2155560553073883,0.24488240480422974,0.16254903376102448,-0.194230318069458,0.10256034880876541,-0.17272445559501648,0.33963462710380554,-0.11860396713018417,-0.26114383339881897,0.12296421825885773,-0.14177219569683075,0.08964686095714569,0.25768041610717773},{0.5991469621658325,-0.028059298172593117,-0.09964752197265625,-0.4301043152809143,0.4350036084651947,0.27963122725486755,0.1406216323375702,-0.1348779797554016,0.2677667438983917,0.05036073550581932,0.1045382171869278,-0.013099129311740398,-0.07815980911254883,0.3569497764110565,0.1675742268562317,0.37846970558166504},{0.47451016306877136,0.24801620841026306,0.19146455824375153,0.07330149412155151,-0.029919911175966263,0.2910539209842682,-0.22688028216362,-0.3598491847515106,0.22453929483890533,-0.18749049305915833,-0.07265904545783997,-0.050250839442014694,0.24691233038902283,-0.39594340324401855,0.21194520592689514,0.21788808703422546}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.08777763694524765,0.16353169083595276,-0.252467542886734,0.16303440928459167,-0.19476206600666046,-0.20803822576999664,-0.1831161379814148,0.09614606201648712,0.16390424966812134,0.2899180054664612,-0.13955454528331757,0.20496927201747894,-0.10955772548913956,-0.10885898768901825,0.13016468286514282,0.3336693346500397,0.144937664270401,-0.07358022779226303,0.06505416333675385,-0.1313956379890442,-0.15054263174533844,-0.3261677026748657,0.00039772639865987003,0.2158500999212265,0.22846302390098572,0.22259880602359772,0.2540372610092163,-0.12590466439723969,-0.10004325956106186,-0.04401658475399017,-0.25391238927841187,0.3586447238922119},{-0.31319957971572876,-0.042880985885858536,-0.009505641646683216,0.2550828456878662,-0.3342151343822479,0.1682019829750061,-0.21160103380680084,-0.08519390225410461,-0.2974778413772583,-0.30892568826675415,-0.1838509738445282,0.1266029328107834,0.3929325044155121,-0.30759236216545105,0.20862478017807007,0.11225471645593643,-0.11212006211280823,0.24548110365867615,-0.14046142995357513,-0.055583592504262924,0.018833916634321213,-0.08296971023082733,0.10558266937732697,-0.07900308817625046,0.27670326828956604,0.11933495849370956,-0.23335006833076477,-0.05413440987467766,0.16626274585723877,-0.255470871925354,-0.16901101171970367,0.11281994730234146},{-0.28603416681289673,-0.12776900827884674,-0.4638274908065796,-0.01886073872447014,-0.03180597722530365,0.01161122415214777,-0.11727606505155563,0.34487178921699524,-0.08434369415044785,-0.23064345121383667,0.02284175157546997,0.2572810649871826,-0.194552943110466,0.3547581434249878,0.23184895515441895,0.22152438759803772,-0.22912533581256866,0.022420834749937057,-0.04944596067070961,-0.27987226843833923,-0.3275494873523712,-0.25042250752449036,0.29756954312324524,0.2116246372461319,0.2823963463306427,0.25183209776878357,-0.14829464256763458,0.0985666811466217,-0.24634695053100586,-0.019657734781503677,-0.24808965623378754,0.2216583639383316},{-0.15503549575805664,0.34256747364997864,0.3423868417739868,0.038850173354148865,0.09058351069688797,0.31174635887145996,0.3872620463371277,0.21262075006961823,0.15926726162433624,0.36804521083831787,-0.36739251017570496,-0.24190184473991394,-0.22245480120182037,-0.24149437248706818,-0.2955946922302246,0.3066025972366333,0.015481622889637947,-0.3456019461154938,-0.2462596893310547,0.30928242206573486,-0.12517258524894714,0.20830917358398438,0.3866383135318756,0.15688525140285492,-0.10350436717271805,-0.030212566256523132,-0.26601043343544006,-0.0694500207901001,-0.3495914340019226,0.08676567673683167,-0.11804948002099991,-0.03086211532354355},{-0.2345660775899887,0.10149125009775162,-0.24815522134304047,-0.2972804605960846,0.3523259162902832,0.3253747820854187,0.25701257586479187,-0.10813388973474503,-0.43453067541122437,0.005711054895073175,-0.011578517034649849,0.047417428344488144,0.24669110774993896,0.01036516111344099,-0.15765222907066345,-0.05862186849117279,-0.11990691721439362,0.3680145740509033,-0.25635117292404175,0.09255018830299377,-0.11688537150621414,0.2532314360141754,-0.2743697166442871,0.060358040034770966,0.3594895899295807,0.19160419702529907,0.441139817237854,-0.2733624577522278,-0.08733804523944855,-0.20814159512519836,-0.0784125104546547,0.4244593381881714},{-0.10621295869350433,0.14376623928546906,0.018640240654349327,0.24463996291160583,0.1590053141117096,-0.3186034858226776,0.05089308321475983,0.2659999430179596,0.18998664617538452,-0.09132610261440277,0.02224833332002163,0.25382936000823975,0.22590334713459015,-0.11473936587572098,0.09952188283205032,-0.2624455988407135,-0.09090034663677216,0.21893002092838287,0.24997998774051666,0.16269633173942566,0.1491943895816803,-0.22212158143520355,0.2562864422798157,-0.04532720148563385,-0.2612558901309967,-0.09221085160970688,-0.19487224519252777,-0.24498644471168518,0.03492164611816406,0.3391246497631073,-0.15637287497520447,0.3423900902271271},{0.0680616945028305,-0.22283220291137695,-0.22238175570964813,0.3647853136062622,0.009768525138497353,0.2999524176120758,0.0957198217511177,0.13030798733234406,-0.3809548020362854,0.2818799316883087,-0.05871694162487984,-0.12777338922023773,-0.30329036712646484,-0.1665658801794052,-0.05280694365501404,-0.23674429953098297,0.039879295974969864,0.2760075628757477,0.23997178673744202,0.3276827335357666,-0.16103704273700714,-0.06651435792446136,0.2557172179222107,-0.325808584690094,0.30197444558143616,0.21031306684017181,0.08495481312274933,-0.11357548832893372,-0.05989813804626465,0.021461505442857742,-0.02148926630616188,-0.3233453035354614},{-0.30436888337135315,0.31302687525749207,0.2834005653858185,-0.2435052990913391,0.14870524406433105,0.1092623621225357,-0.17653311789035797,0.10259462893009186,-0.06883138418197632,0.2468510866165161,0.2916713058948517,0.035058800131082535,-0.2357172966003418,-0.2170102447271347,-0.11232763528823853,0.04493246227502823,0.3206126093864441,-0.20883706212043762,-0.14712627232074738,0.22177956998348236,0.015122946351766586,-0.09522049129009247,-0.13389337062835693,-0.3011561632156372,-0.35612261295318604,-0.44939693808555603,-0.007920172065496445,-0.2614652216434479,0.0745152160525322,-0.3414601981639862,0.06902740150690079,-0.07404517382383347},{-0.18455475568771362,0.2037174105644226,0.05125057324767113,-0.15560539066791534,-0.1816224604845047,0.11894619464874268,0.3885021209716797,-0.09135940670967102,0.04712757468223572,-0.1419610232114792,0.25724729895591736,-0.16841661930084229,0.3340579867362976,0.14086349308490753,-0.26046425104141235,-0.09356442838907242,-0.2740514576435089,-0.1635775864124298,0.23026978969573975,-0.20699433982372284,0.1617221087217331,-0.05211983993649483,-0.12094959616661072,-0.2755142152309418,-0.24334116280078888,0.2334596812725067,0.25229111313819885,0.14897778630256653,0.2189379781484604,-0.27150434255599976,-0.26021432876586914,-0.041018977761268616},{0.06277985870838165,-0.10892730951309204,-0.261319637298584,-0.2899462878704071,-0.20864765346050262,0.27343812584877014,0.05604417249560356,-0.12037129700183868,0.17771382629871368,-0.24804401397705078,-0.0720594972372055,0.2752932906150818,0.2154911756515503,0.2586342394351959,-0.21208220720291138,0.2149258553981781,-0.08297672122716904,-0.05379597842693329,0.04744657874107361,0.04506605491042137,-0.06380771100521088,0.2184763103723526,0.18978305160999298,0.051028285175561905,-0.08987241238355637,-0.1748446524143219,0.2158011943101883,0.2231147289276123,-0.27368688583374023,0.37613677978515625,-0.03775947913527489,0.2396867573261261},{0.22414860129356384,0.28088244795799255,-0.24538247287273407,0.13560369610786438,-0.10211215913295746,-0.09813307225704193,0.21825651824474335,-0.19681985676288605,0.1476888358592987,0.1492374688386917,0.10029979795217514,0.1996280550956726,-0.03624630346894264,0.15062972903251648,0.11757346987724304,0.03365898132324219,0.19951114058494568,0.23217463493347168,-0.011476357467472553,0.04151279106736183,-0.022105371579527855,-0.2941837012767792,-0.3045528531074524,-0.11529826372861862,0.00020132899226155132,-0.1037178561091423,-0.07632402330636978,-0.2324855476617813,-0.1000494509935379,0.019410232082009315,-0.12720006704330444,0.298110693693161},{-0.054892998188734055,0.33353477716445923,-0.24814173579216003,-0.2796783447265625,0.2648390829563141,-0.21444211900234222,-0.2004423886537552,0.14303655922412872,-0.14391298592090607,-0.03363542631268501,0.2255493551492691,0.2646577060222626,-0.23328037559986115,-0.28640514612197876,0.03388664871454239,-0.19833511114120483,0.09054259210824966,0.277490496635437,-0.13859951496124268,0.12509165704250336,-0.2759804129600525,0.05452980101108551,0.2233177274465561,0.16006053984165192,0.07945515960454941,-0.08424199372529984,0.0033245619852095842,-0.022438345476984978,-0.23654183745384216,-0.27789080142974854,-0.27538368105888367,-0.30338403582572937},{0.14408966898918152,-0.032144904136657715,0.07357093691825867,0.2222028225660324,0.04311753809452057,0.05827581509947777,0.0036757478956133127,-0.0879046618938446,0.0935109555721283,0.17616453766822815,0.07244696468114853,0.10164906084537506,-0.07523278146982193,0.24205920100212097,0.0850699171423912,0.07116672396659851,-0.30186840891838074,-0.20999909937381744,0.32256296277046204,-0.2066688984632492,-0.08715181797742844,-0.15386024117469788,-0.006999138277024031,0.2888479232788086,0.05953904986381531,0.1507871150970459,-0.14964349567890167,-0.27268534898757935,0.16572345793247223,0.45336103439331055,0.34336331486701965,-0.1381852626800537},{-0.05900908261537552,0.27385783195495605,-0.4639155864715576,0.15879957377910614,-0.10841257870197296,-0.2836778163909912,0.19861547648906708,0.14007236063480377,0.20294147729873657,-0.06388676911592484,0.20342814922332764,0.1996975541114807,-0.2639065086841583,0.18469305336475372,0.2067837417125702,-0.17901064455509186,0.0028468279633671045,-0.2528688609600067,-0.2079065889120102,0.05460091680288315,0.009177139028906822,0.1484244167804718,0.1112658679485321,0.13278958201408386,-0.2565264105796814,-0.11343832314014435,-0.005265329964458942,-0.09105794131755829,0.3014562427997589,0.06459181755781174,0.22146624326705933,-0.13472265005111694},{0.080784372985363,-0.3367234170436859,-0.12619075179100037,0.19468183815479279,0.2400342971086502,0.09779226034879684,0.037559423595666885,-0.3179263174533844,-0.21562083065509796,0.350564569234848,-0.297351598739624,0.2189008742570877,-0.26596879959106445,0.26366472244262695,0.17887991666793823,-0.051285311579704285,-0.12099982053041458,0.18942072987556458,0.34966060519218445,-0.14079707860946655,0.08131810277700424,-0.11679954081773758,-0.22766856849193573,-0.08631666749715805,-0.06509668380022049,-0.03323367238044739,0.15875643491744995,0.2156325876712799,0.16254347562789917,-0.27738437056541443,-0.33544355630874634,0.2905524969100952},{-0.2109392285346985,-0.2867225408554077,-0.24826295673847198,0.20022007822990417,-0.23343224823474884,0.2203640639781952,-0.15239830315113068,-0.1873759627342224,0.032347988337278366,-0.018047042191028595,0.2886183261871338,0.12125230580568314,0.048245370388031006,0.23587650060653687,0.3242209851741791,-0.021943366155028343,-0.027749260887503624,0.28430795669555664,0.19321531057357788,0.14052706956863403,0.031701963394880295,-0.27833184599876404,0.1630060374736786,0.018550941720604897,0.2152455896139145,0.04305803030729294,-0.2604459226131439,0.008472536690533161,-0.13393110036849976,0.1279735118150711,0.24193045496940613,-0.09580100327730179},{-0.20498497784137726,0.1461605578660965,-0.06158880144357681,0.24966375529766083,0.1125405877828598,-0.10993338376283646,-0.21872763335704803,-0.006117490120232105,0.1318037360906601,0.1319834142923355,-0.24322625994682312,0.12262420356273651,0.23045170307159424,-0.06052883341908455,0.25904059410095215,-0.26053014397621155,0.2599114179611206,0.012947644107043743,0.2784704566001892,0.10943218320608139,-0.4348190128803253,-0.11652388423681259,-0.20761877298355103,0.06533167511224747,-0.13025104999542236,-0.21828176081180573,0.0048519521951675415,0.07893942296504974,0.18254874646663666,-0.23472212255001068,-0.26412728428840637,-0.23751509189605713},{0.2958658039569855,-0.22304806113243103,-0.08210403472185135,-0.26111435890197754,0.13189060986042023,-0.1094386950135231,0.0865858867764473,0.21815036237239838,0.27395910024642944,-0.29141348600387573,-0.21804440021514893,-0.13442568480968475,0.37686899304389954,-0.13118509948253632,-0.19685161113739014,-0.33834266662597656,-0.05418321117758751,0.21297048032283783,0.11383689194917679,0.23154863715171814,-0.14827165007591248,-0.21471579372882843,0.07439302653074265,-0.17051386833190918,-0.16122785210609436,-0.1614275872707367,0.2124725729227066,0.23092451691627502,0.066855788230896,-0.1399732232093811,-0.3271903991699219,0.10287126153707504},{0.22051115334033966,-0.15200108289718628,0.0014514216454699636,-0.11739668250083923,0.3135456442832947,-0.2240963876247406,0.14793670177459717,0.1557026356458664,-0.044181279838085175,0.2293168604373932,-0.39767003059387207,-0.17956407368183136,0.27737581729888916,-0.05362692475318909,-0.18627576529979706,-0.23756757378578186,-0.010834809392690659,0.01834261417388916,-0.14142626523971558,-0.04449940472841263,-0.2006417065858841,-0.18644841015338898,-0.20158736407756805,-0.06941806524991989,0.17626389861106873,-0.07005282491445541,-0.23902323842048645,0.07743906229734421,0.19622920453548431,-0.24228203296661377,0.3587974011898041,0.19980427622795105},{0.29151925444602966,-0.024188118055462837,-0.24888622760772705,-0.21446983516216278,0.0499952957034111,0.05700067803263664,0.01067495159804821,0.03787663206458092,0.15792754292488098,-0.005666058044880629,0.29330506920814514,0.1540062129497528,0.04424262046813965,-0.30004751682281494,-0.047196727246046066,-0.22632437944412231,-0.20027129352092743,0.07958922535181046,-0.2807988226413727,0.31060296297073364,0.19416232407093048,0.005842719227075577,0.026608368381857872,-0.15254473686218262,0.20463316142559052,0.028751589357852936,-0.03544267266988754,0.05881671607494354,-0.06315767765045166,0.28062695264816284,0.012668427079916,0.08751443028450012}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.0630740225315094,-0.27091291546821594,0.06801895797252655,-0.11492832750082016},{0.06764747947454453,-0.024945013225078583,-0.06791970133781433,-0.30756211280822754},{-0.11225508898496628,-0.13887058198451996,-0.1535787284374237,-0.061291441321372986},{0.12470631301403046,-0.2527836561203003,0.04753679037094116,-0.09528053551912308},{0.14099493622779846,0.0032643338199704885,0.09601084887981415,-0.20596791803836823},{0.3646542727947235,-0.31279441714286804,-0.32684627175331116,0.2992238700389862},{0.16213874518871307,0.027066366747021675,0.20300419628620148,-0.28919777274131775},{0.24531258642673492,0.06997768580913544,-0.07511041313409805,-0.10143490135669708},{-0.2143476903438568,0.023461660370230675,-0.040797799825668335,0.011563842184841633},{0.1685796082019806,-0.3187594711780548,-0.1838620901107788,0.014494714327156544},{-0.02191014774143696,0.16867661476135254,-0.12618693709373474,-0.02436887100338936},{0.019861692562699318,0.4272668957710266,0.3042125999927521,0.04755556583404541},{-0.38500818610191345,-0.1924525499343872,0.3712121844291687,0.14093844592571259},{0.2960525453090668,0.36571043729782104,-0.23587670922279358,-0.30461496114730835},{0.26186418533325195,0.1620211899280548,-0.23506902158260345,0.1476316899061203},{-0.10380823165178299,0.011381043121218681,0.24377480149269104,-0.3478032648563385},{0.1056140884757042,-0.06444110721349716,-0.2738993465900421,-0.06079684942960739},{0.26996123790740967,-0.10206805914640427,0.014299123547971249,0.18809624016284943},{0.12573879957199097,-0.2954220175743103,0.32202744483947754,-0.005579414777457714},{0.03721103444695473,-0.16423580050468445,0.06838057190179825,-0.168600931763649},{-0.1634855717420578,-0.16699416935443878,-0.255068838596344,0.2498181313276291},{-0.21087908744812012,-0.29076331853866577,0.14950884878635406,-0.24572820961475372},{0.15883317589759827,-0.29154297709465027,-0.17158065736293793,0.10126298666000366},{0.03467685729265213,0.13338641822338104,0.32368287444114685,0.30817538499832153},{0.22582992911338806,-0.2624349594116211,0.28296545147895813,0.26038822531700134},{0.12652713060379028,0.08342184871435165,0.23747792840003967,0.026614248752593994},{0.32274767756462097,-0.09006071090698242,0.3127400577068329,0.01043141819536686},{0.10912015289068222,0.004916598089039326,-0.2491532862186432,0.0877888947725296},{-0.07760174572467804,0.1956338733434677,-0.08141525089740753,0.2955668270587921},{-0.07274968922138214,0.05419599637389183,0.28888481855392456,0.24534639716148376},{0.12189478427171707,0.0614471435546875,0.2514841556549072,-0.09459288418292999},{0.39331698417663574,0.1826402246952057,0.0724516436457634,0.2156343311071396}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.035756226629018784,-0.025261390954256058,-0.04778227582573891,-0.05415576323866844,-0.10746166855096817,0.10089264810085297,-0.05322775989770889,0.04294911399483681,0.0008305691299028695,-0.04097095504403114,-0.05951068177819252,0.004137684125453234,-0.053377509117126465,-0.06560294330120087,0.025418924167752266,-0.026588723063468933};
static const float actor_encoder_self_encoder_2_bias[16] = {0.06142406538128853,-0.019342951476573944,0.10184218734502792,-0.06954988837242126,-0.02510153502225876,-0.005227519664913416,0.03902082145214081,0.004131068475544453,-0.1902674287557602,0.0670371875166893,0.0015033659292384982,0.022525912150740623,-0.013788504526019096,-0.026271872222423553,0.05096835270524025,0.06397257000207901};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.020044323056936264,-0.031158387660980225,-0.09941449761390686,-0.05121057480573654,0.039888206869363785,0.0022337206173688173,0.0204416885972023,0.07175558805465698,-0.08683976531028748,-0.028084173798561096,0.029996192082762718,0.07289581745862961,-0.076048843562603,0.021611452102661133,0.05143258348107338,-0.0040710181929171085,-0.0058518522419035435,0.03833704814314842,-0.00044749811058864,0.024457888677716255,-0.06892616301774979,-0.07830889523029327,-0.015646716579794884,0.04614613205194473,0.0331372432410717,0.08876270800828934,0.08487255126237869,0.017333563417196274,0.020509278401732445,0.1002379059791565,0.13109898567199707,0.09845812618732452};
static const float action_parameterization_distribution_linear_bias[4] = {0.07401072233915329,0.05521686375141144,0.047330960631370544,0.019572267308831215};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.13108879327774048,-0.3395663797855377,-0.2201472967863083,-0.3224389851093292},{0.31809723377227783,0.003261192701756954,-0.2596505284309387,-0.21709060668945312},{-0.2705967128276825,-0.041607748717069626,0.3520831763744354,0.22703143954277039},{-0.07519293576478958,-0.41789570450782776,0.19399984180927277,0.3825169503688812},{0.23250670731067657,0.45030835270881653,0.10325262695550919,0.5073574781417847},{0.26813021302223206,-0.010487179271876812,-0.06138559803366661,-0.42467907071113586},{0.22081811726093292,-0.5565740466117859,-0.15197651088237762,0.05826662853360176},{-0.39543816447257996,-0.14476123452186584,0.35352301597595215,-0.06828492879867554},{0.004575212951749563,-0.06876664608716965,0.09253624826669693,0.08606202900409698},{-0.05398422107100487,0.14790992438793182,-0.22473156452178955,-0.3118451237678528},{0.24216143786907196,-0.34271514415740967,-0.03581508621573448,-0.41362541913986206},{-0.2500975728034973,0.26822540163993835,0.37821632623672485,0.1196606457233429},{-0.1909596472978592,0.39552590250968933,-0.10148046165704727,-0.037844881415367126},{-0.5319967865943909,0.26754286885261536,0.2509568929672241,0.12731805443763733},{-0.49634021520614624,-0.2856784462928772,0.12092633545398712,-0.1064557209610939},{-0.4670577645301819,-0.40623772144317627,-0.3737928569316864,-0.12394700944423676}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.5198870301246643,-0.5143792629241943,-0.35247522592544556,-0.6729941368103027},{0.5001057982444763,0.6251550316810608,-0.008713348768651485,-0.10211030393838882},{0.5337879657745361,-0.6352815628051758,0.27886006236076355,0.6299373507499695},{-0.5262489318847656,-0.4908522367477417,0.4135490655899048,-0.1944073587656021}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.14478029310703278,-0.07140158116817474,0.04757598042488098,0.024154242128133774};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.09107699245214462,-0.032350849360227585,-0.08814731985330582,0.0261339470744133};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

