
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 20},{20, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[20];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.47557333111763,0.4840443432331085,-0.37340593338012695,0.08116170763969421,-0.07445249706506729,-0.03100232407450676,0.13979165256023407,-0.09066314250230789,0.04958971589803696,0.1227363646030426,0.04360376298427582,-0.025883840397000313,-0.2426053136587143,0.11200717836618423,-0.07892260700464249,0.13165497779846191},{-0.46648117899894714,-0.2890271246433258,-0.11611854285001755,0.11053530126810074,-0.048390671610832214,0.5783660411834717,-0.09133809059858322,0.03800854831933975,0.1927015483379364,-0.26374879479408264,0.06532983481884003,0.36057984828948975,0.11718650162220001,-0.19820928573608398,0.19493603706359863,-0.1382340043783188},{-0.23133596777915955,-0.2728685736656189,-0.18888673186302185,-0.31599748134613037,0.4035121500492096,-0.1288948804140091,-0.639754593372345,-0.012862923555076122,0.23313677310943604,0.5274494290351868,-0.39947932958602905,0.12768788635730743,-0.24883930385112762,0.4318711459636688,0.3025767207145691,-0.25683197379112244},{-0.3916979432106018,0.251427561044693,-0.27645352482795715,0.05995913967490196,0.23606528341770172,0.20720486342906952,-0.23954126238822937,-0.07682769745588303,0.24467015266418457,-0.03665373846888542,0.060986798256635666,0.05115782469511032,-0.08082454651594162,-0.31346437335014343,-0.04896431788802147,0.2506085932254791},{0.051051586866378784,0.16306807100772858,-0.2325209230184555,0.027075668796896935,-0.2087998241186142,0.09493494033813477,-0.14380383491516113,-0.1634347289800644,0.08060738444328308,0.0858415886759758,0.12645955383777618,0.36129462718963623,-0.4128977954387665,-0.032735951244831085,0.02780003659427166,0.3158184587955475},{0.05701739341020584,0.18930330872535706,-0.4334017038345337,-0.23245665431022644,0.122370146214962,0.006618826184421778,-0.48562487959861755,0.0576154850423336,0.3951515853404999,-0.1565590351819992,-0.1052132099866867,0.13675402104854584,-0.2234347015619278,0.39130470156669617,-0.02144140936434269,-0.14727382361888885},{0.028987640514969826,-0.1444232314825058,-0.24066415429115295,0.33759549260139465,-0.11473646014928818,-0.28603094816207886,-0.22711937129497528,-0.3457479774951935,-0.3336297571659088,-0.33807992935180664,-0.2540697455406189,-0.16886457800865173,0.05075186863541603,0.29531848430633545,-0.18213985860347748,-0.16363200545310974},{0.27167412638664246,0.15109790861606598,-0.345981627702713,-0.07627655565738678,-0.2161588966846466,0.4475811719894409,-0.5668721795082092,0.4875757098197937,-0.26323196291923523,0.4917724132537842,0.23740147054195404,-0.09847324341535568,-0.17871204018592834,-0.1980183869600296,-0.021940236911177635,0.7854087948799133},{-0.565155565738678,-0.1284814476966858,-0.010217225179076195,0.9884273409843445,0.5985692739486694,0.11444522440433502,0.30600881576538086,0.19136878848075867,0.3867812156677246,0.22061406075954437,-0.5090916752815247,-0.16035205125808716,0.45255908370018005,-0.17084451019763947,0.23625953495502472,0.04703885316848755},{-0.16705770790576935,0.3915810286998749,0.040542881935834885,-0.07496260851621628,-0.1299366056919098,-0.24053648114204407,0.4179656505584717,-0.23340758681297302,-0.11301412433385849,-0.40593138337135315,-0.22015200555324554,0.5076123476028442,0.30965909361839294,0.3654111623764038,-0.18644218146800995,-0.844470739364624},{0.37586966156959534,-0.2642074525356293,-0.4959535598754883,0.4619481861591339,0.27861878275871277,-0.040062643587589264,0.3344302177429199,-0.4700881838798523,-0.29233938455581665,0.015247497707605362,-0.26248085498809814,-0.10008348524570465,-0.3510019779205322,-0.3899362087249756,-0.018055833876132965,0.2631763219833374},{-0.22531989216804504,-0.25462278723716736,-0.12434014678001404,-0.3598996698856354,-0.06628797948360443,0.4789920449256897,0.057593248784542084,-0.5411110520362854,-0.5687767863273621,-0.1067792996764183,-0.4665345549583435,0.5446985363960266,0.030085215345025063,-0.06392955780029297,0.6700248122215271,0.12435360997915268},{-0.3829489052295685,0.13340803980827332,0.4219527244567871,0.28167930245399475,0.08365126699209213,0.16689853370189667,0.3492293655872345,0.18994154036045074,-0.08547109365463257,-0.5251625776290894,-0.1445227563381195,-0.290081262588501,0.3797384202480316,-0.32237520813941956,-0.08677773922681808,0.10931743681430817},{0.3099718689918518,0.1390066295862198,-0.11642713099718094,0.2973766028881073,-0.27837178111076355,0.012639950029551983,0.22136257588863373,-0.5572229027748108,-0.07515849173069,-0.6837910413742065,-0.11861552298069,0.4614492356777191,-0.0756261944770813,0.06681201606988907,0.20473286509513855,-0.05231586471199989},{-0.3136078417301178,-0.22609053552150726,-0.2722092568874359,-0.21711549162864685,-0.2638028860092163,-0.5155556797981262,0.1377328485250473,0.43021824955940247,-0.4998261034488678,0.36994171142578125,-0.06876496225595474,0.014054801315069199,-0.13993290066719055,0.5167052149772644,0.2780832350254059,0.1883457601070404},{-0.17399363219738007,0.005616014823317528,-0.25487545132637024,0.027644144371151924,-0.2651180624961853,-0.3373779058456421,-0.11520751565694809,-0.300616979598999,-0.191491961479187,-0.10588601231575012,0.02909836173057556,0.2649065852165222,0.3031727373600006,0.28022944927215576,0.041275911033153534,0.1798281967639923},{0.24627697467803955,-0.2351592630147934,0.17827893793582916,-0.1279488205909729,-0.08821756392717361,0.2003968060016632,0.13024264574050903,-0.02177148312330246,-0.41235241293907166,0.2379283308982849,0.11566252261400223,-0.15381839871406555,-0.26585859060287476,0.22857531905174255,0.21143612265586853,-0.057420648634433746},{0.346611887216568,0.09468969702720642,0.12528017163276672,0.07743076980113983,-0.013910521753132343,0.12476301193237305,-0.07238315045833588,0.11686673015356064,-0.2480834573507309,0.3513927459716797,0.22567011415958405,0.2863132059574127,-0.21256132423877716,-0.2001660019159317,-0.006268276367336512,0.20156919956207275}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.005545430816709995,0.0452919527888298,-0.021428456529974937,-0.04816122353076935,-0.1393914818763733,-0.3573760986328125,0.5190109610557556,-0.19438591599464417,-0.39739614725112915,-0.14579810202121735,-0.04462249577045441,-0.1405661702156067,-0.11304014921188354,0.23668989539146423,-0.12770628929138184,0.1669957935810089},{-0.20651236176490784,0.17796504497528076,0.02776949107646942,-0.0803065076470375,-0.2902888357639313,-0.08976766467094421,-0.3948994278907776,0.2917284667491913,0.4170171022415161,-0.04693208634853363,0.10199075937271118,0.37686944007873535,0.06641560792922974,0.4586613178253174,-0.33053281903266907,-0.44336998462677},{0.2419150471687317,0.1855311542749405,0.4256681203842163,-0.023394688963890076,-0.08443605154752731,-0.1349984109401703,0.060708098113536835,-0.32705727219581604,0.3881007730960846,0.23213781416416168,0.313233882188797,-0.39846163988113403,-0.023929806426167488,-0.2824006974697113,-0.21861790120601654,0.2928658723831177},{-0.11761794239282608,0.03051573410630226,-0.006150498054921627,0.22813227772712708,-0.18400514125823975,0.3557310104370117,0.16111499071121216,0.4399271309375763,-0.38274407386779785,0.11148451268672943,-0.09820245206356049,0.19182215631008148,0.5310749411582947,0.14830675721168518,0.3478412628173828,0.337517648935318},{-0.21163253486156464,0.22820119559764862,0.030990147963166237,0.4223400056362152,0.20956595242023468,0.4216015338897705,0.0448797382414341,-0.443556547164917,-0.10249625146389008,-0.11602003127336502,0.11245931684970856,0.09328743815422058,0.13206975162029266,0.152171790599823,0.17522552609443665,0.07787495851516724},{0.07092711329460144,-0.09557395428419113,-0.29711613059043884,-0.37468117475509644,-0.347867876291275,0.04342379420995712,0.12946182489395142,0.06595581769943237,-0.05109687149524689,-0.38341760635375977,-0.24331365525722504,0.22640831768512726,0.0794953778386116,0.19040228426456451,0.15827231109142303,-0.3542594015598297},{-0.25003781914711,0.33976656198501587,-0.1030484288930893,0.06820779293775558,-0.009791633114218712,0.26343414187431335,-0.2941693365573883,0.2059326469898224,0.24135857820510864,0.5649207234382629,-0.168784499168396,0.25599268078804016,-0.1939215362071991,0.34264808893203735,0.285282701253891,0.2296304851770401},{-0.00882007833570242,-0.2320425808429718,-0.264543741941452,0.4173426628112793,-0.42004358768463135,0.5349878668785095,-0.3666931688785553,0.27091771364212036,-0.32367125153541565,0.1059405580163002,-0.09815960377454758,-0.4526996612548828,-0.41177624464035034,0.26337769627571106,0.06653549522161484,0.29881563782691956},{0.25862374901771545,-0.19375184178352356,0.3193100690841675,-0.15066884458065033,0.41072699427604675,-0.32877087593078613,-0.27845850586891174,0.24527843296527863,0.16151145100593567,0.1429932564496994,0.13727404177188873,-0.34495237469673157,0.06273174285888672,0.08123715221881866,0.08184390515089035,-0.37229377031326294},{-0.02192888781428337,-0.29919782280921936,0.2708016335964203,0.3942827582359314,-0.16760535538196564,-0.22228145599365234,-0.34328585863113403,0.1550370752811432,-0.1800866574048996,0.03786688297986984,0.07625825703144073,-0.42112308740615845,-0.07146098464727402,-0.34806501865386963,-0.3834836781024933,0.0263937059789896},{0.10575325042009354,-0.24026386439800262,0.03216158226132393,-0.33032286167144775,-0.3884372115135193,-0.015596129931509495,-0.24967242777347565,0.35684895515441895,-0.03993908315896988,0.15444892644882202,0.11292856931686401,-0.316630095243454,-0.3941326141357422,0.14452524483203888,0.15548266470432281,-0.017074748873710632},{-0.34588924050331116,-0.06832608580589294,0.07911411672830582,-0.11121287941932678,0.12846678495407104,-0.19181478023529053,-0.07399770617485046,0.21195176243782043,0.04669267684221268,-0.07774674147367477,-0.2162696123123169,-0.25444334745407104,-0.2363044023513794,0.40615206956863403,0.06571047008037567,-0.18990018963813782},{0.3536088466644287,-0.276825875043869,0.17209330201148987,0.1047251895070076,-0.21310663223266602,0.17250648140907288,-0.06581873446702957,0.18401974439620972,0.2725580334663391,0.13895586133003235,-0.012721408158540726,-0.21811996400356293,0.116378553211689,0.35044562816619873,-0.23157070577144623,0.3838486671447754},{-0.2976524233818054,0.12229116261005402,0.3267187178134918,0.30353260040283203,-0.23294420540332794,-0.4277593493461609,-0.18475587666034698,-0.3355370759963989,0.2364497035741806,0.1074211373925209,-0.20124775171279907,0.1623188555240631,0.028340307995676994,-0.0107178445905447,-0.0028326460160315037,0.0994076207280159},{-0.05987277254462242,-0.44504231214523315,-0.39649441838264465,0.40269964933395386,0.24847570061683655,-0.0878080353140831,-0.19284772872924805,0.3333315849304199,0.38818785548210144,0.24101780354976654,-0.3103943467140198,-0.06000784784555435,0.07300528883934021,0.043484702706336975,-0.4619194567203522,-0.2590210437774658},{0.058074016124010086,0.3807619512081146,-0.23284755647182465,0.34225741028785706,0.017244990915060043,0.2681554853916168,0.5065227746963501,0.11225369572639465,0.2930537462234497,-0.2532191872596741,-0.3845027685165405,-0.08002422749996185,-0.0018673754530027509,-0.15456196665763855,-0.44228705763816833,-0.368294358253479}};
static const float actor_encoder_feed_forward_0_weight[20][20] = {{0.1302172988653183,0.049671437591314316,0.10746219009160995,0.44343316555023193,-0.04600588232278824,0.38263577222824097,-0.17170138657093048,0.18745215237140656,-0.040318336337804794,0.0011015832424163818,0.12537410855293274,-0.01493100356310606,-0.01108025573194027,-0.15923729538917542,-0.28772836923599243,0.11393215507268906,-0.21497854590415955,-0.1234203651547432,0.008335703983902931,0.22253596782684326},{0.11525949090719223,0.09534849971532822,0.20590588450431824,0.45968014001846313,-0.27605023980140686,0.33862611651420593,0.3076207637786865,0.35045796632766724,-0.16998189687728882,-0.3914618492126465,-0.2948901653289795,0.06023456156253815,-0.09487829357385635,0.26045671105384827,-0.2760707139968872,-0.20878338813781738,0.08253396302461624,0.39981138706207275,-0.09766048938035965,0.14641016721725464},{0.2041206657886505,0.11841655522584915,0.05439658835530281,0.021990517154335976,-0.0688106119632721,-0.0387236587703228,-0.07165646553039551,-0.24709609150886536,0.4406926929950714,0.09898758679628372,-0.3569073975086212,-0.1834172159433365,0.21243484318256378,-0.023457590490579605,0.19221553206443787,-0.42761287093162537,0.1677064597606659,0.28480619192123413,-0.015058232471346855,-0.3203476369380951},{0.1595148891210556,-0.1753794401884079,-0.06261620670557022,-0.4863916039466858,-0.2588242292404175,-0.39107856154441833,-0.16384990513324738,-0.2861567735671997,-0.07409733533859253,0.23397867381572723,0.02763841487467289,0.07751758396625519,0.052126139402389526,-0.1995113641023636,-0.056413501501083374,0.13897821307182312,-0.2788965702056885,0.06782763451337814,0.3660268485546112,-0.30698007345199585},{0.3032473921775818,0.21087543666362762,-0.2142106294631958,-0.2098092883825302,0.20937196910381317,0.02089405246078968,0.3500438332557678,-0.04274344444274902,0.08104967325925827,0.40560850501060486,0.3900409936904907,-0.07755499333143234,-0.2313951998949051,0.08730713278055191,-0.33694812655448914,0.014825636520981789,0.14754033088684082,-0.2729133367538452,0.2731586694717407,0.2921258509159088},{-0.18744176626205444,-0.10339292138814926,-0.010116204619407654,0.3751145303249359,-0.25120308995246887,0.0009745486313477159,0.15911316871643066,-0.1176636815071106,-0.2607409358024597,-0.4340030550956726,-0.28438058495521545,0.4160989224910736,0.11069532483816147,-0.3304082155227661,0.03815148398280144,-0.1836424618959427,0.43106308579444885,0.10519763827323914,-0.04348338395357132,-0.18023917078971863},{0.30988189578056335,-0.3412661552429199,0.36302101612091064,0.26621556282043457,0.3104454576969147,0.17432215809822083,-0.21102625131607056,-0.39193764328956604,-0.11023817211389542,0.10366245359182358,-0.02001829817891121,0.25213444232940674,-0.06334485113620758,-0.0454426035284996,-0.4145391881465912,-0.27476808428764343,0.15745413303375244,0.03944740816950798,-0.36856064200401306,0.1379806101322174},{0.20167672634124756,-0.14286503195762634,0.43939611315727234,0.45877307653427124,0.2846791446208954,-0.21578167378902435,-0.1555776596069336,0.15176822245121002,0.0141259441152215,0.052568040788173676,-0.4623507261276245,0.31917497515678406,0.08610924333333969,-0.18532857298851013,0.00016069777484517545,0.02128445915877819,0.10223353654146194,0.19467324018478394,-0.07302877306938171,-0.2828546166419983},{-0.1756126880645752,-0.0587330088019371,-0.1450071781873703,-0.015269425697624683,-0.28173327445983887,0.42553257942199707,-0.3565528094768524,0.1915171593427658,0.4535808563232422,0.038806427270174026,-0.2867407500743866,0.2713020443916321,-0.05129821226000786,0.19367191195487976,-0.03224639594554901,-0.43024083971977234,0.0778672993183136,-0.3368535339832306,-0.22203132510185242,-0.2870001792907715},{-0.4057128429412842,0.12832044064998627,0.12831833958625793,-0.23889662325382233,0.28028780221939087,0.40651798248291016,-0.11613801121711731,0.2756485044956207,0.32072100043296814,-0.012942495755851269,-0.10976950824260712,0.10160357505083084,0.05886662378907204,-0.36268725991249084,-0.26300737261772156,-0.13260915875434875,0.3379040062427521,0.4689982533454895,0.3626837730407715,0.3066718876361847},{0.10528261214494705,-0.14142581820487976,-0.02790750563144684,0.410918265581131,0.40435951948165894,0.07135511189699173,0.30042341351509094,-0.24380040168762207,0.04772564768791199,0.08277703076601028,-0.26505234837532043,-0.1313410848379135,0.22659438848495483,-0.3507933020591736,-0.046306271106004715,0.05049600079655647,0.045328982174396515,0.04404398426413536,-0.21465876698493958,0.021203426644206047},{-0.1572398543357849,-0.3107418417930603,-0.061566807329654694,0.2646474540233612,-0.2968384623527527,0.06274721026420593,-0.11818909645080566,-0.1065499410033226,0.4022757411003113,0.23780035972595215,0.04256628826260567,-0.2411242425441742,-0.1526346206665039,0.22136937081813812,-0.21687732636928558,0.23892241716384888,-0.33895131945610046,0.16588719189167023,0.2681608498096466,0.43979090452194214},{0.04111628234386444,-0.2751988172531128,0.03258662670850754,0.011310186237096786,-0.1702631413936615,-0.26061052083969116,0.4440681040287018,-0.3026480972766876,-0.25730612874031067,0.05115148425102234,0.18509744107723236,-0.2887062132358551,0.019129497930407524,-0.27934250235557556,-0.35450878739356995,-0.36151012778282166,0.3228428065776825,0.18038307130336761,0.39779937267303467,-0.06602606177330017},{0.3315105736255646,0.37094467878341675,0.3139703571796417,-0.030866123735904694,-0.1096438467502594,0.02777666412293911,0.3433469831943512,0.12072277814149857,0.26828253269195557,-0.317770779132843,-0.005147172603756189,0.033570870757102966,-0.38109564781188965,0.06621313840150833,-0.21098193526268005,0.04343176260590553,-0.08749130368232727,0.32079195976257324,0.1396196186542511,-0.2639347314834595},{-0.353956401348114,0.14760954678058624,0.30543896555900574,0.2590399384498596,0.2125595360994339,0.14204157888889313,0.3698939085006714,-0.014030919410288334,0.08784020692110062,0.15216553211212158,-0.27211543917655945,0.19163388013839722,-0.11660334467887878,-0.04676903784275055,-0.07138602435588837,0.19554372131824493,-0.273627370595932,-0.2722492218017578,0.29963070154190063,-0.3269164264202118},{-0.2020329087972641,0.29438358545303345,-0.20617404580116272,0.0966576635837555,0.19824273884296417,0.169743150472641,0.4782430827617645,-0.05734267830848694,0.4453366696834564,-0.022672880440950394,0.03056514821946621,0.10523763298988342,-0.2583387494087219,0.295296311378479,-0.05866822972893715,-0.22470033168792725,-0.31535378098487854,0.34676578640937805,0.10602834075689316,-0.14017461240291595},{0.40207207202911377,-0.24226164817810059,0.36145228147506714,-0.28605571389198303,0.18138866126537323,0.19713009893894196,-0.1175914779305458,-0.24099352955818176,-0.21081793308258057,0.08779595792293549,0.2307363748550415,0.201539546251297,0.0845361202955246,-0.11101231724023819,0.2799574136734009,-0.20600174367427826,-0.06348966807126999,-0.13917791843414307,-0.0697297528386116,0.3592150807380676},{0.17682307958602905,0.1995125114917755,0.15901406109333038,0.4036095142364502,-0.4261230230331421,0.007091298699378967,0.46552297472953796,-0.08415341377258301,-0.056310638785362244,-0.07850339263677597,0.23188193142414093,-0.2751666009426117,-0.24432478845119476,0.07628543674945831,0.2775335907936096,0.30439186096191406,0.17020229995250702,-0.24974733591079712,-0.11632205545902252,0.14678777754306793},{0.18915273249149323,0.29141220450401306,0.09631028771400452,-0.1340203732252121,-0.16789507865905762,-0.2687349319458008,0.16104692220687866,0.23051610589027405,0.0741145983338356,-0.16214831173419952,0.2496710866689682,-0.07824970036745071,0.07184228301048279,-0.29833924770355225,-0.32008618116378784,0.2733944058418274,-0.22500090301036835,0.05063537508249283,-0.02425486408174038,0.08132771402597427},{0.16380013525485992,-0.0002521155693102628,-0.17910407483577728,0.03460923209786415,0.3337899148464203,0.17096030712127686,-0.12117613852024078,-0.08687693625688553,-0.2044992446899414,0.01813514344394207,-0.05107169598340988,-0.0743781104683876,0.09681079536676407,0.2015829235315323,-0.20709499716758728,0.05208975449204445,0.28326159715652466,-0.3879672884941101,-0.25183722376823425,0.35028520226478577}};
static const float action_parameterization_distribution_linear_weight[20][4] = {{-0.13613197207450867,-0.14403297007083893,-0.2981961667537689,-0.32841870188713074},{-0.2072788029909134,-0.0987853929400444,0.3189772963523865,0.02508128620684147},{0.11596402525901794,0.30688244104385376,0.14819841086864471,-0.16329236328601837},{0.3183113932609558,0.140799880027771,0.24486371874809265,0.31702741980552673},{0.1337287276983261,0.09272897243499756,-0.3899589478969574,0.12131185829639435},{0.11114200204610825,0.016363712027668953,-0.08627181500196457,0.23745091259479523},{-0.40924784541130066,0.0029734813142567873,-0.17650477588176727,0.329967200756073},{0.34339839220046997,-0.16094255447387695,-0.2618924081325531,0.4812103807926178},{-0.29711323976516724,0.5086314082145691,-0.37029358744621277,0.4293413758277893},{-0.04478512704372406,-0.03630673885345459,-0.18606820702552795,-0.19716548919677734},{0.27189937233924866,-0.33901891112327576,-0.517052173614502,0.24473163485527039},{0.4597596228122711,0.43818897008895874,-0.07884123921394348,-0.07176827639341354},{-0.009357191622257233,-0.3710063397884369,0.17685705423355103,0.06767542660236359},{0.15086179971694946,0.20335699617862701,-0.16978438198566437,-0.20006704330444336},{0.4069462716579437,-0.2872241735458374,-0.4310063421726227,0.12675227224826813},{0.13722261786460876,-0.5149409770965576,0.24413850903511047,0.12367008626461029},{0.1479128897190094,0.11384015530347824,0.14458034932613373,-0.04225931689143181},{0.26794251799583435,-0.31975841522216797,0.27279195189476013,0.24853339791297913},{-0.13032139837741852,0.08496909588575363,-0.20091760158538818,0.07636625319719315},{0.3399602770805359,0.3265267312526703,-0.4833132028579712,0.44501015543937683}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.041697606444358826,0.09439320862293243,0.016941381618380547,0.007089878432452679,-0.052667226642370224,-0.07768318802118301,0.06828363984823227,0.07317941635847092,-0.11806982755661011,0.019468987360596657,-0.06408588588237762,0.11489807069301605,0.09934256970882416,0.1516784280538559,0.18879084289073944,-0.05047234147787094};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.21284371614456177,-0.07706752419471741,0.12276570498943329,0.08262662589550018,-0.07727693021297455,0.06270720064640045,-0.07504399120807648,-0.015827840194106102,0.15904472768306732,0.057950105518102646,-0.094721220433712,-0.008122255094349384,-0.03569282591342926,-0.06132682040333748,0.03525710850954056,-0.015866149216890335};
static const float actor_encoder_feed_forward_0_bias[20] = {-0.019656004384160042,-0.0250733382999897,-0.059548817574977875,-0.05900632590055466,0.008316938765347004,0.03365907818078995,-0.08502285182476044,-0.023552287369966507,0.05718923360109329,0.02971380017697811,-0.055158719420433044,-0.011144887655973434,0.06017257645726204,-0.028800787404179573,0.049314770847558975,0.038964927196502686,0.021919190883636475,0.10634991526603699,0.0008315594750456512,-0.13537809252738953};
static const float action_parameterization_distribution_linear_bias[4] = {-0.009517282247543335,-0.009458634071052074,0.016439709812402725,0.017293253913521767};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.031771183013916016,-0.09066611528396606,0.41011708974838257,-0.7832233905792236},{0.01718282327055931,-0.025092359632253647,-0.2752155065536499,0.2652338147163391},{-0.5195420384407043,-0.24564725160598755,0.31435465812683105,-0.20317143201828003},{0.22382378578186035,0.2083476185798645,-0.23842886090278625,-0.08565857261419296},{0.1929859220981598,0.1437344253063202,-0.473884254693985,0.0026145244482904673},{0.048867445439100266,-0.2877827286720276,-0.298734575510025,-0.04556168615818024},{0.1615367829799652,-0.1778796762228012,-0.2957231402397156,0.11776499450206757},{0.10698723793029785,-0.7655007839202881,-0.21865525841712952,-0.24568259716033936},{-0.027772458270192146,-0.23144598305225372,-0.5542212128639221,-0.340966135263443},{0.2442745417356491,-0.3752693831920624,0.1830885261297226,0.3003273010253906},{-0.5573073029518127,-0.5830479264259338,0.13634437322616577,0.262816458940506},{-0.04702027142047882,0.3395853638648987,-0.08159610629081726,-0.321075975894928},{0.4726888835430145,-0.04763253405690193,0.015153484418988228,-0.05045776814222336},{-0.2546815276145935,0.2471114546060562,0.34977349638938904,0.19132345914840698},{0.37726056575775146,0.2967766523361206,-0.2391473799943924,0.3086088299751282},{0.545491099357605,-0.34658482670783997,0.309172123670578,-0.4628136456012726}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.7025793194770813,-0.3768528699874878,-0.7214303016662598,0.2766164243221283},{-0.4203167259693146,0.782220184803009,0.15633778274059296,0.6335707902908325},{-0.6319302916526794,0.5293459296226501,0.2168169617652893,-0.00850975513458252},{0.7800620198249817,0.45206987857818604,0.578061044216156,0.6869801878929138}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.018191851675510406,-0.2632507085800171,0.010134946554899216,-0.11380546540021896};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.026494361460208893,-0.1663496047258377,-0.020454781129956245,-0.0546673908829689};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }
    
    void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

