
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.37444451451301575,0.07498336583375931,0.10734637081623077,-0.23271210491657257,-0.24213345348834991,0.1699526458978653,0.18628908693790436,0.08303987234830856,-0.06990458816289902,0.47052204608917236,0.3543105125427246,-0.08193910121917725,0.14824531972408295,-0.07891911268234253,0.10576804727315903,0.34181833267211914},{0.48228248953819275,0.048674460500478745,0.0118472995236516,0.18391789495944977,0.17755846679210663,0.12600384652614594,-0.13726313412189484,0.31551429629325867,-0.16935943067073822,0.1516585797071457,-0.3183879554271698,0.038742318749427795,-0.23476123809814453,-0.19876563549041748,-0.08763296157121658,0.17417798936367035},{-0.13933038711547852,0.10884199291467667,-0.32659095525741577,-0.04945642873644829,-0.1993280053138733,0.017300356179475784,0.041027143597602844,0.3934384882450104,-0.04443790763616562,-0.09873174875974655,-0.014411166310310364,-0.14934951066970825,-0.21177111566066742,-0.26313695311546326,-0.5779832601547241,-0.5476154088973999},{-0.020499764010310173,-0.15920504927635193,-0.031389202922582626,-0.022046688944101334,-0.19628378748893738,-0.10283735394477844,0.35898593068122864,-0.17959344387054443,-0.1800151914358139,0.15536150336265564,0.34502434730529785,0.4997694492340088,0.0704336017370224,-0.09644100069999695,-0.06947345286607742,-0.1208343356847763},{0.2730558216571808,0.19129818677902222,0.12501125037670135,-0.033010609447956085,-0.022923355922102928,0.08892899006605148,-0.05856158584356308,0.2663143575191498,-0.2114013284444809,0.07089989632368088,-0.54967200756073,-0.07316135615110397,-0.18295009434223175,-0.23732709884643555,-0.2004871368408203,0.1293826401233673},{-0.38361600041389465,0.2562818229198456,-0.1857132464647293,0.408565878868103,-0.005071415100246668,0.270129919052124,-0.3645721673965454,-0.047770094126462936,0.0533829927444458,-0.041770827025175095,-0.09622089564800262,-0.23276649415493011,0.2206682562828064,0.08164060860872269,-0.31895339488983154,0.1381654441356659},{0.28981783986091614,0.42192208766937256,-0.02968682534992695,-0.13937276601791382,0.24098947644233704,-0.3000258207321167,0.4254256784915924,-0.17997576296329498,0.15484890341758728,-0.009580429643392563,0.5343393683433533,0.2891181409358978,-0.5902271270751953,0.6491854190826416,-0.17273028194904327,0.177137091755867},{0.18844832479953766,0.31639930605888367,-0.30457964539527893,-0.26125702261924744,0.0815519243478775,-0.09318006783723831,0.16286954283714294,0.16842015087604523,0.19972659647464752,-0.082417331635952,-0.4281834363937378,0.18476833403110504,0.05212380737066269,0.09281948208808899,-0.2861166298389435,-0.17187903821468353},{-0.40090903639793396,-0.2840481698513031,-0.7956469058990479,-0.2715773284435272,-0.33175963163375854,-0.1294599026441574,0.003915862180292606,0.031750183552503586,-0.7106888890266418,0.40499037504196167,-0.11257310956716537,0.398855984210968,-0.12172738462686539,-0.04168674349784851,0.03259748965501785,0.3283332288265228},{0.05961071327328682,0.37599217891693115,0.04835271090269089,0.34836965799331665,0.4390799403190613,-0.05922454595565796,0.4132997393608093,0.32164597511291504,0.3310662508010864,0.37930920720100403,-0.2044481635093689,-0.21236974000930786,-0.06781939417123795,0.3397485017776489,-0.17638836801052094,0.22092224657535553},{-0.1765558272600174,0.48391273617744446,-0.2703185975551605,-0.5357211232185364,0.54361891746521,0.4295813739299774,0.3926319479942322,-0.22259065508842468,0.4419768750667572,-0.1943969577550888,0.3834869861602783,0.07427100837230682,-0.47940605878829956,-0.022939225658774376,-0.08777417987585068,0.25916555523872375},{0.2781752049922943,0.18613940477371216,0.09022555500268936,0.2844730019569397,0.16291116178035736,0.5276297330856323,0.009814064018428326,0.5398072004318237,-0.4745631814002991,0.19877642393112183,-0.009889613837003708,-0.06809452176094055,0.42719534039497375,0.44095227122306824,-0.2794335186481476,0.11635327339172363},{0.15737701952457428,0.03350389748811722,0.6988875865936279,0.0599009208381176,0.5845449566841125,0.5338712334632874,0.4013608396053314,0.24061478674411774,-0.4404894709587097,-0.2363758683204651,-0.1673019826412201,0.15822604298591614,-0.24255667626857758,0.4974304437637329,0.05627454072237015,0.03141264244914055},{0.1017681136727333,-0.1615869104862213,0.4069678783416748,-0.048994578421115875,0.3609607219696045,-0.25208041071891785,-0.5387563705444336,0.21944282948970795,0.33620068430900574,-0.35928699374198914,0.19774402678012848,-0.11835134774446487,0.24055717885494232,-0.13476327061653137,-0.1817924529314041,-0.43774792551994324},{-0.2899566888809204,-0.26322826743125916,-0.2915390431880951,-0.21205398440361023,0.03596390783786774,0.4062158763408661,-0.4091099798679352,-0.21911045908927917,-0.3226092457771301,0.2781589925289154,0.22947075963020325,0.10946381092071533,-0.3994603455066681,0.3894374370574951,0.06370483338832855,-0.2998356521129608},{-0.02225465141236782,0.10451649874448776,0.01895204931497574,-0.13842765986919403,0.16124485433101654,0.03775683790445328,-0.3505164384841919,0.2294352650642395,0.20423364639282227,0.011640617623925209,-0.25495070219039917,-0.3367767632007599,-0.156325563788414,-0.3840261399745941,0.09097874909639359,-0.059061199426651},{0.11432000994682312,-0.2339678406715393,-0.12698005139827728,-0.3138412833213806,-0.16837069392204285,-0.36965078115463257,0.05087745934724808,-0.21917343139648438,0.12176315486431122,0.2217073142528534,0.17323428392410278,0.07745026051998138,-0.2995080351829529,-0.18717122077941895,-0.32353293895721436,-0.18631169199943542},{-0.0631011426448822,0.08082860708236694,-0.07441584765911102,-0.08047500252723694,0.2258516103029251,-0.14720091223716736,-0.20677320659160614,-0.14414681494235992,0.11222811043262482,0.27897489070892334,0.07263781130313873,-0.05091273412108421,-0.33622512221336365,0.36465293169021606,-0.06549710035324097,0.11452584713697433}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.3274281919002533,-0.388449102640152,-0.19709977507591248,-0.16111603379249573,0.045077573508024216,0.2496965229511261,-0.16985075175762177,-0.17344824969768524,-0.2565714716911316,0.022172942757606506,0.3423795998096466,-0.1071358472108841,0.2903272807598114,-0.0822954848408699,-0.035349685698747635,-0.045906174927949905},{0.12412631511688232,-0.36481359601020813,-0.43473803997039795,0.3427318334579468,0.23516100645065308,0.2112005650997162,0.27027657628059387,-0.030677709728479385,-0.06977836042642593,0.29093697667121887,-0.06079142913222313,-0.1428098827600479,-0.032305724918842316,0.14702442288398743,-0.15144270658493042,-0.24620001018047333},{0.32174283266067505,-0.1209375336766243,0.43276968598365784,0.19591867923736572,0.5176854133605957,0.36515650153160095,-0.45905786752700806,-0.2320694923400879,0.4243673086166382,-0.14792732894420624,-0.06368628144264221,0.25409135222435,-0.07899220287799835,0.42209523916244507,-0.25686579942703247,0.3698152005672455},{-0.35738661885261536,0.22196659445762634,-0.010013174265623093,0.22761234641075134,-0.043306104838848114,0.2545778453350067,-0.1451728194952011,0.2202758640050888,0.3949064314365387,-0.1907501518726349,0.3725738525390625,-0.2162872850894928,0.2055305540561676,-0.4214037358760834,-0.1277661919593811,-0.424769788980484},{-0.0266231968998909,-0.23698930442333221,0.16962210834026337,0.34643489122390747,0.535922110080719,0.21149714291095734,0.05988369137048721,-0.42845672369003296,0.0612780824303627,0.42745399475097656,0.4825127124786377,0.33395281434059143,0.002941090613603592,0.1222752258181572,0.16675058007240295,-0.3540666103363037},{-0.04488702490925789,-0.39124348759651184,-0.2622748017311096,-0.0673261284828186,-0.2601062059402466,-0.06021476164460182,0.0651666671037674,0.05481547862291336,-0.3758655786514282,0.2829860746860504,-0.017279688268899918,0.12981830537319183,0.4166239798069,0.2429223209619522,-0.33709630370140076,-0.1636710911989212},{0.33001506328582764,-0.03601452708244324,-0.3002176880836487,0.38377976417541504,0.44424912333488464,0.3607182502746582,-0.3477487862110138,0.05515696853399277,0.33505067229270935,-0.2562146484851837,-0.003433195874094963,-0.3397710621356964,0.0959436297416687,-0.32766783237457275,-0.00769646605476737,0.13677671551704407},{-0.022269636392593384,-0.1745041459798813,-0.24171476066112518,-0.02017994411289692,-0.09368807822465897,-0.1975628137588501,-0.17755472660064697,0.3509426414966583,-0.1972229778766632,-0.049861591309309006,-0.3974369168281555,-0.16763679683208466,0.19493825733661652,-0.18158310651779175,-0.19211263954639435,0.18737097084522247},{0.05956254154443741,-0.1546904444694519,0.12852151691913605,0.12800832092761993,0.21220992505550385,-0.5512645840644836,0.05613177269697189,0.30313682556152344,0.3470795154571533,-0.3406612277030945,-0.2580820620059967,0.043077778071165085,-0.2725236713886261,-0.22626590728759766,0.38759180903434753,-0.009182315319776535},{-0.24758832156658173,-0.03728026524186134,-0.3704807460308075,-0.17202192544937134,0.2543250024318695,0.36064496636390686,0.002075736178085208,-0.2450738251209259,0.15004175901412964,-0.1213923767209053,-0.31084302067756653,-0.17652173340320587,0.06197400763630867,0.07143505662679672,-0.18150557577610016,0.16856631636619568},{-0.027058523148298264,-0.1852266788482666,-0.1595037281513214,0.12081535905599594,-0.12806864082813263,-0.05067184194922447,0.26671284437179565,-0.02918732538819313,-0.3165226876735687,0.004354068078100681,-0.6009888052940369,0.015015074983239174,0.1035732552409172,0.0680636614561081,0.03880413994193077,0.3747616410255432},{-0.11662959307432175,-0.046777866780757904,-0.31279951333999634,-0.395720899105072,-0.09329131245613098,0.14591564238071442,0.25914621353149414,-0.36565130949020386,-0.43549737334251404,0.15419578552246094,0.10690367221832275,-0.30083078145980835,0.12183907628059387,0.1749948114156723,-0.07462845742702484,-0.46265989542007446},{0.0464591458439827,0.027621185407042503,-0.19755661487579346,-0.252280592918396,0.1412898749113083,-0.014970778487622738,-0.428767591714859,0.12204868346452713,0.38069799542427063,-0.3350500166416168,-0.0857933983206749,-0.03135208785533905,-0.230663001537323,-0.2963336110115051,-0.22305996716022491,0.16631068289279938},{-0.2311258465051651,-0.1709335297346115,0.01585707813501358,0.19184400141239166,0.25767412781715393,0.1917773187160492,-0.1841689646244049,0.08331666141748428,-0.1497827172279358,0.3272360861301422,-0.09608016908168793,-0.29272720217704773,0.11720351129770279,-0.1382453739643097,0.13859006762504578,0.25511160492897034},{0.5694637894630432,0.012689448893070221,-0.09569700062274933,-0.370484858751297,0.3737919330596924,0.3264618515968323,0.17713342607021332,-0.1279846876859665,0.2804812490940094,-0.014550480991601944,0.23467133939266205,-0.00307678384706378,-0.038460418581962585,0.39171507954597473,0.13603092730045319,0.3065701723098755},{0.44170960783958435,0.23242244124412537,0.20926450192928314,0.08538097888231277,-0.05816873535513878,0.264729768037796,-0.24890442192554474,-0.3337036967277527,0.25430792570114136,-0.21845009922981262,-0.01814878173172474,-0.020096104592084885,0.24300913512706757,-0.32782793045043945,0.19400854408740997,0.2603021562099457}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.0728701502084732,0.15565180778503418,-0.3341274857521057,0.10995443910360336,-0.1883428990840912,-0.21549256145954132,-0.17034612596035004,0.05287075787782669,0.17219100892543793,0.27200067043304443,-0.10987449437379837,0.26305532455444336,-0.10913529992103577,-0.12184595316648483,0.09864514321088791,0.275429368019104,0.11579900234937668,-0.08078943938016891,0.017202217131853104,-0.19601669907569885,-0.11056883633136749,-0.3624579608440399,0.006320104468613863,0.2616649866104126,0.2577688992023468,0.2050337940454483,0.2197854071855545,-0.10968823730945587,-0.04638781026005745,-0.025838345289230347,-0.2668195366859436,0.3548990786075592},{-0.2406705766916275,-0.014541206881403923,0.04932352900505066,0.2713574469089508,-0.37833893299102783,0.1734188199043274,-0.2569088339805603,-0.07700901478528976,-0.32401448488235474,-0.27653902769088745,-0.2059766799211502,0.12862637639045715,0.42696598172187805,-0.28796467185020447,0.2683746814727783,0.17835380136966705,-0.07146716862916946,0.20968282222747803,-0.12914803624153137,0.06070581078529358,-0.01263117603957653,-0.11385881155729294,0.11640507727861404,-0.13601769506931305,0.23627616465091705,0.10909164696931839,-0.21646161377429962,-0.05753370001912117,0.11199925094842911,-0.20088350772857666,-0.21664565801620483,0.10649926960468292},{-0.1718725562095642,-0.1561868041753769,-0.3882703483104706,-0.040758248418569565,-0.03541341796517372,-0.02643965743482113,-0.13941580057144165,0.2875393033027649,-0.05296992138028145,-0.2546398937702179,-0.006473606452345848,0.27019789814949036,-0.13237141072750092,0.2630709111690521,0.18490925431251526,0.21511559188365936,-0.2621266841888428,0.012771674431860447,-0.049759089946746826,-0.2805981934070587,-0.3033662736415863,-0.24488826096057892,0.29782700538635254,0.20474942028522491,0.29192695021629333,0.21557781100273132,-0.17305319011211395,0.08020886778831482,-0.22090297937393188,0.04434935748577118,-0.25747236609458923,0.18707352876663208},{-0.1308393031358719,0.38135188817977905,0.27195125818252563,0.025524426251649857,0.14914186298847198,0.30954453349113464,0.4215015172958374,0.20465421676635742,0.15500158071517944,0.36908265948295593,-0.36750197410583496,-0.21205085515975952,-0.1523638218641281,-0.23219238221645355,-0.33342814445495605,0.32117435336112976,0.005540131591260433,-0.3376462757587433,-0.22036568820476532,0.3141285181045532,-0.14946189522743225,0.19753587245941162,0.35118618607521057,0.1583993136882782,-0.1131025105714798,-0.019718745723366737,-0.2481757253408432,-0.07366199791431427,-0.3678056597709656,0.07015243172645569,-0.09379687905311584,-0.01686527021229267},{-0.2647087872028351,0.1168292835354805,-0.3090997040271759,-0.34838172793388367,0.38510167598724365,0.3483741879463196,0.26307862997055054,-0.12601827085018158,-0.4186957776546478,0.017444612458348274,0.013320387341082096,0.07477794587612152,0.24096134305000305,0.0001228289766004309,-0.1708715260028839,-0.12469789385795593,-0.1032847911119461,0.35937657952308655,-0.2944559156894684,0.035178761929273605,-0.07643117755651474,0.2205437570810318,-0.2625906467437744,0.05375950410962105,0.3562025725841522,0.13899537920951843,0.3992713987827301,-0.21735084056854248,-0.05330584570765495,-0.2406402826309204,-0.1162199154496193,0.4144287109375},{-0.13566718995571136,0.09216903895139694,-0.14458902180194855,0.2615119516849518,0.15498055517673492,-0.31523701548576355,0.05542156100273132,0.18718388676643372,0.20939330756664276,-0.11581864953041077,-0.019412614405155182,0.3522951304912567,0.3268863260746002,-0.16069933772087097,0.050482966005802155,-0.3014453947544098,-0.15285463631153107,0.21664774417877197,0.27200502157211304,0.09462834894657135,0.18570329248905182,-0.21528373658657074,0.2525917887687683,0.02222120575606823,-0.21117207407951355,-0.10738477110862732,-0.21231380105018616,-0.27419620752334595,0.066653311252594,0.36723199486732483,-0.1945858895778656,0.33528199791908264},{0.07283889502286911,-0.2623845934867859,-0.14282721281051636,0.3831290304660797,-0.05759024620056152,0.285008043050766,0.05371877923607826,0.10193292051553726,-0.3588322699069977,0.28163379430770874,-0.0831158384680748,-0.17422883212566376,-0.3118269741535187,-0.16481126844882965,-0.036744002252817154,-0.1741510033607483,0.035028595477342606,0.25546640157699585,0.27123722434043884,0.3343382477760315,-0.17150667309761047,-0.016206562519073486,0.24568186700344086,-0.32422858476638794,0.2913462817668915,0.25598594546318054,0.09650528430938721,-0.16538871824741364,-0.0835842490196228,0.03230747953057289,-0.01980341225862503,-0.33485373854637146},{-0.27075183391571045,0.3501183092594147,0.30561232566833496,-0.19237126410007477,0.1348128765821457,0.09486545622348785,-0.15341167151927948,0.10624305158853531,-0.0697176456451416,0.2520263195037842,0.26951465010643005,0.013828802853822708,-0.265889972448349,-0.24960531294345856,-0.11854682862758636,0.05451555177569389,0.27776578068733215,-0.1897048056125641,-0.1016245111823082,0.2677324116230011,0.01646706834435463,-0.08482275903224945,-0.11926469951868057,-0.26185181736946106,-0.30471569299697876,-0.40347692370414734,0.02979356423020363,-0.29713529348373413,0.06613195687532425,-0.2814904451370239,0.1373501569032669,-0.10642147809267044},{-0.19979800283908844,0.22891272604465485,0.02105204574763775,-0.20259949564933777,-0.1576572209596634,0.15756601095199585,0.3946671485900879,-0.10839240998029709,0.035903796553611755,-0.12911508977413177,0.2850869297981262,-0.15075835585594177,0.31971701979637146,0.12123008817434311,-0.26016733050346375,-0.15909099578857422,-0.2605854570865631,-0.15055182576179504,0.18343056738376617,-0.2563798129558563,0.19672998785972595,-0.10486914962530136,-0.11014927178621292,-0.2764502465724945,-0.2352670580148697,0.19229961931705475,0.2237267792224884,0.1978583186864853,0.26593294739723206,-0.2521127462387085,-0.25511160492897034,-0.05658566579222679},{0.10947095602750778,-0.10749654471874237,-0.23187826573848724,-0.2479715645313263,-0.24337993562221527,0.27828463912010193,0.013015622273087502,-0.14226721227169037,0.2085934579372406,-0.2242637276649475,-0.09762315452098846,0.22935956716537476,0.21622008085250854,0.2616620659828186,-0.22537799179553986,0.2540735602378845,-0.0977301225066185,-0.0632820576429367,0.08102895319461823,0.053103506565093994,-0.04129665717482567,0.3090927302837372,0.20722578465938568,0.014677483588457108,-0.09207165241241455,-0.19159352779388428,0.20840169489383698,0.19762776792049408,-0.30821359157562256,0.3260628283023834,-0.09190092980861664,0.2197801023721695},{0.23055264353752136,0.2630562484264374,-0.2777983546257019,0.13196370005607605,-0.14052067697048187,-0.0730161964893341,0.17359939217567444,-0.20368413627147675,0.17753177881240845,0.15254729986190796,0.14138248562812805,0.24761591851711273,-0.07693905383348465,0.19543233513832092,0.1232033371925354,0.007810621056705713,0.20542795956134796,0.2185969352722168,-0.06892629712820053,0.020274195820093155,0.010279598645865917,-0.3269714117050171,-0.2758515477180481,-0.12825803458690643,-0.009342457167804241,-0.1309521198272705,-0.09420587122440338,-0.18509094417095184,-0.057801663875579834,-0.03802391514182091,-0.23536670207977295,0.35640206933021545},{-0.001596387242898345,0.30678749084472656,-0.12809596955776215,-0.304469496011734,0.23555561900138855,-0.2363724261522293,-0.22991490364074707,0.14151345193386078,-0.16488224267959595,-0.05143848434090614,0.2199663370847702,0.25014421343803406,-0.2514112889766693,-0.30445966124534607,0.051682960242033005,-0.18506170809268951,0.0628417506814003,0.28043970465660095,-0.14428839087486267,0.11559362709522247,-0.2914925515651703,0.07717644423246384,0.1971457302570343,0.1590910702943802,0.08025725930929184,-0.07602603733539581,0.01819203421473503,-0.051386598497629166,-0.21881762146949768,-0.2323378473520279,-0.2532343864440918,-0.3329187035560608},{0.16214479506015778,0.006351325195282698,0.01712719537317753,0.23287923634052277,0.05490000173449516,0.06988716870546341,-0.010881771333515644,-0.10594439506530762,0.1863008290529251,0.17583464086055756,0.13336709141731262,0.09428700059652328,-0.029855690896511078,0.3108389377593994,-0.013893935829401016,0.07509252429008484,-0.2862870991230011,-0.25730159878730774,0.2266526222229004,-0.21273264288902283,-0.04459474980831146,-0.06376823782920837,-0.005893176421523094,0.18453377485275269,-0.03996982052922249,0.09776663780212402,-0.22493165731430054,-0.2519291043281555,0.16236500442028046,0.32405319809913635,0.2797374725341797,-0.1817312091588974},{-0.02422143891453743,0.23809412121772766,-0.36398306488990784,0.1885177493095398,-0.12807931005954742,-0.2794303894042969,0.19087906181812286,0.13959139585494995,0.1848265677690506,-0.02596871927380562,0.13832300901412964,0.14406552910804749,-0.28395673632621765,0.18094901740550995,0.21276181936264038,-0.15536996722221375,-0.014865897595882416,-0.2504744231700897,-0.16880451142787933,0.07901008427143097,0.0110471798107028,0.23170673847198486,0.13066460192203522,0.12573738396167755,-0.20912684500217438,-0.11140483617782593,0.0062405746430158615,-0.11838129907846451,0.26425954699516296,0.0704088807106018,0.21142512559890747,-0.15520276129245758},{-0.0009362282580696046,-0.36225640773773193,-0.1541198492050171,0.1762240082025528,0.22352617979049683,0.05150333419442177,0.0404837541282177,-0.326020210981369,-0.22894974052906036,0.29113835096359253,-0.250301331281662,0.3082852363586426,-0.28362828493118286,0.27158287167549133,0.2005031555891037,-0.03414313122630119,-0.1241619735956192,0.18193285167217255,0.32405608892440796,-0.24807727336883545,0.04251408204436302,-0.19037564098834991,-0.2842763364315033,-0.06357265263795853,-0.05829402804374695,0.05175533890724182,0.13362053036689758,0.23594145476818085,0.19781284034252167,-0.2923697829246521,-0.31222695112228394,0.36734646558761597},{-0.23211529850959778,-0.2800973355770111,-0.24965842068195343,0.16756553947925568,-0.19343407452106476,0.1897549331188202,-0.10393550246953964,-0.19467540085315704,0.028400976210832596,-0.03735646978020668,0.26496216654777527,0.11278922855854034,0.09437193721532822,0.1960676908493042,0.29073312878608704,-0.03329583629965782,-0.0268580112606287,0.26647675037384033,0.20515938103199005,0.14498354494571686,0.029654214158654213,-0.28256896138191223,0.15097716450691223,0.026670314371585846,0.2111377865076065,0.02883068285882473,-0.28619322180747986,-0.008975453674793243,-0.13898636400699615,0.15014776587486267,0.2839849293231964,-0.13182860612869263},{-0.1425478607416153,0.10463104397058487,-0.0075667849741876125,0.22899572551250458,0.1457226425409317,-0.128167986869812,-0.12784402072429657,-0.08776818960905075,0.18629705905914307,0.10223394632339478,-0.2943382263183594,0.08865655958652496,0.13063834607601166,-0.11367356777191162,0.2370104044675827,-0.2804124057292938,0.2194702923297882,0.001515438430942595,0.28004246950149536,0.08221997320652008,-0.40967440605163574,-0.13723254203796387,-0.22604753077030182,0.07223820686340332,-0.1174437552690506,-0.27565062046051025,-0.03337612748146057,0.034284383058547974,0.19873137772083282,-0.18420490622520447,-0.0413024015724659,-0.17885228991508484},{0.33081015944480896,-0.1266830563545227,-0.041319720447063446,-0.2462349236011505,0.24620607495307922,-0.06635741889476776,0.15557493269443512,0.2570379972457886,0.2484615594148636,-0.23946411907672882,-0.22766150534152985,-0.2585879862308502,0.34988221526145935,-0.10194657742977142,-0.25454550981521606,-0.33402881026268005,0.030792392790317535,0.19241678714752197,0.07967645674943924,0.30020251870155334,-0.14458951354026794,-0.20498506724834442,0.1270551085472107,-0.28540441393852234,-0.18574362993240356,-0.23739522695541382,0.1742396056652069,0.27362561225891113,0.005082135088741779,-0.24472904205322266,-0.3527661859989166,0.03477814048528671},{0.19419050216674805,-0.16636894643306732,-0.024730756878852844,-0.09514845162630081,0.2752876281738281,-0.20709051191806793,0.0846896842122078,0.13479886949062347,-0.030276048928499222,0.25228822231292725,-0.4111829996109009,-0.15243755280971527,0.2613711953163147,-0.07833542674779892,-0.21204021573066711,-0.22910581529140472,-0.005341028794646263,0.004189356230199337,-0.14185714721679688,-0.038022760301828384,-0.1803818792104721,-0.2007497102022171,-0.17616717517375946,-0.038771845400333405,0.17343568801879883,-0.04874835163354874,-0.2353416383266449,0.0712767243385315,0.22426876425743103,-0.2646421194076538,0.17695514857769012,0.17049986124038696},{0.27424514293670654,0.05333082005381584,-0.24449412524700165,-0.1540663093328476,0.11383610963821411,0.06880706548690796,0.07026946544647217,0.15254805982112885,0.09267271310091019,0.03388998657464981,0.2957819700241089,0.10941388458013535,0.01733274571597576,-0.1652717888355255,-0.03185758739709854,-0.13220056891441345,-0.19469498097896576,0.07482507824897766,-0.24419723451137543,0.35634440183639526,0.08898024260997772,0.02311115339398384,0.033951882272958755,-0.19609062373638153,0.14787471294403076,0.05146542564034462,0.035840269178152084,0.07766187191009521,-0.12136385589838028,0.149696484208107,0.027237307280302048,0.06693638861179352}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.05003233253955841,-0.19344966113567352,0.049172479659318924,-0.12830643355846405},{0.09679751843214035,-0.059845633804798126,-0.11495242267847061,-0.285031795501709},{-0.0653071179986,-0.08198685199022293,-0.08384498208761215,-0.05255783721804619},{0.1850161850452423,-0.35746753215789795,0.12898829579353333,-0.054017435759305954},{0.2860253155231476,0.03237169608473778,0.04513435810804367,-0.4756292998790741},{0.30862095952033997,-0.24730320274829865,-0.36594724655151367,0.3077830970287323},{0.28788700699806213,-0.030096709728240967,0.21891149878501892,-0.4089182913303375},{0.22128163278102875,0.06137842684984207,-0.05888494476675987,-0.11004649102687836},{-0.30257511138916016,-0.0028938991017639637,-0.049011122435331345,-0.013847346417605877},{0.14371943473815918,-0.22342650592327118,-0.14971859753131866,0.0550311841070652},{-0.018552390858530998,0.19633248448371887,-0.10574166476726532,-0.034513507038354874},{0.0028876366559416056,0.435150682926178,0.31484630703926086,0.06843698024749756},{-0.4497205317020416,-0.20515722036361694,0.352925181388855,0.17238447070121765},{0.40827682614326477,0.36564281582832336,-0.2223222851753235,-0.3596048355102539},{0.32043707370758057,0.19905224442481995,-0.21052375435829163,0.24716202914714813},{-0.06652035564184189,-0.04117240756750107,0.24477648735046387,-0.3668580651283264},{0.11187561601400375,-0.08538779616355896,-0.31317079067230225,-0.05362926051020622},{0.22811098396778107,-0.07736237347126007,-0.009139069356024265,0.2141820192337036},{0.09124024212360382,-0.2221410572528839,0.23317278921604156,-0.012063543312251568},{0.02054051123559475,-0.08718003332614899,0.05584513396024704,-0.1544027477502823},{-0.1279502660036087,-0.12331572920084,-0.23636163771152496,0.23138661682605743},{-0.18354488909244537,-0.37885257601737976,0.17374271154403687,-0.34417393803596497},{0.06786776334047318,-0.26055416464805603,-0.12104521691799164,0.06309261173009872},{0.03774617984890938,0.08193083852529526,0.3700970411300659,0.34374648332595825},{0.16899706423282623,-0.2288544476032257,0.2676960825920105,0.2600690424442291},{0.09152358025312424,0.09792492538690567,0.21936507523059845,0.05766915902495384},{0.33201855421066284,-0.09850036352872849,0.20911195874214172,0.036795906722545624},{0.14297549426555634,0.03360573202371597,-0.22483685612678528,0.06763338297605515},{0.012688829563558102,0.12408340722322464,-0.06806153059005737,0.2469402700662613},{-0.10123424232006073,0.03537999093532562,0.27223730087280273,0.24068394303321838},{0.16604526340961456,0.06757616996765137,0.2934347689151764,-0.1154378280043602},{0.401248961687088,0.2658458650112152,0.0452854223549366,0.3041985332965851}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.07247251272201538,0.03879457339644432,-0.026515206322073936,-0.08290758728981018,-0.07645827531814575,0.08134204149246216,-0.0278590340167284,0.05144249275326729,0.03102918528020382,-0.060497917234897614,0.02185354381799698,-0.05996793881058693,0.008516660891473293,0.051252979785203934,0.013832231052219868,-0.009742713533341885};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0815175473690033,-0.01748397760093212,0.08206517994403839,-0.08309156447649002,0.004446004517376423,-0.054508160799741745,0.004629150032997131,0.021869812160730362,-0.07226543128490448,0.03783750534057617,-0.01969885639846325,0.02036634087562561,-0.010602636262774467,-0.016850922256708145,0.048597726970911026,0.01610897108912468};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.017707308754324913,-0.034478072077035904,-0.011325537227094173,-0.048558104783296585,-0.01473258901387453,0.00014889494923409075,-0.04285059869289398,0.06400053948163986,-0.05436856299638748,-0.00226224516518414,0.03801307454705238,0.0301875751465559,-0.10129968822002411,0.018131868913769722,0.06734355539083481,-0.002675423165783286,0.017921792343258858,0.026565149426460266,0.008744325488805771,0.01899578794836998,-0.028825078159570694,-0.03264978155493736,-0.005274458322674036,0.012595240958034992,0.011321231722831726,0.04937528446316719,0.057075850665569305,0.026739168912172318,0.018169285729527473,0.04265554994344711,0.058185189962387085,0.0630357563495636};
static const float action_parameterization_distribution_linear_bias[4] = {0.052049119025468826,0.03288589045405388,0.016512412577867508,0.01680036261677742};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.395828515291214,-0.47039636969566345,-0.06851048767566681,-0.19457046687602997},{0.5285071730613708,-0.03453868627548218,-0.1837684065103531,-0.1717252880334854},{-0.055301036685705185,-0.07065879553556442,0.40473106503486633,0.2844197154045105},{0.14010591804981232,-0.4511140286922455,0.2407388687133789,0.45191875100135803},{0.46847987174987793,0.36176568269729614,0.28189709782600403,0.5641841292381287},{0.4595308005809784,-0.10446645319461823,0.003109358251094818,-0.3529756963253021},{0.3817797005176544,-0.6839765310287476,-0.16118021309375763,0.17962650954723358},{-0.24949617683887482,-0.28939077258110046,0.34232157468795776,0.06641467660665512},{0.14470204710960388,-0.18354660272598267,0.22867172956466675,0.20773927867412567},{0.14455392956733704,0.06850644946098328,-0.11065951734781265,-0.2316272258758545},{0.43462926149368286,-0.42170050740242004,0.09231971204280853,-0.33470863103866577},{-0.03490711748600006,0.18110054731369019,0.5200383067131042,0.22095878422260284},{0.06639829277992249,0.2440674602985382,0.017391523346304893,0.2101539969444275},{-0.3390658497810364,0.14910607039928436,0.35745900869369507,0.2680339515209198},{-0.36774829030036926,-0.38354790210723877,0.19820356369018555,0.017917562276124954},{-0.34311047196388245,-0.4625150263309479,-0.29956915974617004,-0.04156963899731636}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.48038607835769653,-0.5683191418647766,-0.5174667835235596,-0.5636653304100037},{0.5249142646789551,0.6202860474586487,-0.05479379743337631,-0.08457037806510925},{0.5823410749435425,-0.6640200018882751,0.2975147068500519,0.6790487170219421},{-0.4836323857307434,-0.5607622861862183,0.19497351348400116,-0.2445591241121292}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.08899667859077454,-0.13621407747268677,0.1017078161239624,0.10100502520799637};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.0318138524889946,-0.019007759168744087,-0.034661903977394104,0.0327150784432888};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

