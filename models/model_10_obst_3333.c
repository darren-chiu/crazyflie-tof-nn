
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.4323257505893707,0.3271395266056061,0.11481183767318726,0.017128583043813705,-0.03849390149116516,0.028136838227510452,0.1501249521970749,0.0844348818063736,-0.007653715554624796,0.09386371076107025,-0.16635429859161377,0.06070581078529358,0.004779282957315445,0.075771763920784,0.22988802194595337,0.17601796984672546},{0.09908974170684814,0.2380620390176773,0.01573151722550392,0.11881933361291885,-0.27985236048698425,0.13002267479896545,-0.22685439884662628,-0.09073803573846817,0.3276669979095459,-0.15493418276309967,-0.3581641912460327,-0.42302757501602173,0.03827622905373573,-0.151682510972023,0.35712990164756775,-0.06555063277482986},{-0.16807571053504944,-0.07082679867744446,-0.06361284106969833,0.6607728004455566,-0.08555632084608078,-0.69440758228302,-0.06128717213869095,0.14650781452655792,-0.3077959418296814,0.3669404983520508,-0.04601753503084183,-0.3737679719924927,0.31440287828445435,0.30738693475723267,0.25129562616348267,-0.19118955731391907},{0.329923152923584,-0.33453813195228577,-0.14119674265384674,0.03358279541134834,-0.3200928568840027,0.24479562044143677,0.353098601102829,0.07919161021709442,-0.2095552384853363,0.26887717843055725,-0.022158458828926086,-0.015527190640568733,-0.048755086958408356,-0.09319638460874557,0.14006565511226654,0.0749334841966629},{0.1917562037706375,0.11158940941095352,0.04021286964416504,0.1352846622467041,0.0066868700087070465,0.23554958403110504,-0.13696227967739105,-0.008836599998176098,0.1508941948413849,-0.18933607637882233,-0.12773734331130981,0.33951836824417114,-0.2822822034358978,0.090180903673172,0.5683210492134094,-0.27102211117744446},{0.1911308765411377,0.29858022928237915,-0.244158536195755,0.14118368923664093,-0.1939920336008072,0.14980557560920715,0.24344056844711304,-0.17416593432426453,-0.27878114581108093,0.1390155851840973,0.2968738377094269,-0.3932923376560211,0.015489521436393261,0.46379393339157104,0.35151225328445435,-0.19795472919940948},{-0.07881028205156326,0.18726317584514618,0.09215208142995834,-0.22731734812259674,0.2746170163154602,-0.24122703075408936,0.6156102418899536,-0.16175270080566406,0.049801863729953766,0.42468300461769104,0.18037885427474976,0.1271589696407318,0.023279882967472076,0.17383897304534912,0.18379557132720947,-0.28826647996902466},{-0.22493329644203186,0.46795788407325745,0.10721535980701447,0.31540733575820923,-0.039401717483997345,0.35781538486480713,-0.2361753135919571,-0.15777668356895447,0.03435252606868744,-0.15862953662872314,-0.008952120319008827,-0.06059497222304344,-0.2516251504421234,-0.2321978360414505,-0.13519437611103058,0.3017663061618805},{0.46938326954841614,0.3761630058288574,-0.2489595264196396,0.4543607831001282,-0.36061277985572815,0.11602211743593216,0.22092288732528687,0.3669317066669464,-0.3330220878124237,0.10350485891103745,0.27543702721595764,0.29521894454956055,-0.09945902228355408,-0.5889936685562134,-0.38154318928718567,0.6385818719863892},{-0.2701758146286011,0.06971882283687592,-0.2040654420852661,-0.43157365918159485,0.29488039016723633,-0.043074555695056915,-0.23347598314285278,0.18692955374717712,0.3852209746837616,0.2351033091545105,-0.06869470328092575,-0.11303409188985825,0.17558906972408295,0.27550187706947327,-0.398930162191391,-0.16537176072597504},{0.2516658902168274,-0.2482156902551651,0.41457751393318176,-0.33952072262763977,0.2853730320930481,0.0473160594701767,0.42456749081611633,-0.1216341033577919,0.36170876026153564,-0.14172613620758057,0.11448278278112411,0.07589403539896011,-0.15863020718097687,-0.027251580730080605,0.2757203280925751,-0.031536005437374115},{0.11107920110225677,-0.3449319899082184,0.2799922525882721,0.5720940232276917,-0.6685915589332581,0.07881714403629303,-0.07438118755817413,0.40007728338241577,0.04153485223650932,0.030216971412301064,-0.40507352352142334,-0.09820026159286499,-0.6666526198387146,0.10695088654756546,-0.28224289417266846,-0.5033153295516968},{-0.17288106679916382,0.4276238679885864,-0.16644050180912018,0.3348660469055176,0.1786227524280548,-0.42426273226737976,-0.09510815888643265,-0.37440183758735657,-0.3978026509284973,0.6871362924575806,-0.27078232169151306,0.3867202699184418,0.6587803363800049,-0.3753950893878937,-0.3573623299598694,0.06099501997232437},{0.39429527521133423,-0.05690871924161911,0.001505497726611793,0.21049664914608002,-0.46097230911254883,-0.12971296906471252,0.6752974987030029,0.0023119694087654352,0.04202158376574516,0.5967710614204407,-0.6083856225013733,-0.42652153968811035,0.10650626569986343,-0.7219014167785645,0.2759895920753479,0.0873812809586525},{-0.03205792233347893,-0.37049317359924316,-0.4413514733314514,0.061342380940914154,-0.3305221498012543,0.17660674452781677,0.17622482776641846,0.26217249035835266,-0.16181868314743042,-0.12874633073806763,-0.3402406871318817,0.4087215065956116,0.054338254034519196,0.4724968671798706,-0.09320859611034393,0.3214769959449768},{0.1996472328901291,-0.2747112512588501,-0.19957052171230316,0.12625522911548615,-0.10878416150808334,0.3185758590698242,0.3769756555557251,0.1874755471944809,-0.24335449934005737,0.2053028792142868,-0.1583154797554016,-0.2500345706939697,0.23704837262630463,-0.1661578267812729,0.23423710465431213,0.1393720805644989},{0.20944993197917938,-0.2073853611946106,0.28899484872817993,-0.08908028900623322,-0.2881259620189667,0.305707186460495,-0.23329871892929077,0.1980283111333847,-0.2099391669034958,-0.17051227390766144,0.368373841047287,-0.29756036400794983,-0.13350257277488708,0.19203506410121918,0.3159191608428955,-0.13169565796852112},{-0.13314156234264374,0.25711286067962646,-0.1543593853712082,0.23907218873500824,-0.38388729095458984,0.3932223618030548,0.26854756474494934,-0.3795400857925415,-0.26569879055023193,-0.197834312915802,-0.058498889207839966,0.2782619297504425,0.25039729475975037,0.2063479721546173,0.18644921481609344,-0.026187775656580925}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.21799695491790771,0.2277512550354004,0.2323170155286789,-0.39100757241249084,0.38291552662849426,0.00613963371142745,0.09630651026964188,-0.28128230571746826,-0.1522303968667984,0.03701985999941826,0.13582873344421387,-0.08239691704511642,-0.4185900092124939,0.3717082142829895,-0.18898475170135498,0.3753838837146759},{0.4338594377040863,0.08085665106773376,0.3263534605503082,0.40755757689476013,-0.2617567479610443,-0.10134079307317734,-0.06619581580162048,0.39824074506759644,-0.03564388304948807,-0.015298578888177872,-0.32264384627342224,0.04974616318941116,0.09960878640413284,0.2628996968269348,-0.04048694297671318,0.13208763301372528},{-0.28515031933784485,-0.11433855444192886,0.08866695314645767,0.2745964527130127,0.2732270061969757,-0.14512939751148224,0.35613110661506653,0.024334995076060295,-0.07143853604793549,0.14829199016094208,0.02875826135277748,-0.2515385150909424,0.09311868250370026,0.21786002814769745,-0.1972091943025589,-0.1085580587387085},{-0.023674555122852325,0.32964667677879333,0.3082400858402252,-0.25931230187416077,0.03785236179828644,-0.44715845584869385,-0.16564173996448517,0.12101538479328156,0.25561174750328064,-0.5367391109466553,-0.11358140408992767,-0.36235716938972473,0.3934656083583832,0.2163572460412979,-0.2399565726518631,0.23597688972949982},{-0.3908778429031372,-0.19010645151138306,0.060447823256254196,-0.2701954245567322,0.3566536605358124,-0.17378419637680054,0.15277402102947235,0.08487068861722946,0.30545181035995483,0.48944908380508423,-0.21894754469394684,0.30004632472991943,-0.1889096349477768,-0.14268769323825836,-0.42339321970939636,0.3057219684123993},{0.45545080304145813,0.11549851298332214,0.1833001673221588,0.11484265327453613,-0.1006351187825203,-0.2957034409046173,0.08853061497211456,0.3373412489891052,-0.33983340859413147,0.4631318747997284,-0.23828738927841187,-0.34507662057876587,0.21108059585094452,-0.39390823245048523,0.20090170204639435,0.12122905254364014},{0.2720613479614258,-0.29295942187309265,0.23936930298805237,-0.3049500286579132,0.2851216793060303,0.3539564907550812,-0.11690153926610947,0.13941490650177002,0.04700012132525444,-0.03787807747721672,0.027301430702209473,0.12757083773612976,-0.14492729306221008,0.26214709877967834,0.19069761037826538,-0.12173814326524734},{-0.31399691104888916,0.13967736065387726,-0.24709351360797882,-0.018598204478621483,0.1071104109287262,0.34251147508621216,-0.11075548827648163,-0.37707218527793884,-0.06707987934350967,0.13828670978546143,0.29512038826942444,-0.32128381729125977,0.12925337255001068,-0.07972510904073715,0.342949241399765,0.15760590136051178},{-0.1512276828289032,-0.05933979153633118,0.023974748328328133,0.19094185531139374,0.31692543625831604,-0.25678521394729614,0.22483839094638824,-0.1282353699207306,0.005177665036171675,0.33211979269981384,0.058440275490283966,-0.009625272825360298,-0.15652626752853394,0.13750579953193665,0.32380256056785583,-0.12615656852722168},{-0.011457298882305622,-0.26190420985221863,0.21080534160137177,-0.2102079838514328,0.24006202816963196,0.14241556823253632,-0.14139877259731293,0.20687615871429443,0.34024640917778015,-0.016277506947517395,-0.031390246003866196,0.08758804947137833,0.26517289876937866,0.16090013086795807,-0.38282859325408936,0.4265260398387909},{-0.06601335853338242,0.229821115732193,-0.1457929164171219,-0.3027292490005493,-0.31022006273269653,-0.05045722424983978,0.3427712023258209,-0.3847528100013733,-0.404178261756897,-0.14611594378948212,-0.2097131609916687,0.007062068209052086,0.29461079835891724,0.22679632902145386,-0.42462247610092163,0.45491209626197815},{0.3408341109752655,0.23931251466274261,0.09648579359054565,-0.26779744029045105,0.19339600205421448,-0.011715080589056015,-0.14010027050971985,0.4054417610168457,-0.31629621982574463,-0.31206372380256653,-0.3190457224845886,-0.1854981780052185,0.1975879967212677,-0.05413750559091568,-0.08831422030925751,0.12686797976493835},{-0.3705747723579407,-0.07836642116308212,0.2336885631084442,0.27666041254997253,0.25874701142311096,0.06809477508068085,0.030082859098911285,0.40769603848457336,-0.24334099888801575,-0.39517155289649963,-0.3466951251029968,0.28763675689697266,-0.15131282806396484,0.20048540830612183,0.0018491048831492662,0.3299850523471832},{-0.19999980926513672,0.005960854701697826,-0.37007439136505127,-0.390242338180542,-0.2806580662727356,-0.12746289372444153,-0.2805003225803375,0.26384398341178894,-0.2709619402885437,-0.499772846698761,-0.04854077473282814,0.29706624150276184,-0.38246750831604004,0.3191215991973877,-0.2945694625377655,-0.13717162609100342},{0.29384365677833557,-0.43891504406929016,-0.12594051659107208,-0.11369463056325912,-0.28877511620521545,-0.21817456185817719,-0.43344998359680176,0.20108050107955933,0.32791784405708313,-0.0594770647585392,0.04123751446604729,0.24266107380390167,-0.07396732270717621,0.14942029118537903,0.047771066427230835,-0.23002615571022034},{0.30338627099990845,0.2928828299045563,0.2430243343114853,0.14654402434825897,0.02454770728945732,0.38170331716537476,0.30794212222099304,0.2874462306499481,-0.22882099449634552,0.009608501568436623,0.290157675743103,0.060393840074539185,0.4762876629829407,-0.2903284728527069,-0.12071958929300308,-0.049986086785793304}};
static const float actor_encoder_feed_forward_0_weight[20][32] = {{0.21988166868686676,-0.2761703133583069,0.051181450486183167,0.19363339245319366,-0.09435585141181946,-0.3590402901172638,-0.004240886773914099,-0.32931455969810486,0.3211343586444855,0.34566307067871094,0.028400219976902008,0.04009563848376274,-0.17582327127456665,-0.1808343082666397,-0.10519295185804367,-0.10940086096525192,0.24942035973072052,0.3827708959579468,-0.025433648377656937,-0.09439219534397125,0.12814827263355255,0.32618680596351624,-0.15094266831874847,-0.22001373767852783,0.16762147843837738,-0.30255088210105896,0.23939509689807892,-0.15981560945510864,0.30215105414390564,-0.22196799516677856,-0.03378237783908844,-0.041387248784303665},{-0.16636955738067627,-0.24922658503055573,0.2560792863368988,0.24129046499729156,-0.11089769005775452,-0.14369265735149384,0.07485277205705643,-0.1511792689561844,-0.12930810451507568,-0.24120621383190155,-0.11980585008859634,0.00032014294993132353,0.34049004316329956,0.21815302968025208,0.025659816339612007,-0.200784370303154,-0.050841327756643295,-0.1239791139960289,-0.23850110173225403,0.23025307059288025,0.03843645378947258,-0.3419399559497833,-0.03967037424445152,-0.14563162624835968,-0.2179049849510193,-0.24693924188613892,0.28734278678894043,0.396198034286499,-0.17568503320217133,-0.1906893253326416,0.07858358323574066,-0.23590588569641113},{-0.11989370733499527,0.0799829363822937,0.0737450122833252,-0.15289120376110077,0.08859777450561523,0.21231944859027863,-0.21779225766658783,-0.32428160309791565,0.04928756505250931,-0.08070269972085953,-0.020034313201904297,0.010530087165534496,-0.10291004925966263,-0.2636397182941437,0.1777201145887375,0.16654671728610992,-0.23210102319717407,-0.08201427012681961,-0.23857316374778748,0.21503612399101257,0.13791599869728088,-0.09558814018964767,0.32235217094421387,-0.26006409525871277,-0.17459577322006226,-0.15925711393356323,-0.2264789491891861,0.24533134698867798,-0.04729001969099045,-0.09760108590126038,0.04510051757097244,-0.21120807528495789},{0.32431989908218384,-0.106109619140625,-0.23798753321170807,0.21238285303115845,0.1059454157948494,-0.11419276893138885,0.15295441448688507,-0.21926920115947723,0.24076879024505615,0.03462482988834381,0.013649003580212593,-0.24358713626861572,-0.34969696402549744,0.033081769943237305,-0.15268470346927643,0.02739803120493889,0.18512144684791565,0.2682027220726013,0.20009391009807587,0.17091402411460876,-0.0032896522898226976,-0.0839558020234108,-0.10900013893842697,-0.022065110504627228,0.18490350246429443,0.17454761266708374,0.20270182192325592,0.000838076404761523,0.012754613533616066,-0.011358102783560753,0.047012705355882645,-0.2512527406215668},{0.06524421274662018,-0.019046172499656677,-0.218306303024292,-0.38811689615249634,-0.0779949277639389,0.16591031849384308,-0.2105763852596283,0.21013393998146057,-0.1968391388654709,0.174422487616539,0.07396247237920761,0.12962421774864197,-0.14844311773777008,0.17742060124874115,0.3544091284275055,0.19024989008903503,0.02154534123837948,-0.0315748006105423,-0.1349000334739685,-0.05245642736554146,0.3011958599090576,-0.14590533077716827,0.054030995815992355,0.2244734764099121,0.136285662651062,-0.24734309315681458,-0.12612982094287872,-0.046680860221385956,0.12304326891899109,0.163096621632576,-0.019329318776726723,-0.28906750679016113},{0.22911719977855682,-0.17773908376693726,0.08026724308729172,-0.15740257501602173,0.1611543595790863,0.10149988532066345,0.08680420368909836,0.35568180680274963,-0.038654278963804245,-0.1573057770729065,-0.20052964985370636,-0.24614779651165009,0.19096095860004425,-0.05616363137960434,0.19073353707790375,0.1962479054927826,0.11415886133909225,0.31603944301605225,-0.027848735451698303,0.32337281107902527,-0.03489183261990547,-0.16621717810630798,-0.19279447197914124,0.022568853572010994,-0.04731913283467293,-0.2906019687652588,-0.35154110193252563,-0.26083195209503174,-0.02243253029882908,-0.1243022158741951,-0.1021667867898941,0.11210186034440994},{-0.15980392694473267,0.2857227623462677,0.09301421046257019,0.21173083782196045,-0.3224197030067444,0.0902271717786789,-0.16346724331378937,0.11290416866540909,-0.15090548992156982,0.10711602866649628,-0.17799757421016693,0.21982638537883759,-0.3435702323913574,0.27855831384658813,0.068852998316288,0.031763866543769836,0.08362875133752823,-0.34758782386779785,-0.21250559389591217,-0.020817654207348824,0.10134658962488174,0.061192236840724945,-0.21057917177677155,0.2374085634946823,0.3486424684524536,-0.23424087464809418,-0.2606968581676483,0.06872754544019699,0.2686775326728821,-0.04154876247048378,0.16949670016765594,-0.13942338526248932},{-0.24128437042236328,0.04504818841814995,0.038248103111982346,-0.003073533298447728,-0.03731124475598335,0.17053623497486115,0.06296136230230331,0.2719360291957855,0.0010917357867583632,-0.26988348364830017,0.25237026810646057,0.03963840752840042,-0.10698436200618744,0.2911325693130493,0.044162679463624954,-0.1399269849061966,-0.060840412974357605,0.319208562374115,-0.1501154601573944,-0.04415486380457878,-0.03148168325424194,-0.30973005294799805,0.13342024385929108,-0.13815386593341827,-0.13432131707668304,0.11660300195217133,0.05569133907556534,0.18966218829154968,0.10212904959917068,-0.20409521460533142,-0.2700478136539459,0.09681341797113419},{-0.1938893049955368,-0.2510504126548767,-0.3889276683330536,-0.23543447256088257,0.09893408417701721,0.13918115198612213,0.10493608564138412,-0.14312323927879333,0.251763254404068,0.173034206032753,-0.0533357672393322,-0.24004267156124115,-0.17355282604694366,-0.3253064453601837,-0.11642153561115265,-0.13930822908878326,0.34374797344207764,-0.09788283705711365,0.31824666261672974,0.23183923959732056,-0.1620456427335739,-0.07167600840330124,0.040854159742593765,-0.03869929537177086,-0.13796402513980865,0.11634966731071472,0.03841104730963707,-0.2359139621257782,-0.20710612833499908,0.41400185227394104,0.37015795707702637,0.011725797317922115},{0.4363783299922943,0.060036707669496536,-0.10626525431871414,-0.07286188006401062,-0.25920337438583374,-0.31056225299835205,-0.27696749567985535,-0.014979836530983448,0.1483398824930191,0.1328747570514679,-0.11060117185115814,0.17044076323509216,-0.16562440991401672,0.3160654604434967,-0.02958483062684536,-0.3063577711582184,-0.2581317722797394,-0.10388477146625519,0.18218648433685303,-0.24390624463558197,-0.23150017857551575,0.06122414395213127,-0.4454493820667267,-0.15442076325416565,-0.10099708288908005,-0.19946980476379395,-0.15273477137088776,-0.056169990450143814,0.1496431976556778,-0.09890633076429367,-0.05601515248417854,-0.08924473077058792},{-0.07167508453130722,-0.16088399291038513,0.06402073800563812,0.165484219789505,0.12892423570156097,-0.12781095504760742,-0.022800954058766365,-0.004984189756214619,0.2660180926322937,-0.3095599412918091,0.19565542042255402,0.01747930608689785,-0.11496654897928238,0.3313997983932495,-0.21188241243362427,0.14713874459266663,0.2610260546207428,0.09365600347518921,0.06475848704576492,0.1944337785243988,0.02674947679042816,0.06487837433815002,-0.20936721563339233,-0.09899729490280151,-0.14561623334884644,0.07504625618457794,-0.29542312026023865,-0.222195565700531,-0.39173516631126404,0.03717106208205223,0.23830364644527435,-0.033492397516965866},{0.17479051649570465,0.3095957934856415,0.2712724804878235,0.13665570318698883,0.35768237709999084,0.36865171790122986,0.3900383710861206,0.4285750091075897,-0.48807820677757263,0.19173882901668549,-0.07742857933044434,0.21922485530376434,0.21727657318115234,0.018873417750000954,-0.29196298122406006,-0.17472335696220398,0.022580184042453766,0.24734735488891602,0.03273296356201172,-0.3162706196308136,-0.22011177241802216,-0.07972323894500732,0.13644994795322418,0.20478636026382446,-0.2654021978378296,0.21329452097415924,-0.37218013405799866,-0.14268139004707336,0.0897001326084137,-0.29873088002204895,0.3296349048614502,-0.12480869144201279},{-0.16501672565937042,-0.21349312365055084,0.15181484818458557,0.12096549570560455,0.32449260354042053,0.18230248987674713,0.33091920614242554,-0.45823925733566284,0.30227556824684143,0.33794867992401123,-0.3011256158351898,0.24291890859603882,-0.20496809482574463,0.12351363152265549,0.028529338538646698,-0.2443360537290573,0.17851266264915466,-0.08896423876285553,-0.02043362893164158,0.04814477264881134,-0.2894906997680664,-0.08801835030317307,-0.3094785511493683,0.1804092824459076,-0.1504632979631424,-0.20784276723861694,0.2985500991344452,0.05670694261789322,0.3769877552986145,0.24384544789791107,0.04683821275830269,0.09369352459907532},{0.06017998233437538,-0.24155005812644958,-0.05889555811882019,-0.2360815554857254,-0.1538802534341812,-0.1962786167860031,-0.16040655970573425,0.33494243025779724,0.33528363704681396,-0.07081492245197296,0.04474974051117897,0.1798245906829834,0.11754284054040909,0.3119499683380127,-0.27296072244644165,-0.06943967938423157,0.22982393205165863,-0.18503548204898834,0.1551714837551117,-0.228870689868927,0.23506711423397064,0.012197309173643589,0.15803763270378113,-0.002783514792099595,-0.18102173507213593,0.23635001480579376,0.08201766014099121,-0.16736017167568207,0.1988314837217331,0.2492154836654663,0.20710337162017822,-0.07064789533615112},{0.18652033805847168,0.21017904579639435,0.02378266118466854,0.11115195602178574,-0.2923929989337921,-0.042856283485889435,-0.02049277164041996,0.08267585188150406,0.004167724400758743,0.16015765070915222,0.27107372879981995,-0.1925557255744934,0.2793866693973541,-0.08813510835170746,-0.23116172850131989,-0.17330990731716156,-0.14919841289520264,-0.2096741497516632,-0.10467156767845154,0.17169083654880524,-0.37461742758750916,-0.054314907640218735,0.20246735215187073,-0.14766450226306915,-0.16145148873329163,-0.2785995304584503,-0.06780918687582016,0.20751462876796722,-0.2247074544429779,0.18735553324222565,-0.17003889381885529,-0.11077811568975449},{0.012937018647789955,0.021951161324977875,0.20675212144851685,-0.08854547888040543,0.16712422668933868,0.01473127119243145,-0.1937657743692398,0.01254642941057682,-0.22195954620838165,-0.3331339955329895,-0.14685368537902832,0.11799078434705734,-0.20271430909633636,-0.12304388731718063,-0.20432962477207184,0.08353462815284729,-0.09101224690675735,0.17701898515224457,0.04609348624944687,0.13515326380729675,0.22174926102161407,0.12632298469543457,-0.23414970934391022,0.031156400218605995,-0.2723366916179657,-0.2508114278316498,-0.06488436460494995,0.1583775281906128,0.09775635600090027,0.052268438041210175,0.10626393556594849,0.022099392488598824},{-0.14079150557518005,-0.26394423842430115,0.1444159895181656,-0.2960759699344635,-0.1758444905281067,0.25446900725364685,-0.07978364825248718,-0.025471307337284088,-0.33835577964782715,-0.03629099205136299,0.16827905178070068,0.12711364030838013,-0.12708692252635956,0.2751765549182892,0.16929471492767334,0.18106961250305176,0.24981361627578735,-0.10209688544273376,0.33359289169311523,0.2722304165363312,0.14041930437088013,0.28748205304145813,-0.008929827250540257,-0.30914661288261414,-0.030845174565911293,0.17014893889427185,-0.11121335625648499,0.050539884716272354,-0.11411932110786438,0.08078841865062714,0.0586615614593029,-0.17739123106002808},{0.20500218868255615,0.031772468239068985,-0.14209653437137604,-0.15340648591518402,-0.10203608870506287,-0.11195503175258636,0.01766262575984001,-0.19676555693149567,-0.005010787397623062,-0.32673120498657227,-0.09252876788377762,0.057945482432842255,-0.06284555792808533,-0.24884061515331268,0.22912345826625824,-0.39907407760620117,-0.1077507957816124,-0.03352905064821243,-0.054136473685503006,-0.06926857680082321,0.22888971865177155,0.18113714456558228,-0.11991587281227112,-0.25250473618507385,0.33793672919273376,0.24904553592205048,-0.20699374377727509,0.021608879789710045,0.10876378417015076,0.22904972732067108,-0.11121298372745514,0.37627702951431274},{-0.19222275912761688,-0.2141834944486618,-0.056761402636766434,0.044368620961904526,-0.13844910264015198,-0.034979719668626785,-0.06147468090057373,-0.4072778522968292,0.053650639951229095,0.24043609201908112,-0.1781671792268753,-0.23863686621189117,-0.3047964870929718,-0.19557787477970123,0.3136233389377594,0.2860047519207001,-0.2810767889022827,0.06529390066862106,-0.08588279038667679,-0.1595330834388733,-0.15773461759090424,0.01232226938009262,-0.10081527382135391,0.18142840266227722,-0.001810045912861824,-0.2605120837688446,-0.07103652507066727,-0.1202162653207779,-0.14062929153442383,-0.23761491477489471,0.26676228642463684,-0.012561588548123837},{0.16822226345539093,0.3031628429889679,0.0027017458342015743,-0.39549165964126587,-0.29099857807159424,-0.15782703459262848,-0.33142924308776855,0.22275450825691223,-0.11901309341192245,0.0046418034471571445,-0.2048579901456833,0.19289641082286835,-0.23521699011325836,-0.11743403971195221,0.25367993116378784,-0.32939159870147705,-0.21771347522735596,0.05578257143497467,-0.053634729236364365,0.04430774599313736,-0.10566475242376328,-0.03819318488240242,-0.08958487957715988,-0.25400418043136597,0.2774594724178314,0.017215127125382423,0.036974843591451645,-0.1734967827796936,0.23643937706947327,0.3045685887336731,-0.35187509655952454,0.18666908144950867}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.27016717195510864,0.2800663113594055,-0.08886288851499557,0.36888715624809265},{-0.30439403653144836,0.30118924379348755,0.045859936624765396,-0.06584500521421432},{0.18174052238464355,0.21838825941085815,0.18276312947273254,-0.255547434091568},{-0.2867867648601532,-0.31348517537117004,0.29551616311073303,-0.0985756367444992},{-0.18298527598381042,0.02087397500872612,-0.2054090052843094,-0.3283604085445404},{-0.25405436754226685,0.03527258336544037,0.05213911458849907,-0.3014295995235443},{-0.3394317924976349,-0.02310076914727688,0.10647964477539062,-0.14347845315933228},{-0.19787974655628204,-0.2674426734447479,0.3346427381038666,0.25585195422172546},{0.14506752789020538,0.16544640064239502,-0.24277719855308533,-0.27276191115379333},{-0.034459955990314484,0.1547127664089203,0.1682901531457901,0.004191198851913214},{-0.24948866665363312,-0.26517924666404724,-0.19309036433696747,0.26120683550834656},{-0.22089606523513794,-0.03394244611263275,-0.35401228070259094,0.01733969897031784},{0.11392494291067123,-0.14043600857257843,-0.2686798572540283,-0.28281596302986145},{0.37836527824401855,0.13487055897712708,0.03297175094485283,0.2630157470703125},{0.34354761242866516,0.08793571591377258,0.2632085680961609,-0.24283252656459808},{-0.21832121908664703,-0.1699388474225998,-0.1108199954032898,-0.0822528600692749},{0.1529500037431717,-0.16320636868476868,-0.3135974407196045,-0.010697910562157631},{0.2723665237426758,0.3270915448665619,0.17107313871383667,-0.2312837839126587},{-0.06147249788045883,-0.015997756272554398,0.0873589888215065,0.15742145478725433},{0.20977362990379333,0.2631356716156006,-0.1793244332075119,-0.3068229556083679},{-0.02834036946296692,0.21330516040325165,-0.3294486403465271,-0.13366949558258057},{-0.07313677668571472,0.20291925966739655,0.04692177101969719,0.018728086724877357},{0.12846946716308594,-0.32515957951545715,-0.2489653080701828,-0.16684545576572418},{0.22378277778625488,-0.18319714069366455,-0.1077427864074707,0.07100358605384827},{-0.0014982456341385841,-0.017524270340800285,0.2538292109966278,0.26272469758987427},{-0.0457657128572464,-0.13043224811553955,0.3544742166996002,-0.23597034811973572},{0.29092127084732056,-0.26171982288360596,0.0035125946160405874,0.22559314966201782},{0.23121747374534607,-0.2836643159389496,0.29488879442214966,0.027629930526018143},{-0.2585986852645874,0.19007419049739838,-0.035327665507793427,-0.01965584047138691},{0.0047329263761639595,-0.3496045768260956,-0.20388229191303253,0.03577348589897156},{-0.381251722574234,-0.0007306844927370548,0.1908915787935257,-0.005428328178822994},{0.01450042612850666,-0.3431735634803772,-0.15791568160057068,-0.0683828741312027}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11451685428619385,-0.004887882620096207,-0.12151819467544556,0.06243767961859703,-0.04001984745264053,0.005928169470280409,-0.05785699188709259,0.04376031458377838,-0.13844791054725647,0.001185073284432292,-0.05100707709789276,0.09337387979030609,0.10116665065288544,0.06335154175758362,0.00611187843605876,0.014635603874921799};
static const float actor_encoder_self_encoder_2_bias[16] = {0.036263082176446915,0.005095508880913258,-0.00394024234265089,-0.04172171279788017,0.09186572581529617,0.03696632385253906,0.029156187549233437,0.02835187315940857,0.06148681417107582,-0.03598639741539955,-0.07256002724170685,0.004953865893185139,-0.027165638282895088,-0.043988823890686035,-0.06576472520828247,0.013666287064552307};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.011987888254225254,-0.026447737589478493,0.05385593697428703,-0.0867234617471695,-0.03234785795211792,-0.05163520947098732,-0.012074398808181286,0.046691399067640305,-0.005499260034412146,0.006278232205659151,-0.05114718899130821,-0.032893020659685135,-0.0006775132496841252,0.024776887148618698,0.045054491609334946,-0.06115175783634186,0.0015916111879050732,0.059791382402181625,0.004844869952648878,0.005606252700090408,0.002931170864030719,0.0016646668082103133,-0.022448301315307617,0.010030989535152912,0.03450211137533188,0.05272573232650757,0.024699710309505463,0.0443999208509922,-0.046947773545980453,-0.04374073073267937,-0.03954828530550003,6.59413926769048e-05};
static const float action_parameterization_distribution_linear_bias[4] = {0.04864383861422539,0.012817670591175556,0.016699301078915596,0.0027442974969744682};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.0859498605132103,0.2564418315887451,-0.34811729192733765,-0.23471327126026154},{-0.26880326867103577,-0.12469740211963654,-0.13429753482341766,0.15299558639526367},{-0.15904302895069122,0.18521350622177124,-0.2554800808429718,-0.1348932981491089},{0.16690227389335632,0.042713262140750885,0.271210253238678,-0.4942842721939087},{-0.54610675573349,-0.31060341000556946,0.2527666687965393,-0.6399268507957458},{0.028267953544855118,0.015308519825339317,-0.3969835638999939,-0.25304681062698364},{-0.2275831252336502,-0.286628782749176,-0.2756386399269104,0.10440900176763535},{-0.27879855036735535,0.01621265895664692,-0.20598457753658295,-0.4626951515674591},{-0.37209007143974304,-0.5181718468666077,-0.1621207892894745,0.3482261598110199},{-0.561188280582428,-0.254418283700943,0.47062477469444275,-0.19255876541137695},{0.15148378908634186,-0.05933298543095589,-0.3060612678527832,-0.611198902130127},{-0.5158446431159973,-0.5218691825866699,-0.19009946286678314,-0.2253638058900833},{-0.42466169595718384,0.28534987568855286,-0.5601409077644348,-0.19032849371433258},{0.3607199192047119,-0.5483797788619995,-0.47680535912513733,-0.10988952219486237},{0.48454931378364563,-0.24199871718883514,0.40312832593917847,0.06241641938686371},{-0.01346546784043312,0.32674309611320496,-0.43863171339035034,0.0311848446726799}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.3830464780330658,-0.5242608785629272,0.3545156717300415,-0.04014846682548523},{-0.4738685190677643,0.6906980872154236,0.17107729613780975,-0.5783020853996277},{-0.48765695095062256,-0.7178134322166443,-0.1629469245672226,-0.4499833583831787},{0.11275774985551834,0.509971559047699,-0.16080358624458313,-0.6103559732437134}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.04752640053629875,-0.054474636912345886,-0.006181330885738134,-0.09810745716094971};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.150407612323761,0.0024386353325098753,0.04279292747378349,0.053462784737348557};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

