
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{16, 16},{16, 4}};
static float output_0[16];
static float output_1[16];
static float output_2[16];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.20206616818904877,-0.14463230967521667,0.19898471236228943,-0.36886298656463623,-0.10842867940664291,0.04569792002439499,-0.10324912518262863,-0.15097345411777496,0.07299165427684784,-0.22083638608455658,-0.20009569823741913,-0.4638259708881378,0.419157475233078,-0.23354600369930267,0.2870055139064789,0.414104700088501},{-0.025498680770397186,0.29759857058525085,-0.13597117364406586,-0.232614204287529,0.2741972506046295,-0.052783798426389694,-0.19184161722660065,0.13750410079956055,0.18159064650535583,-0.13559231162071228,-0.25666794180870056,0.15756458044052124,-0.4044109880924225,-0.17246440052986145,-0.09159600734710693,0.455780029296875},{-0.5360342860221863,0.44459474086761475,-0.47207799553871155,0.46256503462791443,0.14677543938159943,-0.01760934293270111,-0.33480706810951233,0.022552266716957092,-0.5300015211105347,0.21839845180511475,0.16373467445373535,-0.48653504252433777,-0.4451192021369934,-0.5968815684318542,0.06550949066877365,-0.045903775840997696},{-0.2676626741886139,-0.4158030152320862,0.17654350399971008,0.35644009709358215,-0.20705047249794006,-0.26491105556488037,0.027090301737189293,-0.1904497593641281,0.050973836332559586,-0.23546859622001648,0.2492111772298813,0.018427008762955666,-0.34131112694740295,-0.2402719259262085,-0.06615982204675674,0.39046865701675415},{0.1567694991827011,-0.01853734254837036,0.11134065687656403,0.09113294631242752,0.1437036395072937,0.2367219477891922,0.06956905126571655,0.4233298897743225,-0.2680360674858093,-0.23615801334381104,-0.5363181829452515,0.266065776348114,0.16533219814300537,-0.4454691708087921,0.3899557590484619,-0.36739176511764526},{-0.05623273178935051,0.2802964448928833,-0.06750026345252991,0.5493288040161133,0.13077875971794128,-0.08594869077205658,-0.28237029910087585,0.09525174647569656,0.02889479324221611,0.29066935181617737,-0.04399654641747475,-0.3455401360988617,-0.03669785335659981,-0.42905962467193604,-0.24491867423057556,0.2422826886177063},{-0.2944560945034027,-0.39374497532844543,-0.3301672339439392,0.119997039437294,0.02772219106554985,0.31204646825790405,-0.07476213574409485,0.1969362050294876,0.14431393146514893,-0.317328542470932,0.023167574778199196,-0.04454350098967552,0.29070428013801575,0.26124686002731323,-0.03600131720304489,-0.06868480145931244},{-0.4040728509426117,0.11227315664291382,0.1266983300447464,-0.13910330832004547,0.43365833163261414,1.0346853733062744,0.08851675689220428,-0.031177518889307976,0.03212958946824074,-0.4461889863014221,0.7445712089538574,0.11812202632427216,0.1970338076353073,-0.013306178152561188,0.20922492444515228,-0.10777876526117325},{-0.14707595109939575,0.04097728058695793,0.2865276038646698,0.052585434168577194,-0.01891990192234516,0.36398863792419434,-0.60957932472229,0.03258948773145676,-0.5222764611244202,-0.052800945937633514,0.10672566294670105,-0.08605273067951202,-0.6712210178375244,-0.16350993514060974,0.35028406977653503,0.17355230450630188},{0.09774415194988251,0.13912872970104218,0.3707098364830017,-0.36063870787620544,-0.179177388548851,-0.6616510152816772,-0.09316202253103256,0.49206116795539856,-0.2828812003135681,0.13580793142318726,-0.6704453229904175,-0.08178506791591644,-0.2574884593486786,0.15005405247211456,-0.24824072420597076,0.18350735306739807},{-0.04482422024011612,0.23454861342906952,0.47978538274765015,-0.26942071318626404,-0.24993792176246643,-0.19151164591312408,-0.41831645369529724,0.1513684093952179,0.08389722555875778,-0.2271493375301361,-0.24500134587287903,-0.06816208362579346,-0.1811903864145279,-0.18721893429756165,0.36520227789878845,0.08497469127178192},{-0.45027002692222595,0.19473136961460114,-0.09715842455625534,-0.3839888274669647,0.01853305660188198,0.21812155842781067,0.11444305628538132,0.30365830659866333,0.1971551775932312,-0.32905036211013794,0.18868014216423035,-0.0593150295317173,0.47017547488212585,0.2784915268421173,0.048119157552719116,-0.24342882633209229},{-0.32427406311035156,-0.45839062333106995,0.5139907002449036,0.1913449913263321,0.3643523156642914,0.19850793480873108,-0.4425583481788635,-0.046244215220212936,0.3000546395778656,0.1814030408859253,0.5389161705970764,-0.30042457580566406,-0.4324396848678589,0.3648167848587036,-0.08527234196662903,0.2585262358188629},{0.08678823709487915,0.01950174942612648,0.07400379329919815,-0.23348668217658997,0.5760157704353333,-0.4419853687286377,-0.21626316010951996,0.49340304732322693,-0.4694776237010956,-0.5957872867584229,-0.2740291953086853,0.4332418441772461,0.18217182159423828,-0.30644479393959045,-0.14206191897392273,0.1102646142244339},{0.1433672308921814,-0.30933845043182373,-0.2781011462211609,0.09550927579402924,0.4000275731086731,0.09091080725193024,-0.3014393150806427,-0.5174393057823181,0.12712636590003967,0.007074891123920679,0.2540530860424042,-0.15182101726531982,0.052532393485307693,0.3403546214103699,0.37797117233276367,-0.0686267539858818},{-0.29540643095970154,-0.09736059606075287,-0.13685525953769684,0.2095724493265152,0.1636851727962494,0.12642121315002441,0.08804340660572052,0.22850880026817322,-0.2551513910293579,-0.1454997956752777,-0.2059316784143448,0.15594522655010223,0.2110750675201416,-0.19430974125862122,0.143109530210495,-0.11367129534482956},{-0.07012210786342621,0.22848695516586304,-0.23509038984775543,-0.16407401859760284,0.0913325771689415,0.17942450940608978,0.18982286751270294,0.11835767328739166,0.27351275086402893,0.06193618103861809,-0.17891015112400055,-0.19417135417461395,0.3991377651691437,-0.1682245433330536,-0.2216784507036209,0.23373542726039886},{-0.20323847234249115,0.12242200970649719,-0.21463793516159058,0.15916450321674347,0.17179816961288452,0.3169485032558441,-0.030237341299653053,0.05806715786457062,0.3863157331943512,-0.04305420443415642,0.23050013184547424,-0.1278708279132843,-0.08297306299209595,0.23955991864204407,0.020497003570199013,0.15035563707351685}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.0972660556435585,0.35817644000053406,0.270761102437973,-0.2011922299861908,0.06869150698184967,0.22408199310302734,-0.3814951479434967,0.10706434398889542,-0.11168846487998962,-0.06317809224128723,-0.3350570797920227,0.33259138464927673,0.03664778545498848,-0.1201547309756279,0.06612413376569748,0.3606627583503723},{0.1542833149433136,0.07525452226400375,-0.06712789088487625,-0.4645940661430359,-0.49340370297431946,0.24594195187091827,-0.009295493364334106,0.3205823004245758,-0.16425536572933197,-0.31162720918655396,-0.4032003879547119,-0.15776094794273376,0.24957303702831268,0.01082703098654747,0.11325463652610779,-0.10249591618776321},{-0.34606921672821045,0.0411219596862793,-0.24274355173110962,0.0015745930140838027,0.3763454258441925,-0.15688928961753845,-0.02711397409439087,-0.08901185542345047,0.23770007491111755,-0.1067502349615097,0.28476253151893616,-0.013554113917052746,0.03637823462486267,0.4037044942378998,-0.22456537187099457,-0.32846689224243164},{-0.07566482573747635,0.19845756888389587,0.006341508589684963,-0.3026829659938812,0.1485714614391327,0.1495794653892517,0.24574361741542816,0.38897883892059326,0.2804163098335266,-0.05060875043272972,-0.0807582437992096,0.32971879839897156,0.3441997766494751,0.030331222340464592,0.029770677909255028,-0.2853609621524811},{-0.05359937623143196,0.4039463400840759,-0.10912211984395981,0.16910697519779205,0.08190413564443588,-0.29587286710739136,-0.41196367144584656,0.2759351134300232,-0.34479451179504395,-0.25536981225013733,-0.3290629982948303,0.3220423758029938,-0.32630470395088196,0.3648163378238678,-0.5141065120697021,-0.24636323750019073},{0.5233998894691467,-0.28592008352279663,-0.04776224121451378,0.0034112599678337574,0.35321202874183655,-0.45431891083717346,-0.32347217202186584,0.14674389362335205,-0.28793615102767944,-0.543956995010376,-0.5029837489128113,0.4169301390647888,0.3290504813194275,-0.03926499933004379,0.22214749455451965,-0.39612483978271484},{-0.2631489336490631,0.28431329131126404,0.04803885146975517,-0.20423948764801025,-0.22205020487308502,-0.3716128170490265,-0.41040804982185364,-0.5086597800254822,-0.3058525323867798,0.1377985030412674,0.28288424015045166,-0.1230446919798851,0.08568856120109558,0.3658478260040283,-0.15416955947875977,-0.11174170672893524},{-0.5102049112319946,0.3004661500453949,0.19922207295894623,-0.13985010981559753,-0.17962664365768433,0.2831096649169922,-0.05437173321843147,0.16147151589393616,0.3274363875389099,-0.04200214147567749,0.26941153407096863,-0.41127675771713257,-0.1433703452348709,0.36950406432151794,-0.2982574999332428,-0.21431365609169006},{0.27152183651924133,-0.3434351980686188,0.4460848867893219,0.30197229981422424,0.3035659193992615,-0.13477693498134613,0.15908606350421906,-0.1065496951341629,-0.007276064250618219,0.32896071672439575,-0.3794958293437958,-0.3478050231933594,0.03115631453692913,0.2421419322490692,-0.32973191142082214,-0.2413521558046341},{0.21909451484680176,0.12519945204257965,0.09130972623825073,-0.07003496587276459,0.22178150713443756,0.3429732024669647,-0.09475836902856827,-0.0614682137966156,-0.33051449060440063,-0.17710508406162262,0.12314750999212265,0.1658361852169037,0.4418940842151642,0.3734372854232788,0.23210705816745758,-0.0053685917519032955},{0.46694710850715637,-0.3775964379310608,-0.30723991990089417,-0.12044424563646317,-0.336445152759552,-0.4299163520336151,-0.15767048299312592,0.04302461817860603,0.30355703830718994,-0.34194231033325195,0.20220088958740234,0.21269842982292175,-0.04544275999069214,-0.39940088987350464,0.1823282539844513,0.12382528185844421},{-0.13604599237442017,0.038674283772706985,0.11252106726169586,-0.2039475291967392,0.1000564843416214,-0.1135282889008522,-0.316490113735199,-0.2074049413204193,-0.1620849221944809,0.06571218371391296,-0.4070097804069519,-0.18864662945270538,-0.0793541967868805,0.12353241443634033,-0.27374976873397827,0.12655383348464966},{0.04328593984246254,-0.07392542064189911,-0.06638584285974503,-0.23699438571929932,0.056794941425323486,-0.2179000824689865,0.16812078654766083,-0.18794924020767212,0.012109029106795788,0.19366028904914856,0.12528514862060547,-0.3959863483905792,-0.23091952502727509,-0.34284108877182007,0.30475902557373047,-0.08135140687227249},{-0.4081023931503296,0.3003135919570923,0.07722035050392151,0.3402295708656311,0.18554605543613434,-0.19489362835884094,-0.020497743040323257,-0.4991908371448517,-0.4533979296684265,-0.1964574158191681,-0.16510532796382904,0.10104970633983612,-0.062150344252586365,0.3788529634475708,0.0327090322971344,-0.25963783264160156},{0.1572793573141098,0.14174127578735352,-0.43319302797317505,0.050024572759866714,0.24392563104629517,0.10415544360876083,-0.1574670374393463,0.14717569947242737,0.3969385027885437,-0.0017682116013020277,-0.12287469208240509,-0.2376387119293213,-0.12360338121652603,-0.4794507622718811,-0.10075386613607407,-0.24253495037555695},{-0.26224711537361145,0.014412619173526764,-0.33097511529922485,-0.12446537613868713,0.0665970966219902,-0.05034399777650833,0.23429438471794128,-0.031963739544153214,0.3248213231563568,-0.003932271618396044,0.11673371493816376,0.27092093229293823,-0.359491229057312,-0.2565915882587433,-0.40064549446105957,0.15337327122688293}};
static const float actor_encoder_feed_forward_0_weight[16][16] = {{-0.44231778383255005,0.27768588066101074,0.2795892655849457,-0.34856030344963074,-0.3071575164794922,0.315275639295578,-0.21602165699005127,0.46674200892448425,0.18274392187595367,0.12150488048791885,-0.18044312298297882,0.27979472279548645,0.3570409119129181,0.276736855506897,0.07107493281364441,0.09761618077754974},{-0.40109431743621826,-0.29096320271492004,-0.3392685055732727,-0.10086286813020706,0.08280020207166672,0.3214394450187683,0.0631483942270279,0.04740197956562042,0.394925981760025,-0.2802393436431885,-0.19944728910923004,0.02181786298751831,-0.41710448265075684,0.19044052064418793,0.37469184398651123,-0.07152099162340164},{0.32654741406440735,-0.18988573551177979,-0.362217515707016,-0.17535339295864105,-0.2738228440284729,-0.02915087155997753,0.3511144518852234,0.02975470758974552,0.3134356737136841,0.1537099927663803,-0.033497825264930725,0.16255736351013184,-0.3041372001171112,-0.5344979166984558,-0.3210989236831665,-0.12585201859474182},{-0.3035457134246826,-0.08655499666929245,0.24550963938236237,0.06521765142679214,0.08238571882247925,-0.368655800819397,0.23211000859737396,-0.4002634584903717,-0.18895374238491058,0.20226630568504333,0.17242737114429474,-0.038952119648456573,-0.15948888659477234,0.3742111921310425,-0.05920274928212166,0.40581944584846497},{0.27127039432525635,-0.27983057498931885,0.24788928031921387,-0.19792066514492035,-0.36858823895454407,-0.18357029557228088,0.3618338406085968,-0.31665292382240295,0.18356725573539734,0.28840065002441406,0.20020079612731934,0.2745845317840576,-0.31500208377838135,-0.279933363199234,-0.035821519792079926,0.3398544192314148},{0.19297875463962555,0.08834581077098846,-0.6655523180961609,0.4018203318119049,-0.2653597295284271,-0.22898821532726288,0.2119683474302292,0.15889400243759155,0.11169330030679703,-0.5588656663894653,0.14266909658908844,-0.29056182503700256,0.07682730257511139,0.2640361785888672,-0.35694143176078796,-0.045429777354002},{0.014509906992316246,-0.16481713950634003,0.06761053204536438,0.3267372250556946,0.3608858585357666,-0.07448721677064896,-0.3576962947845459,0.3469254672527313,0.24076104164123535,0.09977550804615021,0.29323074221611023,0.34824034571647644,-0.04217355325818062,0.26433080434799194,-0.30507636070251465,-0.0810435563325882},{-0.461798757314682,-0.22642523050308228,0.26803144812583923,0.33831608295440674,-0.4144783914089203,-0.15526320040225983,-0.3719567656517029,-0.08539486676454544,0.286648154258728,-0.30237093567848206,-0.3436451554298401,0.5869458317756653,-0.1139446347951889,-0.15194283425807953,-0.14271312952041626,0.09593132138252258},{-0.31208065152168274,-0.4835858941078186,-0.3740830421447754,-0.05695423483848572,-0.12420777231454849,-0.013786696828901768,-0.36454346776008606,0.22653283178806305,-0.0252674650400877,0.316806435585022,0.08161234855651855,0.10413394868373871,0.33996784687042236,0.3174743950366974,-0.035586800426244736,-0.10541222989559174},{-0.41209086775779724,0.11142367869615555,-0.20071092247962952,0.007349959574639797,-0.07109921425580978,-0.05532103776931763,0.19936610758304596,0.11163932085037231,0.4028465151786804,0.06955616921186447,0.24949754774570465,-0.4426925778388977,-0.3645908236503601,-0.24625512957572937,0.17863069474697113,0.08563161641359329},{-0.4581436514854431,0.26652792096138,-0.1413724571466446,-0.11936472356319427,0.18739920854568481,-0.23406469821929932,-0.11539332568645477,0.3901005983352661,0.4827216565608978,-0.27301084995269775,0.21786408126354218,-0.3435828983783722,0.4485847055912018,-0.13476723432540894,-0.14580123126506805,-0.11709341406822205},{0.061550043523311615,-0.14050555229187012,0.0007857333985157311,-0.20439700782299042,-0.3527967631816864,-0.12555548548698425,-0.24350647628307343,0.33296287059783936,0.4433107078075409,0.23607751727104187,0.21342028677463531,-0.15361373126506805,0.22011518478393555,-0.317810982465744,0.23812270164489746,0.4690644443035126},{0.32516923546791077,0.0030454485677182674,0.4058853089809418,0.4562413990497589,0.01613263227045536,0.29923492670059204,-0.11450977623462677,0.5872529149055481,0.40964826941490173,-0.22573474049568176,0.064317986369133,0.23476088047027588,-0.25802794098854065,-0.2927520275115967,-0.24675291776657104,-0.08190018683671951},{-0.26641741394996643,0.23088911175727844,0.0377744659781456,-0.04247632622718811,-0.2003326267004013,0.2934306561946869,0.30102330446243286,0.18431474268436432,0.36002451181411743,-0.35197126865386963,-0.06907864660024643,-0.3715554177761078,-0.5823047757148743,-0.47603023052215576,-0.36653804779052734,0.05028844624757767},{0.21360744535923004,0.14517691731452942,0.21884864568710327,0.15695863962173462,0.29616013169288635,-0.2832082509994507,0.3288191854953766,-0.0016689210897311568,0.24465034902095795,-0.15785853564739227,0.28271380066871643,0.4420948028564453,0.4275328516960144,0.19105741381645203,-0.2337777018547058,0.19455331563949585},{-0.13004449009895325,0.27953147888183594,-0.17861226201057434,-0.15507563948631287,-0.18049705028533936,0.3574741780757904,0.20092731714248657,0.47065281867980957,0.19510839879512787,-0.02529340423643589,0.01677258498966694,0.14873124659061432,-0.16668005287647247,-0.33166825771331787,-0.2502393126487732,-0.23292113840579987}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{-0.13502760231494904,-0.18985286355018616,0.24055765569210052,0.3675450086593628},{0.08978018164634705,-0.3348698318004608,-0.5098784565925598,0.4660995602607727},{0.5368942022323608,-0.6788030862808228,0.6492679119110107,-0.10870616137981415},{-0.5626809597015381,-0.24299845099449158,-0.6089619398117065,0.08328239619731903},{0.13021017611026764,0.2280433624982834,-0.2040872722864151,0.3938584327697754},{0.24442046880722046,-0.3513771593570709,-0.39454561471939087,0.37438341975212097},{-0.32342207431793213,0.1291338950395584,0.27988874912261963,0.3853650987148285},{-0.4457949995994568,-0.2388727366924286,0.07591772824525833,-0.39313435554504395},{-0.5238354802131653,0.05235198140144348,-0.15987569093704224,0.03249160945415497},{0.22218061983585358,-0.13766327500343323,0.4548313021659851,0.04348652437329292},{0.052317164838314056,0.17626678943634033,0.4772723615169525,0.2543734312057495},{0.33007609844207764,-0.30716586112976074,-0.4220667779445648,-0.14465568959712982},{-0.5661023259162903,-0.49325695633888245,0.06489976495504379,-0.14108097553253174},{-0.23108519613742828,0.01906532607972622,0.2563326358795166,-0.49387502670288086},{0.5833515524864197,0.18387888371944427,0.2331031709909439,-0.5367434620857239},{-0.4162830114364624,0.12647922337055206,0.4552155137062073,-0.4002007246017456}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.17889036238193512,-0.1300889551639557,-9.732358739711344e-05,0.05277557298541069,0.033626850694417953,-0.026152988895773888,0.007040724623948336,-0.15360866487026215,-0.11287911981344223,0.03370159864425659,0.004197805654257536,0.04578768461942673,-0.2046089619398117,-0.07827980071306229,0.01027402188628912,0.0014900144888088107};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.042216233909130096,0.06947029381990433,-0.07182730734348297,-0.05643073841929436,-0.012368728406727314,0.06507208943367004,-0.004076596349477768,0.008597902953624725,-0.04388648644089699,0.08246984332799911,0.0909656211733818,0.11889086663722992,0.04698294773697853,-0.06389714032411575,0.0029056412167847157,0.017896456643939018};
static const float actor_encoder_feed_forward_0_bias[16] = {-0.017828328534960747,0.027348393574357033,-0.03924872353672981,0.010635403916239738,-0.017214711755514145,0.037861768156290054,-0.05356974899768829,-0.015394579619169235,0.003312969347462058,-0.056702665984630585,0.04915602132678032,0.04436633363366127,-0.004961058031767607,-0.031078165397047997,0.05335954949259758,-0.0358654260635376};
static const float action_parameterization_distribution_linear_bias[4] = {0.0609540119767189,0.04827099293470383,-0.03243967145681381,-0.009061620570719242};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
           
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

