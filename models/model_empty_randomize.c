
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 20},{20, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[20];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2113702893257141,-0.43035101890563965,0.08073881268501282,0.2806997001171112,-0.16444271802902222,-0.03751913830637932,-0.001536661759018898,0.20960642397403717,-0.39227861166000366,-0.19426025450229645,-0.22255340218544006,-0.21040761470794678,0.005427386611700058,-0.15119114518165588,0.025724712759256363,0.24103416502475739},{-0.20212577283382416,0.22247619926929474,-0.30788710713386536,0.4484851658344269,0.11270815879106522,-0.2220003455877304,-0.2454967498779297,-0.14353235065937042,0.21586544811725616,-0.3384128212928772,0.2837396562099457,-0.3441225290298462,0.08403491228818893,-0.08530079573392868,0.01797061413526535,0.17284022271633148},{-0.3013066053390503,-0.05668249353766441,0.4158889651298523,0.2502501308917999,-0.023264484480023384,0.07727427780628204,0.08305105566978455,0.07573261111974716,-0.12185515463352203,-0.6936994194984436,-0.08909649401903152,0.443642258644104,0.13049200177192688,-0.38259798288345337,0.06768327206373215,-0.7281114459037781},{0.18190613389015198,-0.36536434292793274,0.16611947119235992,0.203346386551857,-0.22124747931957245,0.023076344281435013,0.07204015552997589,0.039379820227622986,-0.2204068899154663,-0.0763913094997406,-0.14302708208560944,-0.1154307872056961,0.32424888014793396,0.11307503283023834,-0.02206149511039257,0.17688973248004913},{-0.18570570647716522,0.05287735164165497,0.020504551008343697,0.21493324637413025,0.145140141248703,-0.34730497002601624,0.11153075098991394,0.14615650475025177,0.1697303205728531,-0.03188477084040642,0.31914398074150085,0.27851054072380066,0.16745777428150177,0.2262536585330963,0.10752608627080917,0.15032467246055603},{-0.16482609510421753,-0.11613072454929352,-0.32557281851768494,0.17060446739196777,0.20349115133285522,0.12659834325313568,-0.149656280875206,0.1457372009754181,0.326620876789093,-0.35452738404273987,-0.24998386204242706,-0.039037372916936874,0.025788838043808937,-0.21674218773841858,0.04969188570976257,-0.3975503444671631},{-0.41698551177978516,0.026627397164702415,0.1624712347984314,0.2059139907360077,-0.18447932600975037,-0.2243787944316864,0.22956326603889465,-0.19532443583011627,-0.3079116642475128,-0.01982351392507553,0.14254352450370789,0.259502649307251,-0.9492458701133728,0.28550297021865845,-0.1857168972492218,-0.3184959590435028},{0.17437919974327087,0.15414756536483765,0.12194976210594177,-0.019997065886855125,-0.21831487119197845,-0.08478306978940964,0.3732365369796753,-0.26961055397987366,0.5105343461036682,0.030145736411213875,0.025203678756952286,0.28394460678100586,-0.029643194749951363,0.3351697325706482,-0.5881364345550537,0.2881770431995392},{-0.01088746264576912,-0.6329483985900879,0.2703934907913208,0.09598971158266068,-0.13148100674152374,0.18563403189182281,0.008907086215913296,-0.6046741604804993,-0.12290920317173004,-0.2729763984680176,-0.40406039357185364,0.71847003698349,0.22544357180595398,0.35462743043899536,0.09473422914743423,0.8237196803092957},{-0.3245250880718231,-0.6437592506408691,-0.31996193528175354,-0.36171671748161316,0.4086439609527588,-0.3773951530456543,-0.4749753475189209,0.06485936790704727,-0.10313098132610321,-0.3625057637691498,0.27522528171539307,0.005028923042118549,0.11178767681121826,-0.1462617665529251,0.409148633480072,-0.354086309671402},{-0.24534209072589874,-0.05417032167315483,-0.24300101399421692,0.4616500437259674,-0.4251422584056854,-0.1645062118768692,0.49535444378852844,-0.6251847147941589,-0.32461005449295044,-0.005967169534415007,0.1294311136007309,0.33081793785095215,-0.7324687242507935,-0.22915521264076233,-0.11923515796661377,0.0543702132999897},{-0.6852819919586182,0.05806279182434082,-0.17588971555233002,0.21978747844696045,0.9802730083465576,-0.8504370450973511,0.447871595621109,-0.13538746535778046,0.46303147077560425,0.1978485882282257,0.9032850861549377,0.8348221182823181,0.3501445949077606,0.4526844918727875,-0.3551687002182007,0.20383234322071075},{0.27436167001724243,0.688007652759552,-0.15131627023220062,-0.28819528222084045,0.07916735857725143,0.09802781045436859,0.2935970425605774,0.206311896443367,0.2849261164665222,0.5162584185600281,0.32100123167037964,-0.43713992834091187,-0.589663028717041,-0.5605376362800598,0.24316535890102386,-0.22938977181911469},{0.24031804502010345,-0.3096992075443268,0.43243110179901123,-0.1252041757106781,-0.5169429779052734,-0.033162541687488556,-0.5161582231521606,-0.16036294400691986,-0.523618221282959,-0.6243486404418945,-0.15815682709217072,-0.6601638793945312,-0.4986433982849121,0.1210072711110115,0.5368499159812927,0.24756571650505066},{-0.40417295694351196,-0.1558246612548828,-0.10895227640867233,-0.13789711892604828,-0.2817777991294861,-0.30416688323020935,0.48170700669288635,0.10308144986629486,-0.34344682097435,-0.08198286592960358,0.12972477078437805,-0.09294446557760239,-0.28691625595092773,-0.04142368957400322,0.3190881907939911,0.28808921575546265},{0.223826065659523,-0.09107478708028793,-0.029113231226801872,0.06763672083616257,-0.19225694239139557,0.3117578327655792,-0.22314076125621796,-0.25450196862220764,-0.18539714813232422,-0.010344683192670345,-0.18760818243026733,-0.212675541639328,-0.10075952857732773,-0.1738319844007492,0.048921287059783936,0.02193593978881836},{0.13036830723285675,-0.29230090975761414,0.13211600482463837,0.09476765990257263,0.10897071659564972,-0.04468017816543579,-0.14202751219272614,-0.20204152166843414,-0.23964126408100128,-0.07473492622375488,-0.04270780459046364,0.19063934683799744,0.1049007922410965,0.06392312794923782,-0.020123135298490524,0.04957857355475426},{-0.25640344619750977,0.07435468584299088,0.4671684801578522,-0.0662609189748764,0.12941867113113403,0.06078068166971207,0.05788077786564827,0.29243260622024536,-0.3922209143638611,-0.22931741178035736,0.20596039295196533,0.29990890622138977,-0.07357791811227798,-0.33863019943237305,0.20400212705135345,-0.0995081216096878}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.017000775784254074,0.028763627633452415,0.1823759377002716,-0.4066280722618103,-0.015025352127850056,0.1733887642621994,-0.10970564931631088,0.06988724321126938,0.20332688093185425,0.2867841422557831,-0.1929319053888321,-0.2202867567539215,0.1394677609205246,-0.0984031930565834,0.2959909439086914,-0.09918639808893204},{-0.006854033563286066,-0.4145538806915283,0.20896530151367188,-0.2250429093837738,-0.23756523430347443,-0.04468412324786186,0.357925683259964,-0.12426196783781052,0.3559565842151642,-0.26246538758277893,-0.1536988615989685,-0.19766876101493835,-0.09338902682065964,0.39189496636390686,-0.07671622186899185,-0.18154115974903107},{-0.21172885596752167,-0.025049105286598206,-0.2325078845024109,-0.15853920578956604,-0.18221218883991241,-0.03127108886837959,0.2934117913246155,0.11073357611894608,-0.11962516605854034,-0.07812663912773132,-0.07379275560379028,0.13583782315254211,0.1275985836982727,-0.179277241230011,0.3320343792438507,-0.33788278698921204},{0.15149064362049103,0.06445199251174927,-0.40764719247817993,-0.18540555238723755,-0.5427671074867249,0.012413449585437775,0.055878859013319016,0.014167236164212227,-0.13938115537166595,-0.26574671268463135,0.30099812150001526,-0.008210045285522938,0.01197749748826027,-0.342274010181427,0.0017766468226909637,0.33149316906929016},{-0.05932292714715004,-0.04771322384476662,0.008519760333001614,0.4198141396045685,-0.3307340145111084,-0.053502943366765976,0.06736135482788086,-0.2963769733905792,-0.27285683155059814,-0.14640112221240997,0.4029214680194855,-0.4021371603012085,-0.2239588499069214,0.07781286537647247,-0.36246269941329956,-0.49156278371810913},{-0.34791144728660583,0.3386091887950897,0.1455630511045456,-0.1618158370256424,0.40495097637176514,-0.39295047521591187,-0.16864515841007233,-0.34455406665802,0.037768296897411346,0.002360200509428978,0.3237318694591522,-0.2787115275859833,0.22814203798770905,0.2111573964357376,0.4159083068370819,0.13258573412895203},{0.1920967996120453,-0.052352987229824066,0.23900765180587769,0.29894202947616577,0.19556115567684174,0.5239015817642212,0.13390667736530304,0.6026017665863037,-0.028484942391514778,0.010004272684454918,0.22311842441558838,0.056682001799345016,-0.3389717936515808,-0.0897502452135086,0.19560135900974274,0.33143898844718933},{0.18766959011554718,-0.24030126631259918,0.1694515347480774,-0.1147373765707016,-0.04092416167259216,-0.11680197715759277,-0.18462295830249786,-0.11016710102558136,-0.005734539590775967,-0.08800891786813736,0.07672635465860367,-0.30831995606422424,-0.09663725644350052,-0.07697781175374985,0.29202690720558167,-0.4835055470466614},{-0.14520810544490814,0.11792795360088348,0.3230704665184021,-0.10658658295869827,-0.3641967475414276,0.15812508761882782,0.26045987010002136,-0.060642123222351074,0.19345739483833313,0.2929913401603699,0.1289360374212265,0.04659511521458626,-0.10823220759630203,0.37944528460502625,0.012135127559304237,0.24025489389896393},{-0.023097453638911247,0.3079376816749573,-0.2305683195590973,0.11501315236091614,-0.10132981836795807,-0.13525398075580597,-0.3698711395263672,0.3799227476119995,0.1651601344347,-0.11048243194818497,-0.23637916147708893,-0.14500048756599426,-0.35399502515792847,0.10002034157514572,0.29263928532600403,-0.3069153130054474},{0.3705785870552063,-0.005529223941266537,-0.46385693550109863,-0.2258126586675644,-0.4057703912258148,0.04727897420525551,0.2762051820755005,0.08942694216966629,-0.16306057572364807,0.23240076005458832,-0.15121641755104065,0.015620230697095394,-0.29543641209602356,0.2926396429538727,0.12979039549827576,-0.08043618500232697},{-0.3531876504421234,0.3680875599384308,-0.32227402925491333,-0.33570265769958496,0.14022409915924072,0.2853936553001404,0.277220755815506,-0.29307177662849426,0.08735586702823639,0.4909873902797699,0.3256404399871826,0.047748006880283356,-0.3858427107334137,0.3060385584831238,0.16071966290473938,0.34385743737220764},{-0.26698777079582214,-0.2794440984725952,0.23430050909519196,0.17337080836296082,-0.09728524088859558,-0.3877834677696228,0.3425282835960388,-0.4416755735874176,0.12659074366092682,0.021599307656288147,-0.23072384297847748,-0.3993413746356964,-0.018168721348047256,-0.5074955224990845,-0.17623744904994965,-0.2977169156074524},{-0.24756813049316406,0.3409963548183441,-0.3509646952152252,-0.16391801834106445,-0.08894607424736023,0.11926771700382233,0.08171447366476059,-0.3175007998943329,-0.06826219707727432,-0.14857473969459534,-0.4792971611022949,0.24521295726299286,-0.17720617353916168,0.08926317095756531,0.04082431644201279,0.27952876687049866},{0.5023761987686157,0.19885733723640442,-0.17540466785430908,-0.5538763999938965,-0.20509392023086548,-0.4785213768482208,0.3627004027366638,0.1799362748861313,-0.017461387440562248,-0.11126569658517838,0.054694078862667084,0.5144885182380676,-0.24596774578094482,0.0972614735364914,-0.22505690157413483,-0.23836293816566467},{-0.445135235786438,0.25117242336273193,-0.3444962203502655,0.33124884963035583,0.21854707598686218,-0.07062786817550659,-0.3404090106487274,-0.3814318776130676,-0.22662851214408875,-0.09683512896299362,-0.4585898518562317,0.16758789122104645,0.13282623887062073,-0.05726871266961098,-0.20511384308338165,-0.15818843245506287}};
static const float actor_encoder_feed_forward_0_weight[20][20] = {{-0.4344402849674225,-0.2161269336938858,-0.20042064785957336,0.30126917362213135,0.3407086431980133,-0.25161606073379517,-0.16330581903457642,-0.38482871651649475,0.08442375063896179,0.28601011633872986,-0.09495587646961212,-0.1659540981054306,-0.2723766267299652,0.1419118195772171,-0.41920095682144165,0.28117257356643677,-0.026480956003069878,0.14782509207725525,0.07758079469203949,0.17775577306747437},{-0.013899284414947033,0.2171153575181961,0.32036417722702026,0.17114131152629852,0.03952491655945778,-0.20398640632629395,0.16536395251750946,-0.26310911774635315,0.06548808515071869,-0.094259113073349,0.001821892219595611,0.0391932837665081,-0.19089116156101227,-0.32891127467155457,0.03181135281920433,-0.23220138251781464,0.3351548910140991,-0.01727471686899662,-0.1867397278547287,0.29759758710861206},{0.11125747114419937,-0.24737663567066193,0.04406622797250748,-0.16856838762760162,0.03672085329890251,0.20558002591133118,-0.15316890180110931,0.5522862076759338,-0.2750017046928406,0.008865666575729847,-0.42891591787338257,0.12441102415323257,0.19924095273017883,-0.3302340805530548,-0.15025144815444946,-0.04020554944872856,-0.3759479224681854,0.24217922985553741,-0.15434101223945618,-0.08394809812307358},{0.3054106533527374,0.19389575719833374,-0.09992820024490356,0.2065782994031906,-0.2590560019016266,0.08784130960702896,0.4421875774860382,-0.4277615249156952,-0.22851713001728058,-0.0662328451871872,0.062222082167863846,0.3671589493751526,-0.07492803037166595,-0.2338828593492508,0.41628000140190125,0.3710285425186157,-0.1989847719669342,-0.2776649594306946,0.08624782413244247,0.18854162096977234},{-0.053032178431749344,-0.21393758058547974,-0.2948896586894989,0.027730654925107956,0.31227877736091614,0.36750736832618713,0.009701588191092014,-0.5367658138275146,0.16011308133602142,0.03972325474023819,0.29253441095352173,0.15101881325244904,0.23844285309314728,-0.042167987674474716,-0.2775983214378357,0.23322024941444397,-0.09054367989301682,-0.018511567264795303,-0.19388481974601746,0.3311876654624939},{0.25683051347732544,0.24075837433338165,0.0017970382468774915,0.11030751466751099,-0.15000620484352112,-0.3086360692977905,-0.37216830253601074,-0.12475710362195969,-0.24821209907531738,0.26043471693992615,0.24923014640808105,0.04664217308163643,0.21842597424983978,-0.22204174101352692,0.3830043077468872,-0.01870003528892994,0.3481830358505249,-0.1133938655257225,0.33240750432014465,-0.24784058332443237},{0.007470217067748308,-0.04175497964024544,0.13251250982284546,0.1550772488117218,0.3621548116207123,-0.5165697932243347,0.01643487438559532,0.24567648768424988,-0.2150796502828598,-0.48302939534187317,0.09244578331708908,-0.0017633558018133044,-0.0683649405837059,-0.0731867104768753,0.2368205338716507,0.5022079348564148,0.1803053468465805,0.18144690990447998,-0.1973339468240738,-0.30909672379493713},{-0.06985291093587875,0.18955501914024353,-0.11726270616054535,0.35471823811531067,0.18415085971355438,-0.004094919189810753,0.013956465758383274,-0.46692854166030884,-0.0443149171769619,0.3659963607788086,-0.1515495926141739,0.23932819068431854,-0.24831920862197876,-0.1534212976694107,-0.06985390931367874,0.06837529689073563,0.2960662543773651,-0.22868214547634125,-0.212504580616951,-0.2865724265575409},{0.250453382730484,-0.107318215072155,0.10758443176746368,0.37902969121932983,0.07775401324033737,0.09307420998811722,-0.380062073469162,-0.029691072180867195,-0.29891330003738403,0.20827582478523254,-0.10577316582202911,-0.16969677805900574,-0.477591872215271,-0.39865580201148987,0.1575876921415329,0.24341821670532227,-0.3634425699710846,0.15058176219463348,-0.25215160846710205,0.11583603918552399},{-0.22110146284103394,-0.26235541701316833,0.3132382333278656,-0.4478135406970978,-0.32797566056251526,0.066764235496521,-0.0946914404630661,0.04680125042796135,0.12720198929309845,0.20461253821849823,-0.2380780279636383,0.1812557876110077,0.05678809806704521,-0.45368555188179016,0.2106541246175766,0.07888389378786087,-0.38306087255477905,0.02736910618841648,0.10780597478151321,0.17866948246955872},{0.30779415369033813,-0.042363181710243225,0.13894547522068024,-0.36978018283843994,0.11380859464406967,-0.5720331072807312,0.3399004638195038,-0.12917643785476685,-0.4881677031517029,0.2999856173992157,-0.17624129354953766,-0.2927194833755493,0.36628103256225586,-0.4939652383327484,0.06633345782756805,-0.3218902051448822,-0.13149228692054749,0.1557074338197708,0.06964623928070068,-0.19109956920146942},{0.4013409912586212,-0.2973029613494873,0.09494137018918991,0.12475647032260895,-0.22613927721977234,0.0035818556789308786,0.10529990494251251,0.20760607719421387,0.05784256383776665,-0.16352087259292603,0.15378250181674957,-0.022600984200835228,0.02684764377772808,-0.17733250558376312,-0.4970279037952423,-0.10012070834636688,0.49017611145973206,-0.1591348648071289,-0.11873334646224976,0.14389818906784058},{0.00524533074349165,-0.3676457405090332,0.20174819231033325,-0.2853553891181946,0.057846084237098694,0.060765910893678665,-0.09049272537231445,0.14291413128376007,0.013631054200232029,0.024471845477819443,0.19626504182815552,0.14156031608581543,-0.45550501346588135,0.03555517643690109,-0.09319882839918137,0.10606174170970917,-0.258240282535553,0.046846192330121994,0.3081745505332947,0.21222490072250366},{-0.0019881753250956535,0.16168849170207977,-0.2787950932979584,0.2779649794101715,0.13961391150951385,0.26900798082351685,-0.01820497028529644,-0.346497118473053,0.07880749553442001,0.14214232563972473,0.009700809605419636,0.16538070142269135,-0.152806356549263,-0.13851027190685272,-0.2299770563840866,0.42666417360305786,0.12219276279211044,0.0616757832467556,0.13215503096580505,-0.011820745654404163},{0.3953293263912201,-0.18203511834144592,0.048103850334882736,-0.15471148490905762,0.23550106585025787,0.03203834965825081,0.07409695535898209,-0.30489063262939453,-0.2504368722438812,-0.11394964903593063,0.25026142597198486,-0.0859241783618927,-0.13212674856185913,-0.06620724499225616,0.496997594833374,-0.43102261424064636,-0.23995372653007507,0.06983523070812225,0.028027072548866272,0.31701165437698364},{0.25495749711990356,-0.28711411356925964,0.32373201847076416,-0.14559370279312134,-0.3575064241886139,0.24967098236083984,-0.3141757547855377,0.15202176570892334,-0.2602136433124542,-0.05369953438639641,-0.3865519165992737,-0.296083003282547,0.13056425750255585,-0.20454871654510498,-0.16366711258888245,0.3284827768802643,0.41014015674591064,-0.4493106007575989,0.19006213545799255,-0.05562572181224823},{0.1219133660197258,-0.10129989683628082,-0.2493380755186081,0.27038654685020447,-0.04251737892627716,-0.21813450753688812,0.40172141790390015,-0.31383615732192993,0.13930989801883698,-0.06009412184357643,0.23740872740745544,-0.1971910446882248,-0.1333659291267395,0.3754446506500244,-0.11570149660110474,-0.24287556111812592,-0.06043924018740654,-0.2782096564769745,0.32284608483314514,-0.3156338036060333},{0.17452357709407806,0.04476183280348778,0.05468044430017471,0.0800429955124855,0.01940837688744068,-0.1587509661912918,0.29285308718681335,0.07490655034780502,-0.1858593374490738,-0.15895281732082367,0.3040558397769928,0.18620313704013824,-0.2717595100402832,-0.20676007866859436,-0.13513879477977753,0.13423985242843628,-0.1365308314561844,-0.3214989900588989,0.28701743483543396,-0.34708163142204285},{-0.12342127412557602,-0.1316053569316864,-0.1162925511598587,0.21927836537361145,-0.007770502474159002,-0.30684664845466614,0.14310991764068604,0.3691059648990631,0.14169472455978394,-0.4138633906841278,0.081140898168087,0.2503013610839844,-0.28417402505874634,0.32733142375946045,-0.10770929604768753,0.28027570247650146,-0.3939199149608612,-0.2630336284637451,0.04198553040623665,-0.4302632510662079},{0.0249653160572052,-0.032905109226703644,-0.15720538794994354,-0.0722857192158699,0.2133367508649826,0.3226451873779297,-0.06828270107507706,0.09730160236358643,0.15067237615585327,-0.34735527634620667,-0.27794694900512695,0.19639840722084045,0.4154745936393738,-0.15799488127231598,0.20405307412147522,0.04552662372589111,-0.31535616517066956,-0.13789275288581848,-0.13421902060508728,-0.02306629717350006}};
static const float action_parameterization_distribution_linear_weight[20][4] = {{-0.12412256747484207,0.13890308141708374,-0.20723697543144226,0.02438730001449585},{0.14603884518146515,-0.010842210613191128,0.3318174481391907,0.25954896211624146},{0.03904516249895096,-0.33091822266578674,-0.19557958841323853,0.4076487421989441},{0.08934925496578217,0.12473419308662415,0.3881772756576538,-0.08940065652132034},{-0.1249159500002861,-0.0007207454182207584,0.15287110209465027,-0.18402449786663055},{0.18323931097984314,0.37114372849464417,0.12568622827529907,0.482371062040329},{0.33125054836273193,-0.3935615122318268,0.04073508083820343,0.01955278590321541},{0.08311277627944946,0.11324835568666458,-0.4246046245098114,-0.25397273898124695},{0.17633186280727386,0.0876425951719284,0.3044719398021698,0.2523914575576782},{-0.4229629635810852,0.07321526855230331,0.35890698432922363,0.19164316356182098},{0.18422070145606995,0.2392634004354477,-0.003236153395846486,0.14122344553470612},{0.26734596490859985,0.16109055280685425,0.23483729362487793,0.0681881383061409},{0.13145814836025238,-0.48174262046813965,-0.023782912641763687,-0.020454395562410355},{0.18598416447639465,-0.20249710977077484,0.27926284074783325,0.511496901512146},{-0.194886714220047,-0.23957999050617218,0.24631817638874054,0.46341025829315186},{-0.13180162012577057,0.005991841666400433,0.27863356471061707,0.1607714295387268},{0.5124123096466064,0.14814093708992004,-0.45466113090515137,0.40147143602371216},{0.23650440573692322,-0.08473622798919678,0.4468572735786438,-0.3175659775733948},{-0.15903517603874207,-0.16228125989437103,0.1557478904724121,0.04648945480585098},{0.4404124319553375,0.23113325238227844,0.24177071452140808,-0.33730894327163696}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.07525870203971863,-0.02958519384264946,-0.15160758793354034,0.05048227310180664,-0.28005048632621765,0.09084707498550415,0.12410038709640503,-0.0071444264613091946,-0.0834963470697403,0.027025317773222923,0.13598944246768951,0.06796938180923462,-0.251764178276062,-0.05576019734144211,0.17431169748306274,-0.019162585958838463};
static const float actor_encoder_self_encoder_2_bias[16] = {0.28898242115974426,0.028686657547950745,-0.13598111271858215,0.04678020626306534,0.027531040832400322,-0.03201210871338844,-0.0359860435128212,0.1306312084197998,0.04714761674404144,-0.028008993715047836,-0.07720552384853363,0.037735939025878906,0.03753526136279106,0.017372509464621544,0.07551268488168716,0.04720732569694519};
static const float actor_encoder_feed_forward_0_bias[20] = {-0.03323815390467644,0.0031559057533740997,-0.044956594705581665,0.07102658599615097,0.04506264626979828,0.023910285905003548,0.03227107226848602,-0.24704153835773468,-0.03931618481874466,0.07017119228839874,-0.02177906408905983,0.01870855875313282,0.008782444521784782,0.03419807180762291,-0.1050591990351677,0.10464491695165634,0.055554233491420746,0.027227070182561874,-0.004188953898847103,0.059499964118003845};
static const float action_parameterization_distribution_linear_bias[4] = {-0.00022857812291476876,-0.008955487050116062,0.054121315479278564,-0.01284314040094614};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{-0.23237653076648712,0.18867507576942444,-0.04776318371295929,0.02537890151143074},{-0.14082099497318268,0.007756588514894247,0.3016556203365326,-0.23995861411094666},{0.6264660358428955,0.14924480020999908,-0.16155101358890533,-0.320170521736145},{0.5003567337989807,-0.14658957719802856,0.5368115305900574,0.3196656107902527},{0.18763983249664307,-0.23825563490390778,-0.12126276642084122,-0.19675877690315247},{0.19648106396198273,0.4770824611186981,0.27228301763534546,-0.04419479891657829},{-0.3211752772331238,0.19721458852291107,-0.3688184320926666,0.22016671299934387},{0.570486843585968,-0.20561416447162628,0.48422813415527344,0.2605510652065277},{0.027017973363399506,0.08350183069705963,0.5826813578605652,0.24326254427433014},{-0.10816709697246552,-0.07126767933368683,0.624935507774353,-0.126410111784935},{-0.30832111835479736,0.0014086675364524126,0.23914170265197754,-0.5243011116981506},{0.5856624245643616,0.3781489133834839,0.4956170618534088,-0.5865912437438965},{0.406551331281662,-0.3389749825000763,0.4044359028339386,0.15047906339168549},{0.45258185267448425,0.5723302364349365,0.5811351537704468,-0.011392236687242985},{0.20461997389793396,0.4474514424800873,0.4612746238708496,-0.34982535243034363},{-0.2366696000099182,0.06019635498523712,-0.35133230686187744,0.23839065432548523}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{0.7240055203437805,-0.6564377546310425,-0.3865768015384674,-0.0007919226191006601},{0.44089558720588684,0.2994212508201599,-0.35083305835723877,-0.32547318935394287},{-0.15547387301921844,-0.7053171396255493,-0.6668018102645874,0.6871142983436584},{0.15894891321659088,0.48991164565086365,-0.2546703517436981,0.385062038898468}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.1554422229528427,0.015393765643239021,0.18237482011318207,-0.11599677056074142};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {-0.06056477501988411,-0.12196244299411774,-0.014551903121173382,0.06412657350301743};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }
    
    void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

