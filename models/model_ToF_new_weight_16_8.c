
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{16, 16},{16, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[16];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.30474916100502014,0.02795768901705742,-0.016017597168684006,0.09423920512199402,0.15362292528152466,-0.18906185030937195,-0.19291937351226807,-0.1591973453760147,0.2800285816192627,0.015400285832583904,-0.12020717561244965,0.20875506103038788,-0.051041919738054276,0.07657075673341751,0.25288498401641846,0.126425638794899},{0.0455402173101902,-0.27500566840171814,0.3121403753757477,-0.2173471599817276,-0.3043740391731262,0.23685146868228912,0.2368980199098587,0.015181485563516617,-0.018212005496025085,-0.07973940670490265,0.07552085071802139,-0.03508579730987549,-0.06472489982843399,0.007898603565990925,-0.005425380077213049,-0.3746454119682312},{0.16258594393730164,0.09730709344148636,0.5995036959648132,0.0253753662109375,-0.4799477159976959,0.04707003012299538,-0.1400863081216812,0.063538558781147,-0.21530552208423615,-0.22589564323425293,-0.1009710431098938,0.35627302527427673,0.6576786041259766,-0.16829322278499603,-0.1681852489709854,0.18869264423847198},{0.4891577363014221,0.3148981034755707,0.037621475756168365,0.034730490297079086,-0.14534448087215424,-0.3912886381149292,0.3421606123447418,0.4645519554615021,0.38382214307785034,0.09918882697820663,0.16579657793045044,-0.1229935735464096,0.27329757809638977,0.2201247215270996,0.057878054678440094,0.20527173578739166},{-0.1891842931509018,-0.1595100313425064,0.05403900519013405,-0.19831082224845886,0.0478971004486084,-0.3121076226234436,-0.05512363463640213,0.4275854825973511,0.039902474731206894,-0.0020613328088074923,-0.20834891498088837,-0.3709942698478699,0.3148074150085449,-0.33232569694519043,0.31417739391326904,0.011936546303331852},{0.08313610404729843,0.22297057509422302,0.3979901671409607,0.3009738624095917,-0.33230069279670715,-0.27734673023223877,0.0518694743514061,0.11996451020240784,-0.1765775829553604,-0.11891777813434601,0.03222130611538887,-0.04410380870103836,0.4925679564476013,0.1891223043203354,-0.14979109168052673,0.029788151383399963},{0.3114747703075409,0.36149659752845764,-0.3689819574356079,-0.21889515221118927,-0.14910687506198883,0.10285168141126633,-0.6207408308982849,0.035548318177461624,0.10361266136169434,-0.27344679832458496,-0.14966270327568054,-0.21864917874336243,0.11525966227054596,0.32751286029815674,0.5893250107765198,-0.012329546734690666},{0.181441530585289,-0.37855589389801025,-0.10767798125743866,0.2482791692018509,0.4483509957790375,0.24088738858699799,0.010016282089054585,-0.13221020996570587,0.46725600957870483,0.40321987867355347,0.1516241878271103,-0.2746187746524811,0.0022681255359202623,0.1920464187860489,-0.19169649481773376,0.2916797399520874},{0.5950883030891418,0.14859558641910553,0.3940649926662445,-0.13752804696559906,0.023041067644953728,-0.15246140956878662,0.30443453788757324,0.5752114057540894,0.2353982925415039,-0.036653004586696625,0.22484755516052246,0.47393351793289185,-0.1679084151983261,0.25516048073768616,0.1818111091852188,0.0033406519796699286},{-0.23232817649841309,0.34984317421913147,-0.01617436110973358,-0.2091502696275711,-0.3085896074771881,-0.3463054299354553,-0.5166271328926086,0.2926757335662842,0.04276420921087265,-0.002935196040198207,0.24308623373508453,0.32712888717651367,-0.21639779210090637,-0.4306262135505676,-0.28477296233177185,-0.2815118134021759},{0.2856307327747345,-0.0811474397778511,0.03765763342380524,0.2711259424686432,0.008584237657487392,0.24062633514404297,0.044288311153650284,0.0315517820417881,-0.6434600949287415,0.4314859211444855,-0.12012498825788498,-0.09678572416305542,-0.4333115220069885,-0.2548796832561493,0.22211842238903046,0.31008586287498474},{0.2912786900997162,-0.5107996463775635,0.34556037187576294,0.7019931077957153,-0.0991695448756218,-0.08414430916309357,-0.03782756254076958,0.4729793667793274,-0.12994354963302612,0.2819870114326477,-0.24280470609664917,-0.20100201666355133,0.28950127959251404,-0.757295548915863,0.16032150387763977,-0.42190518975257874},{-0.7114242315292358,-0.5245363712310791,-0.3666364848613739,0.1860615462064743,-0.1479046493768692,-0.36460503935813904,0.2949216663837433,-0.3713929057121277,-0.07396765798330307,-0.018816350027918816,-0.31922486424446106,-0.7116757035255432,0.18563465774059296,-0.5999560952186584,0.15148970484733582,-0.18305465579032898},{-0.3736898899078369,-0.23090314865112305,-0.19628824293613434,0.32443517446517944,0.0797412246465683,0.31906354427337646,-0.3754723370075226,-0.05975235998630524,0.14110992848873138,-0.7991629838943481,-0.5172313451766968,-0.04077448323369026,0.1564345359802246,-0.13679075241088867,-0.5703130960464478,0.263950377702713},{-0.3494870066642761,0.21290497481822968,0.3849749267101288,0.16077762842178345,0.1188928633928299,0.32407665252685547,-0.4092788100242615,0.260653555393219,-0.059518396854400635,0.061968814581632614,0.20894849300384521,0.23874200880527496,-0.24222223460674286,0.34487199783325195,0.0024323926772922277,-0.3494662046432495},{-0.13410314917564392,0.018221138045191765,-0.18204109370708466,-0.09771277010440826,-0.40016067028045654,0.09920957684516907,-0.24302686750888824,-0.29396894574165344,0.06340361386537552,-0.17533287405967712,-0.11790022999048233,-0.016746805980801582,0.21495495736598969,0.24630886316299438,-0.19976474344730377,-0.14152024686336517},{0.017461130395531654,-0.19137735664844513,-0.2037949562072754,-0.2464868277311325,0.4317532181739807,-0.12813737988471985,-0.33522602915763855,-0.15336869657039642,0.08096359670162201,0.02081887423992157,0.06806443631649017,0.4308348000049591,-0.09280671179294586,0.18695510923862457,-0.2957622706890106,0.4059399366378784},{0.11997085064649582,0.425504595041275,-0.34108301997184753,0.16609230637550354,0.25782766938209534,-0.1841881275177002,-0.00779051473364234,0.1792411506175995,-0.44606056809425354,-0.0007046389509923756,0.16104193031787872,-0.14674866199493408,-0.06955226510763168,-0.04922686889767647,0.10321047902107239,-0.08687666058540344}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.20405174791812897,-0.11571624875068665,-0.19166097044944763,-0.1429571956396103,0.15841583907604218,0.28629881143569946,0.31322532892227173,0.010700703598558903,0.1116497740149498,0.28000909090042114,-0.009014199487864971,-0.30757391452789307,-0.36147865653038025,-0.18908928334712982,0.23094654083251953,0.19944991171360016},{0.03496892750263214,-0.1876085102558136,0.16720721125602722,-0.2306242287158966,0.3439202606678009,-0.36881589889526367,0.22797159850597382,-0.4766343832015991,-0.35033172369003296,0.268066942691803,0.1926112025976181,0.20385059714317322,0.22983470559120178,0.45798438787460327,0.21005015075206757,0.38098031282424927},{0.10674787312746048,-0.13128602504730225,-0.36854758858680725,-0.16401393711566925,0.23920702934265137,-0.19216036796569824,-0.42632734775543213,-0.06908861547708511,0.15885800123214722,-0.07470519095659256,-0.027133287861943245,0.2057041972875595,-0.4124314486980438,0.12783393263816833,-0.1649031937122345,0.18169830739498138},{-0.11341189593076706,0.2566130459308624,0.3301922082901001,-0.18005073070526123,-0.2301221638917923,-0.30503034591674805,-0.3099915683269501,0.14560745656490326,0.2600097358226776,0.04927300289273262,0.16951340436935425,-0.3266809284687042,-0.0390390120446682,0.34110525250434875,0.09901910275220871,-0.24887309968471527},{0.09626100957393646,0.2188989371061325,-0.1754661649465561,0.22812654078006744,0.30789685249328613,0.12775371968746185,-0.28247690200805664,0.02882910519838333,-0.07545653730630875,-0.31281110644340515,0.15771432220935822,0.001493716612458229,-0.09613096714019775,-0.12424126267433167,0.22118911147117615,-0.4603534936904907},{0.4690481424331665,0.1295832246541977,0.48437029123306274,0.012293575331568718,-0.022675804793834686,0.13939355313777924,-0.2091265171766281,0.015341565012931824,0.1869691014289856,-0.22076889872550964,-0.2235666811466217,0.1947794109582901,-0.018515687435865402,-0.12073545157909393,0.11630874872207642,-0.1605173647403717},{0.04849014803767204,0.19304461777210236,0.1482042521238327,-0.11390608549118042,-0.18661810457706451,-0.25642478466033936,0.004962611943483353,0.2768687903881073,0.014948984608054161,-0.16209529340267181,0.40504205226898193,0.22683659195899963,-0.003553694812580943,0.22950075566768646,-0.43558529019355774,-0.18549007177352905},{-0.3290307819843292,0.046253472566604614,-0.18395385146141052,-0.056739840656518936,0.21952000260353088,-0.03834749385714531,0.32153579592704773,-0.13557156920433044,-0.4134881794452667,0.030301468446850777,-0.012771264649927616,-0.3889982998371124,-0.2941579818725586,-0.011512870900332928,0.033338092267513275,-0.24852913618087769},{0.2391936480998993,0.3497373163700104,0.14743682742118835,0.3172471821308136,0.4239104092121124,0.10205322504043579,0.11926749348640442,0.29370710253715515,2.5954213924705982e-05,-0.2558567523956299,0.37448200583457947,0.3015328645706177,0.08461195230484009,-0.1057797372341156,-0.3754332363605499,-0.26079875230789185},{0.07632535696029663,0.17751452326774597,-0.39905548095703125,-0.1738910675048828,0.455337792634964,0.032139766961336136,0.4289903938770294,-0.3221958577632904,0.2275061160326004,-0.06815728545188904,0.16447080671787262,-0.1844366043806076,0.296957403421402,-0.35886403918266296,-0.31578126549720764,0.11705349385738373},{-0.03294855356216431,-0.01179224532097578,-0.14575134217739105,-0.10613374412059784,0.3918514549732208,0.5097452998161316,0.1700933277606964,-0.22042839229106903,-0.2601255178451538,-0.143333300948143,-0.004473475273698568,-0.28196799755096436,0.03601783141493797,0.37208253145217896,-0.1150691956281662,0.11986548453569412},{0.277823805809021,-0.22644257545471191,-0.30583247542381287,-0.08643216639757156,-0.19118888676166534,0.02646196074783802,-0.26834094524383545,-0.3501887619495392,-0.06278998404741287,0.32153448462486267,0.2105385661125183,0.1387566775083542,-0.26055872440338135,0.41004708409309387,0.004476209171116352,0.3639146089553833},{-0.040207184851169586,0.18045847117900848,0.0023845776449888945,-0.37569159269332886,0.0858738124370575,0.1139952763915062,-0.44672974944114685,-0.44478896260261536,0.10576914995908737,-0.31364136934280396,0.3124921917915344,0.16117191314697266,0.00011772121797548607,-0.46886298060417175,-0.48899853229522705,0.501332700252533},{-0.12403833121061325,-0.511009156703949,0.14349718391895294,0.03224511072039604,-0.1647050827741623,-0.06090724840760231,0.21631957590579987,0.31548428535461426,0.008349847048521042,0.037527937442064285,0.5634045004844666,0.3021308183670044,-0.394100546836853,-0.22806426882743835,0.07149504125118256,-0.17909589409828186},{-0.19702206552028656,0.05631747841835022,-0.38233768939971924,0.01095306035131216,-0.062076933681964874,0.05109981447458267,0.2692515254020691,-0.168314129114151,0.16527748107910156,0.3418372571468353,-0.3769676685333252,-0.28574851155281067,-0.2504386901855469,-0.2732091546058655,0.09211316704750061,-0.20884105563163757},{-0.023225504904985428,-0.3143380284309387,0.4673766493797302,-0.340343713760376,0.3298497498035431,0.014770878478884697,-0.19752340018749237,-0.23273225128650665,-0.3610038459300995,-0.3294154703617096,0.009140404872596264,-0.3254747986793518,-0.10408903658390045,-0.1505935937166214,-0.16483689844608307,0.09097907692193985}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{0.007773515302687883,0.2135816365480423,-0.3171418011188507,-0.21573922038078308,0.2560443878173828,-0.2243078500032425,-0.15494677424430847,0.11918718367815018,-0.3664856255054474,0.27927500009536743,0.078829824924469,0.3333874046802521,-0.05095861479640007,0.23542523384094238,0.06931135058403015,0.23174484074115753,-0.12017568200826645,0.3343958556652069,-0.1785859614610672,0.04810955747961998,0.3004225790500641,-0.14880192279815674,0.20344489812850952,-0.045048754662275314,0.173740416765213,-0.22968506813049316,-0.08159491419792175,-0.10952644795179367,-0.29069530963897705,0.023298775777220726,-0.011241838335990906,0.31742063164711},{-0.019924571737647057,0.10297456383705139,-0.1276409924030304,-0.25732460618019104,-0.3534921705722809,-0.32621246576309204,-0.030128201469779015,-0.23947292566299438,0.14818309247493744,0.018400074914097786,-0.15670163929462433,0.21951979398727417,0.132285937666893,-0.040701013058423996,0.051601942628622055,0.26485389471054077,-0.20483151078224182,0.32833540439605713,0.029260197654366493,-0.2976960837841034,0.11422936618328094,-0.12169331312179565,0.18250331282615662,-0.056207288056612015,0.009619718417525291,0.3158380091190338,-0.30403435230255127,0.3127046227455139,-0.21373948454856873,-0.11535189300775528,0.14447908103466034,0.2168249785900116},{-0.036509860306978226,-0.06302137672901154,0.3162217438220978,0.13802838325500488,-0.1694839894771576,-0.3532142639160156,-0.018016310408711433,-0.17094577848911285,-0.15400433540344238,0.2656725347042084,-0.1406996250152588,0.3063165545463562,-0.3140147924423218,-0.24070380628108978,-0.06173620745539665,0.14287739992141724,0.2594689428806305,0.17119400203227997,-0.15893566608428955,-0.03479389101266861,-0.11715400218963623,-0.0780419185757637,0.2158123105764389,-0.065956249833107,0.26701751351356506,-0.04136412963271141,0.23134161531925201,-0.1774446815252304,-0.0037991146091371775,-0.20765149593353271,-0.20808517932891846,0.24625875055789948},{-0.304280549287796,-0.16269813477993011,-0.13257893919944763,0.17128024995326996,-0.31948888301849365,-0.2504989504814148,-0.22337454557418823,0.30268844962120056,0.00706374691799283,-0.04616159200668335,0.02561594732105732,0.26518866419792175,0.13353314995765686,-0.2404453605413437,0.3672832250595093,0.004457670729607344,-0.051059748977422714,0.20468030869960785,-0.15054208040237427,-0.20065541565418243,0.212721586227417,0.2920365333557129,-0.10236773639917374,-0.19959412515163422,-0.36769306659698486,0.077906534075737,0.20472432672977448,0.18824434280395508,-0.2245122641324997,0.02976519614458084,-0.04573194310069084,-0.2321271449327469},{-0.010226237587630749,0.20484349131584167,-0.01914104074239731,0.159367635846138,0.12538310885429382,-0.31044384837150574,-0.1693367213010788,-0.13916943967342377,-0.3120255470275879,-0.11696383357048035,-0.15069147944450378,0.2882801592350006,-0.27497613430023193,0.3331397771835327,-0.10619160532951355,-0.07695300877094269,0.0783211886882782,0.12201451510190964,-0.07564106583595276,-0.009603096172213554,0.17029370367527008,0.15112239122390747,-0.1219116821885109,-0.16589610278606415,-0.0947764664888382,0.10936017334461212,-0.16095849871635437,-0.29825180768966675,-0.13642318546772003,-0.20415976643562317,-0.2746492922306061,0.024480246007442474},{0.16615834832191467,0.12814980745315552,0.287442147731781,0.1457122266292572,-0.12838485836982727,0.14187940955162048,0.26735833287239075,-0.15793012082576752,0.052408985793590546,0.32815027236938477,-0.17897307872772217,0.16154690086841583,-0.20309698581695557,0.1886071264743805,0.2040366679430008,-0.1581765115261078,0.26672977209091187,0.35786622762680054,0.08956456929445267,0.11930650472640991,0.07128971070051193,0.06046885997056961,-0.20604254305362701,0.08349069207906723,0.28810057044029236,-0.05655603110790253,0.025110574439167976,0.16372574865818024,0.16558140516281128,-0.021586768329143524,-0.3016296625137329,0.19350852072238922},{-0.23047123849391937,-0.17907612025737762,-0.13659177720546722,0.2591693103313446,0.25773608684539795,0.15262000262737274,0.4091772735118866,-0.09752102941274643,-0.09967442601919174,-0.11226125806570053,0.35508543252944946,0.06428435444831848,-0.18165065348148346,-0.25673890113830566,-0.08603295683860779,0.13079069554805756,-0.0073099383153021336,0.05755191668868065,-0.1227373257279396,-0.1587209403514862,0.2813992500305176,-0.008033559657633305,-0.08450290560722351,0.3232899010181427,0.21052315831184387,-0.13175611197948456,0.11386315524578094,0.20929333567619324,0.0032090211752802134,0.1375327706336975,-0.16220755875110626,-0.015023943036794662},{0.24947310984134674,-0.06950036436319351,-0.09491568058729172,0.19939982891082764,0.11205900460481644,0.10577019304037094,-0.010088657960295677,-0.07967957109212875,0.192343071103096,-0.3030012845993042,-0.18735246360301971,0.010163095779716969,0.127020001411438,-0.07748348265886307,0.382108211517334,0.06101815402507782,0.20421414077281952,0.10023634135723114,0.06067056208848953,-0.09063109010457993,-0.025871850550174713,0.11509522050619125,0.031442880630493164,-0.14694224298000336,0.2718507945537567,-0.0577133409678936,-0.2637012302875519,-0.2450733333826065,-0.32000312209129333,0.2749635577201843,-0.001594050438143313,0.18034926056861877},{0.06224064528942108,0.24986211955547333,-0.2597668170928955,0.15307503938674927,-0.19743722677230835,-0.3915058374404907,0.27404460310935974,-0.04977897182106972,0.06801468133926392,0.07510489225387573,-0.143842414021492,-0.18747694790363312,-0.015948042273521423,-0.033025506883859634,0.09644892066717148,0.007693065330386162,-0.17208537459373474,-0.06302957236766815,-0.35654741525650024,-0.06755142658948898,0.32458266615867615,0.3187171518802643,0.022961629554629326,0.19367016851902008,0.24634473025798798,-0.3952808380126953,-0.04915444925427437,-0.1016717478632927,0.360927551984787,-0.08689027279615402,0.2841377854347229,-0.1660948097705841},{0.18227969110012054,0.15141838788986206,0.03944417089223862,0.1469206064939499,-0.08729854971170425,0.22011855244636536,0.26562243700027466,0.06513277441263199,-0.06722559034824371,0.2555132210254669,0.1939452886581421,0.13082294166088104,0.029675958678126335,0.20163194835186005,0.23005183041095734,0.06898066401481628,0.0865681916475296,-0.06920965015888214,-0.008913504891097546,-0.22308394312858582,-0.20739828050136566,0.1690582036972046,-0.40461891889572144,0.03384063392877579,-0.10764232277870178,-0.18001960217952728,0.18371407687664032,0.11930766701698303,0.24574503302574158,0.40872642397880554,-0.3562421202659607,0.20354175567626953},{-0.1918335109949112,0.059587687253952026,0.27589425444602966,0.1620839685201645,-0.10124477744102478,0.07483081519603729,-0.19038735330104828,-0.2466297149658203,-0.09693381190299988,-0.11934172362089157,0.13319236040115356,0.05554218962788582,0.005118429660797119,-0.33999013900756836,0.16211293637752533,0.09363531321287155,0.02134101092815399,-0.06941981613636017,0.2818012237548828,0.10809958726167679,-0.18868868052959442,-0.17861488461494446,0.11752587556838989,-0.11719535291194916,-0.1651371270418167,0.3733007609844208,0.04648083820939064,-0.37594687938690186,0.029809290543198586,0.024325335398316383,-0.14298047125339508,-0.07693424820899963},{-0.24762307107448578,-0.11848592758178711,0.09324473887681961,0.1529017835855484,0.11929518729448318,0.20301778614521027,-0.1676190197467804,0.26969629526138306,-0.3050870895385742,0.06781928241252899,0.18343056738376617,0.02418329007923603,0.2121390551328659,0.03257051855325699,-0.12351349741220474,-0.28136149048805237,0.2179761677980423,-0.191335529088974,-0.20782017707824707,0.09697616845369339,0.07767477631568909,-0.18393872678279877,-0.2244158685207367,-0.033165544271469116,-0.20932644605636597,-0.28480589389801025,-0.06793617457151413,-0.1719297617673874,0.1957380473613739,-0.2927989363670349,0.16499803960323334,-0.26014772057533264},{-0.2506329119205475,-0.3086666762828827,0.16244077682495117,-0.10362819582223892,-0.17170971632003784,-0.03695691004395485,-0.1080307736992836,-0.27270740270614624,-0.1500912457704544,-0.17384256422519684,-0.150471031665802,-0.21309585869312286,0.2844630777835846,0.08605286478996277,0.18723303079605103,-0.2981191575527191,0.2689986526966095,0.27884331345558167,0.12289086729288101,-0.22900426387786865,0.03490827605128288,-0.004073041491210461,-0.2426455020904541,0.20554469525814056,0.09596866369247437,0.26063281297683716,0.08535300940275192,0.03330407291650772,0.02139548398554325,0.45190462470054626,0.05748478323221207,-0.1971481442451477},{0.011343061923980713,-0.09233064949512482,0.08001521974802017,-0.17757825553417206,0.13651402294635773,0.21026955544948578,0.07973883301019669,0.18487514555454254,-0.04530707374215126,-0.03301255777478218,0.16816866397857666,-0.12285759299993515,0.1773313730955124,0.18848645687103271,0.38469797372817993,-0.13572800159454346,-0.21056252717971802,0.12524163722991943,0.2091914415359497,0.2689511477947235,0.14824578166007996,-0.09091877192258835,0.11557810753583908,0.034879788756370544,-0.10434611886739731,0.09797076880931854,0.1900651901960373,0.33824679255485535,0.24647226929664612,0.2774806022644043,0.1704370677471161,0.2546977400779724},{-0.0521819181740284,0.038092177361249924,0.03228180110454559,0.011606117710471153,0.014124912209808826,-0.3609160780906677,0.013696976937353611,-0.023413002490997314,-0.2771736979484558,-0.03765150532126427,-0.06993461400270462,0.2642863690853119,0.25865620374679565,0.04920937493443489,-0.05053648725152016,0.17353367805480957,0.23924210667610168,-0.20580431818962097,-0.07700265198945999,0.20170871913433075,-0.13693219423294067,-0.1422494649887085,-0.3591752350330353,0.3331063389778137,-0.04554085060954094,-0.36306917667388916,-0.20309963822364807,-0.04352208226919174,-0.33846744894981384,-0.22271807491779327,-0.303551584482193,-0.12947344779968262},{0.3589162826538086,-0.032169196754693985,-0.021314416080713272,0.028632471337914467,-0.25369635224342346,0.18439091742038727,-0.10731175541877747,-0.07377375662326813,0.22668267786502838,-0.011746254749596119,-0.25889497995376587,-0.012833498418331146,-0.013433252461254597,-0.12551499903202057,0.10159052908420563,0.17146894335746765,0.2565474510192871,-0.36663928627967834,0.20959170162677765,-0.12763775885105133,0.0201136264950037,-0.29050377011299133,0.23702280223369598,-0.08990487456321716,0.017002293840050697,0.0796244889497757,0.2266187220811844,0.07333763688802719,-0.208369642496109,-0.21177245676517487,-0.012776688672602177,-0.042232103645801544},{-0.18995247781276703,-0.40978753566741943,0.33649030327796936,-0.324344277381897,-0.17063391208648682,0.28503087162971497,0.255978524684906,0.37941887974739075,-0.28380316495895386,-0.22965748608112335,-0.07085196673870087,0.13277754187583923,0.0327896848320961,-0.33034124970436096,-0.02839205041527748,-0.4443373382091522,-0.2328159511089325,0.0884285643696785,-0.14711059629917145,0.08277750015258789,-0.13548459112644196,0.04984518885612488,0.22675102949142456,-0.11042667925357819,0.11555978655815125,0.17668980360031128,-0.09571116417646408,-0.21704857051372528,-0.13642720878124237,0.19737422466278076,-0.06374460458755493,-0.20969945192337036},{-0.291205495595932,0.019907869398593903,-0.052772559225559235,-0.24784161150455475,-0.22938232123851776,0.06126789376139641,-0.18437963724136353,-0.293868750333786,-0.019865775480866432,0.13171957433223724,-0.31024906039237976,-0.3536449670791626,0.13672566413879395,0.10102135688066483,0.23603098094463348,-0.13109037280082703,0.1583615094423294,-0.2558591663837433,-0.03692290931940079,0.04512267932295799,0.1567448526620865,-0.04875137284398079,0.022778112441301346,0.28518933057785034,0.23055000603199005,0.2145950049161911,0.13658173382282257,-0.4018227458000183,0.020778343081474304,-0.25280842185020447,-0.2582102119922638,-0.1473383605480194},{-0.07454294711351395,0.2752397656440735,-0.2171865701675415,-0.2841608226299286,0.19221921265125275,-0.34606894850730896,-0.16334432363510132,0.05964140221476555,-0.05731188878417015,-0.09056062251329422,0.266169935464859,-0.10330886393785477,0.23250839114189148,0.25953182578086853,-0.263755202293396,-0.08003950864076614,-0.23889406025409698,-0.00954251829534769,0.06617288291454315,-0.03437479957938194,-0.02710728533565998,-0.15243154764175415,-0.08701103180646896,-0.0369935967028141,0.19847562909126282,0.04176758974790573,0.3385029435157776,0.3081916868686676,-0.23674888908863068,0.1944798231124878,0.06793217360973358,0.042539142072200775},{0.2133655995130539,-0.23427630960941315,-0.1662200391292572,0.2710348665714264,0.026918992400169373,-0.09625063836574554,-0.24850507080554962,0.19124680757522583,-0.19072237610816956,0.25343799591064453,-0.058030057698488235,-0.0842152088880539,-0.010074278339743614,-0.12272278219461441,0.3330230712890625,0.11343034356832504,0.12300358712673187,-0.2857142388820648,0.24662132561206818,-0.2509366273880005,0.01614505983889103,0.023517068475484848,-0.21562083065509796,0.21122156083583832,-0.005964198615401983,0.32935696840286255,-0.051570091396570206,0.25776219367980957,-0.2868441641330719,-0.13719652593135834,-0.26656728982925415,0.20451442897319794},{-0.09575309604406357,-0.26317837834358215,0.11936046928167343,0.18415626883506775,-0.017383301630616188,-0.09327740967273712,-0.14734576642513275,0.24129250645637512,0.024153219535946846,0.03530796617269516,-0.3000832200050354,-0.01787070371210575,-0.23878677189350128,-0.27118679881095886,0.06222669035196304,0.25351443886756897,0.018067745491862297,0.24551165103912354,-0.20553001761436462,0.24958884716033936,0.22388850152492523,0.37656718492507935,0.020047690719366074,0.25001969933509827,0.18005511164665222,-0.07994015514850616,-0.08281096816062927,-0.07234245538711548,-0.26330476999282837,-0.11845199018716812,0.17070220410823822,0.03691492974758148},{0.34148433804512024,0.18838830292224884,0.3533245027065277,-0.22759436070919037,-0.19917693734169006,0.0845080241560936,0.309320867061615,-0.26877662539482117,-0.11265981942415237,-0.29185009002685547,0.3246026039123535,0.21540884673595428,0.15118342638015747,0.05523739755153656,0.035419244319200516,-0.05028513818979263,-0.29645973443984985,0.2472270429134369,-0.21008753776550293,0.14500300586223602,0.2727632224559784,0.33489251136779785,0.07151088118553162,0.11604287475347519,-0.15302801132202148,0.03144308552145958,-0.1258193999528885,-0.10235493630170822,-0.04001826420426369,-0.13011176884174347,0.031163698062300682,-0.014009594917297363},{0.21207228302955627,0.31688883900642395,-0.011581402271986008,0.03685280308127403,-0.25615155696868896,-0.1338919699192047,-0.13175615668296814,0.025304364040493965,-0.3155098855495453,-0.21887287497520447,0.2440950721502304,-0.014558234252035618,-0.06784015893936157,-0.23500144481658936,-0.3251384198665619,-0.28652578592300415,0.11636975407600403,-0.2465212643146515,-0.13925553858280182,-0.2242874652147293,0.27969470620155334,0.22657737135887146,-0.20148050785064697,-0.2510145604610443,-0.08508879691362381,0.01975274831056595,-0.055996473878622055,-0.013641739264130592,0.255199134349823,0.28939780592918396,-0.163554847240448,-0.011657614260911942},{0.00012789996981155127,-0.36438292264938354,-0.24110256135463715,-0.04050091654062271,-0.04182219132781029,0.11270712316036224,-0.047201983630657196,0.2659406363964081,-0.11841998994350433,-0.1349303424358368,0.14190836250782013,0.40815821290016174,-0.16363590955734253,-0.14522811770439148,0.22641369700431824,0.013883020728826523,-0.14468568563461304,-0.2874593436717987,-0.2592194974422455,-0.19951067864894867,-0.32051199674606323,-0.20488451421260834,0.0350150391459465,-0.3303960859775543,-0.03249659016728401,-0.32031339406967163,0.04079277068376541,0.19209949672222137,0.12259170413017273,-0.07663995027542114,0.05486571043729782,-0.3056221604347229}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.1685960441827774,-0.39401596784591675,-0.07588162273168564,-0.3328995704650879},{-0.18070824444293976,-0.05670449510216713,-0.2846042215824127,0.07881437987089157},{0.35433122515678406,-0.2060338258743286,-0.1517699807882309,-0.35644426941871643},{-0.02017303742468357,0.012276019901037216,0.03324378281831741,0.237827867269516},{0.17328529059886932,-0.2616270184516907,-0.3131054937839508,0.20297038555145264},{0.05589328706264496,-0.45793139934539795,0.02313803881406784,0.3035428524017334},{-0.0145797124132514,-0.08559492975473404,0.13423220813274384,0.31383049488067627},{0.16873513162136078,-0.02500073052942753,0.013059398159384727,-0.25037485361099243},{-0.1670488566160202,0.2565821409225464,-0.08548316359519958,-0.11633940041065216},{0.15113818645477295,-0.11621109396219254,-0.02360725961625576,0.2228027731180191},{0.36346182227134705,0.3629470765590668,0.10448780655860901,0.23851777613162994},{0.26981136202812195,-0.3070504367351532,-0.11026077717542648,0.39242812991142273},{0.171383798122406,0.15522131323814392,-0.036005452275276184,-0.1847313642501831},{-0.32262805104255676,-0.29902738332748413,0.2354937642812729,0.04387295991182327},{0.4243566393852234,0.36429738998413086,-0.1243220716714859,-0.052522994577884674},{-0.23863190412521362,-0.055819228291511536,-0.012510149739682674,0.1828722506761551},{0.15841670334339142,0.1604354828596115,-0.3641760051250458,-0.16172859072685242},{0.1665889322757721,0.08775456249713898,-0.22309286892414093,0.3179487884044647},{-0.0013620350509881973,-0.1641872674226761,-0.025537140667438507,-0.09912177175283432},{0.07440115511417389,-0.11258150637149811,-0.11207297444343567,0.11132006347179413},{-0.3925306797027588,-0.07008137553930283,0.367285817861557,0.26754599809646606},{0.3793879747390747,0.3084719777107239,-0.06679883599281311,-0.3951989710330963},{-0.022391892969608307,0.246906578540802,-0.37287142872810364,0.07171414792537689},{0.216721773147583,0.3748664855957031,0.182508647441864,-0.22847524285316467},{0.042435988783836365,-0.028929060325026512,-0.25531530380249023,0.17850945889949799},{-0.1741558164358139,-0.08121030777692795,0.3878762125968933,0.3807651102542877},{0.20082645118236542,-0.20007312297821045,-0.08157676458358765,-0.12164147198200226},{0.011946460232138634,-0.04171600937843323,0.08669644594192505,-0.2255610078573227},{-0.17236880958080292,0.024199791252613068,-0.3607293963432312,-0.05517333000898361},{0.10952509939670563,0.010940986685454845,0.3519664704799652,0.27944034337997437},{-0.4023579955101013,-0.1919640302658081,0.006002666428685188,-0.055234454572200775},{-0.21771113574504852,0.03758261725306511,-0.23063348233699799,-0.2290155291557312}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.1258116364479065,-0.015701599419116974,-0.011428273282945156,0.09589990973472595,-0.007659877184778452,0.12128428369760513,-0.04172777384519577,0.027734974399209023,-0.020132744684815407,0.01611226610839367,0.028203217312693596,0.09159962832927704,0.13799305260181427,-0.0007981323287822306,0.025562426075339317,0.018282165750861168};
static const float actor_encoder_self_encoder_2_bias[16] = {0.061578620225191116,-0.05514400824904442,0.013495472259819508,-0.000507853867020458,-0.0022627422586083412,0.015404083766043186,0.03561271354556084,-0.06070026010274887,0.053352635353803635,-0.019342811778187752,0.007128199562430382,-0.04556228592991829,-0.009556170552968979,-0.04920414462685585,0.041308723390102386,0.05304376780986786};
static const float actor_encoder_feed_forward_0_bias[32] = {0.024936633184552193,-0.03763822838664055,0.005934164859354496,-0.007162266876548529,0.007269587833434343,-0.03689153864979744,0.053432125598192215,-0.030016906559467316,-0.003954175394028425,0.00856753159314394,0.05433309078216553,0.042976077646017075,0.010801736265420914,-0.002342838793992996,-0.009609969332814217,-0.02190031297504902,-0.03509937971830368,0.003048128914088011,-0.03869901970028877,0.00806193333119154,0.0023010887671262026,0.02528310753405094,-0.021194009110331535,0.04367832466959953,0.006465334445238113,-0.034315191209316254,0.033936962485313416,0.0034779272973537445,-0.03996501863002777,0.013269764371216297,-0.06949102133512497,-0.040677838027477264};
static const float action_parameterization_distribution_linear_bias[4] = {0.03680209070444107,0.009798407554626465,0.03286775201559067,0.015553219243884087};
static const float actor_encoder_obstacle_encoder_0_weight[16][16] = {{-0.5424456596374512,-0.4072926938533783,0.12200278043746948,0.10196761786937714,-0.2270219326019287,-0.4039975106716156,-0.33547231554985046,0.010946564376354218,-0.20474615693092346,-0.2389649599790573,-0.5725530385971069,-0.23268669843673706,-0.18303599953651428,-0.1013784110546112,0.10669829696416855,0.4750584661960602},{0.20418637990951538,-0.23186761140823364,0.07707808166742325,-0.4057592451572418,0.1802038848400116,0.3096104562282562,0.4623763859272003,0.4128236770629883,-0.21903924643993378,-0.08437079936265945,-0.1920483410358429,-0.1452912539243698,-0.09264755994081497,0.41406184434890747,-0.20240435004234314,0.20288130640983582},{-0.06118582934141159,0.3473046123981476,-0.026979265734553337,0.17536872625350952,-0.5219649076461792,-0.07987387478351593,0.16985255479812622,0.28917691111564636,-0.45369669795036316,-0.36420172452926636,-0.1079716831445694,0.32776638865470886,0.0912214070558548,0.23118744790554047,-0.3858906626701355,-0.008379988372325897},{-0.35036230087280273,-0.24478815495967865,0.10710173845291138,-0.0336737222969532,0.06514663994312286,0.1650504320859909,0.2670673727989197,0.4115932881832123,-0.3294331729412079,-0.34667277336120605,0.24169683456420898,-0.3437252342700958,0.40208739042282104,0.4811137318611145,0.020487703382968903,-0.2507207989692688},{-0.34077998995780945,0.02605482004582882,0.02162844128906727,0.02416498400270939,0.015707900747656822,0.17994140088558197,0.2857232987880707,0.4996838867664337,-0.47452640533447266,-0.2963894009590149,-0.2810782194137573,0.25472596287727356,0.4687744379043579,0.05265987291932106,0.16596311330795288,-0.4840223491191864},{-0.2501928210258484,0.30235087871551514,-0.42482197284698486,0.12509572505950928,0.010189572349190712,-0.006871943827718496,0.38353684544563293,-0.0957210510969162,-0.14784690737724304,-0.12395107001066208,0.20517629384994507,0.3589808940887451,-0.26778408885002136,-0.15115396678447723,-0.044215962290763855,-0.022688284516334534},{0.1701938807964325,0.4968344569206238,0.07619025558233261,-0.11302037537097931,0.2661747336387634,0.0961671769618988,0.4580938518047333,0.16271595656871796,0.18156015872955322,-0.41803663969039917,0.012879456393420696,0.014370917342603207,0.5003023147583008,0.35611462593078613,0.11820144951343536,-0.23990443348884583},{0.3926112651824951,0.3284022808074951,-0.1446191817522049,0.018345162272453308,-0.008367981761693954,-0.2847769856452942,-0.01439351961016655,-0.32874733209609985,-0.48019394278526306,-0.38707593083381653,-0.030634934082627296,-0.24279245734214783,0.49290943145751953,0.09976380318403244,0.5601745843887329,-0.330475777387619},{0.3958120048046112,0.048540711402893066,-0.23302775621414185,0.2813856899738312,-0.23972094058990479,0.17435389757156372,-0.430776447057724,0.28707000613212585,0.029496872797608376,0.0908636599779129,-0.2952728867530823,0.10487225651741028,0.5445994734764099,0.24238701164722443,0.24861271679401398,-0.17923207581043243},{-0.07742659747600555,0.3583037555217743,0.18943989276885986,0.2020060122013092,-0.21093933284282684,0.15901856124401093,0.3124321401119232,-0.32465502619743347,-0.5349545478820801,0.17114655673503876,0.4270760118961334,0.10507555305957794,0.30815938115119934,-0.053307052701711655,0.3880966901779175,-0.057429417967796326},{-0.17652627825737,0.036565184593200684,0.16400837898254395,-0.3236428201198578,-0.2038281112909317,-0.14345821738243103,-0.16041521728038788,-0.3367515206336975,-0.3585638701915741,-0.36164790391921997,-0.07768687605857849,0.1593383252620697,0.4979604184627533,0.32591259479522705,0.13003972172737122,0.1775587499141693},{-0.09366154670715332,-0.11570585519075394,0.18453335762023926,0.4369662404060364,-0.07812868058681488,0.13808079063892365,-0.27166855335235596,-0.34806451201438904,-0.09379984438419342,-0.6558079123497009,0.27521368861198425,-0.2427915334701538,0.2945047914981842,-0.19003529846668243,0.10395122319459915,-0.15493030846118927},{-0.011108685284852982,0.010449361987411976,-0.058635931462049484,0.5757824778556824,0.05371296778321266,-0.0835999920964241,0.08500480651855469,0.13695701956748962,-0.09178635478019714,-0.4143112301826477,0.01048194244503975,-0.10771878063678741,-0.1841682493686676,0.5324288606643677,-0.06789040565490723,0.429663747549057},{0.07210367918014526,0.07559969276189804,0.32433730363845825,0.10973217338323593,-0.23483462631702423,0.3990280330181122,0.08061233162879944,-0.031840186566114426,0.1929362267255783,-0.05568382143974304,-0.17128871381282806,-0.2301376909017563,-0.11117137968540192,0.5355994701385498,-0.07327715307474136,-0.25708022713661194},{-0.3498753309249878,0.2214769870042801,0.44229263067245483,-0.33187997341156006,-0.39138728380203247,0.31907975673675537,-0.005885155405849218,0.002495167776942253,-0.13362738490104675,-0.10058208554983139,-0.3050191104412079,-0.5371115803718567,0.13192905485630035,0.312323659658432,-0.27964460849761963,-0.025998380035161972},{0.06292278319597244,0.029516756534576416,-0.010579433292150497,0.037361301481723785,-0.04965696856379509,0.5494386553764343,0.02668563649058342,0.2094317227602005,-0.26271238923072815,-0.35113340616226196,-0.4565733075141907,-0.1049276813864708,-0.17077624797821045,0.3988417387008667,0.14100728929042816,0.06021140515804291}};
static const float actor_encoder_obstacle_encoder_2_weight[16][8] = {{0.08249706774950027,-0.4141944646835327,-0.4007120728492737,-0.2445523589849472,0.15743452310562134,0.025648530572652817,0.3353492319583893,0.40132537484169006},{0.16593658924102783,-0.14511381089687347,-0.2923625111579895,0.0720791146159172,-0.27170851826667786,-0.07737559080123901,0.42643436789512634,0.41202545166015625},{-0.21298366785049438,-0.32790306210517883,-0.28634050488471985,-0.2148532271385193,-0.16153784096240997,-0.17745386064052582,-0.2761290967464447,-0.014218338765203953},{0.07068023830652237,-0.4008990526199341,0.2841308116912842,-0.2804396450519562,-0.46615517139434814,0.0347013920545578,-0.2533907890319824,0.23113340139389038},{-0.07899653166532516,-0.09274611622095108,-0.41490408778190613,0.3425019085407257,-0.47758081555366516,-0.2884007692337036,-0.5052103400230408,-0.12098528444766998},{-0.22651204466819763,-0.04195044934749603,0.4574611186981201,-0.32176339626312256,-0.054743487387895584,-0.1400318592786789,0.3328127861022949,0.27686062455177307},{-0.10310384631156921,0.407894492149353,0.15870468318462372,0.03141364827752113,0.4180551767349243,0.1938357949256897,0.4583621621131897,-0.21024595201015472},{-0.01043032854795456,0.19417628645896912,-0.43949636816978455,0.20162929594516754,-0.049593158066272736,0.11947914212942123,-0.059556372463703156,-0.33705952763557434},{-0.4507552683353424,-0.10687221586704254,0.44119563698768616,-0.32656338810920715,0.16010168194770813,-0.22180652618408203,0.12161949276924133,0.23982416093349457},{-0.3171793818473816,-0.03595539927482605,-0.08728893846273422,0.19441889226436615,-0.19899973273277283,-0.1824256032705307,0.08689996600151062,0.19020730257034302},{0.4556277096271515,0.24859097599983215,-0.4550412595272064,-0.4069276452064514,-0.09354537725448608,-0.057385560125112534,-0.49437955021858215,0.1482829749584198},{0.23129388689994812,-0.13730069994926453,-0.04976609721779823,0.5296880006790161,-0.0015542819164693356,-0.2567007839679718,0.1897531896829605,0.20260728895664215},{-0.04513285681605339,-0.12912052869796753,0.11897484958171844,0.2910243570804596,-0.2177470475435257,0.33620795607566833,0.20185746252536774,0.12264032661914825},{-0.005644634366035461,-0.07692815363407135,-0.504082441329956,-0.028288457542657852,0.298502653837204,0.6166316866874695,0.04092959314584732,0.16241520643234253},{0.01936897449195385,-0.417397677898407,-0.10330329835414886,-0.3476681113243103,0.31071826815605164,0.04661533981561661,0.037790101021528244,0.20289437472820282},{0.16523532569408417,-0.07804364711046219,0.2633857727050781,0.0014621973969042301,-0.4782056510448456,-0.033486269414424896,0.030035287141799927,-0.23627959191799164}};
static const float actor_encoder_obstacle_encoder_0_bias[16] = {0.04561785236001015,-0.017118042334914207,-0.027737591415643692,-0.051290564239025116,-0.08518717437982559,-0.07775183022022247,0.0023779021576046944,0.04992375150322914,-0.2253093719482422,-0.2577348053455353,0.04342181980609894,0.0238763727247715,0.1302170604467392,0.08989547938108444,-0.027708493173122406,0.0842333436012268};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.009707395918667316,0.01851341687142849,-0.010742491111159325,0.04068635031580925,0.010688865557312965,0.16900090873241425,0.025988496840000153,-0.010707143694162369};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

