
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 20},{20, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[20];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.354874849319458,0.2936067283153534,-0.24907396733760834,0.06884551048278809,-0.03149092569947243,-0.2828947901725769,0.16070662438869476,-0.07918144762516022,0.03120681457221508,0.7398967742919922,0.09009769558906555,0.005938948132097721,-0.1704988330602646,0.0333721786737442,-0.19354534149169922,0.16580073535442352},{-0.2692016661167145,-0.04130903258919716,0.058205101639032364,0.1909816861152649,-0.1095479279756546,0.7787410616874695,-0.08538947999477386,0.1322205513715744,0.10800611227750778,-0.20653420686721802,0.06709639728069305,0.4025746285915375,0.17342890799045563,-0.005271364934742451,0.05639434978365898,-0.19928012788295746},{-0.14453266561031342,-0.26942986249923706,-0.4061373472213745,-0.14864955842494965,0.38085928559303284,-0.005395655985921621,-0.4821760654449463,0.0067048403434455395,-0.14465214312076569,0.5396304130554199,-0.6554116010665894,0.13077428936958313,-0.1289377361536026,0.5021982192993164,0.32733413577079773,-0.24081134796142578},{-0.28070831298828125,0.2511492073535919,0.006970191840082407,0.0606972798705101,0.3331892192363739,0.09788423031568527,-0.16518084704875946,0.011986389756202698,0.38552209734916687,0.028979528695344925,0.07139280438423157,-0.20429913699626923,-0.05642206594347954,-0.4497804641723633,0.01832038350403309,0.13874705135822296},{-0.08778797835111618,0.19254104793071747,-0.24452736973762512,0.02209133841097355,-0.22019968926906586,0.08244234323501587,-0.27954235672950745,-0.327701598405838,0.09456684440374374,-0.11004584282636642,-4.859152249991894e-05,0.2508015036582947,-0.26770809292793274,-0.22439353168010712,0.004189085680991411,0.4901934862136841},{0.09976725280284882,0.07777707278728485,-0.47390371561050415,-0.16786636412143707,0.14098753035068512,0.056769322603940964,-0.2104666829109192,0.1262127310037613,0.39136314392089844,-0.1341070681810379,-0.2715226411819458,-0.052451666444540024,-0.26920488476753235,0.05684540793299675,0.028338171541690826,-0.21351465582847595},{0.15076521039009094,0.04138059541583061,-0.18290790915489197,0.43300554156303406,-0.07415439188480377,-0.309668630361557,-0.4543710947036743,-0.12697739899158478,-0.5229185223579407,-0.21638080477714539,-0.22498813271522522,-0.010691417381167412,0.12169887125492096,0.2103288322687149,-0.19892176985740662,-0.12305016070604324},{0.19183219969272614,0.07510434091091156,-0.45228809118270874,0.009345890022814274,-0.29132261872291565,0.522375226020813,0.018488174304366112,0.38662153482437134,-0.39215967059135437,-0.0703497976064682,-0.10769214481115341,-0.06487637758255005,-0.3648734390735626,-0.0919494554400444,-0.09494470059871674,0.5354360342025757},{-0.6049699783325195,0.3085385859012604,0.1050032302737236,0.5654963850975037,0.4217616319656372,0.2996155321598053,0.171129509806633,0.1450500786304474,0.652819037437439,0.17899003624916077,-0.10401863604784012,-0.21142269670963287,0.4322342574596405,-0.6166696548461914,0.20885619521141052,-0.12477398663759232},{-0.13242024183273315,0.4614430367946625,0.15166833996772766,-0.15970049798488617,-0.012444533407688141,-0.34508854150772095,-0.14401096105575562,-0.15318773686885834,0.022110633552074432,0.07722120732069016,0.08592202514410019,0.36169931292533875,0.4884342551231384,0.24812659621238708,-0.11012449115514755,-0.6241958141326904},{0.4956410825252533,-0.04904356226325035,-0.45451685786247253,0.4996601641178131,0.2582726776599884,-0.041346918791532516,0.1491011083126068,-0.2416619211435318,-0.49775663018226624,0.12103439122438431,-0.2384655922651291,0.0855625718832016,-0.27414578199386597,-0.4478743374347687,0.0031587097328156233,0.32589998841285706},{-0.39165765047073364,-0.06258083134889603,-0.17740508913993835,-0.3403996229171753,0.10379023104906082,0.26331251859664917,-0.11807935684919357,-0.637082576751709,-0.3050961196422577,-0.051116298884153366,-0.6721529364585876,0.5259707570075989,0.23658452928066254,-0.3164292871952057,0.6031205654144287,0.18921467661857605},{-0.6257872581481934,0.7569456100463867,0.4300292134284973,0.2936936318874359,0.15590709447860718,0.3232835829257965,-0.13471610844135284,0.002584396628662944,0.028529148548841476,-0.8087127804756165,-0.08732573688030243,-0.43195366859436035,0.7378202676773071,-0.543125331401825,-0.008411798626184464,0.2197498083114624},{0.17435143887996674,0.06541946530342102,-0.20942313969135284,0.039059292525053024,-0.3635871112346649,-0.2835853695869446,0.022975383326411247,-0.6947605609893799,0.20126810669898987,-0.46996569633483887,-0.11945628374814987,0.6002264618873596,-0.06996302306652069,0.08845348656177521,0.5298953056335449,-0.12206591665744781},{-0.45217272639274597,-0.3902769684791565,-0.2673723101615906,-0.3446023166179657,-0.23204004764556885,-0.4851951599121094,0.3621203601360321,0.46662837266921997,-0.5231632590293884,0.16725976765155792,-0.11410175263881683,-0.19300349056720734,-0.22235047817230225,0.32518523931503296,0.32004037499427795,0.3125189244747162},{-0.217874675989151,0.05670075863599777,-0.22760719060897827,-0.11571673303842545,-0.16251042485237122,-0.00010935346654150635,-0.1614142507314682,-0.32624736428260803,-0.17636607587337494,0.014149854891002178,0.14671598374843597,0.22438406944274902,0.22584344446659088,0.2453436553478241,0.08025185763835907,0.12722112238407135},{0.2803185284137726,-0.3138824701309204,0.1536383032798767,-0.20775122940540314,-0.13356219232082367,0.11491569876670837,0.16248364746570587,-0.01240498386323452,-0.16257759928703308,-0.0007224900182336569,0.0777498111128807,-0.13164085149765015,-0.2870102822780609,-0.021993344649672508,0.18180279433727264,-0.09624440222978592},{0.3108711242675781,0.05671452358365059,0.09220658242702484,0.05476812645792961,-0.03925726190209389,0.24113209545612335,0.05954732000827789,0.19325323402881622,-0.29222697019577026,0.36348453164100647,0.08574680238962173,0.2526790499687195,-0.2974173426628113,-0.23153997957706451,-0.018923329189419746,0.19097408652305603}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.11611499637365341,0.09940445423126221,-0.08307221531867981,-0.06434711813926697,-0.16988076269626617,-0.27016475796699524,0.4861835539340973,-0.22740985453128815,-0.3291584253311157,-0.1221722811460495,0.020998170599341393,-0.22799283266067505,-0.10305400937795639,0.1991281509399414,-0.11846072971820831,0.11680515855550766},{-0.20669366419315338,0.1681339591741562,0.2099093347787857,-0.15211668610572815,-0.16052228212356567,-0.1354655772447586,-0.2670004963874817,0.3140173852443695,0.41180071234703064,-0.08064691722393036,0.18583203852176666,0.2904801666736603,0.23033984005451202,0.5337215065956116,-0.43733543157577515,-0.3603476285934448},{0.29248106479644775,0.20745976269245148,0.2744850814342499,-0.05545340105891228,-0.022485410794615746,-0.1676529049873352,0.0641300231218338,-0.34596899151802063,0.36497265100479126,0.2571016848087311,0.352826863527298,-0.2953495383262634,0.08910024166107178,-0.3331497013568878,-0.12794381380081177,0.2543707489967346},{-0.10093016177415848,0.05036458745598793,0.13084401190280914,0.20759005844593048,-0.2580283582210541,0.26249241828918457,0.038642384111881256,0.43257221579551697,-0.38156354427337646,0.007891139946877956,-0.20052799582481384,-0.03883320093154907,0.42919987440109253,0.12948404252529144,0.1318827122449875,0.3729039430618286},{-0.21548216044902802,0.2632583975791931,0.05673015117645264,0.5040260553359985,0.21554410457611084,0.3576184809207916,0.09622237086296082,-0.5045753717422485,-0.10412058234214783,-0.1336187720298767,0.13812018930912018,-0.0022865659557282925,0.25375792384147644,0.266616553068161,0.039843518286943436,0.09713337570428848},{0.053661007434129715,-0.007091576233506203,-0.26711589097976685,-0.32822397351264954,-0.3880162239074707,0.06163708493113518,0.08168213814496994,0.0917331799864769,0.04882196709513664,-0.36233463883399963,-0.3187040686607361,0.45738309621810913,0.11804023385047913,0.24483774602413177,0.24731352925300598,-0.3515671193599701},{-0.13463158905506134,0.20740482211112976,-0.12864230573177338,0.06404302269220352,0.01333194226026535,0.24904178082942963,-0.2832360863685608,0.20300211012363434,0.2595553696155548,0.5262417197227478,-0.18394964933395386,0.21769313514232635,-0.27296337485313416,0.2045905441045761,0.3199049234390259,0.10486892610788345},{0.075723797082901,-0.14934611320495605,-0.3462955355644226,0.4481799900531769,-0.35393035411834717,0.5335682034492493,-0.4113016128540039,0.2374889850616455,-0.2727715075016022,0.18946298956871033,-0.10971728712320328,-0.2796262502670288,-0.3581691086292267,0.3227633833885193,0.11120428144931793,0.28710198402404785},{0.2894188165664673,-0.09084781259298325,0.36888691782951355,-0.12549835443496704,0.38811609148979187,-0.30872678756713867,-0.24403004348278046,0.17861531674861908,0.19038620591163635,0.2480229139328003,0.19282183051109314,-0.38123205304145813,0.11830825358629227,0.17109312117099762,-0.06042195484042168,-0.29697129130363464},{0.03415580093860626,-0.26200759410858154,0.31598490476608276,0.3123142123222351,-0.09876976162195206,-0.12446342408657074,-0.2882469594478607,0.36444827914237976,-0.1946870982646942,0.13094425201416016,0.08720846474170685,-0.2746487259864807,-0.11453763395547867,-0.2836593985557556,-0.23106996715068817,0.0654749795794487},{0.36463475227355957,-0.16648392379283905,0.16570059955120087,-0.518938422203064,-0.3258317708969116,0.018905961886048317,-0.43915125727653503,0.3678666651248932,-0.08803924918174744,0.27459025382995605,0.26211848855018616,-0.21597042679786682,-0.19854716956615448,0.2782284915447235,0.31175652146339417,0.03413252905011177},{-0.37872087955474854,-0.10586538910865784,-0.03691437467932701,-0.09567613154649734,0.06970897316932678,-0.2727387547492981,-0.01348315179347992,0.3484274446964264,-0.0685114786028862,-0.2279321700334549,-0.36394497752189636,-0.2119016796350479,-0.13659954071044922,0.4724326431751251,0.001054920256137848,-0.08628328889608383},{0.25103098154067993,-0.3273617625236511,0.11165503412485123,0.10837572067975998,-0.2845747470855713,0.08631408214569092,-0.14569605886936188,0.27372103929519653,0.22983677685260773,0.0024413869250565767,-0.18931593000888824,-0.2155320942401886,0.15481163561344147,0.23206406831741333,-0.4384075701236725,0.3437860608100891},{-0.251471608877182,0.044726427644491196,0.25929880142211914,0.2935512959957123,-0.17863470315933228,-0.4687815010547638,-0.26283004879951477,-0.2934459447860718,0.0472395084798336,0.1285969614982605,-0.1829504519701004,0.23754867911338806,-0.011757590807974339,-0.06606181710958481,0.20368897914886475,0.14432139694690704},{-0.057273976504802704,-0.4541313350200653,-0.4016577899456024,0.39640647172927856,0.25968092679977417,0.02300391159951687,-0.20408254861831665,0.36542898416519165,0.45656028389930725,0.2990289628505707,-0.2380811870098114,0.05311410874128342,0.11189185827970505,0.044892922043800354,-0.26353996992111206,-0.3268919587135315},{-0.005515797063708305,0.3904655873775482,-0.14904356002807617,0.26356253027915955,0.055300481617450714,0.3389339745044708,0.4084532558917999,0.040725864470005035,0.28869935870170593,-0.1476697474718094,-0.3314836323261261,-0.04699290171265602,-0.11440838873386383,-0.1968958079814911,-0.4538499712944031,-0.2840494215488434}};
static const float actor_encoder_feed_forward_0_weight[20][20] = {{0.05912373587489128,0.07086634635925293,0.11613401770591736,0.3691309094429016,-0.2348141223192215,0.3493437170982361,-0.20350044965744019,0.12105759978294373,0.0002246681833639741,0.006851655431091785,0.11500433087348938,-0.021842602640390396,-0.019325166940689087,-0.2021663933992386,-0.31730183959007263,0.07812277227640152,-0.1739697903394699,-0.08655960112810135,0.038829606026411057,0.23243272304534912},{0.3468727469444275,0.12924595177173615,0.10640360414981842,0.3215316832065582,-0.18701955676078796,0.3786294460296631,0.24225354194641113,0.42360660433769226,-0.26861289143562317,-0.3060005009174347,-0.20195958018302917,0.06271667778491974,-0.0430133230984211,0.3090279996395111,-0.15751881897449493,-0.14421261847019196,-0.02459779940545559,0.3204624056816101,-0.12490151822566986,0.15727603435516357},{0.17460380494594574,0.10950980335474014,0.11608284711837769,0.13772451877593994,0.05295771360397339,0.07433106750249863,0.10199037194252014,-0.1860116571187973,0.42600446939468384,0.0017456493806093931,-0.32399654388427734,-0.22078734636306763,0.21176019310951233,0.0683506652712822,0.1572752147912979,-0.472626268863678,0.22694438695907593,0.3847063183784485,0.013316319324076176,-0.25188812613487244},{0.09492847323417664,-0.11001603305339813,-0.08922592550516129,-0.3993878662586212,-0.2727417051792145,-0.38227489590644836,-0.08309145271778107,-0.21070416271686554,-0.16940337419509888,0.24175235629081726,-0.00033193969284184277,0.030230257660150528,0.09161695837974548,-0.29058870673179626,-0.03148500993847847,0.30967962741851807,-0.3413849472999573,0.0431172251701355,0.38276535272598267,-0.3063267469406128},{0.2769203782081604,0.278658390045166,-0.22726362943649292,-0.218847393989563,0.1835455298423767,0.03921951353549957,0.2842212915420532,-0.04362228885293007,0.07935184240341187,0.35277286171913147,0.2635279595851898,-0.038839735090732574,-0.15820105373859406,-0.06390319019556046,-0.43046391010284424,0.07738491892814636,0.10035449266433716,-0.14586377143859863,0.29565468430519104,0.19721566140651703},{-0.20214679837226868,-0.09272291511297226,-0.07332803308963776,0.2386680394411087,-0.3678587079048157,-0.021901872009038925,0.039890263229608536,-0.10129968076944351,-0.29785510897636414,-0.35246339440345764,-0.21730785071849823,0.39078038930892944,0.12152545899152756,-0.2896171808242798,0.03648130223155022,-0.16219717264175415,0.3677617013454437,-0.0007041332428343594,-0.05738642066717148,-0.11543379724025726},{0.46697959303855896,-0.3237394392490387,0.20592767000198364,0.24343182146549225,0.3693561851978302,0.2590421736240387,-0.23622457683086395,-0.3550069034099579,-0.10500549525022507,0.06618630141019821,-0.042798954993486404,0.2092401087284088,0.034746117889881134,-0.11200059205293655,-0.34025394916534424,-0.24621278047561646,0.08832869678735733,0.11116846650838852,-0.3932110369205475,0.08295191824436188},{0.03490350767970085,-0.21312080323696136,0.5310300588607788,0.5053796768188477,0.3114112913608551,-0.2756960988044739,-0.12959817051887512,0.15284226834774017,0.09519276767969131,0.0028780135326087475,-0.4391750991344452,0.3466463088989258,0.06917280703783035,-0.09297971427440643,-0.019300052896142006,-0.03751976415514946,0.21546413004398346,0.2386053204536438,-0.09747610986232758,-0.1985601782798767},{-0.19957369565963745,-0.03592293709516525,-0.03269756957888603,-0.0567878782749176,-0.3279547393321991,0.3910926282405853,-0.25760576128959656,0.1197592169046402,0.45676666498184204,0.10090719908475876,-0.3115029036998749,0.30328649282455444,-0.059498224407434464,0.1186847910284996,-0.1529497504234314,-0.4641455411911011,0.1401791274547577,-0.42549416422843933,-0.15103843808174133,-0.20473864674568176},{-0.49395322799682617,0.20201478898525238,0.15837717056274414,-0.21010512113571167,0.21079058945178986,0.3784838616847992,-0.08229295164346695,0.2795082628726959,0.3145716190338135,-0.020043635740876198,-0.04751640930771828,0.08861915022134781,0.07525089383125305,-0.4540851414203644,-0.2886313498020172,-0.060089111328125,0.3472326099872589,0.323245644569397,0.43582525849342346,0.41372647881507874},{0.13156118988990784,0.0008902522386051714,-0.016406618058681488,0.47154906392097473,0.3703456521034241,0.14015522599220276,0.45083028078079224,-0.29634249210357666,0.004919299390166998,0.034582093358039856,-0.2642443776130676,-0.2362690567970276,0.23880815505981445,-0.3600810766220093,-0.23412974178791046,-0.02584145776927471,0.08455713838338852,0.06354641914367676,-0.14450258016586304,0.03754975646734238},{-0.11370092630386353,-0.24806666374206543,0.027729086577892303,0.11762755364179611,-0.33935993909835815,-0.009664398618042469,-0.3071983754634857,-0.1233740970492363,0.37635502219200134,0.2878183424472809,-0.0210830457508564,-0.17772559821605682,-0.06046244874596596,0.15757408738136292,-0.21377332508563995,0.28264597058296204,-0.30634447932243347,0.06733426451683044,0.08722731471061707,0.3290332555770874},{0.018940690904855728,-0.31610822677612305,-0.0072189681231975555,-0.035920608788728714,-0.055348485708236694,-0.22910334169864655,0.4282854497432709,-0.2355959415435791,-0.22588329017162323,0.058100465685129166,0.11728702485561371,-0.28732743859291077,0.05366484075784683,-0.19277235865592957,-0.29504960775375366,-0.45923081040382385,0.3571299910545349,0.24869118630886078,0.34328731894493103,-0.06526690721511841},{0.25387224555015564,0.39625734090805054,0.22004170715808868,-0.09301863610744476,-0.0788600742816925,0.007543907035142183,0.42993658781051636,0.10459403693675995,0.2373639941215515,-0.3579712212085724,0.10224101692438126,-0.10857811570167542,-0.3002341091632843,0.07769825309515,-0.19791381061077118,-0.038293417543172836,-0.12683294713497162,0.4102804660797119,0.08480510115623474,-0.24590496718883514},{-0.3611777424812317,0.13512320816516876,0.2408273071050644,0.1806451380252838,0.21294347941875458,0.12842877209186554,0.24303773045539856,0.0736594945192337,0.10500751435756683,0.1412982940673828,-0.1842086911201477,0.12489380687475204,-0.04832088202238083,-0.04235807806253433,0.039899058640003204,0.21941685676574707,-0.3535563051700592,-0.2770017683506012,0.2918083071708679,-0.3465407192707062},{-0.15292416512966156,0.2891540825366974,-0.2578553557395935,0.10769061744213104,0.10277000814676285,0.15171967446804047,0.4093283712863922,-0.04053737595677376,0.24811653792858124,-0.06270109117031097,0.07423003017902374,0.0418308824300766,-0.18779407441616058,0.3343186676502228,0.07849527150392532,-0.10268715769052505,-0.3020985722541809,0.2709488272666931,-0.0005257147713564336,-0.22440031170845032},{0.31199970841407776,-0.24984769523143768,0.2851490378379822,-0.16883890330791473,0.31592103838920593,0.26830625534057617,-0.15225769579410553,-0.15749578177928925,-0.19984443485736847,-0.024696731939911842,0.12846484780311584,0.2287731021642685,0.1706748902797699,0.005653339438140392,0.3418126106262207,-0.1645289957523346,0.002287341747432947,0.08320844918489456,-0.2290595918893814,0.15947681665420532},{0.18347984552383423,0.20258305966854095,0.0959474965929985,0.48673850297927856,-0.2748788595199585,0.04640943929553032,0.4699801802635193,-0.08389537036418915,0.017054373398423195,-0.13320215046405792,0.07753375172615051,-0.316023051738739,-0.14572933316230774,0.1252058744430542,0.3141151964664459,0.29638221859931946,0.2258376181125641,-0.12189557403326035,-0.23280394077301025,0.02404673770070076},{0.09221912175416946,0.22549283504486084,0.1349574774503708,-0.07750172913074493,0.009804404340684414,-0.3026776611804962,0.13297489285469055,0.30523526668548584,0.1471136063337326,-0.21545936167240143,0.15674936771392822,-0.05528739467263222,0.10109221190214157,-0.25144249200820923,-0.25710925459861755,0.3256226181983948,-0.19375309348106384,0.263849675655365,-0.1507391482591629,-0.044497258961200714},{0.22793026268482208,0.013209439814090729,-0.28060638904571533,0.07582704722881317,0.4570219814777374,0.20403988659381866,-0.08079478144645691,-0.10301239043474197,-0.135895773768425,-0.0071288528852164745,-0.19417741894721985,-0.15336976945400238,0.1792895346879959,0.2411947101354599,-0.1667635440826416,0.03208708390593529,0.30818742513656616,-0.30101096630096436,-0.3163706362247467,0.21766819059848785}};
static const float action_parameterization_distribution_linear_weight[20][4] = {{-0.1491168737411499,-0.17366543412208557,-0.3153279721736908,-0.29824545979499817},{-0.13453646004199982,-0.14532050490379333,0.31187573075294495,-0.020337482914328575},{0.1297505497932434,0.22934547066688538,0.06937883794307709,-0.05777392163872719},{0.23085562884807587,0.17369712889194489,0.31699827313423157,0.29369136691093445},{0.16981108486652374,0.21669615805149078,-0.31546398997306824,0.289822518825531},{0.164980947971344,-0.026624444872140884,-0.02982511557638645,0.24295197427272797},{-0.3508361279964447,-0.045703813433647156,-0.17624486982822418,0.297863245010376},{0.3272252678871155,-0.19374926388263702,-0.2838684618473053,0.4858875274658203},{-0.23786702752113342,0.5552036166191101,-0.2759746313095093,0.44297659397125244},{-0.07303031533956528,0.04673663526773453,-0.2404049187898636,-0.1626991480588913},{0.22126822173595428,-0.2892600893974304,-0.39936086535453796,0.08894484490156174},{0.5116240978240967,0.31994473934173584,-0.08504702150821686,-0.18007822334766388},{-0.03869392350316048,-0.1774374544620514,0.18774065375328064,0.1431136578321457},{0.18009206652641296,0.3029135763645172,-0.19393214583396912,-0.22035254538059235},{0.3225063383579254,-0.14285486936569214,-0.3990686535835266,0.14338479936122894},{0.06316307932138443,-0.5358362793922424,0.26206275820732117,0.056268688291311264},{0.13672520220279694,0.24445390701293945,0.2278074473142624,-0.0014867486897855997},{0.3358166217803955,-0.2627001404762268,0.2461463063955307,0.22563177347183228},{-0.1391426920890808,0.03207068517804146,-0.2636658847332001,0.0887720137834549},{0.2834584414958954,0.25313395261764526,-0.3297991454601288,0.3363853991031647}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11278261244297028,-0.046458613127470016,-0.007207110524177551,-0.12580348551273346,-0.02064494602382183,-0.08056855201721191,0.2827323079109192,0.09698622673749924,-0.1017671674489975,-0.18986032903194427,-0.06547173112630844,-0.04999486729502678,0.0033164285123348236,-0.015249708667397499,0.2411293387413025,0.09288974106311798};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.12972895801067352,-0.04374939575791359,-0.032631244510412216,0.004366111010313034,-0.021770281717181206,0.07928942888975143,-0.05576832965016365,-0.02164415828883648,0.21331463754177094,0.1877707839012146,-0.04033467546105385,0.14434318244457245,-0.06530335545539856,-0.09290624409914017,0.06927749514579773,-0.054366741329431534};
static const float actor_encoder_feed_forward_0_bias[20] = {-0.16974502801895142,0.02353360690176487,0.0315382219851017,-0.037279434502124786,-0.11180240660905838,0.007623561192303896,-0.10826403647661209,-0.05668303743004799,0.03256874531507492,-0.00030811087344773114,0.006504739169031382,0.047969527542591095,0.02670273371040821,-0.11149362474679947,-0.0343128927052021,0.05403682962059975,0.0636809840798378,0.027540240436792374,0.03718098625540733,-0.012235501781105995};
static const float action_parameterization_distribution_linear_bias[4] = {0.022288329899311066,0.015756797045469284,0.06820076704025269,0.005781287793070078};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{-0.005631987005472183,0.16306854784488678,0.5242719054222107,-0.4470286965370178},{0.14519384503364563,0.16283473372459412,-0.12753425538539886,0.34251081943511963},{-0.23693151772022247,-0.22384101152420044,0.3458939790725708,-0.3970233201980591},{0.4117121994495392,0.06483138352632523,-0.2126428186893463,-0.4194035530090332},{0.28732001781463623,-0.042433060705661774,-0.20492805540561676,-0.38861986994743347},{0.03259478509426117,-0.3056543171405792,-0.10408204793930054,-0.20654244720935822},{0.03839530795812607,-0.13676123321056366,-0.17136706411838531,0.09536614269018173},{-0.1762886345386505,-0.6749817728996277,-0.24362017214298248,-0.2012513130903244},{-0.20466382801532745,-0.19424903392791748,-0.463582843542099,-0.2773279547691345},{0.21314702928066254,-0.22567149996757507,0.19983163475990295,0.3283546268939972},{-0.48626792430877686,-0.5138155817985535,0.20562167465686798,0.2367144376039505},{-0.2834566831588745,0.35764068365097046,0.15241442620754242,-0.15151290595531464},{-0.11909447610378265,0.06252821534872055,0.1217338815331459,0.170771986246109},{-0.48984962701797485,0.2995685338973999,0.39614805579185486,0.20991775393486023},{0.08645119518041611,0.44462841749191284,-0.03662927448749542,0.38093721866607666},{0.18738806247711182,-0.07589564472436905,0.48940426111221313,-0.271923303604126}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.5019800662994385,-0.0709710344672203,-0.5411279201507568,0.5735626816749573},{-0.4453951418399811,0.6757922172546387,0.07057582587003708,0.7085214853286743},{-0.7291918396949768,0.2755395472049713,0.13093362748622894,0.12606388330459595},{0.6788257956504822,0.41313600540161133,0.5624974966049194,0.5055906772613525}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {-0.06676971912384033,-0.19618627429008484,0.030047008767724037,-0.0357581190764904};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.06477620452642441,-0.03426869586110115,0.04999731853604317,0.0743708536028862};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }
    
    void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

