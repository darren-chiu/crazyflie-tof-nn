
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.047875337302684784,-0.10438375920057297,-0.10827011615037918,-0.009793623350560665,0.14613373577594757,0.435085266828537,-0.09675581753253937,0.47028905153274536,-0.2709341049194336,-0.07864032685756683,-0.07240238785743713,-0.5374335646629333,-0.09820828586816788,0.21058543026447296,0.018721994012594223,-0.04639749228954315},{0.19740977883338928,0.024317869916558266,0.2508835196495056,-0.274433434009552,0.034845080226659775,-0.5378361344337463,0.39159560203552246,0.1920183002948761,0.07284843921661377,-0.03158799931406975,0.1542731672525406,0.12673915922641754,0.02056780643761158,0.15736620128154755,-0.08924990147352219,-0.010464629158377647},{-0.16755643486976624,-0.09869678318500519,0.04245738312602043,0.26003319025039673,0.5317003130912781,-0.016009844839572906,0.021141832694411278,0.05251025781035423,-0.017838280647993088,-0.3779444992542267,-0.3441886901855469,0.012760024517774582,0.16504502296447754,-0.5387813448905945,-0.3238213062286377,0.4326472580432892},{-0.1401890069246292,0.11461490392684937,-0.2844371497631073,0.2069762796163559,0.1741720587015152,-0.017736587673425674,0.2864215672016144,0.010263482108712196,0.3358655571937561,0.19992108643054962,0.37010839581489563,0.04628146067261696,0.26060301065444946,-0.01721924915909767,0.2807115912437439,-0.23117484152317047},{0.3630425035953522,0.10170005261898041,-0.23195567727088928,-0.10538391023874283,0.12319887429475784,0.15538014471530914,-0.1473814845085144,0.06579404324293137,-0.11262841522693634,-0.41463571786880493,-0.010361784137785435,0.4399453401565552,0.28630566596984863,0.1345338672399521,-0.0436590276658535,0.1958208680152893},{-0.3273766040802002,0.1153310090303421,0.10361959785223007,0.13869121670722961,0.23315617442131042,0.15853095054626465,-0.21196430921554565,-0.2779792249202728,-0.2909650206565857,-0.1586218774318695,0.03222983703017235,-0.14477592706680298,0.1762445569038391,-0.2451450377702713,-0.3707685172557831,-0.13933053612709045},{0.6502841711044312,-0.21731682121753693,-0.2182302325963974,-0.016045983880758286,-0.03647551313042641,-0.13381342589855194,-0.5101041793823242,0.21676039695739746,-0.4715867042541504,-0.05933385342359543,0.10094501078128815,-0.09538447111845016,0.19241751730442047,0.19314678013324738,-0.39654240012168884,-0.6516063809394836},{0.4423292279243469,-0.21799352765083313,-0.04069921374320984,-0.04339251667261124,-0.2643565535545349,-0.2742590308189392,0.3712609112262726,0.4204818308353424,0.2252805382013321,0.20466546714305878,-0.06787517666816711,-0.09847784042358398,0.0669032484292984,0.32911086082458496,-0.47640305757522583,-0.1302192658185959},{-0.24814845621585846,0.1227809265255928,0.09126481413841248,0.026176398620009422,0.5480977296829224,0.45296335220336914,-0.3229208290576935,0.33836817741394043,0.11214525997638702,-0.144123837351799,0.6330897212028503,0.1093747690320015,-0.11665085703134537,0.23123541474342346,0.517374575138092,-0.2543596625328064},{0.16679540276527405,-0.2586769461631775,0.35036584734916687,0.6091718077659607,-0.1374024897813797,0.06490715593099594,0.14558148384094238,-0.19286872446537018,-0.12614808976650238,-0.047200072556734085,-0.03839120641350746,-0.0004468796250876039,0.3946223556995392,-0.25625795125961304,-0.026220178231596947,0.48459360003471375},{0.7603395581245422,-0.4070131778717041,-0.20795223116874695,0.21629928052425385,0.44687628746032715,0.17979395389556885,-0.32877734303474426,-0.609378457069397,-0.05603057146072388,0.013745388947427273,-0.5670228600502014,0.15560965240001678,0.0033288265112787485,-0.494240403175354,-0.1345445215702057,-0.5329419374465942},{0.34968382120132446,0.6115901470184326,0.2981555461883545,0.015448413789272308,0.09265666455030441,0.016866866499185562,0.6873124837875366,0.01993781514465809,-0.5150942802429199,-0.4285852313041687,-0.29768404364585876,0.2598889470100403,0.16732552647590637,0.27303367853164673,0.013347913511097431,0.3381970524787903},{0.2532583177089691,0.11490534245967865,0.369437575340271,0.09409655630588531,-0.12710925936698914,-0.018314294517040253,0.2203214168548584,0.6077552437782288,-0.16409249603748322,-0.07089856266975403,-0.24426333606243134,0.11853118985891342,0.3877326548099518,0.2843295633792877,-0.24626490473747253,0.45824769139289856},{0.27110230922698975,-0.13817745447158813,-0.05350915342569351,0.47306880354881287,-0.4440616965293884,-0.26128092408180237,-0.31604480743408203,-0.42322778701782227,-0.0733075737953186,-0.2598097622394562,-0.428725928068161,-0.43443554639816284,0.2468513548374176,-0.2943066358566284,-0.6181581020355225,-0.016378946602344513},{-0.18672776222229004,0.0471220389008522,0.10005981475114822,-0.3094605505466461,0.007694631814956665,0.08367476612329483,0.17887207865715027,-0.3632257282733917,-0.35572198033332825,0.3608088493347168,-0.30844607949256897,0.3534323275089264,-0.10029221326112747,-0.34037545323371887,-0.38594934344291687,-0.1471443772315979},{0.07338864356279373,-0.08898955583572388,0.29350101947784424,0.12774929404258728,-0.16433967649936676,0.10994084924459457,-0.059305135160684586,-0.04810771718621254,-0.18444953858852386,-0.05529969185590744,-0.16700702905654907,0.12762324512004852,-0.0655963122844696,-0.13748227059841156,-0.15465335547924042,0.22655600309371948},{-0.16026192903518677,-0.12523718178272247,-0.10415063798427582,-0.15194986760616302,0.022290542721748352,-0.14879275858402252,-0.3395039439201355,0.03239290788769722,0.2606630027294159,0.08062945306301117,-0.033666159957647324,0.13907594978809357,-0.1822056621313095,-0.12436416000127792,0.0017874904442578554,0.12149228155612946},{0.2640499472618103,-0.13335368037223816,-0.047236744314432144,-0.10184630751609802,-0.10716119408607483,0.012790963985025883,0.025834374129772186,-0.33709946274757385,-0.042617861181497574,-0.04889215901494026,0.04303792864084244,-0.5168377757072449,0.1871303766965866,0.30625540018081665,-0.053971510380506516,-0.38427090644836426}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.21716643869876862,0.5799804925918579,-0.22771859169006348,0.20434343814849854,-0.39552778005599976,0.6602277159690857,0.06423178315162659,0.07987313717603683,-0.23377454280853271,0.4867626428604126,0.009857912547886372,-0.07949262112379074,0.1571216881275177,0.2691909074783325,0.12655971944332123,0.11936790496110916},{-0.4365570545196533,-0.08237533271312714,0.25781551003456116,-0.15880657732486725,-0.2995457649230957,-0.1759408563375473,0.36312049627304077,0.45303529500961304,-0.15754319727420807,-0.21047821640968323,-0.13342270255088806,-0.09453324228525162,-0.15336880087852478,0.022457152605056763,-0.35800522565841675,-0.5215316414833069},{0.3812044560909271,-0.31327348947525024,0.16150310635566711,0.185503751039505,-0.2286888062953949,-0.06673233956098557,-0.15762321650981903,0.15765856206417084,0.31773972511291504,-0.12183523178100586,-0.1679219901561737,-0.20490646362304688,0.07822810858488083,0.33375290036201477,-0.17301595211029053,-0.25046512484550476},{-0.0865701213479042,-0.0809553787112236,-0.01598643697798252,-0.3769707977771759,-0.041899118572473526,0.036894697695970535,0.029822738841176033,0.010269293561577797,0.10739878565073013,0.1878090649843216,-0.30612578988075256,-0.10528749972581863,-0.07117845863103867,0.016081001609563828,-0.004233925603330135,-0.12217456847429276},{0.10719407349824905,0.0008065162692219019,-0.5433523654937744,0.1435084342956543,0.14865514636039734,0.1769321858882904,0.24525508284568787,0.5802861452102661,0.08147339522838593,0.19343607127666473,-0.0806983932852745,-0.46759259700775146,-0.10428154468536377,-0.254602313041687,0.2505793869495392,0.506044864654541},{-0.2616560757160187,0.21831399202346802,-0.41847753524780273,-0.1299348622560501,0.1355939358472824,0.2521882951259613,-0.07128646969795227,-0.345790296792984,-0.1572679877281189,0.16641029715538025,-0.09836890548467636,0.03198720142245293,-0.1224723681807518,-0.3696785867214203,0.03959989175200462,-0.0750420093536377},{-0.22574709355831146,-0.3667779862880707,-0.07308410108089447,0.1857706606388092,-0.13132543861865997,-0.04307066276669502,0.26224038004875183,0.2001439929008484,0.3631376028060913,-0.13190144300460815,-0.35404741764068604,0.38041481375694275,-0.24897384643554688,0.013908949680626392,0.2533109784126282,-0.22086654603481293},{0.0692499503493309,0.2398134022951126,0.24489308893680573,-0.1847916543483734,-0.041056279093027115,-0.0034256582148373127,0.10333917289972305,0.23385001718997955,-0.13358575105667114,-0.3595723807811737,-0.29647234082221985,0.42876964807510376,-0.3401733636856079,-0.056475017219781876,-0.046781498938798904,-0.4221814274787903},{0.29330965876579285,-0.3299277126789093,-0.2737695276737213,0.1788976788520813,-0.27609527111053467,0.177790567278862,-0.43062642216682434,-0.17595449090003967,0.2932754456996918,0.26641252636909485,-0.31643974781036377,-0.11570319533348083,0.16999590396881104,-0.2386404424905777,-0.30148157477378845,0.15710151195526123},{-0.15947657823562622,0.3931103050708771,0.13437646627426147,0.21000204980373383,0.2364090532064438,0.22365978360176086,-0.4350332021713257,-0.3745650351047516,-0.049617648124694824,-0.3603501617908478,-0.20681853592395782,0.14180566370487213,-0.13362255692481995,-0.11769800633192062,-0.17599207162857056,-0.15754520893096924},{0.03156714141368866,0.39281484484672546,-0.2854114770889282,0.1525963544845581,-0.3472732603549957,-0.05751969665288925,-0.4130282700061798,0.16750159859657288,0.19450996816158295,-0.414612352848053,-0.21905510127544403,-0.45538952946662903,-0.10739048570394516,0.07136723399162292,-0.42840200662612915,0.03853636980056763},{0.19031941890716553,0.04403720051050186,0.323086142539978,-0.11856885999441147,-0.3080542981624603,0.3343135118484497,0.15533721446990967,-0.08483776450157166,0.15090806782245636,-0.10442303121089935,-0.036821238696575165,0.3927135467529297,0.27145814895629883,-0.28201568126678467,0.0046458011493086815,0.03063175454735756},{0.347329705953598,-0.00906496960669756,-0.04208981990814209,0.10515565425157547,-0.12666641175746918,0.23395873606204987,0.24840892851352692,-0.051408760249614716,-0.3975392282009125,0.12104207277297974,0.2103913277387619,-0.4688962996006012,-0.16332975029945374,0.06430274248123169,0.264780730009079,0.11499657481908798},{-0.07318267971277237,0.26767846941947937,0.048176124691963196,-0.12256979197263718,0.09498585760593414,-0.1484110802412033,-0.1324637532234192,-0.038062531501054764,-0.24747933447360992,0.059126075357198715,-0.3460262715816498,-0.229728102684021,-0.0807352140545845,0.3620801270008087,-0.21192865073680878,0.12841008603572845},{0.38063544034957886,-0.07412648946046829,-0.45481011271476746,0.1111927479505539,0.08462385833263397,-0.05028555542230606,0.28312718868255615,-0.33046096563339233,-0.44251057505607605,0.09538847208023071,-0.10290104150772095,-0.3940090239048004,-0.3964588940143585,0.1544942557811737,-0.47452670335769653,-0.06540577858686447},{0.07751603424549103,-0.4704926908016205,-0.3679172694683075,-0.27301621437072754,-0.06178775057196617,-0.30225053429603577,0.02408418618142605,0.3439464271068573,0.35556522011756897,-0.18341588973999023,-0.0697961300611496,-0.31469178199768066,-0.35303643345832825,0.4575444459915161,-0.3132607042789459,0.08222270756959915}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.15164051949977875,-0.43311604857444763,0.18026885390281677,-0.3367150127887726,-0.27181172370910645,0.3134724199771881,0.2980399429798126,-0.18994231522083282,0.26122915744781494,0.10960286110639572,0.04828745499253273,0.35520076751708984,-0.2503953278064728,-0.017548635601997375,-0.06952664256095886,0.2543941140174866,-0.19070982933044434,0.03105916455388069,0.3103407323360443,-0.039716243743896484,0.2701713740825653,0.30932703614234924,0.19429297745227814,0.23454736173152924},{0.13500383496284485,-0.06323421001434326,-0.24154244363307953,-0.07301212847232819,-0.07924337685108185,0.13802273571491241,-0.01919371820986271,0.049519628286361694,-0.31635069847106934,-0.014669287949800491,-0.455668181180954,0.017959168180823326,0.3697572946548462,-0.2669619917869568,-0.1463014930486679,0.2305312156677246,-0.18331776559352875,0.008307380601763725,-0.06406445801258087,-0.19303026795387268,0.3888259530067444,0.03999616950750351,-0.2812633216381073,0.1627887636423111},{-0.11336324363946915,0.012896559201180935,0.13887140154838562,-0.28090694546699524,0.2957569360733032,0.1981930434703827,-0.06786640733480453,0.3619697391986847,-0.37331458926200867,0.24027161300182343,-0.21364594995975494,-0.2169739156961441,-0.27712711691856384,0.0920504480600357,0.382421612739563,0.2385975420475006,0.019057752564549446,0.19437280297279358,0.07807884365320206,0.013793031685054302,0.26448532938957214,-0.2544322907924652,-0.11590789258480072,0.04415106400847435},{0.08908598124980927,-0.2614066004753113,0.13401344418525696,-0.02233126573264599,0.00783045869320631,0.380845308303833,0.10366563498973846,-0.21305020153522491,-0.3251814842224121,-0.20977509021759033,-0.3380834758281708,0.2407202124595642,0.10835199803113937,-0.16781143844127655,0.30848196148872375,-0.38875192403793335,-0.17832012474536896,-0.12828215956687927,-0.2585563659667969,-0.126169353723526,-0.0118801174685359,-0.32661518454551697,-0.35766154527664185,0.11740099638700485},{-0.2232522815465927,-0.34743836522102356,0.24596109986305237,0.05816950649023056,0.09837876260280609,-0.35320577025413513,0.06620368361473083,-0.3274952471256256,0.0422687791287899,0.22311526536941528,-0.18955084681510925,0.24493791162967682,0.21808259189128876,0.27452224493026733,0.1829727441072464,-0.18129394948482513,-0.12958215177059174,0.09782947599887848,0.026572437956929207,0.2143075168132782,0.09694664180278778,-0.4431779086589813,-0.34237977862358093,-0.27938711643218994},{0.12261828035116196,0.33413001894950867,-0.33309412002563477,-0.053316403180360794,-0.11443427950143814,0.34497642517089844,-0.15375109016895294,-0.11766119301319122,-0.17970041930675507,-0.06795178353786469,0.06997040659189224,-0.11500749737024307,-0.007007737178355455,0.19482380151748657,0.3810015618801117,-0.3984937369823456,0.0691450759768486,0.13076120615005493,-0.4161440134048462,0.009846632368862629,-0.13511058688163757,0.03206988051533699,0.14168110489845276,-0.059252407401800156},{0.11011295020580292,-0.0208445992320776,0.3983503580093384,0.300693154335022,0.33693718910217285,0.13878914713859558,-0.23018395900726318,0.28869739174842834,-0.13663911819458008,-0.24543605744838715,-0.15763217210769653,0.2766810655593872,-0.2625661790370941,0.22249126434326172,0.16399382054805756,-0.2159539759159088,0.04879555478692055,-0.0747845396399498,0.1694737821817398,-0.14965537190437317,-0.054672494530677795,0.2063186764717102,-0.1159759908914566,-0.0574151836335659},{-0.03322726488113403,-0.34029772877693176,0.07573041319847107,0.0431252159178257,0.03748319298028946,0.41235417127609253,-0.32496246695518494,-0.38858020305633545,0.3354053795337677,-0.023102257400751114,0.24860504269599915,0.3529309630393982,-0.5084328055381775,-0.06566188484430313,-0.24645495414733887,-0.3742963671684265,-0.2890784740447998,-0.2115880697965622,-0.13949288427829742,0.10474322736263275,0.1994166076183319,0.3684861660003662,-0.27501851320266724,0.057771485298871994},{0.20321714878082275,-0.1959860920906067,0.2218288630247116,-0.13886156678199768,0.139271542429924,0.35799193382263184,0.07536636292934418,-0.21439991891384125,-0.17500700056552887,0.15097194910049438,0.33972689509391785,0.10363131761550903,-0.02643325738608837,0.2679714262485504,-0.24984058737754822,0.24307730793952942,0.05256963521242142,0.1006787121295929,-0.06159409135580063,0.1357146054506302,0.11430805176496506,0.04361303523182869,0.015893643721938133,-0.18592071533203125},{-0.20730739831924438,-0.07492263615131378,-0.3463863134384155,-0.4087194800376892,-0.04204050451517105,-0.2757270038127899,-0.05160706862807274,0.2819605767726898,-0.20363187789916992,0.03153630718588829,0.14840616285800934,0.14609898626804352,-0.0258246548473835,-0.21184402704238892,0.08110444992780685,0.15702813863754272,0.0012587743112817407,-0.17753447592258453,0.11430321633815765,-0.3296706974506378,-0.2851426899433136,0.24326904118061066,-0.31968414783477783,0.016420412808656693},{0.054248202592134476,-0.2843524217605591,-0.18576295673847198,0.19283980131149292,0.05915198102593422,0.0784914419054985,-0.14477495849132538,-0.2875140905380249,-0.056051936000585556,-0.08126953989267349,0.3518522083759308,-0.26024213433265686,-0.08683348447084427,-0.20289282500743866,-0.44390130043029785,0.14563511312007904,0.004182480275630951,-0.05307652801275253,-0.1830320954322815,-0.046517278999090195,-0.17476913332939148,0.2726122736930847,-0.05641636997461319,-0.08806367963552475},{0.18609237670898438,-0.18406905233860016,-0.1752362698316574,-0.26830625534057617,0.11546909809112549,0.3088778853416443,0.28955110907554626,0.3045916259288788,-0.26956993341445923,-0.18573898077011108,0.22834092378616333,-0.20511281490325928,0.05416901409626007,-0.049334391951560974,0.24476315081119537,-0.08368624746799469,0.10039187967777252,0.22395960986614227,0.22029012441635132,-0.023647593334317207,-0.3195153474807739,-0.35965850949287415,0.2662675678730011,0.25136783719062805},{0.026262730360031128,0.07459470629692078,0.23831228911876678,0.2554980218410492,0.3147556781768799,-0.200465127825737,0.018249284476041794,-0.18547923862934113,-0.2587895095348358,-0.2854038178920746,-0.04174592345952988,-0.00367396860383451,-0.13347028195858002,-0.1680491715669632,0.11946363747119904,0.25309738516807556,-0.08661467581987381,0.006958292797207832,-0.23240350186824799,-0.3132353127002716,0.1482863426208496,-0.21946747601032257,-0.16873055696487427,-0.2915152311325073},{0.16916558146476746,-0.11633483320474625,-0.2579568028450012,0.008066256530582905,0.21118369698524475,0.1092732772231102,0.2618953585624695,-0.06615092605352402,0.19038908183574677,0.42870181798934937,-0.08416048437356949,0.050395917147397995,0.33326008915901184,-0.3766593039035797,0.18016132712364197,0.05411148443818092,0.1881600320339203,-0.2501492500305176,0.3507298231124878,-0.03746204823255539,-0.18049897253513336,0.10881383717060089,0.32568302750587463,-0.08064256608486176},{-0.05482098087668419,0.32495129108428955,0.2576957046985626,0.22735750675201416,0.05703612416982651,-0.2397173047065735,0.31781116127967834,0.04048139974474907,-0.04484570026397705,-0.2102268636226654,0.30751439929008484,-0.047918956726789474,-0.09747207164764404,0.14192768931388855,-0.33568301796913147,-0.04556571692228317,-0.29728901386260986,-0.19516941905021667,-0.015426221303641796,-0.00257033109664917,-0.232095405459404,0.22732606530189514,0.05319368094205856,0.21079613268375397},{-0.17812299728393555,-0.46648362278938293,0.060353491455316544,-0.3247378170490265,0.1201736330986023,-0.10372878611087799,0.03972669318318367,-0.13894756138324738,-0.2699184715747833,0.11992870271205902,0.10950315743684769,0.256344199180603,-0.13605175912380219,0.4080778658390045,0.12258601933717728,0.09494645148515701,-0.1407051533460617,-0.05341590568423271,-0.17642049491405487,-0.24245527386665344,-0.049959082156419754,-0.1602165549993515,-0.3847140669822693,-0.2894381284713745},{0.2805408537387848,-0.07969551533460617,0.21589595079421997,0.3614785373210907,-0.0018265224061906338,0.02647097036242485,0.015244935639202595,0.2701721787452698,0.21548837423324585,-0.10173249244689941,0.0015587233938276768,0.03511325642466545,-0.3465437591075897,-0.09124867618083954,-0.03338770195841789,0.311815470457077,0.31743955612182617,-0.11192234605550766,0.1927904337644577,0.05227706581354141,0.05655505135655403,0.012330282479524612,0.054752763360738754,-0.04004824534058571},{0.15921780467033386,0.09367496520280838,-0.011252551339566708,-0.3206825256347656,0.2464701235294342,0.1443786919116974,0.3144865930080414,0.34117114543914795,0.16264137625694275,-0.010698539204895496,0.29614078998565674,-0.33962956070899963,0.018549403175711632,0.021836785599589348,-0.15641270577907562,-0.23262733221054077,-0.22577358782291412,-0.0691148191690445,-0.34496867656707764,0.3504680395126343,0.06511832028627396,-0.39000266790390015,0.19588389992713928,0.19005903601646423},{0.14835010468959808,-0.12087374925613403,-0.05631696432828903,-0.23499223589897156,0.09772371500730515,-0.13795749843120575,-0.267783522605896,-0.1578758805990219,-0.3081474304199219,-0.36738625168800354,-0.28757187724113464,0.07349740713834763,-0.29545858502388,-0.22768449783325195,0.1966038942337036,0.36004090309143066,0.15658451616764069,-0.246652752161026,-0.24490690231323242,0.1783345639705658,0.3671683073043823,-0.018094027414917946,-0.11057710647583008,0.18338221311569214},{0.239946648478508,0.3770701289176941,-0.11538626253604889,0.22719022631645203,0.26534122228622437,-0.4013907313346863,-0.11430249363183975,0.24493016302585602,0.0680365338921547,-0.1542874127626419,0.31478554010391235,-0.05335640907287598,-0.005359537899494171,0.11207111179828644,0.026800476014614105,-0.004894850309938192,0.3124072253704071,0.24862125515937805,-0.2564171552658081,-0.19493556022644043,0.03508394584059715,0.04980907961726189,-0.01554059237241745,0.07858213037252426},{-0.1625714898109436,0.39705759286880493,-0.1452798992395401,0.037817783653736115,-0.04807545617222786,0.1529240608215332,0.02912629023194313,0.15582601726055145,0.069874107837677,0.2786526381969452,0.2166524976491928,-0.28805112838745117,-0.12165867537260056,0.13176241517066956,-0.1437067836523056,0.12656889855861664,-0.3302961587905884,0.17399638891220093,0.02544409967958927,0.3106447756290436,0.13530276715755463,-0.02546713687479496,0.01745465397834778,0.17754705250263214},{-0.07470404356718063,0.3627987504005432,0.3672490119934082,-0.21481505036354065,-0.3094225525856018,0.14114606380462646,0.01741623505949974,-0.02970966510474682,-0.33151841163635254,-0.32034340500831604,-0.27910158038139343,0.06329382210969925,0.1729491949081421,-0.01659955456852913,0.04186416044831276,-0.33701252937316895,-0.15239733457565308,0.09836550801992416,-0.03578418120741844,-0.18917520344257355,-0.03026343137025833,-0.14180028438568115,0.02390497364103794,-0.24504943192005157},{0.037345658987760544,-0.34108734130859375,-0.0023599860724061728,-0.10514603555202484,0.08407776802778244,0.030583500862121582,0.1392035335302353,-0.43098682165145874,-0.17773184180259705,0.2738873064517975,-0.28831833600997925,0.038185782730579376,-0.15561890602111816,0.2082284539937973,-0.26856186985969543,-0.012435652315616608,0.3729681074619293,0.21612966060638428,-0.27896466851234436,-0.02123812958598137,0.025586232542991638,0.013569788075983524,0.15885181725025177,0.21893715858459473},{0.2520037889480591,0.13327795267105103,-0.19837301969528198,-0.3316934406757355,0.13541088998317719,0.3224794566631317,0.19928602874279022,0.036281537264585495,-0.23710721731185913,-0.2845502197742462,0.26224759221076965,-0.1434045433998108,-0.10609032958745956,-0.3164433240890503,0.31837838888168335,-0.20129095017910004,-0.03365638852119446,0.04416380450129509,0.34400030970573425,0.15840286016464233,-0.00997206848114729,-0.08406462520360947,-0.3270423710346222,-0.017956361174583435}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.2851479649543762,0.41867658495903015,-0.3357715606689453,0.012440981343388557},{-0.19346687197685242,0.2115880250930786,0.1838071644306183,0.08388493955135345},{-0.3425705134868622,-0.02655528299510479,-0.3631931245326996,-0.10070916265249252},{-0.21008580923080444,0.047899965196847916,-0.04787413403391838,-0.18314461410045624},{0.2746955454349518,0.10612896829843521,-0.35237905383110046,-0.3410473167896271},{-0.04972630739212036,0.25164979696273804,0.049529269337654114,-0.04436030611395836},{0.438204288482666,-0.31439638137817383,-0.13970522582530975,0.3469087779521942},{-0.1791461557149887,0.14680832624435425,0.12690195441246033,-0.08860581368207932},{-0.40800049901008606,0.38834163546562195,0.1075851172208786,0.3163338303565979},{0.22118569910526276,0.4133560061454773,-0.3089689314365387,0.23229841887950897},{-0.1898764967918396,-0.06352298706769943,-0.18170590698719025,-0.2645280361175537},{-0.2687355577945709,-0.39570343494415283,-0.3004802167415619,0.17822590470314026},{0.3635185956954956,0.13890908658504486,0.3992609977722168,0.2986435294151306},{-0.029989035800099373,-0.36829760670661926,-0.2307620644569397,-0.2283201962709427},{-0.012201687321066856,0.3353765904903412,0.2562392055988312,-0.001297662267461419},{0.459968626499176,0.2602708041667938,0.11175963282585144,-0.09531735628843307},{0.3095439374446869,0.2075166255235672,-0.4204978048801422,0.037047579884529114},{-0.3091917037963867,0.05982578918337822,-0.29836249351501465,0.3495163321495056},{-0.3316480219364166,0.39687496423721313,-0.0988961011171341,-0.037219639867544174},{-0.2117817997932434,-0.11040769517421722,-0.4128872752189636,0.22910869121551514},{-0.35370126366615295,-0.269553005695343,0.2110186517238617,0.26718130707740784},{-0.3008967936038971,-0.2059280276298523,0.24595771729946136,-0.4922546148300171},{0.30261513590812683,0.3328004777431488,0.011159047484397888,0.17732642590999603},{-0.32773032784461975,-0.08738594502210617,0.14206969738006592,-0.020503956824541092}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.018292484804987907,0.09879358112812042,0.01991729810833931,-0.05969168618321419,-0.025804512202739716,-0.0023146229796111584,0.0916755348443985,-0.0008174263639375567,-0.13989505171775818,-0.002092077163979411,0.0491609126329422,0.06691336631774902,-0.031195763498544693,0.052789244800806046,-0.09244616329669952,-0.19652250409126282};
static const float actor_encoder_self_encoder_2_bias[16] = {0.001333004329353571,0.072129026055336,0.07763398438692093,0.045650944113731384,-0.02213563397526741,-0.03689294680953026,0.005103659816086292,0.01129727903753519,-0.0032475858461111784,-0.021441489458084106,-0.014228042215108871,0.041751086711883545,0.09966687858104706,-0.026622679084539413,0.016488997265696526,-0.12382045388221741};
static const float actor_encoder_feed_forward_0_bias[24] = {0.018404588103294373,0.1360330879688263,0.04888993874192238,0.023288395255804062,-0.01284030731767416,-0.0303129144012928,-0.018914859741926193,0.06022506579756737,-0.055845290422439575,-0.0149510707706213,0.007805237080901861,-0.03847552463412285,-0.06402796506881714,0.017115138471126556,0.016554856672883034,0.025648517534136772,-0.016480570659041405,0.00011690519022522494,-0.023313282057642937,-0.006477742921561003,0.036877162754535675,-0.03641057014465332,-0.02011587843298912,0.03866545483469963};
static const float action_parameterization_distribution_linear_bias[4] = {-0.020002808421850204,-0.007655323948711157,0.008913897909224033,-0.022561127319931984};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{0.09818127751350403,-0.5643115043640137,-0.34344419836997986,-0.09956920146942139,0.35903897881507874,-0.08764245361089706,0.35636207461357117,0.38415268063545227},{-0.29788529872894287,-0.33157432079315186,0.23552972078323364,-0.3279685378074646,0.2328588366508484,-0.15155118703842163,0.01917029544711113,0.14593303203582764},{-0.05380772054195404,0.1377161145210266,-0.37755951285362244,0.37550172209739685,0.4161495566368103,-0.2918355166912079,-0.5266376733779907,0.3601709306240082},{0.4747026562690735,-0.2586512565612793,0.2927802503108978,0.37313312292099,-0.0723927691578865,-0.3445029556751251,0.464586079120636,-0.3708288371562958},{-0.5403944253921509,0.44496214389801025,-0.07378466427326202,0.1287079155445099,0.21934200823307037,-0.1525418907403946,0.10947851091623306,-0.024916963651776314},{-0.5346723198890686,-0.36059367656707764,0.22335074841976166,0.4033689796924591,-0.03283938392996788,-0.4657899737358093,-0.14470036327838898,0.24702493846416473},{-0.6433766484260559,-0.3807202875614166,-0.07165815681219101,0.2621347904205322,-0.4536633789539337,-0.5352057218551636,-0.1433432698249817,-0.04520553722977638},{-0.06136450171470642,0.5815184712409973,0.24177730083465576,-0.4463307857513428,0.11716029793024063,-0.27754145860671997,0.5805687308311462,-0.04456254094839096},{-0.4936716556549072,-0.2683138847351074,0.0961531326174736,-0.07722891122102737,-0.36413630843162537,-0.23328092694282532,0.04802333191037178,0.19496719539165497},{-0.24758251011371613,0.5011862516403198,0.23710456490516663,-0.04478950425982475,-0.07941368222236633,-0.4284447431564331,0.2530178725719452,-0.4015052914619446},{0.42105093598365784,0.2463904619216919,-0.06530445069074631,-0.292157381772995,-0.139816015958786,0.15055440366268158,0.3231964111328125,-0.13656096160411835},{0.18210095167160034,-0.3146018087863922,-0.21143709123134613,0.01873784139752388,-0.59489506483078,0.28112033009529114,-0.22846215963363647,0.1881123185157776},{0.43809908628463745,0.4407123923301697,-0.028747620061039925,-0.2879680395126343,-0.10110389441251755,-0.536155104637146,-0.0652313232421875,0.13866791129112244},{0.2437451183795929,-0.0917627364397049,-0.3129671812057495,-0.34615281224250793,-0.015577533282339573,0.0015614069998264313,-0.3900667726993561,0.4227507710456848},{-0.22004824876785278,-0.23258663713932037,-0.4371863007545471,-0.05448674410581589,-0.1328747570514679,-0.4823932349681854,0.29967114329338074,-0.12959878146648407},{-0.015633247792720795,-0.4648594558238983,-0.6050124764442444,-0.29311174154281616,0.31810808181762695,-0.27344587445259094,-0.3655468225479126,0.11856283247470856}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.36026474833488464,0.0184274073690176,-0.37264135479927063,-0.3276411294937134,-0.5302442312240601,0.6713892221450806,-0.1722797155380249,0.00934634730219841},{-0.08320381492376328,0.03749580308794975,-0.6279539465904236,0.36666813492774963,0.012205914594233036,0.35784250497817993,0.5232099294662476,0.3037024736404419},{-0.25189101696014404,-0.46172839403152466,-0.646559476852417,0.49391913414001465,0.12570308148860931,-0.3434334397315979,0.45307958126068115,-0.22036826610565186},{0.5074731707572937,0.08979922533035278,0.2115892469882965,-0.3949277997016907,-0.3424716591835022,-0.4928245544433594,-0.3109293580055237,0.21650157868862152},{-0.10391812771558762,-0.4475700557231903,-0.17204463481903076,0.35944193601608276,0.3796871602535248,-0.3148433268070221,-0.24362631142139435,0.008264005184173584},{0.2766619622707367,-0.48484480381011963,-0.23828661441802979,-0.13796865940093994,-0.5893619060516357,-0.11800992488861084,-0.04765579104423523,0.10670340061187744},{0.3289666473865509,0.55287766456604,-0.3744853138923645,0.6443637609481812,-0.09640143811702728,0.2626236081123352,0.1316872388124466,0.388278990983963},{0.07684560120105743,-0.09551047533750534,0.5078076124191284,0.31699925661087036,0.6696761250495911,0.16462355852127075,0.030868452042341232,-0.04861344397068024}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.07906272262334824,0.0613057017326355,0.02754654362797737,-0.01701967604458332,-0.03966524451971054,-0.12747302651405334,-0.01666230894625187,0.07181672006845474};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.026815084740519524,-0.00529292831197381,-0.012796659022569656,0.02079394832253456,0.10995791852474213,-0.02382707968354225,0.02908990904688835,0.1168266087770462};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

