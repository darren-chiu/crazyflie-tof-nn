
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[4];
static float output_embeds[20];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{20, 20},{20, 4}};
static const int obst_structure [2][2] = {{16, 4},{4, 4}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[4];
static float obst_output_1[4];
static float output_2[20];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.45854002237319946,0.287067174911499,-0.23621350526809692,0.0832381471991539,0.048864010721445084,-0.20082157850265503,0.028527285903692245,-0.03226229548454285,0.08674678206443787,0.24621468782424927,-0.020181281492114067,-0.035491943359375,-0.2240564078092575,0.16023540496826172,-0.40072154998779297,0.18944258987903595},{-0.321434885263443,-0.13938772678375244,-0.08238916099071503,0.20881061255931854,-0.018221380189061165,0.5360381007194519,-0.1295894980430603,0.12213829159736633,0.1165865957736969,-0.2594863772392273,0.059869084507226944,0.40176641941070557,0.1828770786523819,-0.1158478856086731,0.3779686987400055,-0.05429093912243843},{-0.25734013319015503,-0.21091201901435852,-0.2555299699306488,-0.1739412099123001,0.3397477865219116,-0.15777601301670074,-0.460222989320755,-0.15390023589134216,0.061040423810482025,0.39457783102989197,-0.23817726969718933,0.07863688468933105,0.009756890125572681,0.4194498658180237,0.31110307574272156,-0.34964191913604736},{-0.4014488756656647,0.25778618454933167,-0.06447409838438034,0.012490799650549889,0.2873283922672272,0.18021681904792786,-0.12600935995578766,-0.036677077412605286,0.3481684923171997,-0.024836482480168343,-0.011944355443120003,-0.07720339298248291,-0.16728755831718445,-0.3210960626602173,-0.10649466514587402,0.1637909859418869},{-0.12792649865150452,0.1802198439836502,-0.27648070454597473,0.06973312050104141,-0.29950806498527527,0.07849529385566711,-0.16578388214111328,-0.234657421708107,0.040121641010046005,0.06094753369688988,0.05964589864015579,0.36074891686439514,-0.2961009740829468,-0.12929122149944305,0.06152750179171562,0.44247230887413025},{0.09542888402938843,0.1402549296617508,-0.4332088232040405,-0.4598328471183777,0.13675564527511597,0.09754864126443863,-0.6857889890670776,0.16552859544754028,0.48386651277542114,0.03438825160264969,-0.16349662840366364,0.10798043012619019,-0.3943835198879242,0.1743101179599762,0.06873058527708054,-0.2903503477573395},{0.19308210909366608,-0.08683767914772034,-0.32251375913619995,0.4096938967704773,-0.10628549754619598,-0.3339502215385437,-0.26585182547569275,-0.2722299098968506,-0.40938013792037964,-0.3282604515552521,-0.3182847499847412,0.025301646441221237,0.20715820789337158,0.31741827726364136,-0.11839409917593002,-0.17044688761234283},{0.20408344268798828,0.23478423058986664,-0.3839402496814728,0.11533642560243607,-0.17791424691677094,0.5471238493919373,-0.32724013924598694,0.6619821190834045,-0.34944653511047363,0.4671739637851715,0.21766065061092377,-0.10193648189306259,-0.18708138167858124,-0.09663913398981094,0.17273518443107605,0.7365685701370239},{-0.5388650298118591,0.3033899962902069,-0.08799111098051071,0.7156071066856384,0.5171476006507874,0.38098302483558655,0.1339024156332016,0.16488170623779297,0.5894375443458557,0.20809954404830933,-0.5608989596366882,-0.008320672437548637,0.3570205271244049,-0.4082108438014984,0.1841789335012436,-0.046467166393995285},{-0.19328835606575012,0.2516673505306244,0.10683944821357727,-0.2442120611667633,-0.161345973610878,-0.36396974325180054,0.27899110317230225,-0.47381407022476196,-0.08024793118238449,-0.49398383498191833,-0.1986318975687027,0.3072814643383026,0.3345682919025421,0.20711062848567963,-0.44577130675315857,-0.7781412601470947},{0.5259056091308594,-0.19657009840011597,-0.5865208506584167,0.5072746872901917,0.21159476041793823,-0.05461803078651428,0.2987239360809326,-0.4091649353504181,-0.3866517245769501,0.005440080538392067,-0.31065258383750916,0.13028405606746674,-0.15969769656658173,-0.35285019874572754,0.06952901184558868,0.2895601987838745},{-0.4890628755092621,-0.29078829288482666,-0.3215385973453522,-0.11996261030435562,0.0620446503162384,0.567055881023407,-0.023151516914367676,-0.45575788617134094,-0.4884136915206909,-0.1167578250169754,-0.5909543633460999,0.7709059715270996,0.0936429500579834,-0.13946188986301422,0.5272278189659119,0.18511997163295746},{-0.5814052224159241,0.5371845960617065,0.3333199620246887,0.28146374225616455,0.03910914808511734,0.4066268503665924,0.1152973398566246,0.15077857673168182,-0.11882001906633377,-0.6117849349975586,-0.2485240399837494,-0.23051230609416962,0.41954705119132996,-0.4857122004032135,-0.008606651797890663,0.18678300082683563},{0.25336241722106934,-0.002039245329797268,-0.1913105994462967,0.34797346591949463,-0.23204658925533295,0.04838326573371887,0.0768141895532608,-0.3875129818916321,-0.08560152351856232,-0.527055025100708,-0.0803375095129013,0.7405051589012146,-0.09311935305595398,0.04408608376979828,0.13721811771392822,-0.056114379316568375},{-0.4936352074146271,-0.13219216465950012,-0.1479017585515976,-0.36241579055786133,-0.1912774294614792,-0.42719516158103943,0.14961305260658264,0.36901891231536865,-0.4319167733192444,0.3934299945831299,-0.11024084687232971,-0.06909254193305969,-0.2900375723838806,0.48312047123908997,0.1858985722064972,0.2371150404214859},{-0.03261462599039078,0.08251909911632538,-0.2915095388889313,-0.0873507559299469,-0.2267192155122757,-0.17207112908363342,-0.1318129599094391,-0.254885733127594,-0.28545165061950684,-0.00661411602050066,0.008035972714424133,0.1914350986480713,0.2690257430076599,0.46113499999046326,-0.010585617274045944,0.1490601897239685},{0.2261052429676056,-0.305006742477417,0.15392805635929108,-0.17134255170822144,-0.032073989510536194,0.18010956048965454,0.23307816684246063,0.007231154479086399,-0.18101881444454193,0.22851118445396423,0.06298962980508804,-0.014454502612352371,-0.3012441396713257,0.22165276110172272,0.10167823731899261,-0.10499242693185806},{0.3783946633338928,0.18090109527111053,0.14565548300743103,0.06611263006925583,0.019415508955717087,0.22654621303081512,-0.09039819985628128,0.12296268343925476,-0.20096544921398163,0.5412867665290833,0.21271076798439026,0.19177722930908203,-0.2935769259929657,-0.08295058459043503,-0.10726255923509598,0.15143178403377533}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.060605037957429886,0.14728643000125885,-0.0866871103644371,-0.06027120724320412,-0.1260814070701599,-0.35722488164901733,0.44661688804626465,-0.286914199590683,-0.4454728960990906,-0.07534415274858475,0.046459633857011795,-0.2114323377609253,-0.11664535850286484,0.42656171321868896,-0.1437273919582367,0.2541513442993164},{-0.18892540037631989,0.04751989617943764,0.10412421077489853,-0.10361368954181671,-0.21491138637065887,-0.11451275646686554,-0.3059770166873932,0.20194938778877258,0.44060707092285156,-0.0009374214569106698,0.13172705471515656,0.3598040044307709,0.15566512942314148,0.3951778709888458,-0.2711929976940155,-0.32516637444496155},{0.2919999659061432,0.15430210530757904,0.3080248236656189,-0.04635908454656601,-0.04819272831082344,-0.18576392531394958,0.10250621289014816,-0.3095616400241852,0.4216237962245941,0.2901657819747925,0.3792520761489868,-0.2600184381008148,-0.03108670935034752,-0.388763964176178,-0.1033659279346466,0.24201467633247375},{-0.11243434995412827,0.06267369538545609,-0.058346718549728394,0.2527637183666229,-0.2443608194589615,0.3524151146411896,0.1677628606557846,0.4031180739402771,-0.45391079783439636,0.041576385498046875,-0.15315108001232147,0.09807316958904266,0.3323713541030884,0.1792031228542328,0.18383364379405975,0.43393442034721375},{-0.1533423662185669,0.22392866015434265,0.04095149040222168,0.42779266834259033,0.18764197826385498,0.3572212755680084,0.0897243395447731,-0.5691579580307007,-0.09588689357042313,-0.060635872185230255,0.21256564557552338,0.16459132730960846,0.11731576919555664,0.18133026361465454,0.12167807668447495,0.10288334637880325},{0.12163404375314713,-0.06418268382549286,-0.19134730100631714,-0.2973991334438324,-0.3830905556678772,0.0576665922999382,0.15356069803237915,0.05467746779322624,0.08445948362350464,-0.333890438079834,-0.2097582072019577,0.30960530042648315,0.04773327335715294,0.17030924558639526,0.19907042384147644,-0.40207505226135254},{-0.24106889963150024,0.33434319496154785,-0.16872811317443848,0.06641031801700592,-0.03663897514343262,0.24286101758480072,-0.2537132799625397,0.23650306463241577,0.10591404139995575,0.4551859200000763,-0.23022566735744476,0.21488572657108307,-0.1562538594007492,0.3076339364051819,0.2487776279449463,0.10877670347690582},{0.014696020632982254,-0.3057633936405182,-0.2886567711830139,0.4126017391681671,-0.3354346454143524,0.5010711550712585,-0.3915407061576843,0.2572033703327179,-0.25729021430015564,0.1282585710287094,-0.01047314703464508,-0.4031296670436859,-0.3838612735271454,0.2433374673128128,0.20102037489414215,0.2539953887462616},{0.35500580072402954,-0.25430920720100403,0.3160836398601532,-0.10874614864587784,0.45325323939323425,-0.26954537630081177,-0.34215617179870605,0.17120011150836945,0.1454600989818573,0.14939498901367188,0.23467499017715454,-0.35649368166923523,0.08707944303750992,0.0003296102804597467,0.024265939369797707,-0.359844833612442},{0.041352689266204834,-0.29704201221466064,0.4073133170604706,0.37406837940216064,-0.19022664427757263,-0.2094138115644455,-0.3951149880886078,0.18800218403339386,-0.19374322891235352,0.1824924796819687,0.1184329092502594,-0.4027852714061737,-0.026395270600914955,-0.30341672897338867,-0.23337459564208984,-0.04270245134830475},{0.2338894158601761,-0.23633842170238495,0.058622900396585464,-0.34604284167289734,-0.39763203263282776,-0.044306740164756775,-0.4295557141304016,0.33147332072257996,-0.14954745769500732,0.23720304667949677,0.19173164665699005,-0.31673964858055115,-0.4303402304649353,0.10819747298955917,0.2511405646800995,-0.0506623201072216},{-0.40924641489982605,-0.07933850586414337,-0.004904538858681917,-0.06407423317432404,0.10397428274154663,-0.181706041097641,0.10381759703159332,0.36369016766548157,-0.010559776797890663,-0.27988845109939575,-0.35866665840148926,-0.3368081748485565,-0.19871686398983002,0.3628392517566681,-0.03604083135724068,-0.1634705811738968},{0.3167164623737335,-0.29715219140052795,0.023857109248638153,0.09666997194290161,-0.18303342163562775,0.13819454610347748,0.019204456359148026,0.24716706573963165,0.2981681227684021,-0.01584315299987793,-0.04559300094842911,-0.19747129082679749,0.08327612280845642,0.358768105506897,-0.33829164505004883,0.3320205807685852},{-0.36582648754119873,0.1319279968738556,0.32537099719047546,0.2315519154071808,-0.22787967324256897,-0.4463978111743927,-0.17590400576591492,-0.29431766271591187,0.1595129817724228,0.10492771863937378,-0.24956926703453064,0.12146877497434616,0.06573919951915741,-0.02402476966381073,0.03267250210046768,0.047244682908058167},{-0.04849621653556824,-0.47389766573905945,-0.5854532718658447,0.4609571695327759,0.23011286556720734,-0.10753722488880157,-0.36951541900634766,0.33301693201065063,0.3716655373573303,0.21052448451519012,-0.2821124494075775,-0.017369689419865608,0.013092274777591228,-0.019873322919011116,-0.3803618252277374,-0.36301764845848083},{0.06599745154380798,0.35113415122032166,-0.12782669067382812,0.3765921890735626,-0.08152340352535248,0.31488922238349915,0.4198288321495056,0.1140507161617279,0.29306477308273315,-0.1452314704656601,-0.3678283095359802,-0.1470002979040146,-0.055365923792123795,-0.2082921415567398,-0.5081290006637573,-0.3939685821533203}};
static const float actor_encoder_feed_forward_0_weight[20][20] = {{0.05673470348119736,0.10567273944616318,0.09109789878129959,0.41398096084594727,-0.08082865178585052,0.41052213311195374,-0.17669722437858582,0.22823819518089294,0.05139566957950592,0.0029620975255966187,0.07614554464817047,-0.04545645788311958,0.04059205576777458,-0.21373209357261658,-0.26908692717552185,0.042418912053108215,-0.20821553468704224,-0.14237995445728302,0.06078031659126282,0.2867324650287628},{0.14796118438243866,0.14636211097240448,0.19302308559417725,0.45833316445350647,-0.31530675292015076,0.32580992579460144,0.34070226550102234,0.3680018484592438,-0.15955224633216858,-0.4417363405227661,-0.21425952017307281,0.05115005373954773,-0.06864318251609802,0.18112137913703918,-0.273791640996933,-0.1508546769618988,0.08703409880399704,0.4813998341560364,-0.17646002769470215,0.12711448967456818},{0.15584561228752136,0.10156560689210892,0.07026632130146027,0.12340699136257172,-0.07120979577302933,-0.0020277686417102814,0.012803393416106701,-0.27605441212654114,0.4027893543243408,0.05419458821415901,-0.3064102530479431,-0.21903029084205627,0.16831515729427338,-0.025733809918165207,0.12278494238853455,-0.47808608412742615,0.2174351066350937,0.3238980174064636,0.01993623562157154,-0.34101009368896484},{0.030140286311507225,-0.11264587193727493,-0.10320504009723663,-0.4044269025325775,-0.18677304685115814,-0.3304188847541809,-0.15682119131088257,-0.22330966591835022,-0.11802639067173004,0.2434021234512329,-0.011029398068785667,0.03347701206803322,0.13208389282226562,-0.20232908427715302,-0.05114327743649483,0.23626096546649933,-0.29520225524902344,0.010869953781366348,0.3964915871620178,-0.2730952799320221},{0.3363061845302582,0.29308250546455383,-0.21427221596240997,-0.2645926773548126,0.14845983684062958,-0.04640532657504082,0.4168899953365326,-0.05545879155397415,0.03098977543413639,0.34982943534851074,0.3778887093067169,-0.1384841948747635,-0.2178865671157837,0.031347427517175674,-0.3843343257904053,0.07360661029815674,0.11457346379756927,-0.16709250211715698,0.26604247093200684,0.28690940141677856},{-0.127088263630867,-0.06349551677703857,0.020751943811774254,0.28646767139434814,-0.27865490317344666,-0.027243930846452713,0.060023579746484756,-0.12197515368461609,-0.20867908000946045,-0.3622688949108124,-0.2921390235424042,0.41318732500076294,0.13821372389793396,-0.3239537477493286,0.02005593851208687,-0.17763246595859528,0.41554784774780273,-0.007264669053256512,-0.04009454324841499,-0.11640400439500809},{0.35330522060394287,-0.3481254279613495,0.4346533715724945,0.22585618495941162,0.24000316858291626,0.1590477079153061,-0.21466384828090668,-0.39216774702072144,-0.042167454957962036,0.033287208527326584,-0.06717240065336227,0.2794158458709717,-0.091387078166008,-0.020924238488078117,-0.43188825249671936,-0.25050291419029236,0.1799425184726715,0.10814714431762695,-0.47784164547920227,0.10909377783536911},{0.3463731110095978,-0.20966774225234985,0.4211084246635437,0.3916470408439636,0.2602968215942383,-0.2909376323223114,-0.2101297527551651,0.12018716335296631,-0.04507533833384514,0.11469534784555435,-0.3733541965484619,0.3727978765964508,0.13522407412528992,-0.169026181101799,0.05327911302447319,0.050542108714580536,0.04895583167672157,0.1398490071296692,-0.0524175800383091,-0.2916608154773712},{-0.15863974392414093,-0.09978892654180527,-0.09564725309610367,-0.014482448808848858,-0.27327263355255127,0.3647735118865967,-0.3430235981941223,0.11445816606283188,0.38552841544151306,0.11314002424478531,-0.28705355525016785,0.262612521648407,-0.035079799592494965,0.19500862061977386,-0.04781288281083107,-0.5313516855239868,0.1357894092798233,-0.4059167802333832,-0.1613701581954956,-0.2671487629413605},{-0.3841690719127655,0.16171465814113617,0.08753439038991928,-0.17560692131519318,0.28132668137550354,0.4125072956085205,-0.11242805421352386,0.2892037630081177,0.23363561928272247,0.010996341705322266,-0.06374065577983856,0.06555148214101791,0.1117076575756073,-0.4066881537437439,-0.23539474606513977,-0.06539817899465561,0.3211385905742645,0.4056239128112793,0.3878733217716217,0.32671985030174255},{-0.059259381145238876,0.020051710307598114,0.00589766213670373,0.4984961450099945,0.3966946005821228,0.1603432297706604,0.4296391010284424,-0.2851610481739044,0.1375177502632141,0.08227003365755081,-0.25067031383514404,-0.23625709116458893,0.19097378849983215,-0.38761547207832336,-0.19554710388183594,-0.060282956808805466,0.11107617616653442,0.015910087153315544,-0.1310235857963562,0.04594550281763077},{-0.08457683771848679,-0.32034987211227417,-0.000856056110933423,0.20771753787994385,-0.3538244068622589,-0.040316514670848846,-0.17867480218410492,-0.12389528751373291,0.35600167512893677,0.22166554629802704,0.07339673489332199,-0.1953394114971161,-0.19412556290626526,0.19467192888259888,-0.24164506793022156,0.28993603587150574,-0.31481316685676575,0.26122918725013733,0.1710660606622696,0.3854290544986725},{0.02257758192718029,-0.2890513837337494,0.03911672905087471,-0.04126135632395744,-0.18507827818393707,-0.25045040249824524,0.4332796037197113,-0.2355181872844696,-0.22967328131198883,0.037119507789611816,0.17995724081993103,-0.21450355648994446,-0.022856639698147774,-0.24691343307495117,-0.30996885895729065,-0.32928726077079773,0.32032397389411926,0.24303112924098969,0.32298484444618225,-0.015944641083478928},{0.41415274143218994,0.399556040763855,0.3393743932247162,-0.13851702213287354,-0.2058580070734024,-0.008422335609793663,0.4287732243537903,0.055111855268478394,0.1726575642824173,-0.2730729281902313,0.05539403483271599,0.009149177931249142,-0.439349502325058,0.06989295780658722,-0.27667519450187683,0.048796817660331726,-0.15588434040546417,0.2926096022129059,0.06312382966279984,-0.26166218519210815},{-0.2804066836833954,0.15395870804786682,0.1975902020931244,0.2235291600227356,0.21775832772254944,0.1267065852880478,0.32412031292915344,0.04423822462558746,0.03237356245517731,0.14625810086727142,-0.255702942609787,0.2015189230442047,-0.16606323421001434,-0.049004022032022476,-0.010386466048657894,0.2523530423641205,-0.341722697019577,-0.24331793189048767,0.2731621265411377,-0.30218377709388733},{-0.19149452447891235,0.2518889904022217,-0.16444773972034454,0.2091444581747055,0.17428427934646606,0.2144574224948883,0.49909308552742004,-0.028278576210141182,0.3874366581439972,-0.12624391913414001,0.002629475900903344,0.15117621421813965,-0.31652191281318665,0.3464779257774353,-0.08034079521894455,-0.1304590404033661,-0.27388331294059753,0.33311742544174194,-0.013327183201909065,-0.1097194254398346},{0.4103763997554779,-0.17399227619171143,0.2924393117427826,-0.2921391427516937,0.12284362316131592,0.19026407599449158,-0.11121051758527756,-0.2411535680294037,-0.21342936158180237,0.012849128805100918,0.17954105138778687,0.1717192828655243,0.13758568465709686,-0.15063442289829254,0.2432837337255478,-0.12998026609420776,-0.08610954135656357,-0.06753949820995331,-0.17390769720077515,0.22761303186416626},{0.22221508622169495,0.16900938749313354,0.15877774357795715,0.3304065763950348,-0.3834661543369293,-0.01234644278883934,0.48309704661369324,-0.06443265825510025,0.004254006780683994,-0.0850789025425911,0.22472460567951202,-0.2423754781484604,-0.2733437418937683,0.10003987699747086,0.2731962203979492,0.32853105664253235,0.11192227900028229,-0.23048412799835205,-0.1601005345582962,0.08721411973237991},{0.23485949635505676,0.2639690339565277,0.08969057351350784,-0.1905105710029602,-0.13280785083770752,-0.2786358594894409,0.1604304313659668,0.24888813495635986,0.12617328763008118,-0.17517204582691193,0.23542480170726776,-0.0432061105966568,0.05153782293200493,-0.27251821756362915,-0.3177911639213562,0.30240535736083984,-0.2734469771385193,0.08204162120819092,-0.07971106469631195,0.020234685391187668},{0.2106003761291504,-0.00755299860611558,-0.1746143251657486,-0.044048815965652466,0.3445209264755249,0.12764029204845428,-0.09647001326084137,-0.0932864397764206,-0.15040065348148346,0.006694083102047443,-0.08431518822908401,-0.052011411637067795,0.07160622626543045,0.21607105433940887,-0.24158193171024323,0.07807405292987823,0.23676708340644836,-0.37340015172958374,-0.2993808090686798,0.26904305815696716}};
static const float action_parameterization_distribution_linear_weight[20][4] = {{-0.14389440417289734,-0.19294966757297516,-0.3319060802459717,-0.3480472266674042},{-0.22863279283046722,-0.16570992767810822,0.27860379219055176,0.07430486381053925},{0.16966110467910767,0.23804675042629242,0.0881238654255867,-0.24759428203105927},{0.24611566960811615,0.19979454576969147,0.2494928389787674,0.2642049193382263},{0.12652866542339325,0.11001066118478775,-0.2708665728569031,0.18156035244464874},{0.08337319642305374,0.05046452581882477,-0.043063487857580185,0.23337531089782715},{-0.445650577545166,-0.03169851005077362,-0.18699704110622406,0.32264041900634766},{0.28132668137550354,-0.20341885089874268,-0.28769710659980774,0.47264760732650757},{-0.17381280660629272,0.4814397096633911,-0.2654149830341339,0.28287428617477417},{-0.07732457667589188,0.012553183361887932,-0.23377518355846405,-0.1631752848625183},{0.28777363896369934,-0.3712088167667389,-0.516392171382904,0.22542352974414825},{0.38934943079948425,0.3732767105102539,-0.1192593201994896,-0.11357641965150833},{-0.10141818970441818,-0.3979194462299347,0.2583361268043518,0.14975494146347046},{0.22740094363689423,0.276854008436203,-0.17950116097927094,-0.24926698207855225},{0.37795644998550415,-0.27231907844543457,-0.49546197056770325,0.1543750911951065},{0.1249440386891365,-0.5859860777854919,0.21182018518447876,0.12459692358970642},{0.10861935466527939,0.1753365695476532,0.21504554152488708,-0.10530446469783783},{0.28920871019363403,-0.3058144450187683,0.24717001616954803,0.2466535121202469},{-0.17894263565540314,0.05086895450949669,-0.23346759378910065,0.13580024242401123},{0.3046051859855652,0.2781475782394409,-0.40427178144454956,0.40885743498802185}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.1066841259598732,0.1532861441373825,0.1193828210234642,-0.08967456966638565,-0.014366751536726952,0.00695626437664032,0.12200140953063965,0.04597923904657364,-0.07129412144422531,0.04018685221672058,-0.050215885043144226,0.003906078403815627,-0.08870227634906769,0.10066581517457962,0.07393110543489456,0.03478889912366867};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.16273199021816254,-0.02913273684680462,0.02903141640126705,0.014859529212117195,-0.06361386924982071,0.03211330622434616,-0.15256021916866302,-0.04013874754309654,0.15555588901042938,0.10445743799209595,-0.05006138235330582,-0.025702955201268196,0.003563172649592161,-0.12505151331424713,0.060795847326517105,-0.06410019844770432};
static const float actor_encoder_feed_forward_0_bias[20] = {-0.058111608028411865,-0.009172424674034119,-0.06482978165149689,-0.006545363925397396,-0.009343418292701244,0.055715762078762054,-0.08615411818027496,-0.027418963611125946,0.010613223537802696,0.05269765108823776,-0.022148968651890755,-0.05067935213446617,0.08081842958927155,-0.051746852695941925,0.07220448553562164,0.011914442293345928,0.053835976868867874,0.07480189949274063,0.05394831299781799,-0.06600631028413773};
static const float action_parameterization_distribution_linear_bias[4] = {-0.007297935429960489,0.01710057631134987,0.036867618560791016,0.04144155606627464};
static const float actor_encoder_obstacle_encoder_0_weight[16][4] = {{0.05422499403357506,-0.1334654539823532,0.4733924865722656,-0.6924159526824951},{0.09428764879703522,-0.060992851853370667,-0.23319382965564728,0.3396680951118469},{-0.41002628207206726,-0.2772781252861023,0.36156147718429565,-0.2497948706150055},{0.2619447112083435,0.19193631410598755,-0.19674839079380035,-0.1304284930229187},{0.3929169774055481,0.24368275701999664,-0.21491701900959015,-0.1429426521062851},{0.16857774555683136,-0.30216407775878906,-0.27022191882133484,-0.11673220992088318},{0.2946043014526367,-0.1388780027627945,-0.38985675573349,0.00637098029255867},{0.20466189086437225,-0.8764370679855347,-0.47388362884521484,-0.4569069445133209},{0.032955873757600784,-0.2099597305059433,-0.44364726543426514,-0.4532659649848938},{0.30051809549331665,-0.44803035259246826,0.23976342380046844,0.21720995008945465},{-0.5217943787574768,-0.5998996496200562,0.12706249952316284,0.19102109968662262},{-0.03647395595908165,0.27195513248443604,-0.0998244658112526,-0.42087337374687195},{0.3092527389526367,-0.03237616643309593,0.01643325202167034,-0.12153447419404984},{-0.5259964466094971,0.21365857124328613,0.3038153648376465,0.18209604918956757},{0.11730985343456268,0.19380655884742737,-0.28019553422927856,0.3782404661178589},{0.3117871582508087,-0.49164581298828125,0.24698007106781006,-0.33916348218917847}};
static const float actor_encoder_obstacle_encoder_2_weight[4][4] = {{-0.6905121207237244,-0.22543805837631226,-0.6889575719833374,0.3161316215991974},{-0.4211321175098419,0.7944578528404236,0.2029183954000473,0.570773720741272},{-0.5458226799964905,0.17067264020442963,-0.07501199841499329,0.002729353029280901},{0.7984477281570435,0.3724028170108795,0.5677025318145752,0.6888760328292847}};
static const float actor_encoder_obstacle_encoder_0_bias[4] = {0.1179540604352951,-0.35594454407691956,0.03157017007470131,-0.20814548432826996};
static const float actor_encoder_obstacle_encoder_2_bias[4] = {0.012749535962939262,-0.0854492112994194,-0.022888462990522385,-0.04870593920350075};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }
