
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.0695897564291954,-0.018769368529319763,0.08321519196033478,0.06469636410474777,-0.39126351475715637,0.1466222107410431,-0.38984912633895874,0.48481515049934387,0.09895958751440048,0.10120077431201935,0.3112052083015442,-0.30565184354782104,-0.01862182840704918,-0.013026666827499866,0.2908669114112854,0.17304666340351105},{-0.1469837874174118,-0.468453973531723,0.2741411030292511,-0.09444748610258102,0.3038025200366974,0.11205508559942245,0.010875777341425419,-0.03742367774248123,0.06491473317146301,-0.009145129472017288,-0.37795305252075195,0.0013346808264032006,0.03070228174328804,0.10539518296718597,-0.08321338146924973,0.4338351786136627},{0.14101599156856537,0.46718287467956543,0.1071888655424118,0.4741237759590149,-0.2192455381155014,0.09700120240449905,0.21158219873905182,0.45179328322410583,-0.5574439167976379,0.554309606552124,-0.07469350099563599,0.347887247800827,-0.1154237762093544,0.2848478853702545,0.16368646919727325,-0.1265859603881836},{-0.049344029277563095,-0.1786617785692215,-0.09512314200401306,0.2219659984111786,0.02554646134376526,-0.283657968044281,-0.027461910620331764,0.4218709468841553,0.10582280158996582,0.17662964761257172,0.2802923321723938,-0.1278829276561737,0.0036461218260228634,-0.037358358502388,-0.1064525842666626,0.29438018798828125},{-0.1978583186864853,-0.42060425877571106,-0.35134613513946533,0.10772201418876648,-0.040292128920555115,-0.1261826455593109,0.29042819142341614,0.19978362321853638,-0.1026519387960434,-0.017851045355200768,-0.04644695296883583,0.003897992195561528,-0.24357201159000397,0.32461172342300415,-0.16540378332138062,0.044345054775476456},{-0.09909211099147797,0.020276403054594994,0.08286403119564056,-0.23624028265476227,-0.5028207898139954,0.4021134376525879,0.1576090306043625,0.36623480916023254,0.08324388414621353,0.48377251625061035,-0.10466203093528748,-0.0072521367110311985,0.44193539023399353,0.1110016331076622,0.1750948131084442,0.257743775844574},{-0.08121021836996078,-0.10637588798999786,0.4245658814907074,-0.007174378726631403,-0.11924219131469727,0.6105141639709473,-0.22544646263122559,-0.4432417154312134,-0.2948428690433502,0.058165401220321655,0.2197914570569992,-0.7439913153648376,-0.0019081068458035588,-0.4010193645954132,-0.30007204413414,-0.45762819051742554},{-0.5238535404205322,0.16375280916690826,0.6126613616943359,-0.2340380698442459,-0.4253387451171875,0.22295109927654266,0.34987199306488037,0.42998307943344116,0.08367442339658737,0.13856913149356842,0.3726739287376404,-0.20047186315059662,0.24437130987644196,0.19774214923381805,-0.4347129166126251,-0.14579486846923828},{-0.34819623827934265,-0.021462125703692436,-0.05075395479798317,0.23835401237010956,0.551291823387146,-0.2999507188796997,-0.4373142719268799,-0.0671120211482048,-0.0638178139925003,0.3394385576248169,0.33489763736724854,-0.19151270389556885,0.026531308889389038,-0.0793311819434166,-0.45005303621292114,0.4109328091144562},{0.6458327770233154,-0.3043847978115082,-0.1252998262643814,0.7622470259666443,-0.13163495063781738,-0.24681130051612854,-0.03384454920887947,-0.16945776343345642,-0.15067483484745026,0.464769572019577,-0.2978680729866028,0.048424385488033295,0.06672702729701996,0.0708189383149147,-0.32182082533836365,-0.08036568760871887},{-0.638220489025116,-0.4509475827217102,0.308704137802124,0.04034492000937462,0.3276655972003937,0.4301568865776062,-0.025426330044865608,-0.08011200278997421,-0.09718641638755798,0.12175381928682327,0.28310084342956543,-0.17731373012065887,-0.482115238904953,-0.2955045998096466,-0.26773345470428467,-0.5634225606918335},{-0.11577155441045761,-0.025232529267668724,-0.21492506563663483,-0.07761933654546738,0.5517776608467102,-0.026704750955104828,0.09549184888601303,0.4124438166618347,-0.08795628696680069,-0.08718529343605042,-0.4180491268634796,-0.10464640706777573,-0.2435058206319809,0.5517174005508423,0.08351392298936844,0.2472238391637802},{0.347039133310318,-0.31284984946250916,-0.40295693278312683,0.5764570236206055,-0.4341711103916168,0.37690305709838867,0.52381432056427,-0.06781371682882309,-0.00933134276419878,-0.10045568645000458,-0.2514652907848358,-0.5620962381362915,-0.15041248500347137,0.4294060468673706,0.31485486030578613,-0.4657229483127594},{0.5844188332557678,0.508367657661438,0.5147386193275452,0.05141578987240791,-0.2302207201719284,0.01865151897072792,0.18755051493644714,-0.11482328921556473,-0.41341230273246765,-0.15115253627300262,0.04091013967990875,0.3827671706676483,0.30277425050735474,-0.20949122309684753,-0.3105427324771881,-0.03331796079874039},{-0.031468573957681656,-0.3570098578929901,0.557346522808075,-0.2956474721431732,0.13639028370380402,0.5470610857009888,-0.15030469000339508,-0.15898430347442627,0.4374128580093384,-0.03975195065140724,-0.21900898218154907,0.02261350117623806,0.2945205271244049,0.0908351019024849,-0.5004620552062988,0.09873393177986145},{0.13779018819332123,-0.004626791458576918,-0.005177933722734451,-0.2260340005159378,-0.32027193903923035,0.17516741156578064,-0.11375285685062408,-0.1593133509159088,-0.1436339020729065,-0.14545664191246033,0.00875554047524929,0.12472303956747055,0.13401636481285095,-0.17239665985107422,0.14797528088092804,-0.16099250316619873},{-0.03534562513232231,0.10804355144500732,0.2680209279060364,0.0650172308087349,-0.21759474277496338,-0.04079701006412506,-0.19514524936676025,-0.19376394152641296,0.2376764714717865,0.0416509285569191,0.12502826750278473,0.21998931467533112,0.04424630105495453,-0.06711051613092422,-0.3491523265838623,-0.037704743444919586},{0.0002554328239057213,-0.1623183935880661,0.22764210402965546,-0.031714122742414474,-0.10778827220201492,-0.0030157833825796843,-0.05701303109526634,0.13980959355831146,-0.23595918715000153,0.019250744953751564,-0.15883515775203705,-0.15230529010295868,-0.31222715973854065,-0.2915633022785187,0.03239625692367554,-0.3413251042366028}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.2806329131126404,-0.43727442622184753,0.2979241907596588,-0.102383092045784,-0.09330885112285614,0.48904675245285034,-0.40653127431869507,-0.41855520009994507,0.29154032468795776,0.196174755692482,-0.10577422380447388,0.2921297252178192,0.2398475706577301,-0.5701161623001099,-0.19379523396492004,-0.015139017254114151},{-0.3299979865550995,-0.23179413378238678,0.27097776532173157,0.47572803497314453,-0.012982174754142761,0.17954964935779572,0.3229627013206482,-0.4342762529850006,0.18101146817207336,0.2781704068183899,-0.3368980884552002,0.1737654060125351,0.24685272574424744,0.0095687760040164,0.1437668800354004,0.2743854522705078},{-0.09451984614133835,0.07424511760473251,0.11500127613544464,0.4042116701602936,0.2255154550075531,0.2896472215652466,-0.07920712977647781,0.20890219509601593,0.27854791283607483,-0.3464822769165039,0.26197952032089233,0.2811700403690338,-0.15541021525859833,0.23020410537719727,0.31280744075775146,-0.006064246874302626},{0.020590951666235924,0.2634252905845642,0.04923170059919357,0.13954554498195648,-0.48810771107673645,-0.07700525224208832,0.35543081164360046,-0.3384106755256653,-0.27081456780433655,-0.0027199937030673027,0.22789160907268524,-0.13853564858436584,-0.19930881261825562,-0.279188334941864,-0.28379112482070923,0.16319382190704346},{0.38614487648010254,-0.29745855927467346,0.19156180322170258,-0.13065847754478455,-0.12562784552574158,-0.15676149725914001,-0.1349877268075943,0.13901455700397491,0.19227741658687592,-0.14590886235237122,-0.22155490517616272,-0.19035355746746063,0.07949560135602951,0.12839600443840027,0.40560808777809143,-0.2606447637081146},{0.3719686269760132,0.1727174073457718,0.4359756112098694,0.23653799295425415,-0.11518941074609756,-0.17869174480438232,-0.33922165632247925,0.3329087495803833,0.07250561565160751,-0.12774552404880524,-0.13384003937244415,-0.0862349271774292,-0.37812015414237976,0.38369080424308777,-0.3881850838661194,0.18493665754795074},{-0.15654441714286804,0.12609486281871796,0.06889708340167999,0.1332530677318573,-0.12777453660964966,-0.0012664819369092584,-0.4715119004249573,0.03112228587269783,0.29014578461647034,0.35930588841438293,-0.21898357570171356,0.3707386553287506,0.03763297200202942,0.19350770115852356,0.03540371358394623,0.3050217926502228},{-0.11694735288619995,-0.16355009377002716,-0.27796489000320435,0.21206414699554443,0.3859957158565521,-0.2636231482028961,-0.10527398437261581,-0.11802062392234802,-0.3048863708972931,-0.2584725022315979,-0.06346316635608673,-0.10638794302940369,-0.1963062584400177,-0.009156964719295502,0.26029205322265625,0.1734933704137802},{-0.05601392313838005,-0.14080265164375305,0.244536355137825,-0.47606712579727173,0.530018150806427,0.310986191034317,0.09640785306692123,0.4200565814971924,-0.20553743839263916,0.2500462234020233,0.18210817873477936,0.07086672633886337,0.48891863226890564,-0.07932721823453903,0.291612833738327,-0.21444611251354218},{-0.2615928053855896,0.3665285110473633,-0.39582890272140503,0.4444538354873657,-0.012419966980814934,0.07415459305047989,0.05442716181278229,0.02095714956521988,0.5165051221847534,-0.010728934779763222,0.4203972816467285,0.1787070482969284,0.2621360123157501,-0.07310216873884201,-0.3506188690662384,-0.3524887263774872},{-0.6034526228904724,0.1686556190252304,-0.4449184238910675,-0.04975965619087219,-0.14844374358654022,-0.3387293517589569,-0.08604466915130615,0.35555192828178406,0.011258131824433804,-0.4496680796146393,-0.2804882824420929,0.47905299067497253,-0.045714691281318665,0.1622742861509323,0.4338427186012268,-0.18123877048492432},{0.34926438331604004,-0.04115155339241028,-0.3334687650203705,0.21030564606189728,-0.022827912122011185,-0.23840324580669403,0.1556548923254013,0.005246131215244532,-0.03651941195130348,-0.387097030878067,-0.2905733585357666,0.3017590641975403,0.2906554043292999,0.24453482031822205,-0.16600829362869263,0.5121312141418457},{0.1275796890258789,-0.3362771272659302,-0.16374461352825165,0.40055808424949646,-0.08006369322538376,0.3209429681301117,-0.21700842678546906,-0.09440717846155167,-0.006031855009496212,0.14666315913200378,-0.12195014208555222,0.14013671875,0.10030272603034973,-0.004969593603163958,-0.3811874985694885,0.33831313252449036},{-0.20741140842437744,0.08599505573511124,0.06623481959104538,0.4442894160747528,0.16751453280448914,-0.26265209913253784,-0.3447723388671875,-0.21050743758678436,-0.22238507866859436,0.3689412772655487,-0.03479441627860069,0.3791712522506714,0.40699055790901184,-0.47345981001853943,0.02827766351401806,-0.20712974667549133},{-0.2586161494255066,0.2169923037290573,-0.26832056045532227,-0.22406461834907532,-0.1902494579553604,0.11813266575336456,-0.17127051949501038,-0.11760120093822479,0.16866546869277954,0.24599455296993256,0.3355066776275635,-0.20347553491592407,0.09288128465414047,-0.5097802877426147,-0.2892634868621826,0.18779079616069794},{0.10579951107501984,-0.2886267900466919,0.15142159163951874,0.26244625449180603,0.19712205231189728,-0.34640341997146606,0.40377992391586304,0.08745373040437698,-0.19801805913448334,0.15982560813426971,-0.029398467391729355,0.2855161130428314,0.10797947645187378,0.09644608944654465,0.26741600036621094,0.40025389194488525}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.3325450122356415,-0.2763439118862152,0.261735737323761,-0.2508562207221985,-0.37741583585739136,0.005975002888590097,0.277612566947937,-0.3324621617794037,0.014015496708452702,0.2950848937034607,0.03600877523422241,0.2463269680738449,-0.2300569713115692,0.03124786540865898,-0.26742446422576904,0.11141615360975266,-0.2394440919160843,0.20823653042316437,0.10700038820505142,-0.1338878720998764,0.18480423092842102,-0.017282528802752495,-0.11336458474397659,-0.033233996480703354},{-0.052631113678216934,0.02162851393222809,0.2813040018081665,0.17010724544525146,-0.2659488022327423,0.13386018574237823,0.03874669969081879,-0.023804083466529846,0.2992513179779053,-0.013959484174847603,-0.004445500671863556,-0.06026268005371094,-0.2371741086244583,-0.13018730282783508,0.3915109932422638,-0.10099618136882782,0.23616120219230652,0.250453919172287,-0.1364833563566208,0.08897775411605835,-0.1379496455192566,-0.046899933367967606,-0.09474905580282211,-0.16981570422649384},{0.13577674329280853,0.26927220821380615,0.20449933409690857,0.028782907873392105,-0.12785732746124268,0.25603893399238586,0.20196299254894257,-0.022988202050328255,0.2579697370529175,0.3309365510940552,-0.02337443083524704,0.25606417655944824,-0.18209122121334076,-0.023326359689235687,0.2767873704433441,-0.009248162619769573,0.21755607426166534,-0.21220844984054565,-0.029764723032712936,-0.11510888487100601,-0.22352717816829681,-0.0077542755752801895,0.12601488828659058,0.17187277972698212},{-0.40102559328079224,-0.316489577293396,0.14729134738445282,-0.18225669860839844,0.20580361783504486,-0.26031970977783203,-0.049142856150865555,-0.02474352903664112,0.18848112225532532,0.32710886001586914,0.27209460735321045,0.34441712498664856,-0.14513705670833588,0.18619896471500397,0.17310599982738495,0.4449363946914673,0.05528882145881653,-0.011297506280243397,0.17708531022071838,-0.06884375214576721,-0.08282104879617691,0.2561141550540924,0.17152439057826996,-0.3213050961494446},{-0.18843001127243042,0.29027554392814636,-0.05763162672519684,-0.09844238311052322,0.15236763656139374,0.03964759781956673,-0.04797712713479996,-0.21239802241325378,-0.07673899084329605,-0.0652318149805069,-0.1018027663230896,0.18550638854503632,-0.04989204183220863,0.04676056280732155,-0.0051895007491111755,-0.12226597219705582,-0.13423548638820648,0.0480155423283577,-0.26378175616264343,-0.23667530715465546,-0.24665330350399017,-0.050840847194194794,0.02558053471148014,0.22028067708015442},{0.2726345360279083,0.303147554397583,-0.0757693275809288,-0.24203996360301971,0.007462664041668177,0.030989427119493484,-0.23846876621246338,0.2118242084980011,0.17731863260269165,-0.08304886519908905,-0.22354838252067566,-0.36844387650489807,-0.02917454019188881,-0.05720057711005211,0.08583518117666245,0.057620029896497726,-0.3418455719947815,-0.19184017181396484,0.23401512205600739,0.2341957688331604,0.2563905417919159,0.23891758918762207,0.01191314309835434,-0.07073455303907394},{-0.10734077543020248,0.0231680516153574,-0.3718129098415375,0.10717218369245529,0.06838380545377731,-0.24403397738933563,-0.11483358591794968,-0.11643802374601364,-0.29268011450767517,-0.3433881103992462,-0.007514832075685263,0.17652678489685059,0.3351905941963196,0.3229183554649353,0.03045237995684147,0.231265589594841,0.25229963660240173,-0.026419496163725853,-0.1653953194618225,0.17386583983898163,0.2276831865310669,0.28912442922592163,-0.10760089755058289,0.08818461745977402},{0.21997492015361786,0.11890017986297607,0.12971758842468262,0.14289283752441406,0.3725317120552063,0.25739946961402893,0.12482874095439911,-0.229793980717659,-0.11976000666618347,-0.005606380756944418,0.3355948030948639,-0.15078312158584595,0.21547119319438934,0.37991929054260254,-0.29839852452278137,0.12434503436088562,-0.22947846353054047,-0.10889697074890137,-0.4890938103199005,0.2136467546224594,-0.2447756677865982,0.009316228330135345,-0.2439698427915573,0.17264294624328613},{-0.06901665776968002,-0.11009790748357773,0.1562381535768509,-0.016843697056174278,-0.1607142835855484,0.17486697435379028,-0.18161210417747498,-0.2115255892276764,0.34482288360595703,0.4548476040363312,0.45823246240615845,0.008478300645947456,-0.049188386648893356,0.3000839650630951,0.21029032766819,-0.10014093667268753,-0.010064060799777508,-0.23441460728645325,-0.14029566943645477,-0.3497087061405182,0.0032519109081476927,-0.25094422698020935,0.34612804651260376,-0.009074058383703232},{-0.0894295796751976,0.06471806019544601,0.3260587155818939,-0.10778038203716278,0.21681535243988037,-0.12816058099269867,-0.09396588057279587,0.22122697532176971,-0.3015540540218353,0.026294894516468048,0.14193519949913025,-0.20634333789348602,-0.19292736053466797,0.07264119386672974,0.24083802103996277,0.02691936492919922,0.17455971240997314,0.35976436734199524,0.2891339063644409,0.49592918157577515,0.23571419715881348,-0.19639712572097778,-0.09279350936412811,-0.09494498372077942},{0.20426692068576813,-0.34226927161216736,-0.025128642097115517,0.07449561357498169,-0.2212211638689041,-0.24917756021022797,-0.240020751953125,0.06554026901721954,-0.11866133660078049,0.25602301955223083,-0.3759760856628418,-0.2241171896457672,0.03652403503656387,0.20804408192634583,-0.039829321205616,-0.2299528867006302,0.2570803165435791,-0.03126988559961319,0.33149442076683044,-0.25792694091796875,-0.06139560788869858,-0.32887592911720276,0.1563582867383957,-0.10182403773069382},{0.2929238975048065,-0.14922861754894257,0.2942207455635071,-0.27696189284324646,0.16760721802711487,0.18029144406318665,-0.013622469268739223,0.13484373688697815,0.37835144996643066,-0.07101564854383469,-0.07984451949596405,-0.2952962815761566,-0.3799450993537903,0.0011285695945844054,-0.29883241653442383,0.35567060112953186,0.1666382998228073,0.362243115901947,-0.26631155610084534,0.13464179635047913,-0.299645334482193,0.17073708772659302,0.2256157100200653,0.21673737466335297},{0.031639862805604935,0.08916552364826202,0.15343612432479858,-0.30395185947418213,0.11265735328197479,-0.09184539318084717,-0.1604985147714615,0.07836969196796417,0.2576349973678589,-0.24146796762943268,0.23862004280090332,0.22909073531627655,-0.15283221006393433,0.2189607173204422,-0.15771852433681488,-0.37664923071861267,0.04610529914498329,0.3988645672798157,-0.17338940501213074,-0.06723614782094955,-0.39114469289779663,0.04834010824561119,-0.19935721158981323,-0.12315160036087036},{-0.10480891168117523,0.18978160619735718,-0.3178064525127411,-0.23546820878982544,-0.151970773935318,-0.13058693706989288,-0.3297448754310608,-0.27584177255630493,0.37312960624694824,-0.19832409918308258,-0.02291959337890148,-0.3099154531955719,0.015396542847156525,-0.28483715653419495,0.3697654902935028,0.36357682943344116,0.293628066778183,-0.3839050233364105,-0.09878323972225189,-0.3434830605983734,0.0610254630446434,-0.2279611974954605,-0.24760396778583527,-0.14580249786376953},{0.16859492659568787,0.2374195009469986,-0.1456754356622696,0.1479186862707138,-0.29715800285339355,-0.28563883900642395,0.04156697168946266,0.026959354057908058,-0.3408519923686981,-0.10528063029050827,-0.05933705344796181,0.16465742886066437,0.040872104465961456,-0.0090486453846097,-0.4215852916240692,0.04104031249880791,0.3294883966445923,0.2872786223888397,0.09155541658401489,0.10234662890434265,-0.18364226818084717,-0.42754995822906494,-0.003587105078622699,-0.40386146306991577},{0.2696654498577118,-0.05491933971643448,0.09918495267629623,-0.034230176359415054,0.22531823813915253,0.2811829149723053,-0.19819197058677673,-0.0529424324631691,-0.0971347987651825,-0.02737272158265114,0.3320642411708832,0.01067877747118473,-0.22197681665420532,-0.1262347400188446,-0.2714466154575348,-0.14414846897125244,-0.12923282384872437,0.15854328870773315,-0.03977372869849205,0.15446433424949646,0.06995830684900284,0.3355715572834015,-0.026971200481057167,-0.15607474744319916},{0.05698162317276001,-0.2407052218914032,0.13274499773979187,0.008143025450408459,-0.27584129571914673,0.11887690424919128,0.2048051357269287,0.24091781675815582,-0.22110839188098907,-0.30210965871810913,-0.055195342749357224,0.28525570034980774,-0.07988104224205017,-0.3418864905834198,0.07745029777288437,-0.1984672248363495,0.2584713101387024,0.03772084414958954,0.005968692246824503,-0.042228855192661285,0.05065181851387024,-0.14603082835674286,-0.09222506731748581,0.2599332630634308},{0.3011215925216675,0.2027243673801422,0.02114294283092022,0.33009299635887146,-0.1621730923652649,0.26527541875839233,-0.27868640422821045,0.11530676484107971,0.06670697778463364,-0.1612793356180191,-0.004728682339191437,-0.19022677838802338,0.07217829674482346,-0.18130266666412354,0.14830797910690308,-0.005583432037383318,0.09681005030870438,0.0727122351527214,0.04566984996199608,0.13501422107219696,-0.11535181105136871,0.03950699418783188,-0.08410075306892395,0.19581082463264465},{0.04033375158905983,-0.043129101395606995,0.22101882100105286,0.07639110833406448,0.08547616750001907,0.3100152909755707,0.21773414313793182,0.21617282927036285,0.11913131922483444,-0.06740326434373856,-0.19892464578151703,0.29768645763397217,-0.06571955978870392,0.07754632085561752,0.027770409360527992,-0.05792660638689995,0.0049606747925281525,0.05988288298249245,-0.17001089453697205,-0.2237938493490219,0.04243317246437073,0.22722917795181274,0.15615735948085785,0.23245996236801147},{-0.08088831603527069,0.14230242371559143,-0.09643036127090454,0.3457033038139343,-0.12017907202243805,0.04279276728630066,-0.24458955228328705,-0.21948713064193726,0.1646868884563446,-0.1597812920808792,0.06910895556211472,0.25406554341316223,-0.26860204339027405,-0.09473404288291931,0.07023805379867554,0.3423087000846863,0.24023795127868652,0.20065882802009583,-0.21678951382637024,-0.2593018114566803,-0.050118446350097656,0.13472700119018555,-0.28521499037742615,0.278560072183609},{0.2411946803331375,-0.1423257440328598,0.07786885648965836,-0.07316582649946213,-0.05709816515445709,-0.16526231169700623,0.30193981528282166,-0.18711881339550018,0.2310810685157776,-0.2614317536354065,0.03601694479584694,-0.139590322971344,-0.21583151817321777,-0.24568094313144684,-0.1438089907169342,0.16130125522613525,0.029491296038031578,0.04271707311272621,-0.2215798944234848,0.03371964022517204,-0.11638215184211731,0.09214071929454803,-0.19335703551769257,-0.21448247134685516},{0.2155098021030426,-0.05893786624073982,-0.30497947335243225,0.11643046140670776,-0.016740549355745316,0.33739134669303894,-0.2748512923717499,-0.22728095948696136,0.3115389049053192,-0.0385080948472023,-0.34301817417144775,-0.020183337852358818,-0.10776300728321075,-0.19419245421886444,0.2728837728500366,-0.026105409488081932,0.25780922174453735,0.3290517032146454,0.061539795249700546,-0.2609322667121887,-0.05103493481874466,-0.07587378472089767,-0.15927815437316895,-0.09374602138996124},{0.06999644637107849,0.3068099021911621,0.02458801120519638,0.035507988184690475,0.1351807862520218,-0.226913720369339,-0.0029925645794719458,0.12113942950963974,-0.317135214805603,0.07875966280698776,-0.2903907895088196,0.07770895957946777,-0.014187639579176903,-0.027480313554406166,-0.345030277967453,0.14660198986530304,-0.21079830825328827,-0.27566245198249817,0.20457886159420013,0.04955976828932762,-0.2360755205154419,0.22445806860923767,-0.2224189043045044,-0.26325634121894836},{-0.11833395063877106,-0.11047510802745819,0.35082870721817017,-0.18210691213607788,-0.01990104466676712,0.317432165145874,0.14741072058677673,0.20161490142345428,0.23400741815567017,0.3520556688308716,0.2590833306312561,-0.26037490367889404,0.04298222064971924,-0.20632943511009216,0.030002392828464508,0.02435556799173355,-0.027538752183318138,-0.1464530974626541,-0.21359342336654663,0.3225139081478119,0.36167868971824646,0.08519381284713745,0.28428196907043457,0.19789603352546692}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.2141391932964325,0.2863701283931732,-0.002584899542853236,0.1560346931219101},{0.28358015418052673,0.11696053296327591,-0.07953368127346039,0.2846275866031647},{-0.3126734793186188,0.12709100544452667,0.06215955689549446,-0.11752621829509735},{0.3299465775489807,-0.2018236517906189,0.16330082714557648,-0.3325202763080597},{-0.35395926237106323,-0.028984418138861656,-0.47204354405403137,0.44457927346229553},{0.37416234612464905,0.3032738268375397,0.055313270539045334,-0.277921199798584},{0.04114183783531189,0.41740867495536804,0.13951100409030914,0.02651830017566681},{0.07332660257816315,0.3594522178173065,-0.03848131746053696,0.25244829058647156},{-0.13136187195777893,-0.15166538953781128,-0.3285674452781677,-0.10358602553606033},{-0.42380818724632263,0.1266670525074005,-0.3011130690574646,-0.3965645134449005},{0.2779344618320465,-0.1034044399857521,-0.24726463854312897,-0.1628131866455078},{-0.3201877176761627,-0.035560399293899536,0.20458699762821198,-0.23050782084465027},{0.38179612159729004,-0.06936229765415192,-0.00381415244191885,0.08516421914100647},{0.12439320981502533,-0.3784535229206085,-0.07195750623941422,0.30504363775253296},{-0.1715323030948639,-0.45356762409210205,-0.18451537191867828,-0.2641255855560303},{0.12738589942455292,-0.3700626492500305,-0.30168792605400085,-0.3197956681251526},{0.014956893399357796,-0.22579661011695862,0.11217549443244934,0.05384480208158493},{-0.5191757082939148,-0.1377549171447754,0.005259315948933363,-0.040766384452581406},{-0.18436935544013977,0.33102917671203613,0.2506321966648102,-0.3786218762397766},{-0.3025858402252197,0.3190414607524872,0.04049990698695183,0.054077450186014175},{0.3548031151294708,-0.002028570044785738,0.2107849419116974,-0.3254034221172333},{0.19696460664272308,0.16575737297534943,-0.5096914768218994,-0.23900017142295837},{-0.30424708127975464,-0.18402016162872314,-0.15911661088466644,-0.2679944634437561},{0.21138553321361542,0.1653393805027008,-0.02770017646253109,-0.15883824229240417}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.22040529549121857,-0.1466539204120636,0.1892399787902832,-0.21817103028297424,-0.1901068389415741,0.13378313183784485,0.12091874331235886,-0.21086233854293823,-0.014489814639091492,-0.04410891979932785,-0.08679689466953278,-0.15966768562793732,-0.05363382026553154,-0.03100544586777687,-0.061328593641519547,0.19365344941616058};
static const float actor_encoder_self_encoder_2_bias[16] = {0.00630329642444849,0.16272330284118652,0.038941461592912674,0.0038277306593954563,0.09975513070821762,-0.002819886663928628,-0.09740417450666428,0.07092902064323425,-0.02063850127160549,-0.004543913993984461,0.03676502779126167,0.05145984888076782,-0.0006007060874253511,0.13331346213817596,0.07021328061819077,-0.035310447216033936};
static const float actor_encoder_feed_forward_0_bias[24] = {-0.030021797865629196,-0.0026677187997847795,0.04912256821990013,-0.04226897284388542,-0.01869455724954605,0.01833437755703926,0.03844929113984108,0.011606065556406975,-0.002563219517469406,0.0016611572355031967,-0.026211680844426155,-0.017758909612894058,-0.047561582177877426,-0.058739885687828064,-0.022507743909955025,-0.009678322821855545,0.0061150724068284035,0.000725701218470931,-0.02931334264576435,0.024467425420880318,-0.044961608946323395,-0.1158091351389885,0.019145125523209572,-0.011865612119436264};
static const float action_parameterization_distribution_linear_bias[4] = {-0.02715032547712326,0.024989381432533264,0.011556586250662804,0.01564881205558777};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{0.16295716166496277,-0.507358193397522,0.06600730121135712,0.04716872423887253,-0.18719370663166046,0.15897414088249207,0.3121720552444458,0.15052686631679535},{0.119113489985466,0.13613471388816833,0.2838198244571686,-0.4099837839603424,-0.3201504349708557,0.024414822459220886,-0.2948066294193268,0.07161305099725723},{-0.48322397470474243,-0.4712589681148529,0.6832168102264404,-0.17556938529014587,-0.5305506587028503,0.15939456224441528,-0.48190805315971375,0.47766801714897156},{0.025324640795588493,-0.3994416892528534,-0.16332286596298218,0.051235850900411606,0.01383639220148325,-0.08095542341470718,0.13811740279197693,0.3865443468093872},{-0.28996002674102783,-0.3990990221500397,0.03595763444900513,-0.31118619441986084,0.4193413555622101,-0.25411492586135864,-0.14905589818954468,-0.5648403167724609},{-0.5278358459472656,-0.3392084538936615,0.48639485239982605,0.03820868209004402,-0.34977033734321594,0.0606159083545208,-0.1104871854186058,0.40375345945358276},{-0.2731460928916931,0.20755338668823242,-0.18999210000038147,0.06356881558895111,0.19714675843715668,-0.46323102712631226,-0.18937857449054718,0.24784639477729797},{-0.215876504778862,0.19473622739315033,0.6195881962776184,-0.35991036891937256,0.04950227588415146,0.32941949367523193,-0.09523090720176697,-0.20327046513557434},{0.08731405436992645,0.4680059552192688,0.21955138444900513,0.10312549024820328,-0.5330628752708435,0.23757940530776978,-0.3580641448497772,-0.2685476243495941},{0.11696051061153412,0.03515186533331871,0.07545154541730881,-0.5594332814216614,-0.5468557476997375,-0.0645056962966919,0.18593145906925201,0.18772044777870178},{-0.31336209177970886,-0.43381479382514954,0.2592071294784546,-0.13382720947265625,0.3970068395137787,0.25404712557792664,0.2802696228027344,-0.14241452515125275},{-0.16743265092372894,-0.11408466100692749,0.5517377853393555,-0.4076262414455414,0.2754400372505188,0.2931828498840332,0.4074852764606476,-0.0968092754483223},{0.1586526781320572,0.017017405480146408,0.367362916469574,-0.36629268527030945,-0.14994144439697266,0.18915797770023346,-0.40920206904411316,-0.17512093484401703},{0.06122145056724548,-0.182022824883461,0.06916768848896027,-0.0038468348793685436,-0.05347954481840134,0.48131299018859863,-0.09881918132305145,0.32189449667930603},{0.3484184443950653,0.15237581729888916,0.2904461622238159,0.23173537850379944,0.34097275137901306,0.34182554483413696,0.011224925518035889,0.25779372453689575},{-0.39394211769104004,0.27189427614212036,0.07777423411607742,-0.3737439811229706,0.17167823016643524,-0.4757882356643677,-0.2220308929681778,-0.07794316112995148}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.2056421935558319,-0.5341627597808838,-0.21594785153865814,0.33710163831710815,-0.18447349965572357,0.1964716613292694,0.347603976726532,-0.5650607347488403},{-0.45630475878715515,0.4971696138381958,-0.5211187601089478,0.2539748549461365,-0.5524550676345825,-0.35632044076919556,0.036811135709285736,-0.28012320399284363},{-0.036237429827451706,-0.12286250293254852,0.011408146470785141,-0.5676700472831726,-0.02729768306016922,0.06565529853105545,0.09609539061784744,0.21604755520820618},{0.09421157836914062,0.40960589051246643,-0.07422774285078049,0.28611671924591064,-0.4724999666213989,-0.32509514689445496,-0.5638428926467896,0.3100592792034149},{0.1791304498910904,0.03653046861290932,0.24743784964084625,0.4487071633338928,0.11355763673782349,-0.2918502390384674,-0.24237269163131714,-0.2531072497367859},{-0.2946861982345581,-0.5118973851203918,-0.09084784239530563,0.08438298851251602,-0.5692463517189026,0.3116947412490845,-0.06938311457633972,-0.3360697329044342},{-0.026478979736566544,0.47225135564804077,0.29733511805534363,0.014576931484043598,0.564681351184845,0.5221911072731018,0.2007005214691162,-0.10981398820877075},{0.5546126365661621,-0.5589516758918762,-0.48801854252815247,-0.09167435765266418,0.5569065809249878,-0.3998233675956726,0.14664335548877716,0.17398247122764587}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.042539529502391815,-0.03839420899748802,0.08166205137968063,-0.1007147878408432,-0.06023435294628143,-0.1028817668557167,-0.08528842777013779,-0.02887941338121891};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.004931771196424961,0.004521622322499752,0.006609621923416853,-0.055957719683647156,0.026495179161429405,-0.07927264273166656,0.0007625511498190463,0.012544989585876465};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

