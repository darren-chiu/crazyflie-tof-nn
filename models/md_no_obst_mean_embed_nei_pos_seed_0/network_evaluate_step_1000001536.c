#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.18158188462257385,0.28137847781181335,0.09754810482263565,-0.11591072380542755,0.07316836714744568,-0.1871565580368042,-0.008922469802200794,-0.5950897336006165,-0.14275483787059784,-0.004229618236422539,-0.05634588748216629,0.06880366802215576,-0.401186466217041,0.07376773655414581,0.021113799884915352,-0.4434594213962555},{0.026766764000058174,0.11148146539926529,0.04881006479263306,-0.2329288125038147,0.23527851700782776,0.08789462596178055,0.09005039185285568,0.08424770832061768,-0.07506462931632996,0.055351804941892624,-0.33338403701782227,0.1279401034116745,0.11216220259666443,0.07218389213085175,0.08156519383192062,-0.15054480731487274},{-0.2033688724040985,-0.3652125298976898,0.2578631043434143,-0.14014501869678497,-0.2675098180770874,0.30787667632102966,-0.4841044545173645,0.507684051990509,-0.5957035422325134,-0.535336434841156,-0.37744641304016113,-0.2930199205875397,-0.38069435954093933,0.1382203996181488,-0.47272250056266785,-0.6822687983512878},{-0.3676500916481018,-0.06379842013120651,0.011107826605439186,0.24330727756023407,0.1446434110403061,-0.049243323504924774,0.2501615881919861,-0.226042240858078,-0.279207706451416,0.09157679975032806,-0.20880736410617828,0.06137651577591896,-0.14885735511779785,0.2657066583633423,-0.22963562607765198,-0.09554142504930496},{0.16037993133068085,-0.030338935554027557,0.12372472137212753,-0.26001355051994324,0.23420679569244385,0.39951714873313904,-0.11367225646972656,-0.10026746243238449,0.02661614678800106,0.25945889949798584,-0.03706219792366028,0.0863548070192337,0.23577043414115906,0.14034636318683624,-0.27681049704551697,-0.34501293301582336},{0.1470513492822647,0.08895913511514664,0.18782110512256622,-0.1857346147298813,-0.3016698658466339,0.004600801505148411,-0.3283252716064453,0.0975535586476326,-0.19967757165431976,0.17647674679756165,-0.10594413429498672,-0.372467577457428,-0.1684851050376892,0.10329721122980118,-0.4101322293281555,-0.09448838979005814},{-0.48688045144081116,-0.3109918236732483,0.19717206060886383,-0.2797546982765198,-0.17907926440238953,0.013000709936022758,0.19592070579528809,0.2765580117702484,-0.21232494711875916,-0.0025344686582684517,-0.06749957799911499,-0.06717616319656372,-0.26267343759536743,-0.09331823885440826,0.22446413338184357,0.011129135265946388},{0.12981241941452026,0.22013352811336517,0.10750181972980499,0.08164719492197037,-0.26616933941841125,0.39042896032333374,0.3224957585334778,0.2060006856918335,-0.13959366083145142,0.18226227164268494,0.13798870146274567,0.3650071918964386,-0.4656836688518524,-0.406490296125412,-0.06380842626094818,0.3144707977771759},{-0.5982176661491394,0.07675688713788986,0.16357026994228363,0.0581115186214447,0.11810553818941116,0.14640851318836212,0.2750926613807678,-0.2709866762161255,-0.36863985657691956,-0.12048797309398651,0.025187218561768532,0.38139238953590393,0.0795486643910408,0.22790147364139557,0.45436495542526245,0.04181034862995148},{0.4471929967403412,0.2404143512248993,-0.33229371905326843,-0.07021893560886383,0.21065804362297058,-0.03000684641301632,-0.390603631734848,-0.37047645449638367,-0.29630836844444275,0.2986082136631012,-0.03689730912446976,0.33146145939826965,-0.22926536202430725,0.48741212487220764,-0.3677745759487152,0.005055565387010574},{0.33131951093673706,-0.12458823621273041,0.11066080629825592,0.4103566110134125,-0.17251233756542206,0.35383376479148865,0.21696871519088745,0.415399968624115,-0.06565608829259872,-0.2194555699825287,-0.27346667647361755,0.07196181267499924,-0.19458892941474915,-0.3510189354419708,-0.27462175488471985,0.09734601527452469},{0.1837528496980667,-0.14627136290073395,0.006731295492500067,-0.6441020369529724,0.25175076723098755,0.041705790907144547,-0.1323098987340927,-0.13786277174949646,-0.23142388463020325,-0.3940054178237915,-0.8537236452102661,-0.2246793508529663,0.010097043588757515,-0.05373067036271095,0.44457557797431946,0.001966264797374606},{0.24063746631145477,-0.7055081129074097,-0.39706185460090637,-0.07472845911979675,0.4042305052280426,0.05698109790682793,0.18624842166900635,-0.2879166007041931,0.20612052083015442,-0.7011570334434509,0.037101853638887405,-0.5299229025840759,0.59540194272995,-0.9051833748817444,-0.34172001481056213,-0.24617569148540497},{0.024987736716866493,-0.17125335335731506,-0.7809091210365295,0.7122177481651306,-0.1793021708726883,-0.1348962038755417,-0.05954137444496155,-0.08440359681844711,-0.09310712665319443,-0.05897601321339607,0.27161601185798645,-0.1639947146177292,-0.48598772287368774,0.018499203026294708,0.2510204017162323,-0.35821694135665894},{-0.17546434700489044,0.11275088042020798,-0.19500479102134705,0.21084409952163696,0.3109208643436432,-0.19818004965782166,0.2228589504957199,-0.013146912679076195,0.034165579825639725,0.09213832020759583,0.2994706928730011,0.09315352886915207,-0.016262870281934738,-0.261508047580719,0.04361947625875473,0.08023238927125931},{-0.16515623033046722,0.1509191393852234,-0.17472095787525177,0.2739429771900177,-0.012121091596782207,-0.34888410568237305,0.2547052204608917,0.2044500857591629,-0.13973397016525269,-0.08558806031942368,0.099334716796875,-0.01693774200975895,-0.20813190937042236,-0.18669700622558594,-0.22914408147335052,-0.22462815046310425},{-0.23559053242206573,0.20516414940357208,0.058161087334156036,-0.002609750721603632,-0.22085966169834137,0.07978453487157822,-0.23174652457237244,0.20762763917446136,-0.16612109541893005,0.11671793460845947,-0.008823591284453869,0.2856823801994324,0.19693338871002197,0.321353554725647,0.4186650216579437,-0.26653653383255005},{0.2098924070596695,-0.30699095129966736,-0.1039561927318573,-0.009462177753448486,-0.4391738176345825,-0.21497900784015656,-0.2685447931289673,-0.316191703081131,-0.15799513459205627,0.0373523086309433,-0.22579579055309296,0.036166854202747345,0.09260724484920502,0.14776016771793365,-0.0359991081058979,-0.18582338094711304}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.194600448012352,0.29798033833503723,0.00475047342479229,0.4879154562950134,0.1592542976140976,-0.08670055866241455,-0.2138466089963913,-0.3778567314147949,-0.15298299491405487,-0.21076509356498718,0.22238002717494965,0.013655422255396843,0.35372406244277954,0.0508703887462616,-0.3645193576812744,-0.2744474709033966},{-0.23141436278820038,0.18794670701026917,-0.23632757365703583,0.007541036698967218,0.10121091455221176,0.029385901987552643,-0.48252302408218384,0.15164734423160553,0.20494455099105835,0.08790036290884018,0.013759822584688663,0.016476605087518692,-0.15956205129623413,-0.1277545988559723,-0.3013918697834015,-0.15561699867248535},{0.4615767002105713,0.3238600790500641,-0.3342922627925873,-0.5755972862243652,0.2850494086742401,-0.2803911566734314,-0.605352520942688,0.1621086448431015,0.42177414894104004,-0.2636343836784363,0.17434126138687134,-0.2929258346557617,-0.07580775767564774,-0.09990891814231873,0.3463129997253418,0.43288540840148926},{0.31231746077537537,-0.09720825403928757,-0.25103598833084106,0.3277079164981842,-0.2713267505168915,0.3026149272918701,0.16654446721076965,-0.08371435105800629,-0.06124778091907501,0.28517189621925354,0.3390743136405945,-0.4165751338005066,0.13324280083179474,-0.27753496170043945,-0.4339224398136139,-0.011086923070251942},{0.007619180716574192,0.17436029016971588,0.005280605051666498,-0.06896423548460007,0.06628075242042542,-0.01538027822971344,-0.24377228319644928,0.23291155695915222,-0.10641974210739136,-0.28196486830711365,-0.2342107892036438,0.19385971128940582,0.2200818657875061,-0.16322068870067596,0.2103278487920761,0.06969510763883591},{0.39190658926963806,0.006036793347448111,-0.1891367882490158,-0.13408352434635162,0.17816661298274994,0.1954793483018875,-0.15408267080783844,-0.2876029908657074,-0.05450849235057831,0.2257244884967804,-0.13349772989749908,-0.026924535632133484,-0.27097296714782715,0.3701687455177307,0.18356746435165405,-0.16581423580646515},{0.2341843694448471,-0.33622196316719055,-0.38231104612350464,-0.20649293065071106,0.03749856725335121,0.23706085979938507,-0.2442268580198288,0.09892286360263824,0.04759950935840607,0.14182932674884796,-0.010171689093112946,0.31321975588798523,0.3127860724925995,-0.12725675106048584,0.23003873229026794,0.18242767453193665},{-0.21941646933555603,0.36682844161987305,-0.11347542703151703,0.3997451364994049,0.1859341859817505,-0.01342681236565113,0.42410191893577576,0.4650925099849701,-0.06142377480864525,-0.23229242861270905,0.20647341012954712,-0.40348872542381287,-0.08570351451635361,-0.07382674515247345,-0.11895424127578735,-0.07831117510795593},{0.028034940361976624,-0.28208646178245544,0.05442966893315315,0.24368762969970703,0.10161073505878448,0.21709267795085907,0.06493046879768372,0.3924040198326111,-0.013010989874601364,0.14098034799098969,-0.2504000663757324,-0.06712502241134644,0.32823193073272705,-0.4827931821346283,0.3541867434978485,0.016603831201791763},{-0.092416912317276,-0.06671258807182312,-0.20814646780490875,0.18145669996738434,-0.2880215346813202,-0.04922156408429146,0.35579463839530945,0.22662366926670074,0.20076540112495422,-0.1559467315673828,-0.10893036425113678,0.013691790401935577,-0.2398119568824768,0.052246034145355225,-0.36751604080200195,-0.007266291417181492},{-0.10043147951364517,-0.2588910460472107,0.197392076253891,0.24969817698001862,-0.13403937220573425,-0.22167055308818817,0.3266390562057495,-0.1401834636926651,-0.11359883844852448,0.07678041607141495,-0.005368589423596859,-0.29459479451179504,-0.36857134103775024,-0.571718692779541,-0.2768412232398987,-0.05166945233941078},{-0.003464584005996585,-0.4719495177268982,0.2334570735692978,-0.22327721118927002,0.12720684707164764,0.1830674260854721,-0.3027215600013733,-0.273396372795105,0.17522014677524567,0.08056269586086273,-0.5571539998054504,0.3722016513347626,-0.21966898441314697,-0.12365659326314926,0.26328346133232117,0.08477089554071426},{-0.10441668331623077,0.0754716694355011,-0.25210875272750854,0.10874778032302856,0.14203576743602753,0.02075198106467724,0.4147183895111084,-0.26009881496429443,-0.14215168356895447,-0.11411342769861221,-0.33824422955513,0.4380263090133667,0.3832652270793915,0.16028808057308197,0.14175944030284882,0.27908313274383545},{-0.3341711163520813,0.02483900636434555,0.3085249066352844,-0.34417861700057983,0.3356720805168152,-0.4383925199508667,-0.043699294328689575,-0.27506309747695923,0.2575359642505646,0.21748657524585724,0.2913843095302582,0.42821046710014343,-0.13163979351520538,-0.1905679702758789,-0.27370819449424744,0.2042781412601471},{-0.11846547573804855,-0.1823166310787201,-0.2626660466194153,0.1979929655790329,-0.20982033014297485,0.5023486018180847,0.2840237617492676,0.21063053607940674,0.20677483081817627,-0.010817984119057655,-0.11836310476064682,-0.16455265879631042,0.23041392862796783,0.1327051818370819,-0.06265950202941895,0.11832267791032791},{-0.13725391030311584,0.3090873062610626,-0.03474787622690201,-0.11259721964597702,0.04763398692011833,-0.029120266437530518,0.28932464122772217,0.20827887952327728,-0.16073405742645264,-0.15258020162582397,-0.17076361179351807,0.2900720536708832,0.11635632812976837,-0.25099900364875793,-0.3688192665576935,-0.053006209433078766}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.04443007707595825,0.04125543683767319,0.0466797910630703,0.1787799894809723,0.3562740683555603,-0.12146280705928802,-0.0787515938282013,0.06667839735746384,-0.21461589634418488,-0.1139010563492775,-0.0071945711970329285,0.20042815804481506,0.24720169603824615,0.015014768578112125,0.251885324716568,0.11170791834592819,0.19354034960269928,0.10762355476617813,0.04859977588057518,-0.01151353120803833,0.23401284217834473,-0.25069546699523926,-0.2711593508720398,-0.27031010389328003,-0.09821001440286636,0.13237646222114563,-0.2863975465297699,-0.2653263211250305,0.18932154774665833,-0.13365447521209717,-0.3254784941673279,-0.20833653211593628},{0.2471550554037094,0.12050424516201019,0.27266666293144226,0.28820592164993286,0.3836478888988495,-0.007220128085464239,0.20069637894630432,-0.35823628306388855,0.1491088718175888,0.06211167201399803,-0.06740164756774902,-0.23300644755363464,-0.1417199820280075,-0.05398823320865631,-0.2806033492088318,0.3936832547187805,0.14448252320289612,-0.2777138948440552,0.20756879448890686,0.129862442612648,-0.0008635984268039465,0.2804005444049835,-0.20714908838272095,0.18354710936546326,0.09514397382736206,-0.35248443484306335,-0.20410875976085663,0.34560468792915344,-0.25124379992485046,0.0031708793248981237,0.32110831141471863,-0.13543224334716797},{0.21604447066783905,-0.03948821499943733,-0.1902921199798584,-0.25514718890190125,-0.24781253933906555,-0.20184914767742157,-0.31366848945617676,0.07496178895235062,-0.3228749930858612,-0.1488189548254013,0.18135137856006622,0.3013288974761963,0.1787390559911728,-0.08916778862476349,-0.20687852799892426,0.16828878223896027,0.2897675037384033,-0.19134914875030518,-0.11022991687059402,0.19172140955924988,-0.2511039972305298,-0.0374814048409462,-0.007083135657012463,-0.03027665987610817,-0.033780477941036224,0.2965027987957001,-0.29484429955482483,0.20286516845226288,-0.39783886075019836,-0.14850716292858124,0.009334216825664043,0.02981562539935112},{0.19191549718379974,-0.28534287214279175,-0.10078751295804977,0.20668314397335052,0.052641890943050385,-0.10764975100755692,0.3409418761730194,0.07826849818229675,0.1056036576628685,-0.07577823102474213,0.0016427611699327826,-0.08451928943395615,0.29649069905281067,0.12919829785823822,-0.19476839900016785,-0.20529988408088684,-0.16313326358795166,0.12678059935569763,0.1471976935863495,-0.043656907975673676,0.016813227906823158,0.3381476104259491,-0.039212994277477264,-0.22411121428012848,0.037564121186733246,0.10569846630096436,0.11121856421232224,0.03515740856528282,-0.3102506697177887,-0.29223859310150146,0.09079302102327347,0.18401402235031128},{-0.03331697732210159,0.10198406875133514,0.02184566669166088,0.01910153403878212,0.15949790179729462,0.2096848338842392,0.11264979839324951,-0.14759673178195953,-0.0505981370806694,0.05880100280046463,-0.07936526834964752,0.05790259316563606,-0.16710861027240753,0.18880586326122284,0.06615228205919266,0.31585294008255005,0.094734787940979,0.010374912060797215,0.12476510554552078,0.10505720227956772,0.1750052124261856,-0.05005098879337311,-0.2698100507259369,-0.2125711888074875,0.056556642055511475,0.16962450742721558,0.16195660829544067,0.03474574536085129,0.15053005516529083,-0.21156024932861328,-0.2512546479701996,0.2499704360961914},{-0.29459813237190247,0.24479949474334717,0.02935533970594406,-0.012796151451766491,-0.357835590839386,-0.24264951050281525,-0.1473880261182785,0.057298704981803894,0.18121567368507385,-0.15270601212978363,0.05728942155838013,-0.35518014430999756,-0.18259255588054657,0.019747182726860046,0.07423488050699234,-0.2081966996192932,-0.1543029099702835,0.001358653069473803,0.013295485638082027,-0.30197468400001526,0.20759017765522003,-0.07293471693992615,0.046526771038770676,-0.20253098011016846,0.12305131554603577,0.09613006561994553,-0.05267538130283356,0.14326095581054688,0.06713560968637466,0.012406716123223305,-0.25864726305007935,-0.21087981760501862},{0.018793733790516853,-0.0959286019206047,0.05705571174621582,-0.229827880859375,-0.18502826988697052,0.1093059852719307,-0.3271183967590332,-0.08646634966135025,-0.1390884518623352,0.2338317334651947,-0.2299099713563919,0.02381778135895729,0.28050360083580017,0.030137062072753906,-0.32873573899269104,-0.2233862578868866,0.03454723209142685,0.13323324918746948,0.1111273318529129,0.2566273808479309,-0.21710024774074554,0.14280731976032257,0.0061539821326732635,0.08553054183721542,0.24705825746059418,-0.1017337441444397,-0.027216965332627296,0.3093588352203369,0.005662892479449511,-0.2560999393463135,-0.3715513050556183,0.27656054496765137},{0.07081513106822968,0.19655710458755493,0.1279507428407669,0.1283181607723236,-0.14454345405101776,-0.348589688539505,0.17264975607395172,-0.21983376145362854,-0.07678772509098053,-0.2283433973789215,0.2518783211708069,-0.09337610751390457,-0.045265551656484604,-0.07787981629371643,0.286904513835907,0.09791786223649979,0.07781817764043808,0.0001799122546799481,-0.316951721906662,0.09190557897090912,-0.2564760744571686,0.006298097316175699,-0.18316060304641724,0.2111882120370865,0.05637625977396965,-0.020865069702267647,0.2099369913339615,0.028445476666092873,0.03519353270530701,-0.18661551177501678,-0.15292444825172424,0.29751887917518616},{0.15614156424999237,0.37159520387649536,-0.19939792156219482,0.30726638436317444,0.03973580151796341,0.11172258853912354,0.41096460819244385,-0.30573463439941406,-0.06381503492593765,-0.05150529742240906,0.1721879243850708,-0.10730043798685074,-0.034443385899066925,0.2226022332906723,-0.10719321668148041,0.19073739647865295,0.21826492249965668,0.2181115597486496,0.18862222135066986,0.23051708936691284,-0.264516144990921,-0.17509523034095764,0.06771249324083328,0.19674159586429596,0.10749121010303497,0.327754408121109,-0.33302927017211914,-0.3019513189792633,-0.0968281701207161,0.22154879570007324,0.05761261656880379,0.19490967690944672},{0.057307448238134384,-0.026058534160256386,0.014058164320886135,-0.24640943109989166,-0.014732352457940578,-0.3192172944545746,0.09965036064386368,0.2901555001735687,-0.17951622605323792,-0.25584644079208374,0.15920791029930115,-0.08397254347801208,0.016550343483686447,0.047917403280735016,-0.23329931497573853,0.258198082447052,0.07727068662643433,-0.25577953457832336,0.16696156561374664,0.04845229536294937,0.14671944081783295,-0.32738035917282104,0.23689937591552734,-0.14109362661838531,0.1144103929400444,0.2300737202167511,0.3077804446220398,0.24329227209091187,-0.07869427651166916,0.21602745354175568,-0.03174467012286186,-0.013030803762376308},{0.14724403619766235,0.11828066408634186,0.25930055975914,-0.2837821841239929,0.1639266014099121,-0.1767604798078537,-0.04299290478229523,-0.3272055387496948,0.0563114695250988,0.3626249134540558,0.17542704939842224,0.0945451557636261,0.10345695912837982,0.1741638034582138,-0.04622891545295715,0.3170885741710663,-0.08877947181463242,-0.26413190364837646,-0.05008160322904587,-0.009861812926828861,-0.2293061465024948,0.10474678874015808,0.02169184386730194,-0.22578012943267822,-0.131870299577713,-0.21544423699378967,-0.16571536660194397,-0.0037508676759898663,-0.16346107423305511,-0.07509368658065796,0.4552769362926483,0.2975803315639496},{0.3039345145225525,0.06430122256278992,-0.11126571893692017,-0.35383883118629456,-0.2298782616853714,-0.24314019083976746,0.19311246275901794,0.0920838788151741,-0.16586089134216309,0.25314846634864807,-0.37664714455604553,-0.164134219288826,-0.1664506494998932,-0.09272870421409607,-0.10768481343984604,-0.22477363049983978,-0.3609318435192108,-0.2966724932193756,0.06818147003650665,0.12814682722091675,-0.02100672572851181,0.301156222820282,-0.20888473093509674,-0.09152038395404816,0.2056015580892563,0.279750257730484,0.21460658311843872,-0.1548355221748352,-0.11103461682796478,-0.22953210771083832,-0.30864524841308594,0.17007187008857727},{-0.04830441623926163,-0.1020859032869339,-0.10847955197095871,0.025818167254328728,0.21089895069599152,-0.08866940438747406,0.16482336819171906,0.3590483069419861,0.14605924487113953,0.25624310970306396,-0.12325827777385712,-0.33890300989151,0.06987115740776062,0.10594753921031952,0.21487008035182953,0.1464846134185791,-0.366107314825058,-0.21974433958530426,-0.21374507248401642,0.2004203349351883,-0.08193717896938324,-0.2681276500225067,-0.25817692279815674,-0.1130649596452713,0.16650229692459106,0.2695590555667877,0.25415927171707153,0.14157040417194366,-0.17169766128063202,-0.07915206998586655,0.07759727537631989,-0.18084385991096497},{0.30177393555641174,-0.09673634171485901,-0.30797603726387024,-0.10417496412992477,0.04669537395238876,0.03205396234989166,-0.08507799357175827,-0.08579237014055252,0.14204317331314087,0.3613502085208893,-0.3015507459640503,0.26865723729133606,0.2394649237394333,-0.28316500782966614,0.08974646776914597,-0.2325143814086914,-0.08047709614038467,0.13900496065616608,-0.12120696157217026,0.3814117908477783,0.1260068118572235,-0.1335115134716034,-0.23997271060943604,-0.12629671394824982,-0.35409873723983765,0.10463578999042511,-0.009873144328594208,0.24800188839435577,-0.05480285733938217,0.11346039921045303,0.3323708772659302,-0.19659246504306793},{0.18995657563209534,-0.20810513198375702,0.12870527803897858,-0.12233476340770721,-0.23825925588607788,-0.2885720133781433,0.1788272112607956,-0.2345026433467865,0.2018064260482788,0.16172853112220764,-0.13122768700122833,0.15812982618808746,0.006590545177459717,0.11286569386720657,-0.07230426371097565,0.009348967112600803,0.09414871782064438,-0.09184709936380386,-0.0017522069392725825,-0.19733716547489166,0.010691490955650806,-0.2613917589187622,-0.14421026408672333,-0.3481573462486267,0.03504491597414017,-0.1960119754076004,0.08123253285884857,0.1090361624956131,0.14790916442871094,0.06385665386915207,0.01793745346367359,-0.014970079995691776},{0.2322016954421997,-0.14698408544063568,-0.2346295863389969,0.22955948114395142,-0.13147231936454773,0.10504743456840515,0.27647486329078674,-0.2673112154006958,-0.10430878400802612,-0.3116433918476105,-0.2577895522117615,-0.3466416001319885,-0.2590259611606598,-0.2117464244365692,0.057378653436899185,0.3314574658870697,0.3005271255970001,-0.20245350897312164,0.06063954904675484,-0.07479532808065414,-0.07555430382490158,-0.20446589589118958,-0.2070414125919342,0.2512845993041992,-0.11146574467420578,-0.026116523891687393,-0.17633256316184998,-0.0895891785621643,-0.19682861864566803,-0.09612720459699631,-0.2106647491455078,-0.1670505702495575},{0.25551262497901917,0.3654766082763672,-0.17433877289295197,-0.14862166345119476,-0.04491753131151199,0.317417174577713,0.26565468311309814,0.21695576608181,0.021520111709833145,-0.33458271622657776,0.05499269813299179,0.08002764731645584,0.03073197603225708,-0.03601629659533501,0.2127789407968521,0.06205855682492256,-0.239451065659523,0.02329065278172493,-0.21176768839359283,-0.2528376281261444,-0.0007092620944604278,0.10494636744260788,-0.08114027976989746,-0.2448025792837143,-0.07811850309371948,0.09229527413845062,0.1306108683347702,-0.22394396364688873,0.09573245048522949,-0.25305598974227905,0.16566865146160126,-0.20023119449615479},{-0.29356586933135986,-0.1294073462486267,0.16525839269161224,-0.07920481264591217,0.2565189599990845,0.16824385523796082,0.11521519720554352,-0.3084007203578949,-0.06292248517274857,0.17776603996753693,0.23249439895153046,0.2217116355895996,-0.08940022438764572,0.028130315244197845,-0.272434264421463,-0.11234695464372635,0.3053381145000458,-0.1595495194196701,0.04643942415714264,0.16300244629383087,0.2819768488407135,0.17198483645915985,0.11653192341327667,-0.2666335701942444,-0.018333695828914642,0.01971592754125595,0.2309984713792801,0.32934799790382385,-0.0997215136885643,-0.14732098579406738,0.15486618876457214,0.2502134144306183},{0.21486927568912506,-0.20084482431411743,-0.17246323823928833,-0.0180544164031744,0.1127752959728241,0.2246580719947815,-0.34698495268821716,0.04555207118391991,-0.3315938115119934,-0.2169334590435028,0.23821525275707245,-0.031755514442920685,-0.002226742450147867,-0.20708705484867096,-0.029593031853437424,0.007684195414185524,0.2312425822019577,-0.012285150587558746,-0.09358608722686768,0.2527506947517395,0.06353956460952759,-0.07652131468057632,0.11751710623502731,0.25655046105384827,0.040290024131536484,-0.37445947527885437,-0.11261196434497833,0.21224556863307953,-0.14450456202030182,-0.07555113732814789,0.12163019180297852,0.16544495522975922},{0.2087031602859497,0.2355109602212906,0.09989709407091141,-0.11155771464109421,-0.26015785336494446,0.016145221889019012,-0.1209607943892479,0.21678480505943298,0.1039300262928009,-0.00030119039001874626,-0.07838702946901321,0.09029455482959747,0.2240464836359024,0.25212520360946655,-0.09381677955389023,-0.24098192155361176,-0.3644663393497467,0.332540363073349,0.49651819467544556,-0.3306850790977478,-0.21959906816482544,0.26024970412254333,0.22300998866558075,-0.20596617460250854,0.20942002534866333,-0.006551753263920546,0.29870474338531494,0.05407695472240448,0.1154838502407074,-0.03837747871875763,-0.11525077372789383,0.14023438096046448},{-0.27996450662612915,0.018295440822839737,-0.1095268726348877,-0.06232060119509697,-0.07528916001319885,-0.1588762104511261,0.04011203348636627,-0.05859162658452988,-0.181145578622818,0.20099696516990662,0.21668972074985504,-0.02788444422185421,0.055818360298871994,-0.31551384925842285,-0.19661350548267365,0.1835283488035202,-0.22305040061473846,-0.014271174557507038,-0.29588910937309265,-0.01822607032954693,-0.02251284383237362,0.10221797972917557,0.2517583668231964,0.019526585936546326,-0.1741296947002411,-0.07463797926902771,0.013773872517049313,0.2053889036178589,0.09064869582653046,-0.18729817867279053,-0.13015848398208618,-0.00941997580230236},{0.0033901450224220753,0.3011067509651184,0.01994415372610092,0.09591517597436905,0.13823509216308594,0.08354957401752472,0.1299356371164322,0.20059190690517426,-0.33824166655540466,0.023795578628778458,-0.014514520764350891,0.12241259962320328,-0.17385558784008026,0.5760571956634521,-0.002530730329453945,-0.03755943104624748,0.07197451591491699,0.09415046125650406,0.04121267795562744,0.19029057025909424,-0.2580970823764801,0.12134837359189987,-0.014452117495238781,0.275149405002594,0.18685857951641083,0.07639535516500473,0.17851895093917847,-0.17547476291656494,0.2554831802845001,0.2623711824417114,-0.15398715436458588,-0.16132718324661255},{-0.26660871505737305,0.31862425804138184,0.023279331624507904,0.09706415981054306,-0.1177084669470787,0.19529367983341217,0.03256729617714882,0.028398126363754272,0.1455373466014862,-0.2844650447368622,-0.09323236346244812,-0.2441284954547882,-0.14896778762340546,0.11951643973588943,0.02025787904858589,-0.14797942340373993,0.13624727725982666,0.15676787495613098,0.28571179509162903,0.1373414248228073,-0.2416921854019165,-0.28963714838027954,-0.17450587451457977,0.2927558422088623,0.33935508131980896,0.1374819576740265,0.1523275524377823,-0.029428893700242043,0.07364972680807114,-0.004743912722915411,-0.31889548897743225,0.15190106630325317},{-0.1330200433731079,0.004252840299159288,-0.10381312668323517,-0.20401723682880402,0.18188586831092834,0.15129226446151733,0.17458505928516388,-0.1337156891822815,0.2794836759567261,0.20182882249355316,0.19757404923439026,-0.06834228336811066,-0.04548707231879234,-0.036329127848148346,-0.34557226300239563,-0.058348093181848526,-0.18276390433311462,-0.2367473840713501,-0.18592074513435364,-0.29673197865486145,-0.03874518349766731,0.07776076346635818,0.07539137452840805,0.15199394524097443,0.0519857294857502,-0.02845989167690277,0.2321753352880478,-0.30222514271736145,-0.057142965495586395,-0.10605201870203018,0.11988766491413116,0.01188685279339552}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2751453220844269,0.003207223489880562,-0.24907223880290985,-0.1831449568271637},{0.054582446813583374,-0.1268296092748642,-0.012283124960958958,0.25467103719711304},{0.04424135014414787,0.02798638679087162,-0.1271888166666031,-0.043192245066165924},{-0.16792309284210205,0.021063582971692085,0.10276514291763306,0.10117252171039581},{-0.2532951235771179,0.042022861540317535,-0.08865655213594437,-0.24123671650886536},{0.18973778188228607,-0.23956236243247986,-0.2973051369190216,0.08641374856233597},{0.10534118860960007,0.024420002475380898,-0.023975223302841187,0.3408874571323395},{0.32400673627853394,0.26745206117630005,0.07447502762079239,0.10106697678565979},{-0.2655709683895111,0.16446997225284576,0.15645550191402435,0.066957987844944},{-0.1688997596502304,-0.1958882361650467,-0.2213083952665329,-0.25560835003852844},{-0.044873472303152084,0.22964520752429962,-0.2114628404378891,-0.2015961855649948},{-0.15830419957637787,-0.189683198928833,0.15377822518348694,0.13030998408794403},{0.22501824796199799,0.24692894518375397,-0.17592644691467285,-0.3059828579425812},{0.29121726751327515,-0.04147458076477051,-0.10615992546081543,0.13140548765659332},{0.3220255672931671,0.29963189363479614,-0.3268078565597534,-0.29319676756858826},{0.03406317159533501,0.10354787111282349,-0.10599848628044128,0.01217008475214243},{-0.36597302556037903,-0.0759979858994484,-0.2855181396007538,-0.3487788140773773},{-0.067097507417202,0.13464803993701935,0.0809134915471077,0.08791839331388474},{0.06938256323337555,0.3362292945384979,0.22192217409610748,0.08426190912723541},{-0.0907314121723175,-0.23181892931461334,0.12253782898187637,-0.2613239586353302},{0.10403486341238022,0.10134796798229218,-0.1892799288034439,-0.1028895452618599},{-0.10705621540546417,0.18116937577724457,0.24422280490398407,-0.14146634936332703},{0.2701278626918793,-0.03831129148602486,-0.2729867100715637,-0.089291512966156},{0.18502414226531982,0.18183811008930206,-0.17780184745788574,-0.07494775205850601},{0.27824828028678894,0.32944318652153015,0.1944994479417801,0.10463054478168488},{0.17352034151554108,-0.22002775967121124,0.19791382551193237,-0.06558600813150406},{-0.21263590455055237,0.24825698137283325,0.21325130760669708,0.0573204830288887},{-0.10387153923511505,-0.17763172090053558,-0.09955108165740967,-0.3023671507835388},{-0.1686180830001831,0.2055853307247162,-0.19002984464168549,0.24515466392040253},{0.09051650017499924,-0.21709385514259338,-0.3156725764274597,-0.17873823642730713},{-0.04407818242907524,-0.13468721508979797,0.018819376826286316,0.1362619698047638},{0.011244121007621288,0.03086674027144909,-0.25813978910446167,-0.15827292203903198}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05730339139699936,0.09235759824514389,0.06887571513652802,-0.11453472822904587,-0.015003455802798271,0.07710288465023041,-0.03474607318639755,-0.08671612292528152,0.07464128732681274,0.018891263753175735,0.06274646520614624,-0.044106628745794296,0.1626162827014923,0.12493008375167847,-0.06894633173942566,0.02665804699063301};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.005014452151954174,0.04753142222762108,-0.003502404084429145,0.006062863394618034,0.057388294488191605,-0.02513047121465206,0.03195377439260483,-0.01850184053182602,0.03427397087216377,0.0037698959931731224,0.003324125660583377,0.002761522540822625,-0.019989358261227608,-0.02412000671029091,-0.024429848417639732,-0.021526463329792023};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.003101334674283862,0.009905323386192322,0.03112473525106907,-0.001424020971171558,-0.023746227845549583,0.010234368965029716,0.03725083917379379,0.005064812954515219,0.005535345058888197,-0.030292540788650513,-0.06174910068511963,-0.017603471875190735,-0.05169570446014404,0.017094731330871582,0.026217199862003326,-0.031095605343580246,-0.05326404795050621,0.020941566675901413,0.014791755005717278,-0.0016873154090717435,-0.0008789128041826189,0.005205826368182898,0.009929890744388103,0.007271070498973131,0.029023226350545883,-0.008834188804030418,0.001941850408911705,-0.012660359032452106,-0.009132705628871918,0.01499268226325512,0.04818390682339668,-0.007902794517576694};
static const float action_parameterization_distribution_linear_bias[4] = {0.0235745832324028,0.0037503917701542377,0.03187361732125282,0.017785562202334404};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.2000508308410645,1.0885573625564575,-0.38658976554870605,0.8555687665939331,1.0525689125061035,-0.030145728960633278,0.6099240779876709,-0.7079501152038574},{0.4042469561100006,0.7284586429595947,1.4812041521072388,-0.5103665590286255,0.478378564119339,-0.20489603281021118,0.1849924772977829,0.6220625638961792},{0.9971520304679871,0.845956027507782,-0.6248955726623535,0.15041767060756683,-0.3626571595668793,0.7333553433418274,-1.65569269657135,0.14268659055233002}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.4322831332683563,-0.8337498307228088,0.12592121958732605,-0.8835008144378662,1.2206828594207764,-0.7650875449180603,-0.025455357506871223,0.5320286154747009},{0.24933096766471863,-0.21082280576229095,-0.26388928294181824,-0.8414357304573059,-0.4763377606868744,0.5286408066749573,-0.824198305606842,-0.2695135176181793},{-0.26858076453208923,-0.03984583169221878,-0.27839788794517517,-0.5758766531944275,0.9384084939956665,0.9745951294898987,0.6750779747962952,-0.10797078162431717},{-0.24470047652721405,0.380657821893692,-0.5427109599113464,-0.1327226758003235,-1.0531758069992065,0.12113945186138153,-0.2906019687652588,0.6927031874656677},{-0.7088838815689087,0.02213265188038349,0.3103867769241333,0.11088810861110687,-0.7905763983726501,0.6713008880615234,-0.04523814469575882,0.5200421810150146},{0.4225301742553711,-0.49489060044288635,-0.4683873951435089,-0.37377679347991943,0.1131325289607048,0.2504199147224426,-0.5270340442657471,0.1442665010690689},{0.271589994430542,-0.27720192074775696,0.07166848331689835,0.4872918128967285,-0.3928793966770172,1.0273329019546509,0.02688601054251194,0.5097389221191406},{-0.1267230212688446,0.34091660380363464,-0.07026999443769455,-0.3322635591030121,0.9595056772232056,-0.5929190516471863,0.2700754702091217,0.11130804568529129}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.015965862199664116,-0.06854899227619171,-0.02842634543776512,0.005251987371593714,0.021779993548989296,-0.004482683259993792,0.014433383010327816,0.01754467375576496};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.010062948800623417,-0.01990259252488613,-0.00624249828979373,0.0029425674583762884,-0.060770705342292786,0.035765133798122406,0.03814487159252167,-0.01666245423257351};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
