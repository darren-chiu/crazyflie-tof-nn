#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.11588975787162781,0.3190012574195862,0.11179004609584808,-0.10563323646783829,0.07387907058000565,-0.19988895952701569,-0.01844283752143383,-0.5830941796302795,-0.14678683876991272,0.002512518782168627,-0.07293146103620529,0.08172813802957535,-0.399432897567749,0.09762267768383026,0.03484005853533745,-0.39334800839424133},{-0.018259016796946526,0.0815422385931015,0.0698452740907669,-0.23965571820735931,0.26082098484039307,0.0733228325843811,0.09733114391565323,0.0821264237165451,-0.08300265669822693,0.0053184558637440205,-0.3693602979183197,0.12396712601184845,0.10865770280361176,0.07941614091396332,0.0906330943107605,-0.17380470037460327},{-0.2051437497138977,-0.376801997423172,0.24654553830623627,-0.10431534796953201,-0.26170456409454346,0.33196786046028137,-0.46313101053237915,0.5116714239120483,-0.5686293244361877,-0.5258941650390625,-0.3185293674468994,-0.2721293568611145,-0.3398437201976776,0.1371019333600998,-0.45977604389190674,-0.6163079738616943},{-0.3625142276287079,-0.04762537032365799,0.0019931031856685877,0.23773092031478882,0.14049263298511505,-0.03801992908120155,0.27457326650619507,-0.22012163698673248,-0.27222442626953125,0.11341363936662674,-0.20399560034275055,0.0638585090637207,-0.154706671833992,0.26038533449172974,-0.2062545269727707,-0.11980776488780975},{0.13266709446907043,-0.05438729748129845,0.12334959954023361,-0.2720569968223572,0.24574118852615356,0.41556447744369507,-0.11059517413377762,-0.09891504794359207,0.0278332456946373,0.2387029528617859,-0.01803852617740631,0.095856674015522,0.23754416406154633,0.14381162822246552,-0.2720518708229065,-0.36886924505233765},{0.15161541104316711,0.09231576323509216,0.1729574352502823,-0.19036239385604858,-0.3111303448677063,-0.021841851994395256,-0.30700358748435974,0.05938422307372093,-0.19285166263580322,0.2147178202867508,-0.09645015001296997,-0.34477919340133667,-0.13893018662929535,0.09989207237958908,-0.39084261655807495,-0.07373940199613571},{-0.492918461561203,-0.31844383478164673,0.19129568338394165,-0.27517950534820557,-0.16496025025844574,0.003619702998548746,0.20709358155727386,0.2728934586048126,-0.21148306131362915,-0.019433047622442245,-0.05474672093987465,-0.0471983402967453,-0.27540016174316406,-0.09617489576339722,0.21878421306610107,0.013217518106102943},{0.1310538798570633,0.23976045846939087,0.10358938574790955,0.08192536979913712,-0.282168984413147,0.4018658399581909,0.32937249541282654,0.18908071517944336,-0.13884951174259186,0.20011524856090546,0.12685252726078033,0.3622160851955414,-0.4511805474758148,-0.40540823340415955,-0.04668140038847923,0.2986754775047302},{-0.5069228410720825,0.01664540357887745,0.12275970727205276,0.04333657771348953,0.11477585136890411,0.13378670811653137,0.25606411695480347,-0.2430202066898346,-0.3565947115421295,-0.1524769514799118,0.02236483432352543,0.34766045212745667,0.08498515188694,0.1518544703722,0.42527997493743896,0.03591800108551979},{0.4493544399738312,0.22535103559494019,-0.3257105052471161,-0.06867266446352005,0.2286224514245987,-0.03740512207150459,-0.398207426071167,-0.354483962059021,-0.29602763056755066,0.2863549292087555,-0.02628866583108902,0.3305283188819885,-0.24247486889362335,0.4847194254398346,-0.38553541898727417,0.019917462021112442},{0.33358871936798096,-0.13565172255039215,0.10556832700967789,0.4073287546634674,-0.15596778690814972,0.34536078572273254,0.22356677055358887,0.4121653735637665,-0.06876334547996521,-0.2491300404071808,-0.2737867832183838,0.08697906136512756,-0.20558364689350128,-0.35193517804145813,-0.28510937094688416,0.09957592934370041},{0.11539414525032043,-0.08090848475694656,-0.013529683463275433,-0.5402997732162476,0.22385910153388977,-0.0003970603283960372,-0.07760930806398392,-0.20139749348163605,-0.17397230863571167,-0.385224312543869,-0.780273973941803,-0.15908868610858917,0.011943143792450428,-0.11471468955278397,0.4848569929599762,0.02781914360821247},{0.19348987936973572,-0.6705739498138428,-0.3477451503276825,-0.04557875543832779,0.3836415708065033,0.09048377722501755,0.1778292953968048,-0.26944953203201294,0.18321502208709717,-0.648854672908783,0.024587279185652733,-0.5211566686630249,0.554899275302887,-0.8632898330688477,-0.32897141575813293,-0.24100488424301147},{0.014186901040375233,-0.21693186461925507,-0.7473223805427551,0.6871956586837769,-0.19362683594226837,-0.10735571384429932,-0.041283994913101196,-0.05071551725268364,-0.11002349108457565,-0.09077160060405731,0.31448718905448914,-0.17346055805683136,-0.5037936568260193,0.03977840766310692,0.22631177306175232,-0.3937230408191681},{-0.18557848036289215,0.10141215473413467,-0.194097638130188,0.21268588304519653,0.32060492038726807,-0.20622429251670837,0.23238089680671692,-0.013108598068356514,0.03455401957035065,0.07727833092212677,0.30771031975746155,0.10439044237136841,-0.032055191695690155,-0.2649952173233032,0.03353402391076088,0.08192937821149826},{-0.2069665491580963,0.14710846543312073,-0.18669714033603668,0.2858964502811432,-0.004819979425519705,-0.3842104375362396,0.2327965497970581,0.17886507511138916,-0.08510595560073853,-0.09069466590881348,0.08184488117694855,-0.022596297785639763,-0.21635259687900543,-0.21518883109092712,-0.2658872604370117,-0.2292683720588684},{-0.2587026059627533,0.2196987122297287,0.04194347560405731,0.016984807327389717,-0.23963533341884613,0.06888414174318314,-0.2573802173137665,0.1802157163619995,-0.16436783969402313,0.16634371876716614,-0.009245333261787891,0.31970617175102234,0.20928367972373962,0.3219643533229828,0.37305426597595215,-0.26571959257125854},{0.23493558168411255,-0.2832808196544647,-0.12354037910699844,-0.05415258929133415,-0.4369359612464905,-0.20715422928333282,-0.26310425996780396,-0.24156466126441956,-0.192989319562912,0.0046857669949531555,-0.31219667196273804,0.06393089890480042,0.06843268126249313,0.13895098865032196,-0.05403527617454529,-0.18444465100765228}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.17843063175678253,0.2967536747455597,0.008105049841105938,0.47452783584594727,0.1677950918674469,-0.0951642319560051,-0.2030426561832428,-0.39835357666015625,-0.11720935255289078,-0.21363361179828644,0.2242015153169632,0.021612834185361862,0.35672053694725037,0.05474875867366791,-0.3703869879245758,-0.3090602457523346},{-0.26572757959365845,0.20688003301620483,-0.238661989569664,-0.006705387029796839,0.10467677563428879,0.011738908477127552,-0.5046584606170654,0.15290763974189758,0.2576330602169037,0.08390110731124878,0.02238021232187748,0.0039953794330358505,-0.16564899682998657,-0.12972582876682281,-0.290723979473114,-0.12779854238033295},{0.4427761137485504,0.30985671281814575,-0.34499773383140564,-0.5616557002067566,0.3174256682395935,-0.28737303614616394,-0.6009795069694519,0.18464791774749756,0.39469099044799805,-0.2631029486656189,0.1665477156639099,-0.28230682015419006,-0.049358777701854706,-0.09297563135623932,0.3338465988636017,0.4132564067840576},{0.31328973174095154,-0.08882301300764084,-0.24652701616287231,0.3382245898246765,-0.29212287068367004,0.30896493792533875,0.163695827126503,-0.08115606009960175,-0.0956391915678978,0.28524816036224365,0.34831422567367554,-0.4224853217601776,0.12647409737110138,-0.2779202461242676,-0.42571282386779785,0.005557964090257883},{0.04733889177441597,0.19404029846191406,0.008592589758336544,-0.06619095057249069,0.06953475624322891,-0.021533699706196785,-0.2208975851535797,0.2511236071586609,-0.12820012867450714,-0.2852305471897125,-0.2302081286907196,0.19142290949821472,0.22295254468917847,-0.17401409149169922,0.22224828600883484,0.07881882041692734},{0.41428110003471375,0.022053131833672523,-0.20790109038352966,-0.12149509787559509,0.2297719269990921,0.16129378974437714,-0.17683355510234833,-0.2974211573600769,-0.07723993062973022,0.2147815078496933,-0.11481162160634995,-0.04668961465358734,-0.28489628434181213,0.3881242871284485,0.2008802592754364,-0.14915180206298828},{0.23108863830566406,-0.34340253472328186,-0.371925950050354,-0.22118951380252838,0.009804312139749527,0.24856023490428925,-0.26479819416999817,0.06332940608263016,0.06804705411195755,0.15939465165138245,-0.017457548528909683,0.3170507252216339,0.3291584253311157,-0.1318468302488327,0.23870213329792023,0.25077423453330994},{-0.29527923464775085,0.3554295599460602,-0.11162479966878891,0.42077237367630005,0.18925048410892487,-0.005387220066040754,0.38797464966773987,0.4391237795352936,-0.06613396853208542,-0.23946475982666016,0.2121431976556778,-0.40076062083244324,-0.06257014721632004,-0.07893501222133636,-0.11431784927845001,-0.042510416358709335},{0.042480506002902985,-0.2501899003982544,0.05559370294213295,0.26115524768829346,0.11022622883319855,0.19569408893585205,0.05078020691871643,0.390112966299057,-0.014223167672753334,0.13138146698474884,-0.23913118243217468,-0.07143960148096085,0.3487977981567383,-0.4779925048351288,0.3626863360404968,-0.0017565857851877809},{-0.08298664540052414,-0.06657307595014572,-0.2355879843235016,0.197386234998703,-0.2886432409286499,-0.05651039257645607,0.3090671896934509,0.23747515678405762,0.2023545652627945,-0.16793577373027802,-0.14088907837867737,0.01611027866601944,-0.2503003478050232,0.03447144851088524,-0.37527692317962646,0.016267744824290276},{-0.11614298075437546,-0.2359377145767212,0.23318254947662354,0.28922945261001587,-0.15883146226406097,-0.2666735053062439,0.3291397988796234,-0.14668962359428406,-0.1314384937286377,0.0761268138885498,0.01773756369948387,-0.29701119661331177,-0.3611512780189514,-0.5646377801895142,-0.30308255553245544,-0.1020021140575409},{-0.017020434141159058,-0.492662250995636,0.225569486618042,-0.21339130401611328,0.12325011193752289,0.1823558658361435,-0.3629826605319977,-0.3177432119846344,0.204644575715065,0.09909862279891968,-0.5676229596138,0.3880646526813507,-0.2090982049703598,-0.11901212483644485,0.2422451674938202,0.12474899739027023},{-0.08532706648111343,0.08533019572496414,-0.2647467255592346,0.1356576383113861,0.14754517376422882,0.008142624981701374,0.36327460408210754,-0.2867381274700165,-0.145864337682724,-0.10057254135608673,-0.3552682101726532,0.443960577249527,0.41222861409187317,0.17147408425807953,0.11742034554481506,0.3003425896167755},{-0.34499385952949524,0.027424419298768044,0.3190251886844635,-0.33785682916641235,0.36997759342193604,-0.4473952651023865,-0.0353211872279644,-0.2849275767803192,0.24154606461524963,0.2015732079744339,0.29915860295295715,0.42158690094947815,-0.1508481502532959,-0.15704117715358734,-0.30238306522369385,0.2659139633178711},{-0.12091462314128876,-0.17868700623512268,-0.26961368322372437,0.20684075355529785,-0.19993039965629578,0.49488505721092224,0.26716750860214233,0.21699625253677368,0.22564059495925903,-0.010489843785762787,-0.11396520584821701,-0.17845389246940613,0.2333964705467224,0.13844886422157288,-0.07788137346506119,0.13276620209217072},{-0.13039827346801758,0.3122045397758484,-0.029480427503585815,-0.11534663289785385,0.037222977727651596,-0.025692854076623917,0.27021846175193787,0.23388151824474335,-0.18919067084789276,-0.15970249474048615,-0.1809495985507965,0.27593570947647095,0.14482200145721436,-0.2569510340690613,-0.3993099629878998,-0.020951667800545692}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.042078323662281036,0.028548289090394974,0.04957115277647972,0.179963618516922,0.3650233745574951,-0.12689831852912903,-0.09092763066291809,0.06919767707586288,-0.19965024292469025,-0.1189517006278038,0.006846296600997448,0.20118221640586853,0.26315975189208984,-0.013989957980811596,0.2612806260585785,0.10662692040205002,0.19616524875164032,0.101473867893219,0.06000927835702896,-0.019757669419050217,0.25343531370162964,-0.2284773886203766,-0.2700648009777069,-0.25785258412361145,-0.09375672787427902,0.12841147184371948,-0.27129465341567993,-0.2690405249595642,0.20893415808677673,-0.14198480546474457,-0.31180375814437866,-0.20419412851333618},{0.23805014789104462,0.1038704589009285,0.27962684631347656,0.3119947910308838,0.3950139880180359,-0.01246228814125061,0.18408071994781494,-0.36816081404685974,0.16879358887672424,0.0628395825624466,-0.06561687588691711,-0.23055927455425262,-0.16080039739608765,-0.07667288184165955,-0.2854103147983551,0.38467851281166077,0.16352665424346924,-0.2685587704181671,0.19464510679244995,0.14848366379737854,-0.022190647199749947,0.30367639660835266,-0.23861871659755707,0.16630946099758148,0.09675074368715286,-0.35260218381881714,-0.18269647657871246,0.35968202352523804,-0.2573747932910919,0.013452861458063126,0.26332616806030273,-0.13462631404399872},{0.20360274612903595,-0.04273197799921036,-0.18161891400814056,-0.27091822028160095,-0.24458765983581543,-0.19740107655525208,-0.336415559053421,0.08383708447217941,-0.33864450454711914,-0.15591280162334442,0.16223269701004028,0.31324881315231323,0.18511080741882324,-0.08145628124475479,-0.20672279596328735,0.14205054938793182,0.29726412892341614,-0.1823362112045288,-0.12672540545463562,0.2113562375307083,-0.25242897868156433,-0.01554159726947546,-0.01418144442141056,-0.019339220598340034,-0.03723587095737457,0.3240431845188141,-0.2951631247997284,0.21479028463363647,-0.43790024518966675,-0.13743314146995544,-0.023569874465465546,0.034915946424007416},{0.1798797845840454,-0.28921034932136536,-0.11351573467254639,0.21137169003486633,0.05592065677046776,-0.1302228569984436,0.3380878269672394,0.08488649874925613,0.1114886999130249,-0.07583015412092209,-0.010382401756942272,-0.07445427775382996,0.3005647361278534,0.15468323230743408,-0.21296840906143188,-0.21588502824306488,-0.17058661580085754,0.14284351468086243,0.15885823965072632,-0.03849365934729576,-0.00354905822314322,0.344051718711853,-0.05651871860027313,-0.2369675487279892,0.04730221629142761,0.1105118989944458,0.11606733500957489,0.03496181219816208,-0.33069315552711487,-0.3074814975261688,0.09264527261257172,0.16497789323329926},{-0.061978571116924286,0.11255812644958496,-0.008706179447472095,0.06018618494272232,0.1729191690683365,0.20785866677761078,0.12043174356222153,-0.1762189120054245,-0.025314198806881905,0.07321682572364807,-0.1168205738067627,0.08246395736932755,-0.23487380146980286,0.179571270942688,0.03253835812211037,0.27295899391174316,0.09036330133676529,0.017301859334111214,0.1097966879606247,0.14735716581344604,0.13699519634246826,-0.030336854979395866,-0.32004210352897644,-0.2577369213104248,0.03893447667360306,0.18990971148014069,0.18161435425281525,0.047104716300964355,0.1509651392698288,-0.21142621338367462,-0.24035905301570892,0.2299111783504486},{-0.2948535084724426,0.2633860111236572,0.01057394314557314,-0.013936735689640045,-0.36991432309150696,-0.24996916949748993,-0.12668168544769287,0.056032441556453705,0.1846856027841568,-0.1506606787443161,0.04782126471400261,-0.35354408621788025,-0.17877791821956635,0.05125058442354202,0.06539183109998703,-0.2039947658777237,-0.1755029559135437,0.0015925761545076966,0.028757568448781967,-0.3193952143192291,0.20652098953723907,-0.09434651583433151,0.05051496997475624,-0.1997363418340683,0.1258825957775116,0.0913567766547203,-0.05864056199789047,0.13110294938087463,0.08344390988349915,-0.0028155986219644547,-0.21451079845428467,-0.2245197296142578},{0.013099145144224167,-0.11154424399137497,0.04017378389835358,-0.22659501433372498,-0.20313557982444763,0.09896130114793777,-0.3367632031440735,-0.07989466190338135,-0.12777695059776306,0.22570842504501343,-0.22621116042137146,0.03438269719481468,0.2928084135055542,0.030513837933540344,-0.32914334535598755,-0.2237582802772522,0.011269506067037582,0.14191755652427673,0.13706009089946747,0.26262760162353516,-0.231987863779068,0.16073496639728546,0.0036068269982934,0.0840289369225502,0.2709755003452301,-0.08801048249006271,-0.03412238135933876,0.3087741434574127,-0.024137061089277267,-0.2744522988796234,-0.3202078640460968,0.26055848598480225},{0.07833760976791382,0.1804676353931427,0.13502739369869232,0.13745495676994324,-0.14519841969013214,-0.36897268891334534,0.1713487058877945,-0.22100988030433655,-0.06094414368271828,-0.22261345386505127,0.28304263949394226,-0.11196863651275635,-0.03742052987217903,-0.08552617579698563,0.2898816764354706,0.13297303020954132,0.07821431010961533,0.000478332513011992,-0.30487489700317383,0.08025864511728287,-0.268196165561676,0.0014362535439431667,-0.18615461885929108,0.20059660077095032,0.06888627260923386,-0.04706836864352226,0.21053250133991241,0.02907525561749935,0.055016834288835526,-0.19437679648399353,-0.15729616582393646,0.2975122630596161},{0.1805931031703949,0.39677032828330994,-0.18837875127792358,0.2946470379829407,0.022723207250237465,0.14917606115341187,0.4496013820171356,-0.31758520007133484,-0.09183946251869202,-0.03560127690434456,0.17234741151332855,-0.12372070550918579,-0.05194747820496559,0.2411995679140091,-0.09703358262777328,0.2160474807024002,0.22001609206199646,0.21050138771533966,0.16328875720500946,0.21535472571849823,-0.2563541829586029,-0.2205878049135208,0.09072477370500565,0.19855694472789764,0.09086886793375015,0.31520700454711914,-0.35731467604637146,-0.3068814277648926,-0.07454004138708115,0.24954301118850708,0.04896228760480881,0.2087082415819168},{0.07576987892389297,-0.02180591970682144,0.01319889072328806,-0.27992483973503113,-0.03550846129655838,-0.30986467003822327,0.08871325850486755,0.29807087779045105,-0.20637522637844086,-0.2602354884147644,0.14931437373161316,-0.09822532534599304,0.04903385788202286,0.07244697958230972,-0.21394261717796326,0.26444312930107117,0.0641297847032547,-0.26386210322380066,0.1733122169971466,0.03948230296373367,0.16976068913936615,-0.3353591859340668,0.27081021666526794,-0.10570373386144638,0.11997359246015549,0.24830441176891327,0.28274768590927124,0.2474966198205948,-0.09367931634187698,0.21563245356082916,-0.003493092255666852,-0.00660472409799695},{0.14436595141887665,0.12050379067659378,0.2693372666835785,-0.2808683216571808,0.15333569049835205,-0.16574391722679138,-0.06920526921749115,-0.33511462807655334,0.05332070589065552,0.36207830905914307,0.15991313755512238,0.10341410338878632,0.0948471799492836,0.16725830733776093,-0.052612945437431335,0.2983596622943878,-0.06903357058763504,-0.2571996748447418,-0.0783674567937851,0.0040679145604372025,-0.2453819364309311,0.1170254498720169,0.012291692197322845,-0.22957880795001984,-0.13446395099163055,-0.19582882523536682,-0.16097061336040497,0.011696888133883476,-0.185564324259758,-0.05702465400099754,0.41743963956832886,0.2971395254135132},{0.28697308897972107,0.07991374284029007,-0.13910189270973206,-0.34458205103874207,-0.23171284794807434,-0.25286170840263367,0.20910266041755676,0.09236541390419006,-0.16808755695819855,0.24072791635990143,-0.3873675763607025,-0.14655707776546478,-0.18172693252563477,-0.11530078202486038,-0.11504406481981277,-0.23243631422519684,-0.37535884976387024,-0.314950555562973,0.08454924821853638,0.1397106945514679,-0.022418292239308357,0.2916906774044037,-0.19681701064109802,-0.10538098216056824,0.19648246467113495,0.2881177067756653,0.20678220689296722,-0.17030981183052063,-0.11553122848272324,-0.25083714723587036,-0.2569209337234497,0.16054685413837433},{-0.05742230638861656,-0.10136880725622177,-0.13135866820812225,0.02493794448673725,0.21547137200832367,-0.11144131422042847,0.1659318506717682,0.37957268953323364,0.1477261334657669,0.235251322388649,-0.13113826513290405,-0.33680930733680725,0.08422316610813141,0.12774474918842316,0.21203020215034485,0.1404256522655487,-0.3819608688354492,-0.23247185349464417,-0.1796719878911972,0.2072511613368988,-0.08236181735992432,-0.26429483294487,-0.25574252009391785,-0.11296387016773224,0.18191760778427124,0.2844568192958832,0.2561914622783661,0.12914733588695526,-0.18927247822284698,-0.10621586441993713,0.07796413451433182,-0.19540254771709442},{0.29777562618255615,-0.061897240579128265,-0.3023546040058136,-0.09360258281230927,0.03119583986699581,0.06260759383440018,-0.05339694395661354,-0.08841817826032639,0.14237764477729797,0.3491986393928528,-0.3205870985984802,0.27534225583076477,0.21847781538963318,-0.268123596906662,0.08381455391645432,-0.2404244840145111,-0.08217129856348038,0.15603330731391907,-0.13481378555297852,0.3665376603603363,0.13245439529418945,-0.14742128551006317,-0.24095293879508972,-0.11776290833950043,-0.35409271717071533,0.1001516804099083,0.0018794495845213532,0.22565147280693054,-0.03346627578139305,0.12605412304401398,0.3189164996147156,-0.1977643519639969},{0.18056626617908478,-0.1895642727613449,0.1205892488360405,-0.11237121373414993,-0.22443944215774536,-0.2928121089935303,0.1902845799922943,-0.2425752878189087,0.21593594551086426,0.16197684407234192,-0.14585410058498383,0.17376109957695007,-0.011860156431794167,0.10246682167053223,-0.0846993699669838,-0.01688205637037754,0.08719877898693085,-0.0893118754029274,0.0016008010134100914,-0.1938949078321457,0.015649734064936638,-0.2495076060295105,-0.15823759138584137,-0.35482367873191833,0.02746342308819294,-0.19440633058547974,0.10549132525920868,0.09949581325054169,0.17455382645130157,0.0574999637901783,0.039148975163698196,-0.02502891607582569},{0.2392546385526657,-0.15996792912483215,-0.25522395968437195,0.23149611055850983,-0.1296120136976242,0.10349051654338837,0.2705245912075043,-0.2811819612979889,-0.09979663789272308,-0.3004274368286133,-0.24684911966323853,-0.34551113843917847,-0.2631494700908661,-0.23651835322380066,0.06462709605693817,0.3315751254558563,0.29245635867118835,-0.21981710195541382,0.07119240611791611,-0.05839787796139717,-0.07748177647590637,-0.20073412358760834,-0.19634529948234558,0.24321915209293365,-0.11663545668125153,-0.016752200201153755,-0.1855122447013855,-0.08157069981098175,-0.2050105333328247,-0.10633005946874619,-0.1625356376171112,-0.16965223848819733},{0.25605884194374084,0.3677612245082855,-0.1856600046157837,-0.1533033698797226,-0.03973843902349472,0.3027466833591461,0.27495771646499634,0.2201598584651947,0.016917759552598,-0.3385425806045532,0.06596710532903671,0.06851229816675186,0.04055556282401085,-0.0593550018966198,0.20550264418125153,0.0814187303185463,-0.23119129240512848,0.015497359447181225,-0.18267813324928284,-0.27171996235847473,0.008028121665120125,0.10758646577596664,-0.07063799351453781,-0.24459922313690186,-0.07510068267583847,0.07628079503774643,0.14437124133110046,-0.2280816286802292,0.11365722864866257,-0.25748389959335327,0.13168150186538696,-0.20395779609680176},{-0.3011852502822876,-0.15627169609069824,0.17267455160617828,-0.06630454212427139,0.27009937167167664,0.14701184630393982,0.09322352707386017,-0.28990626335144043,-0.037117451429367065,0.16088059544563293,0.23713845014572144,0.20304666459560394,-0.089301697909832,0.044115930795669556,-0.25974240899086,-0.1257133185863495,0.295470267534256,-0.12281981855630875,0.04726846516132355,0.17087899148464203,0.2736586928367615,0.20903624594211578,0.09317054599523544,-0.2653569281101227,0.0017502667615190148,0.018663471564650536,0.25947538018226624,0.32476216554641724,-0.10982705652713776,-0.16784949600696564,0.11942674219608307,0.25479990243911743},{0.21705636382102966,-0.18964463472366333,-0.15829609334468842,-0.011589755304157734,0.09178609400987625,0.23203203082084656,-0.3236243426799774,0.06184900179505348,-0.32759422063827515,-0.24621440470218658,0.2400660216808319,-0.0265071839094162,-0.001506964908912778,-0.21225324273109436,-0.009054227732121944,0.006179631222039461,0.22299069166183472,0.02909526228904724,-0.087257020175457,0.2219839245080948,0.07815377414226532,-0.05727023631334305,0.11550924926996231,0.2692122161388397,0.06568285077810287,-0.39040815830230713,-0.08407005667686462,0.1782454252243042,-0.10830918699502945,-0.08061360567808151,0.08925347775220871,0.17296622693538666},{0.19964633882045746,0.2303301841020584,0.10284779220819473,-0.09880691021680832,-0.2514667809009552,0.007940530776977539,-0.13748577237129211,0.2142113596200943,0.11680731177330017,-0.0012697847560048103,-0.08609875291585922,0.09130039066076279,0.21092639863491058,0.268091082572937,-0.09783541411161423,-0.2608683705329895,-0.359129935503006,0.3558933734893799,0.4760293960571289,-0.31480926275253296,-0.23767809569835663,0.28164783120155334,0.20606690645217896,-0.22364303469657898,0.2088940292596817,-0.004631363786756992,0.31407156586647034,0.05756795033812523,0.11006763577461243,-0.04017115756869316,-0.14008888602256775,0.14246152341365814},{-0.2938057780265808,0.02156747691333294,-0.14350120723247528,-0.05533260107040405,-0.08638643473386765,-0.16901130974292755,0.03488938882946968,-0.07646077871322632,-0.18676917254924774,0.20384851098060608,0.19794192910194397,0.005368929821997881,0.043091755360364914,-0.36959603428840637,-0.21844419836997986,0.16662515699863434,-0.2242705225944519,-0.02821463905274868,-0.29375821352005005,0.001259182346984744,-0.03427107259631157,0.11199352145195007,0.24218592047691345,0.004776518326252699,-0.1840323954820633,-0.051661912351846695,0.018055126070976257,0.21712686121463776,0.07827349752187729,-0.1930377036333084,-0.11008787155151367,-0.02653028443455696},{0.006589672062546015,0.3217119872570038,0.031860265880823135,0.09931443631649017,0.12157023698091507,0.10924381017684937,0.1410720944404602,0.1953921914100647,-0.34427186846733093,0.026839274913072586,-0.03561822697520256,0.14028328657150269,-0.1927701234817505,0.6179704070091248,-0.002703659236431122,-0.05625901371240616,0.059048980474472046,0.09529244899749756,0.00958880502730608,0.2017417699098587,-0.269488126039505,0.09629839658737183,-0.010646633803844452,0.27223747968673706,0.1755063682794571,0.09425031393766403,0.1505706012248993,-0.1768990308046341,0.24702541530132294,0.27404096722602844,-0.11611124128103256,-0.16105225682258606},{-0.25882163643836975,0.30663764476776123,0.030542680993676186,0.0971657782793045,-0.12760710716247559,0.18823982775211334,0.02602599933743477,0.045208100229501724,0.1467982679605484,-0.307593435049057,-0.0895453467965126,-0.24806112051010132,-0.13626237213611603,0.09731166809797287,0.03720848634839058,-0.14681380987167358,0.13573019206523895,0.17938733100891113,0.3044204115867615,0.12469886988401413,-0.22973254323005676,-0.25818344950675964,-0.1817677766084671,0.3160000741481781,0.36347445845603943,0.13397333025932312,0.17332296073436737,-0.03762909024953842,0.08395995944738388,-0.018031621351838112,-0.3476693034172058,0.1610465943813324},{-0.1192149668931961,-0.03843144699931145,-0.07598861306905746,-0.2180326282978058,0.209568053483963,0.13885995745658875,0.13644641637802124,-0.12000281363725662,0.29129159450531006,0.20756304264068604,0.2204591929912567,-0.11510686576366425,-0.018783969804644585,-0.010452435351908207,-0.31160855293273926,-0.05410489812493324,-0.17160874605178833,-0.22221340239048004,-0.19049419462680817,-0.2839513421058655,-0.03179532662034035,0.11062981188297272,0.07038377970457077,0.17227864265441895,0.0724869817495346,-0.027339832857251167,0.23923639953136444,-0.2948343753814697,-0.07950015366077423,-0.09845948964357376,0.0793222188949585,0.023532485589385033}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.28816619515419006,-0.0008345026290044188,-0.2861177921295166,-0.17769569158554077},{0.06169900670647621,-0.16471442580223083,-0.02923227846622467,0.31628814339637756},{0.03952646628022194,0.03950272127985954,-0.14505040645599365,-0.06819280236959457},{-0.20985625684261322,0.031303003430366516,0.10689485818147659,0.12830209732055664},{-0.27824342250823975,0.04861009493470192,-0.09929435700178146,-0.2740509510040283},{0.20480243861675262,-0.2393466979265213,-0.3378170132637024,0.09710647910833359},{0.11667165905237198,0.014127997681498528,-0.031856782734394073,0.38609686493873596},{0.37430450320243835,0.2996671497821808,0.09357443451881409,0.10596621781587601},{-0.3145182430744171,0.21624135971069336,0.17925380170345306,0.07324296981096268},{-0.19184191524982452,-0.24604231119155884,-0.21384647488594055,-0.2718949615955353},{-0.042943503707647324,0.25234976410865784,-0.2398688793182373,-0.23120296001434326},{-0.17685651779174805,-0.2228744775056839,0.1615186333656311,0.1453000009059906},{0.2557251751422882,0.28916695713996887,-0.1918131411075592,-0.33557480573654175},{0.319617360830307,-0.05553661286830902,-0.12498138844966888,0.134364053606987},{0.33972182869911194,0.3285536468029022,-0.3800742030143738,-0.28525155782699585},{0.030196238309144974,0.09582065045833588,-0.12669694423675537,-0.006284566130489111},{-0.38103312253952026,-0.08190639317035675,-0.32938429713249207,-0.35728719830513},{-0.0887928158044815,0.17427970468997955,0.09460330009460449,0.14181245863437653},{0.07417051494121552,0.3582547605037689,0.24089683592319489,0.09128154069185257},{-0.08596150577068329,-0.2713608145713806,0.13728564977645874,-0.2611958682537079},{0.11797191202640533,0.12588854134082794,-0.23238803446292877,-0.10628551244735718},{-0.12810958921909332,0.18565741181373596,0.294780433177948,-0.1641749143600464},{0.30130282044410706,-0.05801837146282196,-0.30685627460479736,-0.10086198896169662},{0.21691997349262238,0.20002833008766174,-0.20611034333705902,-0.0844137966632843},{0.31551453471183777,0.36358535289764404,0.21759335696697235,0.10254122316837311},{0.22555433213710785,-0.24909867346286774,0.21833591163158417,-0.0644419714808464},{-0.22011741995811462,0.2880004942417145,0.2596544623374939,0.06335937231779099},{-0.12840455770492554,-0.20197778940200806,-0.07280012965202332,-0.3418470323085785},{-0.20025093853473663,0.21713438630104065,-0.23058508336544037,0.2982115149497986},{0.11037348210811615,-0.2533043920993805,-0.3841950595378876,-0.16372540593147278},{-0.04809224605560303,-0.13553108274936676,0.023120488971471786,0.13042473793029785},{0.001339100068435073,0.046278588473796844,-0.2699323892593384,-0.19334644079208374}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05704014375805855,0.08403460681438446,0.06797932833433151,-0.11384472995996475,0.0010714582167565823,0.06398231536149979,-0.02130875736474991,-0.08619742840528488,0.07920140027999878,0.00637091975659132,0.06298985332250595,-0.032797884196043015,0.14638638496398926,0.11815991252660751,-0.07446610927581787,0.0290546752512455};
static const float actor_encoder_self_encoder_2_bias[16] = {0.004225675482302904,0.04801143333315849,0.0006877474952489138,0.005932674743235111,0.04930320382118225,-0.025123735889792442,0.023238567635416985,-0.014771970920264721,0.026955140754580498,-0.0030948093626648188,0.004148802254348993,0.01051265373826027,-0.02422683872282505,-0.03125690296292305,-0.02497037686407566,-0.010471097193658352};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0067218998447060585,0.01676344871520996,0.027612265199422836,-0.0030324652325361967,-0.027608735486865044,0.0035992220509797335,0.037310414016246796,0.0056798444129526615,-0.00017953211499843746,-0.030472537502646446,-0.06724648177623749,-0.004714154172688723,-0.055873338133096695,0.009264328517019749,0.01670719124376774,-0.030925583094358444,-0.05213727802038193,0.015908312052488327,0.011316006071865559,-0.0037191519513726234,-0.01166777964681387,0.0013983017997816205,0.009323381818830967,0.003123379312455654,0.0241900272667408,-0.009800149127840996,-0.005719420965760946,-0.013405892066657543,-0.006687149405479431,0.015020055696368217,0.05861274152994156,-0.010926628485321999};
static const float action_parameterization_distribution_linear_bias[4] = {0.02374897338449955,0.0003324262797832489,0.031036101281642914,0.018954241648316383};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.1575610637664795,1.0388544797897339,-0.3220686614513397,0.8123878836631775,0.9908221960067749,-0.054851826280355453,0.6194338202476501,-0.6945466995239258},{0.3762196898460388,0.6997303366661072,1.381042718887329,-0.4612535834312439,0.445853590965271,-0.248087540268898,0.21370497345924377,0.6405420899391174},{0.8887038826942444,0.7281553745269775,-0.5795440077781677,0.12148649245500565,-0.33273714780807495,0.6636312007904053,-1.5478837490081787,0.15430021286010742}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.42317017912864685,-0.8220332264900208,0.12074489146471024,-0.8333854675292969,1.1984152793884277,-0.7602972984313965,-0.024602726101875305,0.5088477730751038},{0.26351192593574524,-0.2320224642753601,-0.27799248695373535,-0.7896826267242432,-0.4975704252719879,0.5192689895629883,-0.7889251112937927,-0.3088105618953705},{-0.25243228673934937,-0.025531882420182228,-0.3191942572593689,-0.5348610877990723,0.9348921179771423,0.917239248752594,0.6382967829704285,-0.05861711502075195},{-0.27229127287864685,0.3852922022342682,-0.523486852645874,-0.14410525560379028,-1.0555654764175415,0.1150251254439354,-0.2475099414587021,0.6780489087104797},{-0.7167465686798096,0.022199098020792007,0.31489941477775574,0.09632134437561035,-0.7675451040267944,0.5731292963027954,-0.05532277002930641,0.5112997889518738},{0.38862866163253784,-0.48804840445518494,-0.45369210839271545,-0.34367841482162476,0.11214183270931244,0.23295772075653076,-0.4955929219722748,0.09495563805103302},{0.2812086045742035,-0.28997802734375,0.0731402337551117,0.43325430154800415,-0.40274131298065186,1.0154626369476318,-0.02304850146174431,0.5346670746803284},{-0.12611377239227295,0.36268118023872375,-0.08260591328144073,-0.2991665303707123,0.9919485449790955,-0.6144359707832336,0.22138914465904236,0.11917285621166229}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.00032710068626329303,-0.055333781987428665,-0.014977023005485535,-0.005009712651371956,0.017613889649510384,0.004617006983608007,0.014748286455869675,0.021792279556393623};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.010810807347297668,-0.022172506898641586,-0.006066807080060244,0.005734410136938095,-0.029095033183693886,0.03447648882865906,0.022995952516794205,-0.015567283146083355};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
