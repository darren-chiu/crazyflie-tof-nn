#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.14013610780239105,0.3102279603481293,0.10930678993463516,-0.10726380348205566,0.06256948411464691,-0.25547516345977783,-0.023274041712284088,-0.5685445666313171,-0.15040141344070435,0.018145278096199036,-0.03175825998187065,0.08598680794239044,-0.3800540566444397,0.11277150362730026,0.08549735695123672,-0.3429401218891144},{-0.02985333651304245,0.062121015042066574,0.0966351255774498,-0.25618284940719604,0.27912983298301697,0.09360331296920776,0.11076673865318298,0.09147395193576813,-0.11471818387508392,-0.03847566246986389,-0.4074805676937103,0.09367004036903381,0.08606952428817749,0.09447433054447174,0.0944078266620636,-0.1883600950241089},{-0.1891564428806305,-0.36491096019744873,0.21778763830661774,-0.09279609471559525,-0.25210288166999817,0.30793583393096924,-0.43274345993995667,0.45015308260917664,-0.5334528684616089,-0.48373281955718994,-0.2726278603076935,-0.2566840946674347,-0.34246575832366943,0.1288970559835434,-0.42591482400894165,-0.5505792498588562},{-0.33713576197624207,-0.07706977427005768,-0.02017640694975853,0.24279767274856567,0.14420248568058014,-0.0495457649230957,0.3046373426914215,-0.19827257096767426,-0.26878711581230164,0.08839565515518188,-0.21451479196548462,0.05485827475786209,-0.1527157872915268,0.26338809728622437,-0.22865119576454163,-0.10529036819934845},{0.13895706832408905,-0.0825393795967102,0.14193521440029144,-0.299989253282547,0.2865641713142395,0.4310402572154999,-0.09408166259527206,-0.11796024441719055,0.03269032761454582,0.2585940361022949,-0.024464109912514687,0.11673162877559662,0.24254900217056274,0.13476164638996124,-0.2634061872959137,-0.36266976594924927},{0.15854504704475403,0.136135071516037,0.16116875410079956,-0.15264414250850677,-0.29582956433296204,-0.016237199306488037,-0.29366812109947205,0.04533424228429794,-0.15885980427265167,0.2584182918071747,-0.09110009670257568,-0.3213825821876526,-0.12952920794487,0.09453337639570236,-0.3851895034313202,-0.050437793135643005},{-0.4915393590927124,-0.3229033052921295,0.19218245148658752,-0.2743474543094635,-0.13357232511043549,-0.0004437507886905223,0.22874009609222412,0.27486148476600647,-0.21011358499526978,-0.01965118944644928,-0.057437963783741,-0.013355731032788754,-0.2775602340698242,-0.08388233184814453,0.22165657579898834,0.03339877724647522},{0.13492178916931152,0.257027804851532,0.09725990146398544,0.05533706769347191,-0.3048306703567505,0.4110219180583954,0.3056938052177429,0.18461880087852478,-0.14294081926345825,0.19085682928562164,0.12046432495117188,0.3330157399177551,-0.44025295972824097,-0.412507027387619,-0.044878434389829636,0.27910372614860535},{-0.4898959994316101,0.002243434777483344,0.11675909906625748,0.02822059392929077,0.11950157582759857,0.15901173651218414,0.24449878931045532,-0.26054948568344116,-0.3638712167739868,-0.22026406228542328,0.02151661366224289,0.3424278497695923,0.08767031878232956,0.15996168553829193,0.3814140260219574,-0.010331903584301472},{0.4447568953037262,0.20109492540359497,-0.322451651096344,-0.04253063350915909,0.2483406960964203,-0.051647961139678955,-0.3763982951641083,-0.3498002290725708,-0.29576781392097473,0.2898677885532379,-0.014368664473295212,0.35549119114875793,-0.25864318013191223,0.4903932809829712,-0.386034220457077,0.042870085686445236},{0.3401050567626953,-0.1523830145597458,0.09682434797286987,0.41581839323043823,-0.12328902631998062,0.3302874267101288,0.2389429658651352,0.42057499289512634,-0.06650784611701965,-0.252681165933609,-0.2656573951244354,0.1117052361369133,-0.20833665132522583,-0.3462978005409241,-0.285676509141922,0.12417659163475037},{0.10659715533256531,-0.110203318297863,-0.06702663004398346,-0.48756614327430725,0.1611035168170929,-0.05887044221162796,-0.12807659804821014,-0.22803416848182678,-0.16496050357818604,-0.4098898470401764,-0.7194700241088867,-0.1397475153207779,-0.0006934534176252782,-0.0875319093465805,0.4931299388408661,0.10384827852249146},{0.19201219081878662,-0.6675524711608887,-0.33978086709976196,-0.02076070010662079,0.35138770937919617,0.07238369435071945,0.19480754435062408,-0.24300724267959595,0.18227364122867584,-0.6040260195732117,0.04596462473273277,-0.5451407432556152,0.530686616897583,-0.861868679523468,-0.2751522660255432,-0.18394695222377777},{0.010966673493385315,-0.17249548435211182,-0.6633405685424805,0.5901663303375244,-0.15351803600788116,-0.009455432184040546,-0.011695998720824718,-0.03897704929113388,-0.14074262976646423,-0.12152823805809021,0.25519341230392456,-0.18437382578849792,-0.5108431577682495,0.034901656210422516,0.2171950489282608,-0.4702256917953491},{-0.18161778151988983,0.08588806539773941,-0.20253442227840424,0.22707904875278473,0.3486744165420532,-0.21947549283504486,0.25287359952926636,-0.009946983307600021,0.04174444451928139,0.07690268009901047,0.3087898790836334,0.13449493050575256,-0.033247850835323334,-0.2603999078273773,0.03844958171248436,0.10711147636175156},{-0.22515971958637238,0.14466719329357147,-0.1787378489971161,0.2827485203742981,0.004376052878797054,-0.36366939544677734,0.23564906418323517,0.1688377559185028,-0.09118644893169403,-0.12033470720052719,0.060966722667217255,-0.03127400949597359,-0.2122909128665924,-0.18593567609786987,-0.28307226300239563,-0.2473231852054596},{-0.2914278209209442,0.2549149990081787,0.04663635045289993,0.038000136613845825,-0.27419528365135193,0.09916941076517105,-0.2833405137062073,0.16586802899837494,-0.1624145805835724,0.17722927033901215,-0.014129201881587505,0.33487755060195923,0.2019088864326477,0.30445432662963867,0.36947643756866455,-0.26239320635795593},{0.22570598125457764,-0.26728343963623047,-0.11931239068508148,-0.09389156103134155,-0.4044727087020874,-0.23408064246177673,-0.24868330359458923,-0.25067344307899475,-0.1921890676021576,-0.027965616434812546,-0.320239782333374,0.060629915446043015,0.040032800287008286,0.18260458111763,-0.029968777671456337,-0.17816253006458282}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.17936554551124573,0.2993813455104828,0.0284461360424757,0.47742438316345215,0.15538574755191803,-0.09634481370449066,-0.2025163322687149,-0.41263753175735474,-0.10272564738988876,-0.1999494880437851,0.2177666574716568,0.026852762326598167,0.3696863055229187,0.0603347085416317,-0.3935854434967041,-0.3628746569156647},{-0.28993839025497437,0.22090864181518555,-0.2368343025445938,-0.010465824045240879,0.11792502552270889,-0.0017748735845088959,-0.5019000768661499,0.15980812907218933,0.28917747735977173,0.08899635076522827,0.030644234269857407,-0.009551754221320152,-0.1783585250377655,-0.11684376001358032,-0.28624582290649414,-0.10940521210432053},{0.4202653169631958,0.31081777811050415,-0.34500396251678467,-0.5405987501144409,0.2976548373699188,-0.28046363592147827,-0.5838629603385925,0.18164652585983276,0.38730350136756897,-0.25612112879753113,0.14651519060134888,-0.27990999817848206,-0.04444165155291557,-0.10728544741868973,0.31693217158317566,0.38277503848075867},{0.34056270122528076,-0.09877625107765198,-0.2513391375541687,0.3419654071331024,-0.30369558930397034,0.30125096440315247,0.17024388909339905,-0.055581241846084595,-0.11713767051696777,0.301387757062912,0.35419559478759766,-0.41612300276756287,0.1305287480354309,-0.2921118140220642,-0.42656344175338745,0.019579967483878136},{0.07592962682247162,0.17836198210716248,0.009025944396853447,-0.07388431578874588,0.06447054445743561,-0.02878154255449772,-0.21096046268939972,0.27342483401298523,-0.1378892958164215,-0.27559319138526917,-0.2380213886499405,0.21487440168857574,0.2314113974571228,-0.1895376592874527,0.21123382449150085,0.10301230102777481},{0.441762238740921,0.023577028885483742,-0.24155278503894806,-0.12843598425388336,0.2313094437122345,0.15088146924972534,-0.1983080506324768,-0.3076404631137848,-0.07892274111509323,0.20369358360767365,-0.11952633410692215,-0.0846526175737381,-0.3135756850242615,0.3909742832183838,0.20415450632572174,-0.12939509749412537},{0.2536824345588684,-0.35215112566947937,-0.37138110399246216,-0.24635577201843262,0.002486869227141142,0.23290234804153442,-0.2697663903236389,0.06352308392524719,0.08720126003026962,0.16564230620861053,-0.016098424792289734,0.3214436173439026,0.3190714716911316,-0.1409476101398468,0.24112330377101898,0.3070163130760193},{-0.3118377923965454,0.35013440251350403,-0.12773634493350983,0.4091465175151825,0.20484022796154022,-0.002759132767096162,0.36218127608299255,0.4179721772670746,-0.049194417893886566,-0.24598328769207,0.22267550230026245,-0.41377967596054077,-0.07868920266628265,-0.07096453756093979,-0.10130252689123154,0.01853490062057972},{0.05273568257689476,-0.22918811440467834,0.04267553240060806,0.26068463921546936,0.13345056772232056,0.16735723614692688,0.03276585042476654,0.4072549045085907,-0.0077826944179832935,0.12090654671192169,-0.24057602882385254,-0.08389502763748169,0.33298152685165405,-0.466060996055603,0.37401095032691956,0.016654059290885925},{-0.0764954462647438,-0.06720255315303802,-0.2445141226053238,0.20788097381591797,-0.2893248498439789,-0.04545588418841362,0.2889590561389923,0.23478026688098907,0.2146306335926056,-0.17906533181667328,-0.17605216801166534,0.014381254091858864,-0.24251164495944977,0.03113061562180519,-0.35989755392074585,0.020431185141205788},{-0.10502149164676666,-0.23196060955524445,0.22705380618572235,0.2925948202610016,-0.1704934537410736,-0.2887210249900818,0.31387683749198914,-0.1258140355348587,-0.13298285007476807,0.09488288313150406,0.006844513118267059,-0.3146211504936218,-0.3744763731956482,-0.5616739988327026,-0.32934775948524475,-0.10723318159580231},{-0.025702014565467834,-0.48662814497947693,0.2173333764076233,-0.22160747647285461,0.15701912343502045,0.17217397689819336,-0.38432618975639343,-0.32546448707580566,0.21329015493392944,0.08940256386995316,-0.5669658184051514,0.3915942311286926,-0.21870794892311096,-0.10567007958889008,0.2548172175884247,0.1762547492980957},{-0.09174201637506485,0.10507753491401672,-0.2781103551387787,0.14739520847797394,0.1746620088815689,-0.009597621858119965,0.3664214015007019,-0.31098243594169617,-0.1411079466342926,-0.11157602071762085,-0.35761868953704834,0.4321482479572296,0.42253944277763367,0.21474717557430267,0.1321706622838974,0.3133687376976013},{-0.3394927382469177,0.00828124862164259,0.3107316792011261,-0.3374175429344177,0.3565625548362732,-0.4382608234882355,-0.04901168495416641,-0.28531181812286377,0.233882337808609,0.20618736743927002,0.3148387670516968,0.41970598697662354,-0.13676409423351288,-0.15434469282627106,-0.3055115342140198,0.28225570917129517},{-0.13372576236724854,-0.1719151735305786,-0.29151278734207153,0.22618824243545532,-0.19116932153701782,0.4869544506072998,0.25998878479003906,0.2217690795660019,0.2244831919670105,-0.0070623853243887424,-0.11604342609643936,-0.18279814720153809,0.24201305210590363,0.14606407284736633,-0.08411390334367752,0.12865719199180603},{-0.13712921738624573,0.32660725712776184,-0.02337023615837097,-0.14064545929431915,0.05085301771759987,-0.04790041223168373,0.24918942153453827,0.25383052229881287,-0.18293806910514832,-0.16979005932807922,-0.18148192763328552,0.27869343757629395,0.1284237802028656,-0.24843433499336243,-0.3854098320007324,0.04573696479201317}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.04458079859614372,0.004543572198599577,0.07149625569581985,0.18346922099590302,0.3862421214580536,-0.12477487325668335,-0.10751935094594955,0.07305043935775757,-0.19870784878730774,-0.10888002812862396,0.02853855863213539,0.16864176094532013,0.2864377498626709,-0.051697857677936554,0.26934564113616943,0.11575734615325928,0.2044002264738083,0.0930490642786026,0.05964651331305504,-0.03323933854699135,0.2747510075569153,-0.2072305530309677,-0.2723325490951538,-0.23407964408397675,-0.09552394598722458,0.10664273798465729,-0.26422634720802307,-0.2658308744430542,0.22455716133117676,-0.13220104575157166,-0.34214410185813904,-0.18498416244983673},{0.2434893697500229,0.10484474897384644,0.27911123633384705,0.3235824406147003,0.3745098114013672,-0.005488845054060221,0.17299127578735352,-0.3741762042045593,0.1649375557899475,0.07553917169570923,-0.07539011538028717,-0.21415884792804718,-0.18082484602928162,-0.1097690686583519,-0.3027113974094391,0.35753297805786133,0.15591304004192352,-0.28065282106399536,0.1663845032453537,0.1775377094745636,-0.04396907240152359,0.30080005526542664,-0.24202947318553925,0.12959963083267212,0.07605049014091492,-0.3375483751296997,-0.1766156554222107,0.38258764147758484,-0.26947468519210815,0.02544863149523735,0.28189563751220703,-0.13366371393203735},{0.1909170299768448,-0.0506550557911396,-0.18218258023262024,-0.28230106830596924,-0.25877174735069275,-0.2160041332244873,-0.3571123778820038,0.09786538779735565,-0.34475231170654297,-0.159798264503479,0.14945073425769806,0.31693223118782043,0.17926889657974243,-0.0949113667011261,-0.20631131529808044,0.12747091054916382,0.28436338901519775,-0.17794932425022125,-0.12910112738609314,0.2320799082517624,-0.25481608510017395,0.003607552731409669,-0.025253713130950928,-0.022143209353089333,-0.03665830194950104,0.34471648931503296,-0.28051313757896423,0.2223879098892212,-0.46431368589401245,-0.1414070576429367,-0.03895691782236099,0.03886330500245094},{0.16804514825344086,-0.29570505023002625,-0.133755624294281,0.20624318718910217,0.07261539995670319,-0.15776924788951874,0.33187350630760193,0.07750778645277023,0.12892039120197296,-0.08386299014091492,-0.015403468161821365,-0.05946534126996994,0.3022015690803528,0.17919602990150452,-0.21666201949119568,-0.22553075850009918,-0.16871951520442963,0.16110846400260925,0.18082362413406372,-0.032806720584630966,-0.01184783224016428,0.34853097796440125,-0.06752333790063858,-0.23771719634532928,0.06201756373047829,0.11435849219560623,0.12951825559139252,0.03343130275607109,-0.34331682324409485,-0.33140820264816284,0.11193445324897766,0.15098513662815094},{-0.06915590167045593,0.13527965545654297,-0.01159791648387909,0.10266595333814621,0.1645706295967102,0.24034297466278076,0.1384391039609909,-0.2097373902797699,-0.020275546237826347,0.10206829756498337,-0.13050764799118042,0.11391844600439072,-0.2908254563808441,0.15035994350910187,0.003515766467899084,0.24666091799736023,0.09775456041097641,0.010912692174315453,0.06578797847032547,0.15938051044940948,0.12018546462059021,-0.04567744582891464,-0.3418726623058319,-0.3033205270767212,-0.013077232986688614,0.1837802529335022,0.17624372243881226,0.07383320480585098,0.17595551908016205,-0.18969419598579407,-0.18544071912765503,0.23645052313804626},{-0.3048475980758667,0.27249619364738464,-0.004762176424264908,-0.022088872268795967,-0.35540711879730225,-0.24984994530677795,-0.10983359813690186,0.04458272457122803,0.1888980120420456,-0.15380147099494934,0.03202991187572479,-0.34534311294555664,-0.17752669751644135,0.08414837718009949,0.06290389597415924,-0.20571090281009674,-0.17300210893154144,-7.71202685427852e-05,0.04477764293551445,-0.3268289864063263,0.20207060873508453,-0.09934591501951218,0.044248029589653015,-0.18374033272266388,0.13909412920475006,0.09101148694753647,-0.0682368278503418,0.11702462285757065,0.09171891212463379,-0.013422845862805843,-0.21254688501358032,-0.24103069305419922},{-0.001964392140507698,-0.11652706563472748,0.028646748512983322,-0.20599618554115295,-0.19072964787483215,0.09801167994737625,-0.33201563358306885,-0.11631682515144348,-0.10598880052566528,0.24639450013637543,-0.2318994104862213,0.0604509562253952,0.27416327595710754,0.02614319510757923,-0.33158600330352783,-0.2255551666021347,0.026032917201519012,0.14253221452236176,0.12431587278842926,0.2914821207523346,-0.25438156723976135,0.15990309417247772,-0.007269447203725576,0.05118951573967934,0.251205712556839,-0.0916387289762497,-0.031228719279170036,0.3205667734146118,-0.025181971490383148,-0.273540735244751,-0.2817686200141907,0.2533207833766937},{0.07229568809270859,0.18588131666183472,0.12038592994213104,0.15444348752498627,-0.13990189135074615,-0.3762339651584625,0.1825147569179535,-0.24177245795726776,-0.04813724011182785,-0.22568020224571228,0.28159910440444946,-0.09880262613296509,-0.05431145429611206,-0.09158825874328613,0.2771798074245453,0.1361408531665802,0.09715332835912704,0.006321428343653679,-0.29707640409469604,0.0689639151096344,-0.29176032543182373,-0.011173306964337826,-0.1956886500120163,0.1823626309633255,0.06587748974561691,-0.06437952071428299,0.207315132021904,0.020154539495706558,0.08084259927272797,-0.20414675772190094,-0.16246645152568817,0.28672438859939575},{0.20755518972873688,0.40744173526763916,-0.1864548772573471,0.28542956709861755,0.008760729804635048,0.16252736747264862,0.46608927845954895,-0.31351062655448914,-0.0982690155506134,-0.039033230394124985,0.17447422444820404,-0.12404613941907883,-0.05320145934820175,0.26518434286117554,-0.08979462832212448,0.22218015789985657,0.2149256467819214,0.21175099909305573,0.160647451877594,0.2034919708967209,-0.2531583905220032,-0.23669201135635376,0.10721209645271301,0.19715788960456848,0.09612838923931122,0.3187672793865204,-0.3682263195514679,-0.31055188179016113,-0.07052375376224518,0.2553991973400116,0.055626511573791504,0.20826977491378784},{0.09374109655618668,-0.0422588512301445,0.04382037743926048,-0.30674463510513306,-0.019768258556723595,-0.2970159947872162,0.07661888748407364,0.3017556071281433,-0.2240465134382248,-0.24993938207626343,0.17169202864170074,-0.1431727409362793,0.0829760953783989,0.10796025395393372,-0.16783353686332703,0.2961080074310303,0.07455617189407349,-0.28782543540000916,0.17142967879772186,0.03182398900389671,0.21008263528347015,-0.3376828730106354,0.29820430278778076,-0.061307184398174286,0.1225133091211319,0.24046407639980316,0.25712069869041443,0.2575753927230835,-0.09620890021324158,0.24056565761566162,-0.027722055092453957,0.025323746725916862},{0.16335496306419373,0.09672537446022034,0.31036171317100525,-0.2977573871612549,0.14736723899841309,-0.16384603083133698,-0.09533718973398209,-0.31464430689811707,0.0442691370844841,0.3728569447994232,0.17727141082286835,0.0562543123960495,0.12156642973423004,0.17134125530719757,-0.021494092419743538,0.31462499499320984,-0.07462088763713837,-0.26443183422088623,-0.09018316119909286,0.0073686642572283745,-0.21862243115901947,0.12517064809799194,0.033376723527908325,-0.20870177447795868,-0.12885147333145142,-0.20191574096679688,-0.15766063332557678,0.026988916099071503,-0.19167427718639374,-0.032648660242557526,0.38442784547805786,0.33168354630470276},{0.27037686109542847,0.08464627712965012,-0.170088991522789,-0.34183943271636963,-0.2379680573940277,-0.26347124576568604,0.20520813763141632,0.0966319888830185,-0.16968713700771332,0.23339521884918213,-0.4062383770942688,-0.11655228585004807,-0.18947634100914001,-0.14316973090171814,-0.13976718485355377,-0.2385680228471756,-0.37851452827453613,-0.32371747493743896,0.09660197049379349,0.16199113428592682,-0.04864955320954323,0.305908203125,-0.20854023098945618,-0.12640626728534698,0.19770139455795288,0.3175524175167084,0.20275600254535675,-0.17308028042316437,-0.1457524299621582,-0.2754857838153839,-0.26610249280929565,0.13120481371879578},{-0.07764784246683121,-0.10843955725431442,-0.16426275670528412,0.01321661937981844,0.23079103231430054,-0.14099706709384918,0.1479823738336563,0.38818928599357605,0.14960595965385437,0.2205708920955658,-0.15002186596393585,-0.3163512945175171,0.09878099709749222,0.11164674162864685,0.19316810369491577,0.11981426924467087,-0.390597939491272,-0.2354024201631546,-0.14466582238674164,0.22861813008785248,-0.10133600980043411,-0.240304633975029,-0.2682660222053528,-0.11606691777706146,0.2075849026441574,0.3161546587944031,0.26732364296913147,0.11964437365531921,-0.22379401326179504,-0.1437007337808609,0.04991781711578369,-0.2213766872882843},{0.29583752155303955,-0.05488427355885506,-0.2913573980331421,-0.08581781387329102,0.023511698469519615,0.0767202377319336,-0.04962179809808731,-0.07871341705322266,0.15003962814807892,0.3586329519748688,-0.3273658752441406,0.27540963888168335,0.21317483484745026,-0.2685995101928711,0.07821023464202881,-0.2524667978286743,-0.10018455237150192,0.16051118075847626,-0.15244068205356598,0.369358092546463,0.1336459517478943,-0.14417850971221924,-0.24307961761951447,-0.1304110735654831,-0.35758182406425476,0.09781962633132935,0.011960218660533428,0.23074093461036682,-0.03180771693587303,0.13460960984230042,0.3379303812980652,-0.19681942462921143},{0.14120423793792725,-0.1756068915128708,0.10515814274549484,-0.07488472759723663,-0.21213263273239136,-0.291678249835968,0.20456133782863617,-0.24976535141468048,0.2286558598279953,0.16605372726917267,-0.17368336021900177,0.18283332884311676,-0.04704887792468071,0.0712885782122612,-0.12312696129083633,-0.05199423059821129,0.07821640372276306,-0.07432511448860168,0.001953592523932457,-0.2076743096113205,-0.001890593208372593,-0.23188436031341553,-0.1985417604446411,-0.37096554040908813,0.01577628031373024,-0.2062879502773285,0.1242532804608345,0.09102369844913483,0.20066078007221222,0.048839062452316284,0.05297340452671051,-0.042401716113090515},{0.23200339078903198,-0.16226400434970856,-0.26947668194770813,0.24787291884422302,-0.12516848742961884,0.11181825399398804,0.2760813534259796,-0.30379894375801086,-0.09818720817565918,-0.28147679567337036,-0.2592761516571045,-0.33316245675086975,-0.28243979811668396,-0.24999134242534637,0.05616982281208038,0.32308444380760193,0.3029206395149231,-0.23642830550670624,0.05911434069275856,-0.041750386357307434,-0.09951427578926086,-0.1979716271162033,-0.20522178709506989,0.21153397858142853,-0.13488620519638062,-0.007699093781411648,-0.19512225687503815,-0.07062506675720215,-0.208095982670784,-0.10220401734113693,-0.15955941379070282,-0.17950962483882904},{0.2627547085285187,0.3541804254055023,-0.1889776736497879,-0.15916307270526886,-0.01816556043922901,0.29428237676620483,0.25758808851242065,0.22522523999214172,0.03338896110653877,-0.33691737055778503,0.09398189932107925,0.061593253165483475,0.05307375267148018,-0.04823872819542885,0.2019103318452835,0.10429395735263824,-0.22406476736068726,0.023503411561250687,-0.15966801345348358,-0.28739142417907715,0.013231558725237846,0.12395631521940231,-0.07550511509180069,-0.23773232102394104,-0.07407862693071365,0.056870151311159134,0.15722517669200897,-0.22230304777622223,0.12160120904445648,-0.25754880905151367,0.09429540485143661,-0.19206330180168152},{-0.32507452368736267,-0.18476375937461853,0.1780730038881302,-0.06283798068761826,0.259361207485199,0.11607321351766586,0.08209986984729767,-0.2528769373893738,-0.023087667301297188,0.14340214431285858,0.23410576581954956,0.16443273425102234,-0.08012513816356659,0.02103361114859581,-0.23985326290130615,-0.15573406219482422,0.2699578106403351,-0.1128966212272644,0.06315310299396515,0.17921748757362366,0.2745678424835205,0.23983561992645264,0.08355113118886948,-0.27446407079696655,0.04264487698674202,0.03488866612315178,0.2834929823875427,0.31819549202919006,-0.13269570469856262,-0.19786185026168823,0.0865916758775711,0.24679403007030487},{0.19023378193378448,-0.15136127173900604,-0.1921186000108719,0.018407700583338737,0.024814628064632416,0.22546251118183136,-0.2922062575817108,0.08883305639028549,-0.3380051851272583,-0.2815053164958954,0.1878899335861206,0.012164347805082798,-0.04524371773004532,-0.2160889208316803,-0.041775062680244446,-0.047777749598026276,0.16279847919940948,0.04300696775317192,-0.06993768364191055,0.2161131203174591,0.05185340344905853,-0.048330262303352356,0.09790428727865219,0.2472139447927475,0.08264409750699997,-0.35960689187049866,-0.0626298114657402,0.15608081221580505,-0.11356557160615921,-0.10417526215314865,0.1187446191906929,0.13708393275737762},{0.16891655325889587,0.22059990465641022,0.10227574408054352,-0.07843752205371857,-0.26125919818878174,-0.010954244993627071,-0.14058884978294373,0.23229587078094482,0.1364852786064148,-0.008898918516933918,-0.09444890171289444,0.08335740864276886,0.19792120158672333,0.2494121491909027,-0.08991116285324097,-0.27649810910224915,-0.36661258339881897,0.371605783700943,0.4766297936439514,-0.31899699568748474,-0.24318665266036987,0.29344573616981506,0.19327475130558014,-0.24363356828689575,0.21524174511432648,-0.00834769569337368,0.3288452625274658,0.05187712982296944,0.11313742399215698,-0.06060096621513367,-0.15726923942565918,0.13648077845573425},{-0.3161824643611908,0.026599841192364693,-0.18923847377300262,-0.02411152794957161,-0.09476282447576523,-0.19791953265666962,0.035716764628887177,-0.08593403548002243,-0.16540402173995972,0.1844450682401657,0.18191078305244446,0.04133794084191322,0.01859443448483944,-0.3834573030471802,-0.2593371570110321,0.14627611637115479,-0.24389249086380005,-0.0051869554445147514,-0.26708826422691345,0.0059935529716312885,-0.06455188244581223,0.1507590413093567,0.2047680765390396,-0.005372048821300268,-0.17828120291233063,-0.04929037019610405,0.054348334670066833,0.21081112325191498,0.07730891555547714,-0.2254873365163803,-0.09484687447547913,-0.0547550767660141},{-0.013424980454146862,0.33186033368110657,0.02701510302722454,0.12876847386360168,0.11411726474761963,0.09787296503782272,0.15824005007743835,0.18486370146274567,-0.3354232609272003,0.023718835785984993,-0.05618792399764061,0.15088830888271332,-0.2172914445400238,0.5821416974067688,-0.00963250920176506,-0.07656626403331757,0.058329399675130844,0.11056984215974808,0.006536730099469423,0.20611299574375153,-0.2838885486125946,0.08903027325868607,-0.022414352744817734,0.25386011600494385,0.16968591511249542,0.09138061851263046,0.16016556322574615,-0.1877702921628952,0.2593039870262146,0.25402742624282837,-0.0864383727312088,-0.1751236468553543},{-0.22210484743118286,0.30446189641952515,0.052276186645030975,0.07469481229782104,-0.14644065499305725,0.19940949976444244,0.01914949156343937,0.06970694661140442,0.10849210619926453,-0.32393646240234375,-0.07662436366081238,-0.2769542336463928,-0.11330653727054596,0.09935352951288223,0.057919349521398544,-0.14403881132602692,0.12344719469547272,0.16447128355503082,0.31352078914642334,0.11612019687891006,-0.2009609490633011,-0.2516251802444458,-0.15915176272392273,0.3638868033885956,0.3842551112174988,0.14462533593177795,0.171895831823349,-0.03921647369861603,0.06976764649152756,-0.007067299913614988,-0.3806191384792328,0.18538211286067963},{-0.12273915112018585,-0.07098542153835297,-0.06141725182533264,-0.2250150591135025,0.20888954401016235,0.10741087794303894,0.12237486243247986,-0.09817720949649811,0.2978473901748657,0.19616259634494781,0.22313548624515533,-0.13593898713588715,-0.0017068750457838178,-0.017105532810091972,-0.2763556241989136,-0.06912728399038315,-0.1763112097978592,-0.2194594442844391,-0.18021756410598755,-0.274899423122406,-0.024419451132416725,0.13237327337265015,0.07420598715543747,0.18591398000717163,0.09543782472610474,-0.013590412214398384,0.24892793595790863,-0.2973094582557678,-0.10079097002744675,-0.11616451293230057,0.05962115526199341,0.022538060322403908}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.28751522302627563,-0.01964254304766655,-0.31932830810546875,-0.1898447573184967},{0.0733875185251236,-0.1704336255788803,-0.0551643893122673,0.36826255917549133},{0.042195215821266174,0.05671517178416252,-0.18987561762332916,-0.09860865026712418},{-0.24104192852973938,0.023407012224197388,0.0997367575764656,0.1592206060886383},{-0.287318617105484,0.05452919378876686,-0.10961783677339554,-0.3083423376083374},{0.2231217324733734,-0.25714460015296936,-0.3760048747062683,0.10639169067144394},{0.12128539383411407,0.014956198632717133,-0.025329863652586937,0.4175013601779938},{0.42100080847740173,0.34229710698127747,0.11679946631193161,0.09561468660831451},{-0.3207968473434448,0.2528131604194641,0.18772265315055847,0.06031249836087227},{-0.22026784718036652,-0.2718554437160492,-0.19726262986660004,-0.2887767553329468},{-0.030026568099856377,0.29299435019493103,-0.2581060826778412,-0.2433362752199173},{-0.2020946592092514,-0.22744090855121613,0.16438595950603485,0.16298356652259827},{0.27291592955589294,0.33785882592201233,-0.19829335808753967,-0.37600240111351013},{0.33780425786972046,-0.04474596679210663,-0.13462649285793304,0.12226513773202896},{0.36091578006744385,0.35276028513908386,-0.44380784034729004,-0.29262495040893555},{0.015046179294586182,0.09687839448451996,-0.17229624092578888,-0.011954502202570438},{-0.39675572514533997,-0.11018292605876923,-0.3961876630783081,-0.3592858612537384},{-0.1073782816529274,0.2060747742652893,0.09891065955162048,0.18293069303035736},{0.08690440654754639,0.3674711287021637,0.251238077878952,0.08735127747058868},{-0.09803254902362823,-0.3362676501274109,0.16811202466487885,-0.27233174443244934},{0.13753938674926758,0.1451391875743866,-0.2770715653896332,-0.12572424113750458},{-0.14692525565624237,0.2045455127954483,0.3487500250339508,-0.1714634895324707},{0.3317757546901703,-0.03972851112484932,-0.3237648904323578,-0.1009269654750824},{0.24791574478149414,0.19583112001419067,-0.22440104186534882,-0.0822058841586113},{0.3567577302455902,0.3820073902606964,0.2482510209083557,0.09552112221717834},{0.2803199887275696,-0.2597593665122986,0.2485048770904541,-0.09836956858634949},{-0.22429828345775604,0.324968159198761,0.3307603597640991,0.06192201003432274},{-0.16446782648563385,-0.25191009044647217,-0.036102209240198135,-0.36577144265174866},{-0.25945332646369934,0.2437341958284378,-0.2794298231601715,0.3643568158149719},{0.13625675439834595,-0.27733132243156433,-0.4515884816646576,-0.16116219758987427},{-0.04917874559760094,-0.14365461468696594,0.017182227224111557,0.13514725863933563},{0.011827798560261726,0.052563849836587906,-0.2956925928592682,-0.22328294813632965}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05272701010107994,0.06253134459257126,0.06901302188634872,-0.1107308641076088,0.020167121663689613,0.0629550963640213,-0.005908650811761618,-0.07371021807193756,0.0764908641576767,-0.0014619354624301195,0.05937395989894867,-0.012356340885162354,0.14050662517547607,0.11784567683935165,-0.07479645311832428,0.04521183297038078};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0233302004635334,0.052324891090393066,0.0018933817045763135,-0.012967342510819435,0.052519623190164566,-0.036818671971559525,0.016735635697841644,0.0055810739286243916,0.013244768604636192,-0.005352422595024109,0.001403653877787292,0.008104723878204823,-0.03244578093290329,-0.03063196688890457,-0.02364685945212841,0.0019408975495025516};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.010382183827459812,0.009306494146585464,0.03122388757765293,-0.010461647063493729,-0.016925539821386337,0.003688933327794075,0.023790519684553146,-0.003709217766299844,-0.007615006063133478,-0.02271243929862976,-0.05918709933757782,0.0002758801856543869,-0.04925619065761566,-0.006007700692862272,0.017817020416259766,-0.01867586188018322,-0.03308679163455963,0.006004139315336943,0.008615823462605476,-0.0015579487662762403,-0.006810575257986784,0.0005818409845232964,0.007984932512044907,0.01217329315841198,0.014965945854783058,-0.020200952887535095,-0.010550846345722675,-0.007335939444601536,-0.0015820313710719347,0.01977790892124176,0.04078942537307739,-0.00541632529348135};
static const float action_parameterization_distribution_linear_bias[4] = {0.017319094389677048,-5.647756324833608e-07,0.021522823721170425,0.011056788265705109};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-1.0346332788467407,0.952957034111023,-0.25413087010383606,0.7318952083587646,0.9580547213554382,-0.049537207931280136,0.6142902374267578,-0.6981279253959656},{0.3164691627025604,0.6531322598457336,1.2170637845993042,-0.40468883514404297,0.3668844699859619,-0.2927655875682831,0.16731077432632446,0.6436435580253601},{0.7481791377067566,0.5868349075317383,-0.4435478448867798,0.12731613218784332,-0.26102861762046814,0.5672821998596191,-1.4089932441711426,0.12620295584201813}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.40505582094192505,-0.792091965675354,0.14057087898254395,-0.7805622220039368,1.1530226469039917,-0.6820149421691895,-0.01473985705524683,0.4975820481777191},{0.28709349036216736,-0.2539663016796112,-0.33553236722946167,-0.7174209356307983,-0.47466790676116943,0.5333120226860046,-0.7409115433692932,-0.3534318506717682},{-0.22988520562648773,-0.032019633799791336,-0.3447682857513428,-0.5063515901565552,0.889934241771698,0.8683344721794128,0.5964905023574829,-0.031772810965776443},{-0.30469146370887756,0.397215873003006,-0.5015258193016052,-0.17370355129241943,-0.9853602051734924,0.06891337037086487,-0.2193019539117813,0.6567592620849609},{-0.7078475952148438,0.003182198153808713,0.2841421961784363,0.10011095553636551,-0.7331182360649109,0.46944791078567505,-0.08895810693502426,0.4768778085708618},{0.34773534536361694,-0.4691754877567291,-0.3950977623462677,-0.34403008222579956,0.13237525522708893,0.251897931098938,-0.45281121134757996,0.05442587286233902},{0.31027644872665405,-0.32278206944465637,0.04034767672419548,0.3742882311344147,-0.4405788779258728,0.9362005591392517,-0.08608192205429077,0.5562034845352173},{-0.11372479051351547,0.3822718560695648,-0.10001768916845322,-0.2608107328414917,0.9465236067771912,-0.5807750821113586,0.17462512850761414,0.12926551699638367}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.023227155208587646,-0.046351972967386246,0.003100953297689557,0.0006553018465638161,0.02376321516931057,-0.008960087783634663,0.01461885403841734,0.024133238941431046};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.02061360515654087,-0.01245479378849268,0.005211518611758947,-0.0009885620092973113,-0.014946148730814457,0.03638185188174248,0.012802595272660255,-0.0176729466766119};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
