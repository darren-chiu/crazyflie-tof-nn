#include "network_evaluate.h"

static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int nbr_structure [2][2] = {{3, 8},{8, 8}};

static const int D_SELF = self_structure[1][1];
static const int D_NBR = nbr_structure[1][1];

static float neighbor_embeds[D_NBR];
static float output_embeds[D_SELF + D_NBR];

static float nbr_output_0[NEIGHBORS][8];
static float nbr_output_1[NEIGHBORS][8];
static float output_0[16];
static float output_1[16];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.16049708425998688,0.3333125710487366,0.07495357096195221,-0.10473132133483887,0.06840796023607254,-0.32121095061302185,-0.019027670845389366,-0.5162779092788696,-0.11950469017028809,0.029728595167398453,0.007391106337308884,0.11702287942171097,-0.34964561462402344,0.14727506041526794,0.12542690336704254,-0.27534976601600647},{-0.07027988135814667,0.04369032010436058,0.06779380142688751,-0.17297886312007904,0.2883901596069336,0.08023831993341446,0.12071987241506577,0.09156869351863861,-0.12968477606773376,-0.02350049652159214,-0.3526466190814972,0.07679521292448044,0.04738057032227516,0.1053479015827179,0.06474720686674118,-0.16316911578178406},{-0.18179306387901306,-0.357845276594162,0.18522386252880096,-0.11598063260316849,-0.21770073473453522,0.28771936893463135,-0.4217578172683716,0.3936240077018738,-0.48266562819480896,-0.43695926666259766,-0.26334095001220703,-0.2608940601348877,-0.29767918586730957,0.12754783034324646,-0.40396350622177124,-0.4302573800086975},{-0.25886839628219604,-0.1787087470293045,-0.05836201086640358,0.26051995158195496,0.15585076808929443,-0.021865064278244972,0.33926549553871155,-0.20317436754703522,-0.27748405933380127,0.10259632021188736,-0.23290622234344482,0.026328222826123238,-0.15685799717903137,0.3088759779930115,-0.2277594804763794,-0.09203749895095825},{0.12229335308074951,-0.06876766681671143,0.14516295492649078,-0.31180164217948914,0.31512483954429626,0.42726629972457886,-0.0699368566274643,-0.13150301575660706,0.07564195245504379,0.34827515482902527,0.02002750150859356,0.10732749104499817,0.24983906745910645,0.0988081768155098,-0.244043231010437,-0.4029881954193115},{0.18080107867717743,0.1391596645116806,0.16386011242866516,-0.17465513944625854,-0.2787625789642334,-0.03861391171813011,-0.28831660747528076,0.06033032014966011,-0.17259061336517334,0.2671145498752594,-0.08159830421209335,-0.30625274777412415,-0.0790281593799591,0.11384899914264679,-0.3831983804702759,-0.03452521190047264},{-0.4810439646244049,-0.34427088499069214,0.19545678794384003,-0.26835349202156067,-0.11421199142932892,-0.015543607994914055,0.2506552040576935,0.2854202687740326,-0.20609714090824127,-0.02653069794178009,-0.0845721960067749,-0.0009034434333443642,-0.29822129011154175,-0.08694382011890411,0.22123904526233673,0.07692785561084747},{0.13722501695156097,0.2830980718135834,0.0712529718875885,0.028619661927223206,-0.34125468134880066,0.42773839831352234,0.27004778385162354,0.17108987271785736,-0.17717212438583374,0.17186959087848663,0.1251368522644043,0.3129757046699524,-0.4122043550014496,-0.37562617659568787,-0.06332488358020782,0.2292318046092987},{-0.4667430818080902,-0.014165714383125305,0.13549618422985077,0.024652494117617607,0.11578819155693054,0.23546303808689117,0.20925337076187134,-0.21642501652240753,-0.353421151638031,-0.2760617733001709,0.052782073616981506,0.2863277196884155,0.03578290715813637,0.08833025395870209,0.3671233057975769,-0.10173602402210236},{0.4379364848136902,0.1793457716703415,-0.29641565680503845,-0.009326035156846046,0.26363733410835266,-0.06293550133705139,-0.34148871898651123,-0.34571602940559387,-0.26677629351615906,0.30175694823265076,-0.0196775384247303,0.3826083540916443,-0.3036232590675354,0.46311599016189575,-0.36979880928993225,0.0817502811551094},{0.35360613465309143,-0.17579880356788635,0.10405758768320084,0.42396754026412964,-0.10556893795728683,0.3147444427013397,0.25940752029418945,0.43436935544013977,-0.06453435122966766,-0.26101475954055786,-0.2957962155342102,0.11606596410274506,-0.2318151593208313,-0.35059067606925964,-0.28860050439834595,0.16933612525463104},{0.049955982714891434,-0.08745836466550827,-0.06999799609184265,-0.448886513710022,0.11998322606086731,-0.06852010637521744,-0.147435262799263,-0.2665307819843292,-0.1808824986219406,-0.4548233151435852,-0.7282164096832275,-0.16235105693340302,-0.01424352452158928,-0.10662230104207993,0.47602659463882446,0.13731645047664642},{0.2123464196920395,-0.6837882995605469,-0.39558038115501404,0.006162205245345831,0.3229944407939911,0.014074021019041538,0.20422670245170593,-0.2637439966201782,0.17625392973423004,-0.5538623332977295,0.11894672363996506,-0.5188791751861572,0.5135379433631897,-0.7690712213516235,-0.28560182452201843,-0.130395770072937},{-0.016156161203980446,-0.15611080825328827,-0.6268515586853027,0.5758593082427979,-0.13672508299350739,0.04768959805369377,0.0058923629112541676,-0.045536015182733536,-0.1283029168844223,-0.11743906140327454,0.3324224054813385,-0.17063584923744202,-0.5243264436721802,0.009524394758045673,0.2463933378458023,-0.5016533732414246},{-0.1569669544696808,0.04061535373330116,-0.21238267421722412,0.24211318790912628,0.3621947467327118,-0.25375881791114807,0.28200098872184753,0.01071859523653984,0.05669599771499634,0.08378829061985016,0.2842589318752289,0.15372060239315033,-0.053171757608652115,-0.277000367641449,0.05465256795287132,0.1551840603351593},{-0.29811251163482666,0.16260793805122375,-0.16534385085105896,0.30371013283729553,0.01719985157251358,-0.38875043392181396,0.272716224193573,0.15935847163200378,-0.08884602040052414,-0.11596164107322693,0.04794945567846298,-0.03472831845283508,-0.236040860414505,-0.19181853532791138,-0.33453813195228577,-0.310228556394577},{-0.3088952898979187,0.260090708732605,0.05295262113213539,0.04079081118106842,-0.3481176793575287,0.11950939893722534,-0.3187081515789032,0.10247521847486496,-0.19358375668525696,0.16503162682056427,-0.030827701091766357,0.36065492033958435,0.2344965636730194,0.31704118847846985,0.3826923072338104,-0.29722416400909424},{0.2515743374824524,-0.3104581832885742,-0.1487942636013031,-0.08926358819007874,-0.38068607449531555,-0.1908722072839737,-0.22813665866851807,-0.22928141057491302,-0.16017583012580872,-0.020316587761044502,-0.3173121213912964,0.023206688463687897,0.02588280290365219,0.1563708782196045,-0.06076487898826599,-0.22572143375873566}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.13651645183563232,0.3160443603992462,0.04524637386202812,0.4563103914260864,0.16420285403728485,-0.12119772285223007,-0.1928023099899292,-0.41888681054115295,-0.08524871617555618,-0.20225167274475098,0.22499628365039825,0.011310964822769165,0.3619546890258789,0.08025927096605301,-0.3925192058086395,-0.3868754804134369},{-0.32821670174598694,0.20231400430202484,-0.2270621955394745,-0.04610046371817589,0.11791027337312698,-0.0052546062506735325,-0.5122455954551697,0.12716910243034363,0.34703463315963745,0.11579176783561707,0.03847554326057434,-0.030920278280973434,-0.20375902950763702,-0.09797841310501099,-0.2952399253845215,-0.09563974291086197},{0.4081836938858032,0.3564285337924957,-0.33808109164237976,-0.5166698694229126,0.33074861764907837,-0.298335462808609,-0.5323598384857178,0.14362649619579315,0.3690532445907593,-0.2904771864414215,0.1399715691804886,-0.2667674422264099,-0.042234472930431366,-0.04069065675139427,0.320315420627594,0.37684205174446106},{0.3284938931465149,-0.09740906208753586,-0.24861988425254822,0.3483563959598541,-0.3067774772644043,0.30208370089530945,0.16329793632030487,-0.04071030765771866,-0.14233757555484772,0.3008993864059448,0.364896297454834,-0.40279582142829895,0.13948723673820496,-0.3072494566440582,-0.413055419921875,0.0371980294585228},{0.10447321087121964,0.14650081098079681,-0.005479601211845875,-0.06790732592344284,0.03623088076710701,-0.003239093581214547,-0.21915799379348755,0.2909815311431885,-0.13682158291339874,-0.278633713722229,-0.2544049322605133,0.2394687682390213,0.24626372754573822,-0.22786371409893036,0.21638436615467072,0.09876493364572525},{0.45698782801628113,0.059296466410160065,-0.2782275974750519,-0.1347063034772873,0.28083059191703796,0.12732525169849396,-0.2108050286769867,-0.3210126757621765,-0.09293116629123688,0.18154068291187286,-0.1112096756696701,-0.10940594971179962,-0.35654374957084656,0.42679333686828613,0.21521548926830292,-0.11111022531986237},{0.2726505696773529,-0.36553484201431274,-0.3580513298511505,-0.268680214881897,-0.014163542538881302,0.2342035323381424,-0.2931482493877411,0.04725883528590202,0.11761816591024399,0.17579638957977295,-0.003603481687605381,0.3363785147666931,0.3170473575592041,-0.17237024009227753,0.23950383067131042,0.34619033336639404},{-0.3334121108055115,0.34468069672584534,-0.13427063822746277,0.39103376865386963,0.1929796040058136,-0.020203325897455215,0.3376317024230957,0.44112804532051086,-0.07920230180025101,-0.24008505046367645,0.25147292017936707,-0.42465677857398987,-0.09438097476959229,-0.08536794036626816,-0.12122669070959091,0.04632384702563286},{0.08061423897743225,-0.1958228349685669,0.04324471950531006,0.22814320027828217,0.16423159837722778,0.1352718472480774,0.02045796997845173,0.4275815188884735,-0.007577897049486637,0.10424202680587769,-0.23889580368995667,-0.13176539540290833,0.3065595328807831,-0.45068466663360596,0.40112459659576416,0.034509651362895966},{-0.07754756510257721,-0.10360985994338989,-0.25762754678726196,0.21697969734668732,-0.31221863627433777,-0.024345654994249344,0.26606202125549316,0.20956261456012726,0.249528169631958,-0.17238646745681763,-0.1974007487297058,0.007743717636913061,-0.26223933696746826,0.04266786947846413,-0.37227892875671387,0.010274048894643784},{-0.11757330596446991,-0.218116894364357,0.22364641726016998,0.2770061492919922,-0.1518544703722,-0.30611443519592285,0.3011547029018402,-0.11095407605171204,-0.14438548684120178,0.0672975704073906,-0.00247235712595284,-0.3438112735748291,-0.38601818680763245,-0.5382705330848694,-0.30916452407836914,-0.09424451738595963},{-0.035076748579740524,-0.5105761885643005,0.2113940566778183,-0.24283677339553833,0.14793168008327484,0.17200040817260742,-0.4097100496292114,-0.325742244720459,0.22558006644248962,0.11744295805692673,-0.5730434060096741,0.38085243105888367,-0.23374000191688538,-0.09530699998140335,0.23611968755722046,0.18124394118785858},{-0.11170060187578201,0.12330365180969238,-0.29316094517707825,0.14983604848384857,0.2101249247789383,-0.026160821318626404,0.36162710189819336,-0.3432389199733734,-0.125658318400383,-0.11406292021274567,-0.35940390825271606,0.4070630371570587,0.39069339632987976,0.27344223856925964,0.1387232542037964,0.3388896584510803},{-0.34581929445266724,-0.00976442452520132,0.2798766791820526,-0.32524076104164124,0.368430495262146,-0.4186934232711792,-0.05243737995624542,-0.27890753746032715,0.2379172146320343,0.20516271889209747,0.315022736787796,0.4194582998752594,-0.15759582817554474,-0.1261826604604721,-0.3087921440601349,0.27951014041900635},{-0.14268937706947327,-0.16456905007362366,-0.31682634353637695,0.24050754308700562,-0.15918511152267456,0.49206021428108215,0.2805221676826477,0.23322536051273346,0.19768542051315308,-0.012622078880667686,-0.14231394231319427,-0.20132876932621002,0.24980977177619934,0.18061520159244537,-0.0807061716914177,0.09994381666183472},{-0.11992351710796356,0.3386183977127075,-0.019763052463531494,-0.1669873595237732,0.06780023872852325,-0.05058418959379196,0.22462692856788635,0.2510765790939331,-0.18512824177742004,-0.1943884789943695,-0.19739940762519836,0.2734357416629791,0.11083481460809708,-0.23531664907932281,-0.37655630707740784,0.07753967493772507}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.03974829614162445,-0.007830319926142693,0.08476141840219498,0.1930970549583435,0.4070996642112732,-0.12051092088222504,-0.12109924852848053,0.055102910846471786,-0.20570725202560425,-0.09248893707990646,0.037933606654405594,0.1616770625114441,0.2908666431903839,-0.08622246235609055,0.26746541261672974,0.1302364617586136,0.21609170734882355,0.07383724302053452,0.04334183782339096,-0.017631080001592636,0.2822308838367462,-0.19366370141506195,-0.282940536737442,-0.23978687822818756,-0.10720193386077881,0.10976240783929825,-0.26816579699516296,-0.24956080317497253,0.21867114305496216,-0.11327356100082397,-0.3580051064491272,-0.17162057757377625},{0.22099247574806213,0.10108012706041336,0.2744755446910858,0.3381333351135254,0.3936002254486084,-0.02064388617873192,0.16420219838619232,-0.4005553424358368,0.1743665188550949,0.10526488721370697,-0.09777244180440903,-0.18298682570457458,-0.20844365656375885,-0.16557306051254272,-0.31221121549606323,0.329319566488266,0.17198505997657776,-0.2827029824256897,0.14139799773693085,0.20270107686519623,-0.05722624808549881,0.3012838065624237,-0.2699732184410095,0.09633873403072357,0.053442105650901794,-0.3435201346874237,-0.1621757596731186,0.40517887473106384,-0.2609349489212036,0.024831628426909447,0.3091655373573303,-0.13505856692790985},{0.1992436647415161,-0.08200432360172272,-0.17908023297786713,-0.31743836402893066,-0.27330538630485535,-0.22503821551799774,-0.366069495677948,0.1389705091714859,-0.3475225567817688,-0.18477670848369598,0.16892214119434357,0.29017993807792664,0.2079855054616928,-0.09459903836250305,-0.17158810794353485,0.11917996406555176,0.2645631730556488,-0.17535534501075745,-0.11446201801300049,0.22444355487823486,-0.22932404279708862,0.018561212345957756,-0.01679305173456669,0.0005198229337111115,0.0006321841501630843,0.36214450001716614,-0.26241806149482727,0.2072277069091797,-0.4861983358860016,-0.14788499474525452,-0.06138981878757477,0.05020897462964058},{0.16291740536689758,-0.3296286165714264,-0.13594350218772888,0.22140473127365112,0.1146019920706749,-0.20136389136314392,0.29611608386039734,0.05672890320420265,0.15829253196716309,-0.07303517311811447,0.013974487781524658,-0.046988338232040405,0.30400627851486206,0.1701440066099167,-0.22233936190605164,-0.22110500931739807,-0.1375524401664734,0.1774694174528122,0.19252297282218933,-0.019561920315027237,-0.019697384908795357,0.3713964521884918,-0.08337345719337463,-0.25571784377098083,0.04632094129920006,0.09066585451364517,0.1443602442741394,0.058306366205215454,-0.344721257686615,-0.35622331500053406,0.12897762656211853,0.15287192165851593},{-0.08989821374416351,0.1523573398590088,-0.005264902021735907,0.13025030493736267,0.1882622092962265,0.25960755348205566,0.147078275680542,-0.2584579586982727,-0.008430175483226776,0.15047107636928558,-0.1517850160598755,0.13990575075149536,-0.3255271017551422,0.1229376569390297,-0.006851536221802235,0.2542712092399597,0.1397591084241867,0.002141255885362625,0.00849977321922779,0.1775505393743515,0.11898346990346909,-0.07059361040592194,-0.35674914717674255,-0.3236570656299591,-0.07000313699245453,0.14761921763420105,0.16644451022148132,0.10589180886745453,0.21364247798919678,-0.15975956618785858,-0.15821683406829834,0.25516384840011597},{-0.2991431653499603,0.2778216302394867,-0.012271965853869915,-0.012518110685050488,-0.35743680596351624,-0.25817468762397766,-0.10200650990009308,0.052136216312646866,0.20011909306049347,-0.17415116727352142,0.04999108612537384,-0.3573993444442749,-0.16691197454929352,0.10894565284252167,0.050753723829984665,-0.18317162990570068,-0.17956246435642242,0.010777728632092476,0.06910453736782074,-0.34219810366630554,0.1984289288520813,-0.08886387199163437,0.04198102653026581,-0.16623671352863312,0.152226984500885,0.0820956602692604,-0.06561984121799469,0.10821836441755295,0.09151551872491837,-0.022234516218304634,-0.24722859263420105,-0.25291359424591064},{-0.005075020249933004,-0.14735713601112366,0.028292708098888397,-0.17938372492790222,-0.1649249792098999,0.05848207697272301,-0.3583102822303772,-0.12613315880298615,-0.07392890006303787,0.2623087167739868,-0.2216341197490692,0.0613747239112854,0.273254930973053,-0.021630818024277687,-0.33244553208351135,-0.23690368235111237,0.04692353308200836,0.14928077161312103,0.1319575309753418,0.3246958255767822,-0.2818359434604645,0.1940661370754242,-0.03817901760339737,0.03876982256770134,0.2264062762260437,-0.09798772633075714,-0.019886668771505356,0.354562908411026,-0.045038122683763504,-0.2945461571216583,-0.3025459051132202,0.24080626666545868},{0.08192787319421768,0.197583869099617,0.12234272062778473,0.15830251574516296,-0.15410293638706207,-0.37300410866737366,0.19167588651180267,-0.22636303305625916,-0.05462805926799774,-0.23927868902683258,0.3019505739212036,-0.10507287830114365,-0.043201807886362076,-0.09106941521167755,0.2828198969364166,0.1564459353685379,0.08700522780418396,0.012316843494772911,-0.28343960642814636,0.038655783981084824,-0.28928789496421814,-0.012321061454713345,-0.1990288347005844,0.1906069964170456,0.08020047098398209,-0.07104220986366272,0.20832893252372742,-0.0010725344764068723,0.08507667481899261,-0.21703366935253143,-0.17838367819786072,0.2822594940662384},{0.21963299810886383,0.4227982461452484,-0.17753776907920837,0.26645293831825256,-0.0035917656496167183,0.18750999867916107,0.4766532778739929,-0.29837068915367126,-0.11210603266954422,-0.040523990988731384,0.1713642030954361,-0.13166198134422302,-0.04437447339296341,0.31046128273010254,-0.08253347873687744,0.22294825315475464,0.20664134621620178,0.20995162427425385,0.16076332330703735,0.188214510679245,-0.23798279464244843,-0.2575998902320862,0.13611164689064026,0.21929030120372772,0.10301370173692703,0.3184772729873657,-0.3843179941177368,-0.3231310546398163,-0.060842130333185196,0.26446712017059326,0.06256470084190369,0.22015061974525452},{0.11860305815935135,-0.04377610981464386,0.061797305941581726,-0.3185975253582001,-0.01996682770550251,-0.279890239238739,0.064974345266819,0.29235079884529114,-0.23195962607860565,-0.23994919657707214,0.17376358807086945,-0.16756762564182281,0.08356058597564697,0.13078449666500092,-0.15339788794517517,0.3091330826282501,0.08128249645233154,-0.308893620967865,0.15604710578918457,0.037461549043655396,0.2184719741344452,-0.3503199815750122,0.32569271326065063,-0.0415949746966362,0.10928236693143845,0.25076428055763245,0.2335817515850067,0.2712772488594055,-0.10630165785551071,0.272569477558136,-0.036751288920640945,0.041699815541505814},{0.18413046002388,0.06507845222949982,0.3371727466583252,-0.31680649518966675,0.16236458718776703,-0.16392068564891815,-0.13282883167266846,-0.32136180996894836,0.0374952033162117,0.397961288690567,0.1801985204219818,0.03301228955388069,0.12321977317333221,0.132217675447464,0.004974400624632835,0.2908457815647125,-0.06943275034427643,-0.2897668182849884,-0.11420045047998428,0.02952798269689083,-0.20696638524532318,0.13254880905151367,0.030616294592618942,-0.20118477940559387,-0.13525784015655518,-0.18310347199440002,-0.15579178929328918,0.052397292107343674,-0.21387819945812225,-0.002856325823813677,0.3697943389415741,0.3563693165779114},{0.2731419503688812,0.11732415109872818,-0.18677136301994324,-0.3649370074272156,-0.27742999792099,-0.2334490418434143,0.2373209148645401,0.11358414590358734,-0.19991979002952576,0.215772345662117,-0.4266235828399658,-0.12018579244613647,-0.1790882647037506,-0.09923092275857925,-0.14858220517635345,-0.2265833169221878,-0.39617180824279785,-0.3276454210281372,0.10626436769962311,0.15068024396896362,-0.04900868237018585,0.27827513217926025,-0.1813170164823532,-0.12391719967126846,0.21537047624588013,0.3367515504360199,0.17674298584461212,-0.1996256411075592,-0.1545618623495102,-0.27349093556404114,-0.2862160801887512,0.11364276707172394},{-0.10021056234836578,-0.10172222554683685,-0.20782390236854553,0.029082881286740303,0.23262912034988403,-0.16243697702884674,0.15095169842243195,0.37634941935539246,0.1532009243965149,0.21050560474395752,-0.16201569139957428,-0.28872913122177124,0.08538411557674408,0.10732029378414154,0.15531232953071594,0.11328364163637161,-0.3958892822265625,-0.2190515249967575,-0.12225780636072159,0.23822662234306335,-0.1264979988336563,-0.23213723301887512,-0.29127535223960876,-0.14764165878295898,0.2191053330898285,0.3223736584186554,0.2807614207267761,0.11497482657432556,-0.23511596024036407,-0.17419463396072388,0.04994172230362892,-0.25919342041015625},{0.28524813055992126,-0.05579078942537308,-0.2868262827396393,-0.08608217537403107,0.0330902636051178,0.07803572714328766,-0.045403990894556046,-0.08804359287023544,0.1572714000940323,0.36642324924468994,-0.34546956419944763,0.2750709652900696,0.1999037116765976,-0.27863648533821106,0.07733476161956787,-0.2719474732875824,-0.0984952449798584,0.16091476380825043,-0.1660350263118744,0.38195279240608215,0.13363134860992432,-0.14902926981449127,-0.24490785598754883,-0.12841330468654633,-0.3678775727748871,0.09339414536952972,0.01571699231863022,0.23980189859867096,-0.020575355738401413,0.14915700256824493,0.345638245344162,-0.19331900775432587},{0.1148325502872467,-0.17809122800827026,0.09480917453765869,-0.04246605560183525,-0.19539107382297516,-0.3002723455429077,0.21876472234725952,-0.26330891251564026,0.24864092469215393,0.15544041991233826,-0.1795651763677597,0.1820790022611618,-0.06252484023571014,0.03854424133896828,-0.14381755888462067,-0.05043381452560425,0.07397681474685669,-0.059053387492895126,-0.0029611163772642612,-0.20660586655139923,-0.00753262871876359,-0.21185536682605743,-0.23473772406578064,-0.3812262713909149,0.014341364614665508,-0.2208709716796875,0.1511296033859253,0.08899601548910141,0.21845757961273193,0.05203525349497795,0.04547963663935661,-0.053123146295547485},{0.21837542951107025,-0.1418905407190323,-0.27828991413116455,0.27957117557525635,-0.13477183878421783,0.1267172396183014,0.2894558012485504,-0.31690821051597595,-0.09075432270765305,-0.2701468765735626,-0.27734968066215515,-0.32342028617858887,-0.3004431128501892,-0.26208263635635376,0.032725121825933456,0.32396578788757324,0.3041219413280487,-0.23946520686149597,0.04769871011376381,-0.034417007118463516,-0.12364354729652405,-0.1978364735841751,-0.22061848640441895,0.19719114899635315,-0.15698939561843872,-0.00845247134566307,-0.20034979283809662,-0.06522255390882492,-0.20438003540039062,-0.09767448902130127,-0.17082341015338898,-0.19527606666088104},{0.2412693053483963,0.22450962662696838,-0.16336050629615784,-0.12665502727031708,0.10027182847261429,0.21576251089572906,0.12956200540065765,0.14996281266212463,0.1257495880126953,-0.26898980140686035,0.1754562109708786,0.06653561443090439,0.10636356472969055,-0.09202159196138382,0.20231817662715912,0.14719025790691376,-0.11730172485113144,0.05253330618143082,-0.14617204666137695,-0.25773370265960693,0.027081329375505447,0.21373140811920166,-0.10695986449718475,-0.2844841182231903,-0.11499416083097458,-0.017691250890493393,0.20721086859703064,-0.1312101036310196,0.12708498537540436,-0.2837355136871338,0.03230898082256317,-0.14557895064353943},{-0.3137005865573883,-0.15121904015541077,0.18803247809410095,-0.13442373275756836,0.16975687444210052,0.13683132827281952,0.15306797623634338,-0.11239796876907349,-0.07808846980333328,0.05604444444179535,0.21066832542419434,0.08457959443330765,-0.05971010774374008,0.06304702907800674,-0.18777823448181152,-0.20337273180484772,0.15505915880203247,-0.1261550933122635,0.10021767765283585,0.13369542360305786,0.2959948480129242,0.24050438404083252,0.10800033062696457,-0.20697930455207825,0.13851183652877808,0.10965215414762497,0.2867712676525116,0.2329660952091217,-0.17055891454219818,-0.19166132807731628,0.06107284873723984,0.23825916647911072},{0.12502902746200562,-0.16938896477222443,-0.23608382046222687,0.060442980378866196,-0.024485677480697632,0.18529774248600006,-0.28726738691329956,0.13655968010425568,-0.2744365334510803,-0.33521372079849243,0.17134393751621246,0.019999943673610687,-0.05803961306810379,-0.24582119286060333,-0.06220969557762146,-0.09805264323949814,0.1239851638674736,0.11253006011247635,-0.013901880010962486,0.18400317430496216,0.028731567785143852,0.023174326866865158,0.05007011443376541,0.22743722796440125,0.13062462210655212,-0.35762545466423035,0.020048372447490692,0.11129020154476166,-0.09842516481876373,-0.15576171875,0.11234316974878311,0.10292045772075653},{0.17813915014266968,0.24177664518356323,0.12273713201284409,-0.12134157121181488,-0.29649728536605835,0.026989273726940155,-0.11224418133497238,0.2713378369808197,0.09243214875459671,-0.018738452345132828,-0.12080486863851547,0.054465532302856445,0.18757528066635132,0.23579777777194977,-0.06363358348608017,-0.30534347891807556,-0.3916906416416168,0.3377336263656616,0.44300901889801025,-0.3259885311126709,-0.2255467176437378,0.27368658781051636,0.2104298621416092,-0.2216801792383194,0.2220979481935501,0.03391958028078079,0.3099565804004669,0.02747965417802334,0.09714873135089874,-0.020965928211808205,-0.15906228125095367,0.15580560266971588},{-0.3029574155807495,0.0371319055557251,-0.19639424979686737,-0.009887948632240295,-0.12446034699678421,-0.17570807039737701,0.03607482835650444,-0.10137161612510681,-0.15703825652599335,0.18119023740291595,0.18960262835025787,0.0500464029610157,0.017785966396331787,-0.3154202103614807,-0.263114869594574,0.1716318130493164,-0.24254992604255676,0.004670605529099703,-0.2651630640029907,-0.007397057022899389,-0.053980544209480286,0.14161929488182068,0.2300674468278885,0.005509928800165653,-0.1782657951116562,-0.05814036354422569,0.04366079717874527,0.20788903534412384,0.09673544019460678,-0.21582067012786865,-0.08041967451572418,-0.054071273654699326},{-0.0061849928461015224,0.3084200322628021,0.053152233362197876,0.12282402813434601,0.15362942218780518,0.05673174187541008,0.14742019772529602,0.20802325010299683,-0.3249950706958771,0.015437522903084755,-0.034579820930957794,0.12053146213293076,-0.20756664872169495,0.45762231945991516,0.02221989631652832,-0.07879739999771118,0.06029777601361275,0.11590074747800827,0.022328265011310577,0.20538006722927094,-0.26935574412345886,0.11442095786333084,-0.038414690643548965,0.28658556938171387,0.17944754660129547,0.0828402042388916,0.1925162523984909,-0.19429118931293488,0.2555043697357178,0.23595096170902252,-0.12970654666423798,-0.15982364118099213},{-0.2450878620147705,0.30689600110054016,0.012454606592655182,0.10155928134918213,-0.1906455159187317,0.1955241709947586,0.013182480819523335,0.07679247111082077,0.12499677389860153,-0.34894299507141113,-0.10681518912315369,-0.2353060096502304,-0.13346680998802185,0.08041295409202576,0.03627242520451546,-0.1804720163345337,0.09616535902023315,0.18363256752490997,0.321110337972641,0.1264951527118683,-0.2137349396944046,-0.22427527606487274,-0.1652257740497589,0.3551611602306366,0.39333033561706543,0.17749379575252533,0.2004474550485611,-0.050679124891757965,0.05960719659924507,-0.026702629402279854,-0.3508606255054474,0.1672113835811615},{-0.12588630616664886,-0.028702080249786377,-0.07439084351062775,-0.24283985793590546,0.14618588984012604,0.10699475556612015,0.17650941014289856,-0.04422502964735031,0.27673009037971497,0.14461103081703186,0.17483390867710114,-0.14337888360023499,-0.033584114164114,-0.05898061394691467,-0.26365217566490173,-0.1207214742898941,-0.24394503235816956,-0.21714283525943756,-0.16852796077728271,-0.28959617018699646,-0.03821121156215668,0.1288953274488449,0.06996949017047882,0.21997852623462677,0.12967446446418762,0.0323031060397625,0.2653036415576935,-0.35080358386039734,-0.11108314245939255,-0.1196824237704277,0.07686734944581985,-0.004575933795422316}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.2722969651222229,-0.02461051382124424,-0.33871737122535706,-0.24511313438415527},{0.09887947142124176,-0.16358274221420288,-0.08643016964197159,0.39294373989105225},{0.05188041552901268,0.04767685756087303,-0.2041013091802597,-0.13439421355724335},{-0.3155948221683502,0.015396947041153908,0.09551630169153214,0.19302122294902802},{-0.3399236500263214,0.046369440853595734,-0.11376272886991501,-0.3470747172832489},{0.21106570959091187,-0.2653007209300995,-0.3836734890937805,0.10331334173679352},{0.10632090270519257,0.020945345982909203,-0.05743229389190674,0.4640703797340393},{0.4622947573661804,0.3848341703414917,0.1386471390724182,0.07630029320716858},{-0.3648344874382019,0.24543218314647675,0.21622343361377716,0.0705137699842453},{-0.21562545001506805,-0.3122406303882599,-0.2181713879108429,-0.29024437069892883},{-0.011220531538128853,0.3326479494571686,-0.2772552967071533,-0.2703498303890228},{-0.2153889536857605,-0.2299814522266388,0.17122824490070343,0.14856722950935364},{0.27968719601631165,0.3563891649246216,-0.19269059598445892,-0.43578559160232544},{0.3474652171134949,-0.03829319775104523,-0.12470252811908722,0.08554131537675858},{0.35256773233413696,0.37764614820480347,-0.4783543348312378,-0.3211686909198761},{-0.03663747385144234,0.09545859694480896,-0.2365606725215912,-0.024711860343813896},{-0.42560040950775146,-0.11107932031154633,-0.4144774377346039,-0.3900865912437439},{-0.13242806494235992,0.24124747514724731,0.11128465831279755,0.18127155303955078},{0.11127053201198578,0.35780730843544006,0.28514528274536133,0.08938752859830856},{-0.10925453156232834,-0.3657430112361908,0.19464239478111267,-0.2734771966934204},{0.1266946643590927,0.13719268143177032,-0.32705557346343994,-0.13300061225891113},{-0.13598009943962097,0.23221582174301147,0.3806023895740509,-0.20762991905212402},{0.3868011236190796,-0.03725938871502876,-0.3469145596027374,-0.11178090423345566},{0.29822611808776855,0.22469095885753632,-0.21662844717502594,-0.058076731860637665},{0.4196533262729645,0.4098910987377167,0.29722222685813904,0.11093142628669739},{0.3520490825176239,-0.27976009249687195,0.25319215655326843,-0.10327083617448807},{-0.21268074214458466,0.3599822521209717,0.38502877950668335,0.09096776694059372},{-0.21001406013965607,-0.29147839546203613,-0.01716880314052105,-0.3947349190711975},{-0.3070293962955475,0.2653849720954895,-0.3383663296699524,0.39693108201026917},{0.15918493270874023,-0.3044869005680084,-0.48169293999671936,-0.16520562767982483},{-0.06995006650686264,-0.1633654236793518,0.014811513014137745,0.12959519028663635},{0.06537727266550064,0.04789622500538826,-0.3204803764820099,-0.2401856780052185}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.02830536849796772,0.018182704225182533,0.05975089594721794,-0.0934993177652359,0.026215244084596634,0.03365720808506012,0.023203827440738678,-0.04945514351129532,0.0915525034070015,0.00174202979542315,0.031253643333911896,0.007697011809796095,0.11657175421714783,0.09647020697593689,-0.05776394531130791,0.0867963507771492};
static const float actor_encoder_self_encoder_2_bias[16] = {0.02495855838060379,0.044287845492362976,0.012196539901196957,-0.030369576066732407,0.04554543271660805,-0.03806750103831291,0.011922984384000301,0.010088546201586723,0.0028636385686695576,-0.010044325143098831,0.0032442924566566944,0.010747645050287247,-0.01938033476471901,-0.0259760282933712,-0.018915724009275436,0.006709440145641565};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.009091741405427456,0.016315625980496407,0.023534122854471207,-0.013506265357136726,-0.02808506041765213,0.021749986335635185,0.022906342521309853,0.0017875266494229436,-0.017327168956398964,-0.013192674145102501,-0.04904075711965561,0.005916643422096968,-0.04129764810204506,-0.010663316585123539,0.004714366979897022,-0.006901537999510765,-0.0255220178514719,-0.006243973504751921,-0.002440850483253598,0.0007215310470201075,-0.011225860565900803,-0.003010215936228633,-0.0021641068160533905,0.0044714342802762985,0.00743220467120409,-0.016191773116588593,-0.020495539531111717,-0.007804485037922859,-0.00813937559723854,0.021690059453248978,0.026440121233463287,-0.008947127498686314};
static const float action_parameterization_distribution_linear_bias[4] = {0.02024436742067337,-0.010340377688407898,0.014006811194121838,0.015734432265162468};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[3][8] = {{-0.6940566897392273,0.7352064847946167,-0.10106632858514786,0.4519205093383789,0.6038139462471008,-0.08491232991218567,0.5095295310020447,-0.6136538982391357},{0.22970899939537048,0.5111400485038757,0.8130003809928894,-0.3472527265548706,0.36967727541923523,-0.33893662691116333,0.16218602657318115,0.6031731367111206},{0.4005660116672516,0.44590210914611816,-0.30741623044013977,0.16424167156219482,-0.07983867079019547,0.4177960157394409,-1.076266884803772,0.06943163275718689}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{0.34997981786727905,-0.682642936706543,0.1630559116601944,-0.6600656509399414,0.827451229095459,-0.45190757513046265,-0.07473234832286835,0.4690808057785034},{0.2882080376148224,-0.29308855533599854,-0.42843079566955566,-0.6168781518936157,-0.3303215801715851,0.45767444372177124,-0.6606610417366028,-0.395722895860672},{-0.18529106676578522,-0.06465306878089905,-0.427884042263031,-0.4406023919582367,0.7682612538337708,0.7223151326179504,0.5466337203979492,0.010676305741071701},{-0.3302954137325287,0.3618684411048889,-0.44747480750083923,-0.25345680117607117,-0.7421706914901733,0.01138451136648655,-0.15817445516586304,0.5927811861038208},{-0.6642900109291077,-0.0933082178235054,0.17292439937591553,0.0909733772277832,-0.5477922558784485,0.19435030221939087,-0.03496719151735306,0.48027336597442627},{0.24709372222423553,-0.3984626829624176,-0.24493439495563507,-0.35062411427497864,0.11481617391109467,0.4278887212276459,-0.4382190406322479,-0.05070662871003151},{0.34975337982177734,-0.3820900619029999,-0.0062821111641824245,0.22178076207637787,-0.3721645176410675,0.6024126410484314,-0.14167307317256927,0.6080980896949768},{-0.12456388771533966,0.46290963888168335,-0.15966734290122986,-0.14279283583164215,0.6783896684646606,-0.5294455885887146,0.0908658504486084,0.15619444847106934}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {0.0019204890122637153,-0.01438613049685955,-0.009973090142011642,0.026322750374674797,0.04198390245437622,-0.01460098847746849,-0.019466841593384743,0.03559507429599762};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.028491102159023285,-0.007226321846246719,0.015518701635301113,-0.016899392008781433,-0.025597985833883286,0.008963958360254765,0.001949701807461679,-0.018399562686681747};

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
    for (int i = 0; i < self_structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < self_structure[0][0]; j++) {
            output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
        }
        output_0[i] += actor_encoder_self_encoder_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }

    for (int i = 0; i < self_structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < self_structure[1][0]; j++) {
            output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
        }
        output_1[i] += actor_encoder_self_encoder_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }

    // Concat self_embed and neighbor_embed
    for (int i = 0; i < D_SELF; i++) {
        output_embeds[i] = output_1[i];
    }
    for (int i = 0; i < D_NBR; i++) {
        output_embeds[D_SELF + i] = neighbor_embeds[i];
    }

    // Feedforward layer
    for (int i = 0; i < self_structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < self_structure[2][0] ; j++) {
            output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
        }
        output_2[i] += actor_encoder_feed_forward_0_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < self_structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < self_structure[3][0]; j++) {
            output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
        }
        output_3[i] += action_parameterization_distribution_linear_bias[i];
    }

    control_n->thrust_0 = output_3[0];
    control_n->thrust_1 = output_3[1];
    control_n->thrust_2 = output_3[2];
    control_n->thrust_3 = output_3[3];
}

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS*NBR_OBS_DIM]) {
    for (int n = 0; n < NEIGHBORS; n++) {            
        for (int i = 0; i < nbr_structure[0][1]; i++) {
            nbr_output_0[n][i] = 0; 
            for (int j = 0; j < nbr_structure[0][0]; j++) {
                nbr_output_0[n][i] += neighbor_inputs[n*NBR_OBS_DIM + j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i]; 
            }
            nbr_output_0[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
            nbr_output_0[n][i] = tanhf(nbr_output_0[n][i]);
        }
    }

    for (int n = 0; n < NEIGHBORS; n++) {
        for (int i = 0; i < nbr_structure[1][1]; i++) {
            nbr_output_1[n][i] = 0;
            for (int j = 0; j < nbr_structure[1][0]; j++) {
                nbr_output_1[n][i] += nbr_output_0[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
            }
            nbr_output_1[n][i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
            nbr_output_1[n][i] = tanhf(nbr_output_1[n][i]);
        }
    }

    // Average over number of neighbors
    for (int i = 0; i < D_NBR; i++) {
        neighbor_embeds[i] = 0;
        for (int n = 0; n < NEIGHBORS; n++) {
            neighbor_embeds[i] += nbr_output_1[n][i];
        }
        neighbor_embeds[i] /= NEIGHBORS;
    }
}
