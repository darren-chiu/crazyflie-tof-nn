
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.0954032614827156,-0.00900452584028244,0.0009630521526560187,0.03269302845001221,-0.4416114389896393,0.08522078394889832,-0.3131549656391144,0.5592689514160156,0.14482265710830688,0.05366668105125427,0.0034196937922388315,-0.2724017798900604,0.07286617159843445,0.023250896483659744,0.509702742099762,0.16906769573688507},{-0.046442508697509766,-0.35612207651138306,0.47376778721809387,0.008981355465948582,0.24727293848991394,0.06340009719133377,0.1991666704416275,-0.14800319075584412,-0.0513763390481472,0.008006508462131023,-0.7097445130348206,0.03389488533139229,0.06180213391780853,0.06277284026145935,-0.2073688507080078,0.325519859790802},{0.09991759806871414,0.3290857970714569,0.36972206830978394,0.18302124738693237,-0.20655441284179688,0.22229227423667908,0.28265148401260376,0.6899716258049011,-0.32732465863227844,0.5600680708885193,0.13633206486701965,0.2916724681854248,-0.06252733618021011,0.24238407611846924,-0.05746607854962349,-0.10192134231328964},{0.045292481780052185,-0.13142210245132446,-0.03092823550105095,0.2141745239496231,0.03424181416630745,-0.1723887324333191,-0.0656237080693245,0.38460657000541687,0.06496872752904892,0.11780507117509842,0.08195272833108902,-0.293487012386322,0.03595603629946709,0.01847762055695057,0.009437677450478077,0.1826425939798355},{-0.0951218232512474,-0.4083104431629181,-0.30641159415245056,-0.08388965576887131,-0.1262935847043991,0.09012148529291153,0.20244301855564117,0.03972163423895836,-0.25675293803215027,-0.022523069754242897,-0.23377647995948792,0.016912590712308884,-0.0970863625407219,0.10857779532670975,-0.1283506155014038,-0.06219126656651497},{-0.19820141792297363,0.08638554066419601,0.1555556356906891,-0.13750992715358734,-0.3841423988342285,0.2680821418762207,0.07879950851202011,0.1932113617658615,-0.004572706297039986,0.48953282833099365,-0.11114904284477234,-0.05166797712445259,0.26297736167907715,0.08519694209098816,0.15818743407726288,0.051338374614715576},{-0.14916664361953735,0.09980584681034088,0.20470286905765533,0.1330244243144989,0.07803470641374588,0.5640063881874084,-0.2757679224014282,-0.5027967691421509,-0.37839388847351074,-0.10213317722082138,0.3328356444835663,-0.48233285546302795,-0.0972137600183487,-0.4739963710308075,-0.3954851031303406,-0.369586706161499},{-0.47480618953704834,0.29661664366722107,0.4902532398700714,-0.08396854996681213,-0.3104426860809326,0.18990477919578552,0.34786415100097656,0.3739117383956909,0.0912565141916275,0.18285715579986572,0.37830495834350586,-0.29889416694641113,0.15024347603321075,0.029932543635368347,-0.4410094618797302,-0.2878076732158661},{-0.2036920040845871,-0.01666739210486412,-0.11224647611379623,0.626711905002594,0.7713267207145691,-0.405868262052536,-0.4640217125415802,0.29547029733657837,-0.055635254830121994,0.21129898726940155,0.2930561602115631,-0.6725875735282898,-0.01850719563663006,0.20486275851726532,-0.1625225991010666,0.28117308020591736},{0.6270387768745422,-0.4058624505996704,0.04576998949050903,0.5613600611686707,-0.2662472426891327,-0.19580629467964172,0.002362901112064719,-0.13615374267101288,-0.17319031059741974,0.43313735723495483,-0.3082543611526489,0.1394539475440979,0.1696605384349823,0.2513085901737213,-0.2764739990234375,0.06906047463417053},{-0.61286860704422,-0.2650560140609741,0.048327989876270294,0.1400381177663803,0.5177509784698486,0.3554328978061676,-0.08000676333904266,-0.09972359985113144,-0.1400529146194458,-0.06177704036235809,0.34839892387390137,0.060780540108680725,-0.546684205532074,-0.3386171758174896,-0.35198110342025757,-0.4611937403678894},{-0.030835116282105446,-0.2113688737154007,-0.10825473815202713,0.08946279436349869,0.23579658567905426,0.300879567861557,-0.09996853023767471,0.6264317631721497,-0.4747009575366974,-0.18664495646953583,-0.13058726489543915,-0.009842130355536938,0.03959948942065239,0.2866488993167877,0.2894269526004791,0.04416218027472496},{0.47982117533683777,-0.27953508496284485,-0.1572827845811844,0.5214268565177917,-0.3157239854335785,0.3507479131221771,0.5032936930656433,0.1445789337158203,-0.08668465912342072,-0.004848663229495287,0.06479717046022415,-0.5225411653518677,-0.1074538603425026,0.3980385661125183,0.5072766542434692,-0.38076353073120117},{0.5163462162017822,0.2266760766506195,0.23250897228717804,-0.07759654521942139,-0.45859453082084656,0.16659733653068542,0.2541568875312805,-0.3327978551387787,-0.3796752095222473,-0.26356834173202515,-0.15832574665546417,0.4573465883731842,0.4236537218093872,-0.21870331466197968,-0.19900895655155182,0.03669959679245949},{-0.049190983176231384,-0.4423050284385681,0.5602638721466064,-0.12212111055850983,0.1688748002052307,0.48625022172927856,-0.17637686431407928,0.010361767373979092,0.47200971841812134,-0.04237803444266319,-0.1465621441602707,-0.02345631644129753,0.3242018222808838,0.09041215479373932,-0.5096724629402161,0.06707919389009476},{0.16334716975688934,0.08970034867525101,-0.03199605271220207,-0.21697284281253815,-0.2431841641664505,0.22579756379127502,-0.036294735968112946,-0.010532237589359283,-0.08078397810459137,-0.13878855109214783,-0.060394469648599625,0.12623019516468048,0.18607032299041748,-0.16521014273166656,0.18198275566101074,-0.2700366675853729},{-0.040979888290166855,0.0896606296300888,0.18393900990486145,-0.06725968420505524,-0.19074593484401703,0.04470500349998474,-0.2328004688024521,-0.35516679286956787,0.13564488291740417,0.002565900795161724,0.15209966897964478,0.14560048282146454,0.027790917083621025,-0.1684352159500122,-0.2273591160774231,-0.09828963130712509},{-0.038421642035245895,0.11727137863636017,0.1112675815820694,-0.016570480540394783,-0.20945842564105988,0.08899637311697006,-0.07722141593694687,0.16626138985157013,-0.22573736310005188,0.05711991339921951,-0.10232143104076385,-0.08854340761899948,-0.22378379106521606,-0.22848457098007202,0.06641031801700592,-0.41863808035850525}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.2510247528553009,-0.4345453381538391,0.23760859668254852,-0.09242644906044006,-0.06632690876722336,0.4446749687194824,-0.40316042304039,-0.2819935381412506,0.2092663198709488,0.15314644575119019,-0.05019475147128105,0.3947834372520447,0.35016924142837524,-0.532120943069458,-0.19079533219337463,-0.04604731500148773},{-0.386389821767807,-0.21615636348724365,0.16460026800632477,0.32466796040534973,0.03482051566243172,0.2922573387622833,0.2731165587902069,-0.3750753402709961,0.2752974033355713,0.13304582238197327,-0.43957194685935974,0.02578137442469597,0.12810753285884857,0.17977465689182281,0.2263585776090622,0.18518680334091187},{-0.018842516466975212,0.05767456442117691,0.05222197622060776,0.3477392792701721,0.2518240511417389,0.24436871707439423,-0.09248960018157959,0.07733821868896484,0.24306254088878632,-0.26113390922546387,0.3255809545516968,0.2161901742219925,-0.1875026822090149,0.16488546133041382,0.32239776849746704,-0.010791661217808723},{0.036589495837688446,0.3535669445991516,0.007907971739768982,0.15651287138462067,-0.5222457051277161,-0.15322895348072052,0.30280351638793945,-0.31283697485923767,-0.3166585862636566,-0.09814488887786865,0.24548514187335968,-0.08882583677768707,-0.11670375615358353,-0.3428492546081543,-0.26433444023132324,0.10205162316560745},{0.3360576629638672,-0.3284623920917511,0.1818149834871292,-0.1112973690032959,-0.1529485285282135,-0.15727883577346802,-0.24513204395771027,0.10772880911827087,0.1316821426153183,-0.07326686382293701,-0.35151469707489014,-0.18362000584602356,0.1168421134352684,0.05511811748147011,0.4375467300415039,-0.18519346415996552},{0.38588351011276245,0.1796545386314392,0.3794788420200348,0.2541981339454651,-0.0734003558754921,-0.2550247311592102,-0.22953353822231293,0.2909322679042816,0.1039011999964714,-0.07274947315454483,-0.09151509404182434,-0.1104784607887268,-0.43583813309669495,0.429552286863327,-0.277584046125412,0.13568182289600372},{-0.15605363249778748,0.07288888841867447,0.112117700278759,0.164671391248703,-0.07985585927963257,0.0669679194688797,-0.5094794034957886,-0.0042303577065467834,0.31561025977134705,0.3460051715373993,-0.26497986912727356,0.33772388100624084,-0.0802302360534668,0.22831398248672485,0.04985184967517853,0.3177777826786041},{-0.11661150306463242,-0.09582207351922989,-0.3105599582195282,0.3011414408683777,0.5016137957572937,-0.3321493864059448,-0.1057358980178833,-0.07645871490240097,-0.23920682072639465,-0.35621148347854614,-0.0115263806656003,-0.019372347742319107,-0.2704617977142334,0.014893921092152596,0.3440502882003784,0.15544800460338593},{-0.05376449599862099,-0.196208655834198,0.22938232123851776,-0.503108561038971,0.5606151819229126,0.3309481143951416,0.11801379173994064,0.4886111617088318,-0.18517477810382843,0.2103625237941742,0.2602900564670563,-0.006256109103560448,0.4001774489879608,0.0038296268321573734,0.28992560505867004,-0.33860936760902405},{-0.24205118417739868,0.39216527342796326,-0.3957453668117523,0.4402120113372803,0.04646033048629761,0.09572350978851318,0.01619713567197323,0.03502190113067627,0.5037859678268433,-0.09449364244937897,0.3379114866256714,0.21357372403144836,0.36332598328590393,-0.20081230998039246,-0.3065904974937439,-0.27913179993629456},{-0.5340862274169922,0.21399734914302826,-0.4234498143196106,-0.03714887052774429,-0.22051233053207397,-0.3508400022983551,-0.05992085486650467,0.2969624102115631,0.01695329137146473,-0.35614073276519775,-0.24073246121406555,0.42731088399887085,-0.10814987123012543,0.04523838683962822,0.5407129526138306,-0.2008206844329834},{0.30493131279945374,-0.027861598879098892,-0.33542004227638245,0.2523491680622101,-0.07422424107789993,-0.23183698952198029,0.1971273571252823,-0.02688516303896904,0.0032380351331084967,-0.40714430809020996,-0.25892242789268494,0.29611265659332275,0.296165406703949,0.21936190128326416,-0.2617565393447876,0.4392543137073517},{0.04290226101875305,-0.30825504660606384,-0.16624777019023895,0.4101961851119995,-0.04755228012800217,0.35638710856437683,-0.21105307340621948,-0.14915500581264496,-0.030924702063202858,0.32662472128868103,0.003370358608663082,0.075957752764225,0.10588821768760681,-0.01088765449821949,-0.3051221966743469,0.26119616627693176},{-0.20994625985622406,0.1252897083759308,0.13753043115139008,0.43517574667930603,0.16724126040935516,-0.18104152381420135,-0.3675694763660431,-0.19154706597328186,-0.14134369790554047,0.3177422285079956,-0.09100090712308884,0.317399263381958,0.31415829062461853,-0.47884783148765564,-0.043062299489974976,-0.20135898888111115},{-0.2474520057439804,0.26846808195114136,-0.3173017203807831,-0.2491118162870407,-0.23659993708133698,0.12687702476978302,-0.0638384073972702,-0.009395790286362171,0.18542729318141937,0.1576244831085205,0.3760193884372711,-0.2121288776397705,0.10871707648038864,-0.43474632501602173,-0.2496422827243805,0.18381400406360626},{0.06293066591024399,-0.2622803747653961,0.10392817854881287,0.21052002906799316,0.15315449237823486,-0.3404172956943512,0.37082797288894653,0.055525995790958405,-0.21636484563350677,0.1966850757598877,0.0786546841263771,0.1908201426267624,0.11840937286615372,0.22125236690044403,0.23052643239498138,0.34881386160850525}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.2624475359916687,-0.18031974136829376,0.22603176534175873,-0.28129780292510986,-0.31004053354263306,0.032659146934747696,0.2759545147418976,-0.23334915935993195,0.035738419741392136,0.23904632031917572,0.07454197108745575,0.2250378429889679,-0.1678653061389923,0.09567321836948395,-0.31929701566696167,0.09484696388244629,-0.27944543957710266,0.14579284191131592,0.03693687915802002,-0.13283777236938477,0.11779747903347015,0.08422855287790298,-0.1847209632396698,-0.033568158745765686},{-0.023632837459445,0.08016723394393921,0.27712780237197876,0.12140044569969177,-0.22490805387496948,0.17995598912239075,0.010357060469686985,0.03353755548596382,0.2894006073474884,-0.041434820741415024,0.05027979984879494,-0.14390552043914795,-0.2183748185634613,-0.08674775063991547,0.31893038749694824,-0.1205047219991684,0.1863887906074524,0.20504972338676453,-0.14583000540733337,0.11431796103715897,-0.12217453122138977,-0.020166223868727684,-0.08875326067209244,-0.11263452470302582},{0.15584109723567963,0.2907766103744507,0.15510669350624084,0.01908876746892929,-0.10956815630197525,0.22253338992595673,0.16249388456344604,-0.015040292404592037,0.2577632963657379,0.26725178956985474,-0.016788700595498085,0.2743590772151947,-0.1276087462902069,-0.020319942384958267,0.23914873600006104,-0.012056075967848301,0.24388469755649567,-0.31307074427604675,-0.07331128418445587,-0.14509473741054535,-0.23441413044929504,0.022651633247733116,0.08475083857774734,0.1255975365638733},{-0.44431689381599426,-0.359404981136322,0.0798458680510521,-0.21813268959522247,0.1858079731464386,-0.2296154946088791,0.04313775524497032,-0.04697791859507561,0.17791520059108734,0.30146506428718567,0.2865222692489624,0.3198244869709015,-0.09065506607294083,0.10857563465833664,0.18969890475273132,0.397855669260025,0.046825673431158066,-0.049820151180028915,0.16487158834934235,-0.055336643010377884,-0.046931229531764984,0.12449123710393906,0.2348189502954483,-0.3216395974159241},{-0.16126380860805511,0.2940787971019745,-0.12235867977142334,-0.1219368726015091,0.21973955631256104,0.048942286521196365,-0.010875328443944454,-0.1830352246761322,-0.0148538276553154,-0.05642418935894966,-0.0714762881398201,0.15340285003185272,-0.031101681292057037,0.015157793648540974,0.01651042327284813,-0.09963671118021011,-0.19204658269882202,-0.019987042993307114,-0.27699774503707886,-0.23890918493270874,-0.25157883763313293,0.04525335878133774,0.127139151096344,0.25895801186561584},{0.28406617045402527,0.3374393880367279,-0.12177932262420654,-0.23796668648719788,0.048167355358600616,-0.02189503237605095,-0.16390489041805267,0.26197516918182373,0.15263260900974274,-0.10046372562646866,-0.2390790581703186,-0.41521331667900085,-0.005634913686662912,-0.02881813235580921,0.05269059166312218,0.051560647785663605,-0.3382149338722229,-0.16353172063827515,0.2614709138870239,0.1976873278617859,0.23181138932704926,0.3329514265060425,-0.04848497733473778,-0.06684166938066483},{-0.10826036334037781,0.004833408631384373,-0.3846277594566345,0.07553034275770187,0.07463733106851578,-0.278338760137558,-0.13045459985733032,-0.11064853519201279,-0.25634676218032837,-0.358694463968277,-0.055710699409246445,0.18513131141662598,0.3147049844264984,0.3410690128803253,0.04798121005296707,0.19711995124816895,0.29673677682876587,-0.04562969505786896,-0.19534099102020264,0.15041562914848328,0.24498669803142548,0.2547769844532013,-0.11794841289520264,0.03552532196044922},{0.20409154891967773,0.06551922857761383,0.125862255692482,0.19373874366283417,0.385530024766922,0.2387547791004181,0.13856826722621918,-0.2471584975719452,-0.12292219698429108,0.003896844107657671,0.3172009587287903,-0.08247072994709015,0.20902635157108307,0.3469271957874298,-0.2575763463973999,0.12570743262767792,-0.20676469802856445,-0.132792130112648,-0.44023293256759644,0.233210489153862,-0.2158593237400055,0.008534316904842854,-0.1758219301700592,0.19657209515571594},{-0.09156376868486404,-0.10030645877122879,0.16329911351203918,-0.012558606453239918,-0.1699361354112625,0.17359042167663574,-0.16762219369411469,-0.22614511847496033,0.3145985007286072,0.45887434482574463,0.49312931299209595,0.0017549224430695176,-0.02893807739019394,0.26772603392601013,0.21031446754932404,-0.09582126885652542,-0.0381346195936203,-0.12755843997001648,-0.07897348701953888,-0.3455023765563965,0.02048516273498535,-0.20765241980552673,0.2771509885787964,0.07814335078001022},{-0.011019310913980007,0.17521360516548157,0.1954907774925232,-0.05580246448516846,0.04960567504167557,0.017920436337590218,-0.1127193421125412,0.19293992221355438,-0.2788902819156647,-0.0517413355410099,0.2714361846446991,-0.32512935996055603,-0.054564688354730606,0.0628875121474266,0.20683182775974274,0.0721643790602684,0.1631440669298172,0.16757820546627045,0.2515948414802551,0.36641913652420044,0.34917041659355164,-0.10791982710361481,-0.15755455195903778,-0.014598426409065723},{0.2056109756231308,-0.42784324288368225,-0.03588012605905533,0.0833192691206932,-0.2879657745361328,-0.21885640919208527,-0.04637451469898224,0.040244340896606445,-0.19943809509277344,0.19723883271217346,-0.4260748624801636,-0.23993927240371704,0.03243956342339516,0.237892746925354,-0.12644535303115845,-0.2774851322174072,0.3321097791194916,-0.00204381812363863,0.3651794195175171,-0.33072420954704285,-0.0528649166226387,-0.29624125361442566,0.18838368356227875,-0.12759828567504883},{0.30012065172195435,-0.19638724625110626,0.24022051692008972,-0.20210129022598267,0.12239991873502731,0.22030283510684967,-0.009232663549482822,0.09187052398920059,0.35662737488746643,-0.03359680995345116,-0.026755938306450844,-0.28297853469848633,-0.30532118678092957,-0.03465777263045311,-0.21722741425037384,0.36048424243927,0.1514711230993271,0.3691633939743042,-0.2529838979244232,0.0917787030339241,-0.1927749514579773,0.07322085648775101,0.2775436043739319,0.23703226447105408},{0.07955895364284515,0.13222448527812958,0.13651055097579956,-0.3722901940345764,0.1521984189748764,-0.08979588747024536,-0.18108615279197693,0.13575975596904755,0.3345452547073364,-0.2196136713027954,0.22541813552379608,0.18515245616436005,-0.15565814077854156,0.2079397439956665,-0.13504353165626526,-0.40804076194763184,-0.00032463340903632343,0.43086007237434387,-0.22933675348758698,-0.08058054745197296,-0.42721039056777954,0.08157971501350403,-0.17380763590335846,-0.12708942592144012},{-0.06780870258808136,0.2038327306509018,-0.33908358216285706,-0.1932428777217865,-0.17114518582820892,-0.08955881744623184,-0.3161505460739136,-0.24161943793296814,0.39243006706237793,-0.187250018119812,0.01827891916036606,-0.28020739555358887,0.06767959892749786,-0.35045355558395386,0.3909262716770172,0.38370731472969055,0.25447654724121094,-0.5069902539253235,-0.03319147601723671,-0.3333926796913147,0.12665130198001862,-0.17753122746944427,-0.25196775794029236,-0.0432826466858387},{0.17206765711307526,0.21836170554161072,-0.17070849239826202,0.15099602937698364,-0.3153279423713684,-0.2888890504837036,0.06143325939774513,0.031616512686014175,-0.37125957012176514,-0.13663670420646667,-0.0932694599032402,0.2133733630180359,0.03496265411376953,-0.040343027561903,-0.4262073338031769,-0.002130911685526371,0.3464466631412506,0.21778087317943573,0.11058880388736725,0.13839325308799744,-0.15991678833961487,-0.5019233822822571,0.04304817318916321,-0.3972734808921814},{0.19117611646652222,-0.11958964914083481,0.044587381184101105,0.08105475455522537,0.10521170496940613,0.28306275606155396,-0.19628992676734924,-0.133488729596138,-0.15176939964294434,-0.0662427544593811,0.32600322365760803,0.03330172225832939,-0.16127631068229675,-0.09743816405534744,-0.21891002357006073,-0.0742984339594841,-0.019528290256857872,0.1583820879459381,-0.04335242882370949,0.06685894727706909,0.13853473961353302,0.21727362275123596,-0.07970035076141357,-0.1857030987739563},{0.02624083124101162,-0.25598475337028503,0.11049754917621613,0.056709352880716324,-0.28892192244529724,0.10390852391719818,0.20498265326023102,0.2283449023962021,-0.22389985620975494,-0.30464646220207214,-0.05009433254599571,0.2985142171382904,-0.06458120048046112,-0.317420095205307,0.10298667848110199,-0.16197119653224945,0.2685186564922333,-0.03481213375926018,0.02378237061202526,-0.0511295460164547,0.06588462740182877,-0.14990676939487457,-0.0667215883731842,0.28257426619529724},{0.3000933825969696,0.18611423671245575,0.05459101125597954,0.29828211665153503,-0.1639210432767868,0.27819886803627014,-0.28513219952583313,0.11581090092658997,0.0792808085680008,-0.13662850856781006,-0.017105523496866226,-0.1716189980506897,0.04082558676600456,-0.21404898166656494,0.14161904156208038,-0.02402554079890251,0.0912059023976326,0.1403391808271408,0.049153171479701996,0.1432807296514511,-0.12044324725866318,0.01995568349957466,-0.09083931893110275,0.17189104855060577},{0.03024536371231079,-0.05147530883550644,0.1740507185459137,0.08120332658290863,0.12474711984395981,0.24482595920562744,0.20025216042995453,0.20622867345809937,0.0938696414232254,-0.07596061378717422,-0.25745707750320435,0.2794104814529419,-0.05636938288807869,0.07759392261505127,-0.0010978488717228174,-0.03412732854485512,0.04968243092298508,0.051077987998723984,-0.2354944795370102,-0.2330218255519867,-0.022710470482707024,0.1790299266576767,0.15072354674339294,0.18244397640228271},{-0.07883116602897644,0.13025006651878357,-0.06592689454555511,0.3118498921394348,-0.11979884654283524,0.0523458793759346,-0.25109973549842834,-0.21333137154579163,0.18161775171756744,-0.13644050061702728,0.06039884686470032,0.26587432622909546,-0.2974596619606018,-0.11822335422039032,0.0636746734380722,0.3239597678184509,0.23168233036994934,0.263518750667572,-0.21441242098808289,-0.25313490629196167,-0.05647491663694382,0.12129876762628555,-0.29406070709228516,0.2533215582370758},{0.2364778369665146,-0.13301682472229004,0.04563402384519577,-0.0422968789935112,-0.04619601368904114,-0.18948149681091309,0.2985912561416626,-0.19163738191127777,0.22499075531959534,-0.28354713320732117,0.04341450706124306,-0.1563437134027481,-0.18984198570251465,-0.21363741159439087,-0.13025030493736267,0.18790876865386963,0.0425841324031353,-0.02031116373836994,-0.23079542815685272,0.026530684903264046,-0.12277153879404068,0.1041279137134552,-0.17922692000865936,-0.20107077062129974},{0.26692450046539307,0.007512315642088652,-0.30892688035964966,0.07101773470640182,0.015405605547130108,0.28427669405937195,-0.2237551361322403,-0.1421293318271637,0.24528436362743378,-0.09257093816995621,-0.39430302381515503,-0.04541456326842308,-0.09659257531166077,-0.14103420078754425,0.20594194531440735,-0.09364096075296402,0.23797468841075897,0.3184686601161957,0.06235189735889435,-0.19339053332805634,-0.11142486333847046,-0.08182534575462341,-0.19682948291301727,-0.11459414660930634},{-0.04542747512459755,0.21989691257476807,-0.037714459002017975,0.2202099710702896,0.06764580309391022,-0.22383737564086914,-0.08884747326374054,-0.04480576142668724,-0.27357932925224304,0.10268411040306091,-0.1742081642150879,0.12428504228591919,0.029585277661681175,-0.0032839749474078417,-0.20591050386428833,0.3088676929473877,-0.13756906986236572,-0.3063887655735016,0.22394677996635437,-0.06611081957817078,-0.13309119641780853,0.2827047109603882,-0.1174950897693634,-0.23838940262794495},{-0.17239812016487122,-0.14779157936573029,0.3786826729774475,-0.18208982050418854,-0.005300025921314955,0.293830931186676,0.13711802661418915,0.18542276322841644,0.22122864425182343,0.3700335919857025,0.22309455275535583,-0.2123734951019287,0.0059122503735125065,-0.23438481986522675,0.052042074501514435,0.03250324726104736,-0.011230360716581345,-0.13900966942310333,-0.20662645995616913,0.3738728165626526,0.34484022855758667,0.044297028332948685,0.32595565915107727,0.20908410847187042}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.22242747247219086,0.34276071190834045,0.04917728155851364,0.13470733165740967},{0.2220367193222046,0.1858302801847458,-0.20689836144447327,0.28560420870780945},{-0.17179034650325775,0.11919084191322327,0.07734768092632294,-0.07557246088981628},{0.31224775314331055,-0.25466087460517883,0.19687595963478088,-0.3950638473033905},{-0.29861968755722046,-0.13943351805210114,-0.3446193337440491,0.23480531573295593},{0.34153205156326294,0.3257165253162384,0.031876616179943085,-0.26776301860809326},{0.04771413654088974,0.39145541191101074,0.13132087886333466,0.035449475049972534},{0.05583357810974121,0.35089659690856934,-0.025542808696627617,0.33238163590431213},{-0.14156919717788696,-0.10632097721099854,-0.3697361350059509,-0.12001407891511917},{-0.39861905574798584,0.1049647182226181,-0.2539503276348114,-0.3515828549861908},{0.2404789924621582,-0.07407326996326447,-0.17570465803146362,-0.12967588007450104},{-0.35391098260879517,-0.06611461937427521,0.1523481011390686,-0.1991700679063797},{0.3550713062286377,-0.08143860101699829,0.042452096939086914,0.1083872839808464},{0.10487920045852661,-0.3391554355621338,-0.05995834991335869,0.3381156921386719},{-0.1713700294494629,-0.4591328203678131,-0.23676835000514984,-0.24653594195842743},{0.08085080981254578,-0.3654290735721588,-0.2945835590362549,-0.3586282432079315},{0.0331958644092083,-0.15708962082862854,0.1505696028470993,0.04763869568705559},{-0.5286829471588135,-0.1316741704940796,-0.04992080107331276,-0.04142133891582489},{-0.11197532713413239,0.31549325585365295,0.2643897831439972,-0.3488914668560028},{-0.20667172968387604,0.2242046594619751,0.13653503358364105,0.026715967804193497},{0.36390867829322815,-0.012494741939008236,0.2264813333749771,-0.2836592197418213},{0.16624678671360016,0.14998586475849152,-0.5057989358901978,-0.2308902144432068},{-0.33835914731025696,-0.23671607673168182,-0.26177749037742615,-0.2891845703125},{0.11657638102769852,0.16957896947860718,-0.09270147979259491,-0.12296544015407562}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.221754252910614,-0.20215767621994019,0.12269476056098938,-0.062243420630693436,-0.155685693025589,0.08277082443237305,0.10629529505968094,-0.056869689375162125,0.05648449435830116,-0.07890006899833679,-0.02267293818295002,-0.18788562715053558,0.0041273050010204315,-0.060599327087402344,-0.08587773144245148,0.14996372163295746};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.002474850509315729,0.1085459291934967,0.02332955040037632,-0.03526528179645538,0.093121737241745,-0.009511780925095081,-0.08785899728536606,0.09536626189947128,0.011006835848093033,0.0017926966538652778,0.08294163644313812,0.0417221337556839,-0.045644160360097885,0.13501262664794922,0.17316357791423798,-0.0008283188799396157};
static const float actor_encoder_feed_forward_0_bias[24] = {-0.02360757812857628,0.014142213389277458,0.015957221388816833,-0.003010090673342347,-0.023654930293560028,0.019192922860383987,0.04856235906481743,0.005697023123502731,-0.018475526943802834,-0.022151127457618713,-0.008205852471292019,-0.03743172064423561,-0.01307951845228672,-0.03892640396952629,-0.016992853954434395,0.012913571670651436,0.0050636520609259605,-0.07411157339811325,-0.026946846395730972,0.010504812933504581,-0.03270164877176285,-0.08788532763719559,0.024443810805678368,0.02694621868431568};
static const float action_parameterization_distribution_linear_bias[4] = {0.006823861040174961,0.012920106761157513,0.010846341028809547,0.005672220140695572};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{0.05883106216788292,-0.4430774450302124,-0.029942044988274574,0.11972594261169434,-0.21242961287498474,0.17799954116344452,0.18671070039272308,0.12172022461891174},{0.05016276240348816,0.18649813532829285,0.15012207627296448,-0.31478333473205566,-0.27502477169036865,0.1088542714715004,-0.4164266586303711,0.1043069064617157},{-0.5313764810562134,-0.3486045300960541,0.5094931721687317,-0.1325007677078247,-0.4555591940879822,0.26175186038017273,-0.5710534453392029,0.5813091993331909},{0.007295205723494291,-0.33405688405036926,-0.3297586739063263,0.08465734869241714,0.10901805013418198,0.028794199228286743,0.06416332721710205,0.5765502452850342},{-0.18322403728961945,-0.31039294600486755,-0.18503697216510773,-0.35847386717796326,0.4951772391796112,-0.16422346234321594,-0.11411280930042267,-0.37526369094848633},{-0.49047812819480896,-0.2867397964000702,0.27121010422706604,0.026078306138515472,-0.2978062629699707,0.13658982515335083,-0.12428916245698929,0.6056861281394958},{-0.24908490478992462,0.22710666060447693,-0.3231162428855896,0.023007534444332123,0.2460685670375824,-0.40065503120422363,-0.20835058391094208,0.4561852812767029},{-0.17622730135917664,0.2251133918762207,0.4079412519931793,-0.3977556526660919,0.11316799372434616,0.4055851399898529,-0.12481646984815598,0.023434456437826157},{0.1301516443490982,0.4808163642883301,0.008686821907758713,0.08014201372861862,-0.4437257647514343,0.40198439359664917,-0.39985567331314087,-0.07249683886766434},{0.12991586327552795,0.00847429409623146,-0.1256316751241684,-0.5163309574127197,-0.4689277410507202,0.06022614240646362,0.12970808148384094,0.3791579604148865},{-0.32557418942451477,-0.4954763650894165,0.055619772523641586,-0.09647604078054428,0.4715031385421753,0.33106520771980286,0.25404879450798035,0.02213553711771965},{-0.20242080092430115,-0.17497088015079498,0.3877509832382202,-0.36363136768341064,0.3487010896205902,0.3468070924282074,0.36196810007095337,0.06353698670864105},{0.11160356551408768,-0.0843130350112915,0.4264995753765106,-0.28815484046936035,-0.10702856630086899,0.05125269666314125,-0.5377448201179504,-0.004964908584952354},{0.018769318237900734,-0.23704762756824493,0.04169290140271187,0.027299191802740097,-0.011443857103586197,0.41998642683029175,-0.19254228472709656,0.4572647511959076},{0.29764845967292786,0.14301562309265137,0.2923423945903778,0.2910851836204529,0.3765411376953125,0.34891366958618164,-0.06417728960514069,0.3636234700679779},{-0.4825044870376587,0.24100933969020844,0.05271770432591438,-0.30434080958366394,0.17487117648124695,-0.46427613496780396,-0.3016628623008728,-0.04177296161651611}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.2209324687719345,-0.5274692177772522,-0.24050810933113098,0.2942237854003906,-0.1430492103099823,0.16553595662117004,0.3979361653327942,-0.5807896256446838},{-0.44867411255836487,0.555778443813324,-0.5196080207824707,0.23009976744651794,-0.5298060774803162,-0.3730522692203522,0.05619562789797783,-0.2778460383415222},{-0.0363335944712162,-0.09247807413339615,0.005541433114558458,-0.5498946309089661,-0.039536215364933014,0.09110383689403534,0.08056262135505676,0.22138269245624542},{0.09367690235376358,0.38776305317878723,-0.066851906478405,0.268840491771698,-0.4599011540412903,-0.34755563735961914,-0.5502461194992065,0.3049756586551666},{0.0965932086110115,0.15750554203987122,0.36397218704223633,0.3624238073825836,0.09897507727146149,-0.3280801475048065,-0.16641421616077423,-0.16993480920791626},{-0.29499295353889465,-0.46008214354515076,-0.07929518073797226,0.10120890289545059,-0.5909914970397949,0.3261648416519165,-0.07497814297676086,-0.32621893286705017},{-0.01915263757109642,0.42086735367774963,0.2819710969924927,0.04363936930894852,0.5193358063697815,0.49470192193984985,0.21383072435855865,-0.14717943966388702},{0.5458812117576599,-0.5507171154022217,-0.4977956712245941,-0.05639786645770073,0.5419281125068665,-0.3672926425933838,0.12450774013996124,0.17070958018302917}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.06674084067344666,-0.02375233918428421,0.01686672680079937,-0.0013653497444465756,0.007713434752076864,-0.03359530493617058,-0.10089889168739319,0.12380725145339966};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.005450218450278044,0.04606800526380539,0.00017583786393515766,-0.03387391194701195,0.008462022058665752,-0.05355871096253395,-0.01619233749806881,0.01904529333114624};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

