
#include "network_evaluate_tof.h"
#include <string.h>


#define EPS 0.000001 // 1e-6

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 24},{24, 4}};
static const int obst_structure [2][2] = {{16, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[24];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.10284193605184555,0.09633264690637589,0.1887970119714737,0.06351394951343536,-0.39672568440437317,0.10644077509641647,-0.32576462626457214,0.36610502004623413,0.027227794751524925,0.07881380617618561,0.1401909738779068,-0.3119205832481384,0.058354854583740234,0.03296294063329697,0.34773874282836914,0.13924430310726166},{-0.11518363654613495,-0.2692289650440216,0.2495076209306717,0.008468464948236942,0.24187293648719788,0.05631573498249054,0.08760612457990646,-0.39087048172950745,0.023140763863921165,0.001332156709395349,-0.5887463688850403,-0.10354673862457275,0.12486971914768219,0.011028853245079517,-0.18513110280036926,0.38407981395721436},{0.05439768359065056,0.3622506856918335,0.24007576704025269,0.3912408947944641,-0.33626788854599,0.20375652611255646,0.138030543923378,0.539741039276123,-0.4180152416229248,0.501836359500885,-0.04298849403858185,0.34610840678215027,-0.13831277191638947,0.19605237245559692,0.20950232446193695,-0.06374146044254303},{-0.06810957938432693,-0.18761098384857178,-0.08941342681646347,0.33452412486076355,-0.03783843666315079,-0.2914504408836365,0.07091104984283447,0.44445914030075073,0.013891139067709446,0.19248948991298676,0.09338749945163727,-0.3187182545661926,0.020006000995635986,-0.004352371208369732,0.03152846544981003,0.18363331258296967},{-0.18821686506271362,-0.4375802278518677,-0.3380647897720337,-0.06309770047664642,-0.03363465517759323,-0.018091900274157524,0.35758280754089355,0.19694186747074127,-0.32451629638671875,-0.08896096050739288,-0.184530571103096,0.05755600705742836,-0.02321203052997589,0.34029608964920044,-0.05207987502217293,-0.07263495773077011},{-0.22644828259944916,0.050936080515384674,-0.03686325252056122,-0.06552542746067047,-0.3068592846393585,0.28505939245224,0.12130321562290192,0.2033584713935852,-0.04694428667426109,0.5020100474357605,-0.1572597771883011,-0.13531586527824402,0.35251349210739136,0.04924611747264862,0.2978430986404419,0.19634854793548584},{0.014743826352059841,-0.04166460782289505,0.42415064573287964,0.1143752858042717,-0.08607455343008041,0.555656373500824,-0.16460201144218445,-0.39578595757484436,-0.36591577529907227,0.006210106424987316,0.21109312772750854,-0.6175830960273743,0.019176552072167397,-0.4375336170196533,-0.27091866731643677,-0.4532647132873535},{-0.3535083532333374,0.17879486083984375,0.5796162486076355,0.05408221110701561,-0.26805388927459717,0.16918303072452545,0.2589218318462372,0.3599013388156891,0.16664382815361023,0.1916828751564026,0.3754245638847351,-0.21332138776779175,0.1689014881849289,0.02337603084743023,-0.3729827404022217,-0.2581852674484253},{-0.5993639826774597,-0.26490071415901184,-0.17619016766548157,0.5840435028076172,0.47918665409088135,-0.4300285875797272,-0.6456795930862427,0.11784377694129944,0.008130408823490143,0.2240825891494751,0.34633946418762207,-0.7261446118354797,-0.15291748940944672,0.02217363379895687,-0.032297100871801376,0.2808534502983093},{0.5084723830223083,-0.3228386640548706,-0.059796180576086044,0.44845160841941833,-0.29213184118270874,-0.19429326057434082,0.06417379528284073,-0.16712431609630585,-0.22580549120903015,0.4475783705711365,-0.3114704489707947,0.053203560411930084,0.12870749831199646,0.23770403861999512,-0.3313089609146118,0.02167750895023346},{-0.6004433631896973,-0.4073253273963928,0.316186785697937,0.14580754935741425,0.36524006724357605,0.3728112578392029,0.04856664687395096,0.004919997416436672,-0.16866587102413177,0.045790787786245346,0.2270948737859726,-0.09694530069828033,-0.42512327432632446,-0.29861557483673096,-0.20439884066581726,-0.5756160616874695},{-0.12129512429237366,-0.03309958055615425,-0.33831605315208435,0.06808903068304062,0.36732497811317444,0.17510852217674255,-0.06388368457555771,0.93357914686203,-0.320989191532135,-0.26748114824295044,-0.41245967149734497,-0.17163380980491638,0.06472639739513397,0.4136257767677307,0.1447734832763672,0.30169734358787537},{0.2496640980243683,-0.34693965315818787,-0.37564852833747864,0.710306704044342,-0.1640927791595459,0.33973777294158936,0.417070209980011,0.23267008364200592,0.03654840961098671,-0.22391344606876373,-0.13802151381969452,-0.6653022170066833,-0.21277593076229095,0.28793999552726746,0.5221843719482422,-0.4102751612663269},{0.6535767316818237,0.47498375177383423,0.3930117189884186,-0.03330303728580475,-0.14011000096797943,0.09252335131168365,0.4349101185798645,-0.18006235361099243,-0.44109538197517395,-0.21810856461524963,-0.1377173811197281,0.4770826995372772,0.44991493225097656,-0.1652916967868805,-0.47260844707489014,-0.07071336358785629},{-0.002759574679657817,-0.37435081601142883,0.5112031102180481,-0.03369155526161194,0.28846779465675354,0.5020677447319031,-0.2795388102531433,0.011385194025933743,0.4367242157459259,-0.06805290281772614,-0.15934079885482788,0.05768715217709541,0.31493550539016724,-0.03499303385615349,-0.4377918839454651,-0.021130938082933426},{0.11375658959150314,0.032933808863162994,-0.029229674488306046,-0.20939122140407562,-0.36918583512306213,0.16195815801620483,-0.02346506342291832,0.07240545004606247,-0.1270734965801239,-0.14754581451416016,0.001962072215974331,0.11840248852968216,0.17182551324367523,-0.13006314635276794,0.22591876983642578,-0.2843918204307556},{0.009634910151362419,0.11768613010644913,0.11859427392482758,-0.04508437216281891,-0.25282225012779236,0.005654373671859503,-0.17968715727329254,-0.30045467615127563,0.12107399851083755,0.018358903005719185,0.11043690145015717,0.18057683110237122,0.09109587222337723,-0.11312652379274368,-0.3017626106739044,0.005432748701423407},{-0.05090723931789398,0.022340090945363045,0.11802762001752853,-0.014927894808351994,-0.16833414137363434,0.15107905864715576,-0.10209909826517105,0.1530139446258545,-0.24764083325862885,0.1647249311208725,-0.2149694412946701,-0.10378679633140564,-0.29440540075302124,-0.41636738181114197,0.07636371999979019,-0.4007208049297333}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.2546878755092621,-0.4451538324356079,0.2008868157863617,-0.04068339988589287,-0.008833417668938637,0.43611615896224976,-0.3985941410064697,-0.28531599044799805,0.27174070477485657,0.1710372269153595,-0.02868719771504402,0.3714255690574646,0.28800901770591736,-0.4508354663848877,-0.1815221756696701,-0.0431152880191803},{-0.31187209486961365,-0.14766483008861542,0.198735773563385,0.4136523902416229,-0.04367714375257492,0.21100550889968872,0.27184537053108215,-0.33759382367134094,0.16916847229003906,0.12221378833055496,-0.26490822434425354,0.08943410217761993,0.17908377945423126,0.1035028025507927,0.16455590724945068,0.23133158683776855},{-0.08482533693313599,0.05026597902178764,0.06975989788770676,0.32768771052360535,0.25916433334350586,0.2891094386577606,-0.06307478994131088,0.10852382332086563,0.24927043914794922,-0.3375149667263031,0.3041630983352661,0.20473772287368774,-0.12076330929994583,0.13955950736999512,0.3445877134799957,-0.02280736342072487},{-0.03048616088926792,0.3199158012866974,-0.028844254091382027,0.137209951877594,-0.4057890474796295,-0.08885499089956284,0.34116968512535095,-0.27400216460227966,-0.3300541639328003,0.059762533754110336,0.26126205921173096,-0.1709529310464859,-0.15684089064598083,-0.25084564089775085,-0.19591471552848816,0.1277090460062027},{0.278695672750473,-0.3576614558696747,0.0786266177892685,-0.15596817433834076,-0.032154761254787445,-0.13233867287635803,-0.15742094814777374,0.22354908287525177,0.14520429074764252,-0.026699841022491455,-0.28200045228004456,-0.15934814512729645,0.14176619052886963,0.18432928621768951,0.4313759505748749,-0.1846952885389328},{0.31424424052238464,0.1630832701921463,0.3644120991230011,0.20632223784923553,-0.2045721560716629,-0.20513997972011566,-0.2572685182094574,0.23657487332820892,0.09553258121013641,-0.20160607993602753,-0.08853365480899811,-0.13141672313213348,-0.3837555944919586,0.3420647382736206,-0.30867165327072144,0.10627485811710358},{-0.14128105342388153,0.03139215335249901,0.0930778831243515,0.11171024292707443,-0.16016551852226257,0.04269903153181076,-0.47669851779937744,-0.05865729972720146,0.26358693838119507,0.37325620651245117,-0.2487936168909073,0.3109159767627716,-0.03923797979950905,0.2336631715297699,0.10801391303539276,0.3714412450790405},{-0.16251014173030853,-0.08198339492082596,-0.18512222170829773,0.2814593017101288,0.473552942276001,-0.29701608419418335,-0.12698803842067719,-0.20475144684314728,-0.23795518279075623,-0.36439046263694763,-0.03737610951066017,-0.08176983892917633,-0.268029123544693,-0.056638866662979126,0.26515793800354004,0.17747363448143005},{-0.06964576989412308,-0.17883479595184326,0.2157483696937561,-0.5030141472816467,0.5376536250114441,0.2626659870147705,0.15755048394203186,0.4624658226966858,-0.1818048506975174,0.14449520409107208,0.25722256302833557,-0.011455667205154896,0.44879215955734253,-0.024520348757505417,0.339089959859848,-0.34738093614578247},{-0.16629981994628906,0.4899197518825531,-0.35711780190467834,0.407571941614151,-0.07548151165246964,0.0827956572175026,0.055552270263433456,0.011193174868822098,0.5512981414794922,0.05038784444332123,0.3919760286808014,0.129603311419487,0.2691514194011688,-0.10666735470294952,-0.3335023820400238,-0.28613609075546265},{-0.6269086599349976,0.2078869491815567,-0.4022831916809082,-0.06159847602248192,-0.14529293775558472,-0.3678111135959625,-0.08182864636182785,0.32743602991104126,-0.0311282966285944,-0.38446497917175293,-0.249006986618042,0.4251161813735962,-0.036976102739572525,0.034655287861824036,0.4875689744949341,-0.21602168679237366},{0.3976278603076935,-0.024083223193883896,-0.3750995993614197,0.3346777856349945,0.03357020020484924,-0.30793625116348267,0.15233924984931946,0.03952860087156296,-0.03797030821442604,-0.40570223331451416,-0.2730283737182617,0.3668440580368042,0.29435211420059204,0.30594587326049805,-0.18979743123054504,0.44022029638290405},{0.006374475546181202,-0.2803313136100769,-0.17627719044685364,0.3918401598930359,-0.1979726254940033,0.32722780108451843,-0.2145286202430725,-0.16232888400554657,-0.022443421185016632,0.20184539258480072,-0.02296416461467743,0.08116483688354492,0.11515053361654282,-0.0020736989099532366,-0.2652948498725891,0.2172599732875824},{-0.24887092411518097,0.06906656920909882,0.22384358942508698,0.38458752632141113,0.23284301161766052,-0.1350177824497223,-0.2786480784416199,-0.15128690004348755,-0.15194259583950043,0.3407246768474579,-0.05382651463150978,0.349923312664032,0.3296087682247162,-0.35771694779396057,-0.010546622797846794,-0.16459952294826508},{-0.2505297064781189,0.25496530532836914,-0.2483634650707245,-0.2021353393793106,-0.22625482082366943,0.14942693710327148,-0.11204149574041367,-0.031522754579782486,0.21294568479061127,0.13275395333766937,0.40677085518836975,-0.19549603760242462,0.056445203721523285,-0.4192759394645691,-0.25120359659194946,0.16095860302448273},{0.08214093744754791,-0.28663328289985657,0.2439824342727661,0.2688398063182831,0.16358083486557007,-0.3256673514842987,0.330491840839386,0.004505424294620752,-0.12143511325120926,0.1640797108411789,0.08171667158603668,0.31045088171958923,0.09134333580732346,0.13112890720367432,0.28500503301620483,0.3975825607776642}};
static const float actor_encoder_feed_forward_0_weight[24][24] = {{-0.2934550940990448,-0.19246307015419006,0.18647892773151398,-0.28829362988471985,-0.31620514392852783,-0.005685738753527403,0.27429381012916565,-0.31454241275787354,0.07582933455705643,0.2675110697746277,0.1271936148405075,0.20057404041290283,-0.18794214725494385,0.04713460057973862,-0.30632513761520386,0.12914349138736725,-0.24486979842185974,0.19954465329647064,0.04705622419714928,-0.18977200984954834,0.1681399792432785,0.05526065453886986,-0.12971298396587372,0.019303463399410248},{-0.08339560776948929,0.034707386046648026,0.2964852750301361,0.2138141542673111,-0.28849008679389954,0.17607320845127106,-0.05203486606478691,-0.020597681403160095,0.2866554856300354,-0.040031611919403076,0.07180436700582504,-0.08981545269489288,-0.19660690426826477,-0.07609586417675018,0.4257386326789856,-0.07989232987165451,0.25430288910865784,0.21456480026245117,-0.12461263686418533,0.06811268627643585,-0.08062340319156647,0.05102791264653206,-0.07434308528900146,-0.11619285494089127},{0.16220298409461975,0.2891487777233124,0.12944605946540833,0.03617234155535698,-0.13581208884716034,0.23907364904880524,0.23062913119792938,-0.020213929936289787,0.22553934156894684,0.23899851739406586,-0.031165368854999542,0.24309387803077698,-0.1403404325246811,-0.06962385028600693,0.20067289471626282,-0.027283497154712677,0.2604731023311615,-0.27064651250839233,-0.03262302652001381,-0.1641951948404312,-0.20259585976600647,-0.014809810556471348,0.06360924243927002,0.1609957069158554},{-0.38132748007774353,-0.2970920503139496,0.07684075832366943,-0.18955862522125244,0.18370792269706726,-0.20119799673557281,0.025020325556397438,-0.003990747034549713,0.15592551231384277,0.305492639541626,0.2922104299068451,0.27214670181274414,-0.1011432409286499,0.09274448454380035,0.1607770323753357,0.4106135368347168,0.0778895765542984,-0.052232757210731506,0.24991023540496826,-0.08709708601236343,-0.045126620680093765,0.15960873663425446,0.13104426860809326,-0.29888564348220825},{-0.14070183038711548,0.2949148416519165,-0.09701163321733475,-0.06555131077766418,0.14819662272930145,0.11612159013748169,0.004882971756160259,-0.18860922753810883,-0.04411453753709793,-0.05453332141041756,-0.049676623195409775,0.16131256520748138,-0.03347361832857132,-0.05635230988264084,-0.0256903488188982,-0.10233890265226364,-0.20215611159801483,-0.008343678899109364,-0.22811222076416016,-0.2678481936454773,-0.22932158410549164,0.021662622690200806,0.04775320366024971,0.31714314222335815},{0.26159363985061646,0.29834967851638794,-0.13288401067256927,-0.24223016202449799,0.02852248214185238,-0.03286708518862724,-0.23831330239772797,0.2339143604040146,0.17683684825897217,-0.09982967376708984,-0.2748541235923767,-0.33947286009788513,-0.008005357347428799,0.0017553537618368864,0.08292386680841446,0.05008601024746895,-0.2794875204563141,-0.22621850669384003,0.22087110579013824,0.19558405876159668,0.25918224453926086,0.26554030179977417,-0.02507561817765236,-0.12423370033502579},{-0.11277414858341217,-0.005065175238996744,-0.32818666100502014,0.014551947824656963,0.0701899528503418,-0.2882683575153351,-0.04394654929637909,-0.08464883267879486,-0.3045552372932434,-0.2509598731994629,-0.04887106642127037,0.22618716955184937,0.2755534052848816,0.27033546566963196,-0.0026144611183553934,0.1409841775894165,0.26021820306777954,-0.06268727779388428,-0.08251955360174179,0.1956828087568283,0.20089155435562134,0.23728173971176147,-0.1338280439376831,0.11036131531000137},{0.16897255182266235,0.05078030005097389,0.12264685332775116,0.22970587015151978,0.33317503333091736,0.22097927331924438,0.12168122082948685,-0.2738824188709259,-0.14481903612613678,-0.06630505621433258,0.28476792573928833,-0.06708890944719315,0.20722413063049316,0.33194857835769653,-0.26498109102249146,0.12156983464956284,-0.16662488877773285,-0.04289378598332405,-0.46560367941856384,0.21627268195152283,-0.23157471418380737,-0.040994737297296524,-0.23182566463947296,0.1893334537744522},{-0.07554907351732254,-0.09909728914499283,0.16118429601192474,0.00696533964946866,-0.19077344238758087,0.1653195172548294,-0.16750964522361755,-0.22138570249080658,0.31458115577697754,0.444364070892334,0.46376925706863403,0.015393523499369621,-0.0321318693459034,0.34808269143104553,0.21349292993545532,-0.10965019464492798,0.039440691471099854,-0.22334671020507812,-0.10101734846830368,-0.3842219412326813,0.05449747294187546,-0.19652745127677917,0.2809239625930786,0.06870387494564056},{-0.040433138608932495,0.12489371001720428,0.26155906915664673,-0.09960515052080154,0.13412293791770935,-0.06295756995677948,-0.0915946215391159,0.2096244990825653,-0.3265475332736969,0.01440527942031622,0.21091361343860626,-0.32203030586242676,-0.11601824313402176,0.08947809785604477,0.19078747928142548,0.05065055564045906,0.19269810616970062,0.23394551873207092,0.2413427233695984,0.43951040506362915,0.3413521945476532,-0.2623124420642853,-0.11766935139894485,-0.08654122054576874},{0.20651134848594666,-0.3811575770378113,-0.017896443605422974,0.09297748655080795,-0.29079678654670715,-0.2088402807712555,-0.20077313482761383,0.04737876355648041,-0.16829970479011536,0.27105849981307983,-0.3177185654640198,-0.25433024764060974,0.04839976504445076,0.2116233855485916,-0.08267977833747864,-0.2547277808189392,0.30808204412460327,-0.10069964826107025,0.38778480887413025,-0.3132394254207611,-0.03872811794281006,-0.36551859974861145,0.16944995522499084,-0.05538179352879524},{0.34527409076690674,-0.14684651792049408,0.3084673583507538,-0.2868988513946533,0.17063768208026886,0.232904314994812,0.08700823783874512,0.14059588313102722,0.37616655230522156,0.007490027695894241,-0.09486421942710876,-0.27056199312210083,-0.3846696615219116,-0.10423039644956589,-0.30909493565559387,0.34544265270233154,0.12741850316524506,0.3441498577594757,-0.14655324816703796,0.16432654857635498,-0.24092018604278564,0.06141660362482071,0.20446155965328217,0.2611050009727478},{0.045795783400535583,0.08381719887256622,0.12772920727729797,-0.28632912039756775,0.06797397136688232,-0.0763658657670021,-0.1542065590620041,0.06337844580411911,0.2903917133808136,-0.18318665027618408,0.2714349031448364,0.20021769404411316,-0.11853286623954773,0.2068004310131073,-0.1366652399301529,-0.3613409101963043,0.08471133559942245,0.3232576549053192,-0.17620541155338287,-0.12475966662168503,-0.3324960470199585,-0.017980892211198807,-0.19750715792179108,-0.09557320922613144},{-0.08467825502157211,0.1706683188676834,-0.26278501749038696,-0.21011903882026672,-0.18025514483451843,-0.10213793069124222,-0.2451871633529663,-0.2507384121417999,0.3839209973812103,-0.17054075002670288,-0.05753597617149353,-0.21660397946834564,-0.042067140340805054,-0.40385568141937256,0.3375442326068878,0.33969032764434814,0.24983267486095428,-0.340126097202301,-0.006704617291688919,-0.2932620644569397,0.07137810438871384,-0.18470680713653564,-0.26524949073791504,-0.04089447110891342},{0.18344111740589142,0.23145370185375214,-0.16024456918239594,0.16478806734085083,-0.32017427682876587,-0.2416086345911026,0.11211013048887253,0.04258829727768898,-0.3568265438079834,-0.14221404492855072,-0.0816526710987091,0.18375638127326965,0.03887791931629181,-0.11653584241867065,-0.46236443519592285,-0.005805278662592173,0.27726486325263977,0.2640303671360016,0.12322982400655746,0.13413915038108826,-0.1954164206981659,-0.4146060347557068,-0.005542777478694916,-0.3310560882091522},{0.2506539225578308,-0.1137286052107811,0.09361428767442703,0.007185874506831169,0.1839742511510849,0.3216416537761688,-0.16949965059757233,-0.12292087823152542,-0.10093265026807785,0.035763971507549286,0.3117847442626953,0.06494512408971786,-0.23581668734550476,-0.17873868346214294,-0.22923199832439423,-0.11052136868238449,-0.11131161451339722,0.15452511608600616,0.021575896069407463,0.10375747829675674,0.12624751031398773,0.19823700189590454,-0.006093285977840424,-0.2464720457792282},{-0.03869716450572014,-0.3332349359989166,0.20703640580177307,0.012188160791993141,-0.2686766982078552,0.048828620463609695,0.21520698070526123,0.21446938812732697,-0.23734362423419952,-0.3075184226036072,-0.20903602242469788,0.44916319847106934,-0.17396406829357147,-0.37360528111457825,0.11266425251960754,-0.2418912947177887,0.28264689445495605,0.1466943621635437,0.042350929230451584,0.028044775128364563,-0.006560062989592552,-0.21599029004573822,-0.04017670825123787,0.17091034352779388},{0.3329346179962158,0.227496936917305,0.04376480355858803,0.28233230113983154,-0.14466610550880432,0.2649489641189575,-0.2495243102312088,0.147244393825531,0.07753362506628036,-0.10204321891069412,0.030425941571593285,-0.24151404201984406,0.07267758250236511,-0.17814289033412933,0.1194678395986557,-0.0012653274461627007,0.09226832538843155,0.06115102395415306,0.06190764531493187,0.16287417709827423,-0.12099812179803848,0.02772355265915394,-0.0918537899851799,0.20932422578334808},{0.030039239674806595,-0.035089317709207535,0.14734607934951782,0.019618134945631027,0.14044396579265594,0.2820223271846771,0.23209646344184875,0.21877224743366241,0.18083374202251434,-0.11509468406438828,-0.22315530478954315,0.22789427638053894,-0.03633672371506691,-0.0004662511346396059,0.0037849105428904295,-0.019854864105582237,0.01492395345121622,0.01412955578416586,-0.2929481267929077,-0.2786449193954468,-0.08157885819673538,0.2853829562664032,0.17525362968444824,0.21436910331249237},{-0.03195490688085556,0.1884298324584961,-0.06279417127370834,0.2592603862285614,-0.0726052075624466,0.009975681081414223,-0.22241279482841492,-0.16672810912132263,0.14083810150623322,-0.11947192251682281,0.03892315551638603,0.21791696548461914,-0.2879392206668854,-0.06565216183662415,0.02391720935702324,0.30022546648979187,0.2389332503080368,0.22279047966003418,-0.22440871596336365,-0.21161320805549622,-0.05243917554616928,0.07151316851377487,-0.31777843832969666,0.2527105510234833},{0.207449808716774,-0.1756744086742401,0.044388122856616974,-0.02264612540602684,-0.07460882514715195,-0.16579313576221466,0.27519121766090393,-0.22226212918758392,0.24558433890342712,-0.32181182503700256,0.029931969940662384,-0.11625590920448303,-0.20071056485176086,-0.254416823387146,-0.10854330658912659,0.1873456984758377,0.04422185570001602,0.02405972220003605,-0.24263474345207214,0.004945915192365646,-0.13806743919849396,0.1356952041387558,-0.17096318304538727,-0.2203122079372406},{0.18557940423488617,-0.08577782660722733,-0.3646981418132782,0.18633806705474854,-0.048979245126247406,0.3696999251842499,-0.31665194034576416,-0.2702249586582184,0.3507162928581238,-0.09077738225460052,-0.27647003531455994,-0.03359813988208771,-0.06789947301149368,-0.2170572578907013,0.32647350430488586,0.02938222885131836,0.2510823905467987,0.28537285327911377,0.04242105409502983,-0.3301236629486084,-0.04627206549048424,0.007252200040966272,-0.12535959482192993,-0.06158977001905441},{0.02471143752336502,0.2462252676486969,-0.021004704758524895,0.10945366322994232,0.10825379192829132,-0.22702781856060028,-0.05223890393972397,0.06943081319332123,-0.30879709124565125,0.05433374270796776,-0.26477429270744324,0.09457029402256012,-0.0031967011746019125,-0.05517086386680603,-0.2885420024394989,0.1665225625038147,-0.1869979053735733,-0.2912375032901764,0.2355959713459015,-0.020627865567803383,-0.23357094824314117,0.25739428400993347,-0.18468895554542542,-0.2750166356563568},{-0.1599086970090866,-0.11463082581758499,0.322553813457489,-0.14567093551158905,-0.027717294171452522,0.3229869306087494,0.1612977236509323,0.2151269167661667,0.2404642254114151,0.3004601299762726,0.25276586413383484,-0.21920165419578552,0.07307768613100052,-0.22960509359836578,0.04613689333200455,-0.005089649464935064,-0.03566421568393707,-0.15622150897979736,-0.20060084760189056,0.3293461501598358,0.31860828399658203,0.10212760418653488,0.2941950261592865,0.19893334805965424}};
static const float action_parameterization_distribution_linear_weight[24][4] = {{0.2381948083639145,0.3233468532562256,0.05614100769162178,0.15287438035011292},{0.2649799585342407,0.1693086475133896,-0.10245911031961441,0.26737281680107117},{-0.2428661733865738,0.1501750946044922,0.07564539462327957,-0.13256031274795532},{0.2411004602909088,-0.18047267198562622,0.17990711331367493,-0.32451292872428894},{-0.2948007881641388,-0.09042301028966904,-0.38227903842926025,0.3374353051185608},{0.4024476706981659,0.319750040769577,0.06998039036989212,-0.3060915768146515},{0.034076202660799026,0.363063782453537,0.12107852101325989,0.012962249107658863},{0.07187435030937195,0.3188216984272003,-0.003400503657758236,0.2959124445915222},{-0.056273166090250015,-0.15378537774085999,-0.31849366426467896,-0.09996865689754486},{-0.356174498796463,0.1653803288936615,-0.2662469446659088,-0.37568190693855286},{0.2915319502353668,-0.10402505099773407,-0.2351733148097992,-0.15273363888263702},{-0.336945503950119,-0.017582645639777184,0.1479906439781189,-0.19190262258052826},{0.26701444387435913,-0.09043600410223007,0.007961892522871494,0.08483339101076126},{0.16895140707492828,-0.37040242552757263,-0.08283395320177078,0.36067676544189453},{-0.1703588366508484,-0.46218279004096985,-0.16422736644744873,-0.20631320774555206},{0.09309616684913635,-0.32147860527038574,-0.2477681040763855,-0.2934514284133911},{0.018330100923776627,-0.14449577033519745,0.19314518570899963,0.029154041782021523},{-0.33816397190093994,-0.0961502343416214,-0.06085171177983284,-0.08103309571743011},{-0.1407652199268341,0.3246603310108185,0.2506566047668457,-0.3528446853160858},{-0.31161007285118103,0.30334970355033875,0.08862289041280746,0.04621125012636185},{0.3480348289012909,-0.03911910206079483,0.23830516636371613,-0.3478403389453888},{0.16266469657421112,0.06873546540737152,-0.4283807873725891,-0.18061575293540955},{-0.24859993159770966,-0.18881171941757202,-0.2165863960981369,-0.2550292909145355},{0.10548447072505951,0.17153500020503998,-0.027512596920132637,-0.05194789916276932}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.17004090547561646,-0.14122137427330017,0.128438338637352,0.025954825803637505,-0.058947257697582245,0.11272537708282471,0.0347379595041275,-0.02112765982747078,-0.024486249312758446,-0.07436280697584152,-0.02333134599030018,-0.11328481882810593,0.02189818024635315,-0.13267676532268524,-0.023965107277035713,0.0853835940361023};
static const float actor_encoder_self_encoder_2_bias[16] = {0.015637708827853203,0.12930582463741302,0.05871809646487236,-0.02898196317255497,0.02511749044060707,-0.05504627898335457,-0.09278753399848938,0.0037228369619697332,0.0034774718806147575,-0.09052915871143341,0.05281826853752136,0.03573008254170418,-0.01951160654425621,0.07192735373973846,0.07259290665388107,-0.019988272339105606};
static const float actor_encoder_feed_forward_0_bias[24] = {-0.05055207759141922,-0.04377947747707367,0.0316186398267746,0.03391149267554283,-0.07917678356170654,0.06377562135457993,0.035778727382421494,-0.03590644523501396,-0.007522969041019678,-0.0514625646173954,-0.023517949506640434,0.020976737141609192,-0.03659747168421745,-0.09172607213258743,0.0009957533329725266,0.014277536422014236,0.002517879009246826,-0.029991695657372475,-0.015184263698756695,-0.0037833964452147484,-0.025698790326714516,-0.06155215576291084,0.030356045812368393,0.02199558913707733};
static const float action_parameterization_distribution_linear_bias[4] = {-0.01389395073056221,0.008248784579336643,0.0352507084608078,-0.048125095665454865};
static const float actor_encoder_obstacle_encoder_0_weight[16][8] = {{0.2770925760269165,-0.5359655618667603,0.04075862467288971,0.2264433205127716,-0.06762559711933136,0.13963527977466583,0.2554234266281128,0.23902274668216705},{0.23345156013965607,0.1395859569311142,0.3148956596851349,-0.21451890468597412,-0.20162495970726013,0.026089878752827644,-0.30555087327957153,0.12107875198125839},{-0.4020567238330841,-0.3223989009857178,0.6542087197303772,-0.009249052964150906,-0.44212520122528076,0.16323307156562805,-0.42574042081832886,0.3706357181072235},{0.0059877908788621426,-0.30291372537612915,-0.13799448311328888,0.27153918147087097,0.0285489559173584,-0.12459591776132584,0.16906821727752686,0.2375376969575882},{-0.2223474085330963,-0.36790406703948975,0.02445266768336296,-0.1555265635251999,0.4554196894168854,-0.3094600737094879,-0.029909273609519005,-0.5364266633987427},{-0.4222237467765808,-0.2447928935289383,0.526543915271759,0.11924038827419281,-0.24255046248435974,0.06314925104379654,0.033932846039533615,0.36331263184547424},{-0.2650424540042877,0.2566722333431244,-0.09187041968107224,0.15610018372535706,0.2488757222890854,-0.47779276967048645,-0.011203790083527565,0.19363170862197876},{-0.3309692442417145,0.2823845148086548,0.6354654431343079,-0.19966886937618256,0.049710653722286224,0.28364449739456177,0.1652701050043106,-0.2620372474193573},{0.023616965860128403,0.49753081798553467,0.2926221787929535,0.29647353291511536,-0.45518428087234497,0.14887145161628723,-0.09191608428955078,-0.306423157453537},{0.10932952910661697,0.052259642630815506,0.09289807081222534,-0.40514883399009705,-0.4637332856655121,-0.16040650010108948,0.4129023849964142,0.15952953696250916},{-0.25494280457496643,-0.4054236114025116,0.2658202350139618,-0.04806938394904137,0.4750606417655945,0.2148793637752533,0.5534622073173523,-0.15185800194740295},{-0.05859469994902611,-0.08060047775506973,0.5386470556259155,-0.3970664143562317,0.35453054308891296,0.27312248945236206,0.47788670659065247,-0.09511792659759521},{0.2324923425912857,0.05016070231795311,0.36080101132392883,-0.35550346970558167,-0.0176764614880085,0.176655113697052,-0.24726657569408417,-0.16963279247283936},{0.10559888929128647,-0.14640088379383087,0.08315040171146393,0.08659829199314117,0.03675198554992676,0.5006722807884216,0.01515332143753767,0.3314960300922394},{0.40670570731163025,0.17883726954460144,0.3283321261405945,0.33241578936576843,0.4524071216583252,0.4042433500289917,0.09068488329648972,0.3530272841453552},{-0.25153154134750366,0.2216619998216629,0.04008980467915535,-0.2965160310268402,0.36232295632362366,-0.4150765836238861,-0.19844207167625427,0.10625710338354111}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.2465589940547943,-0.6360041499137878,-0.2198827564716339,0.26227739453315735,-0.15257085859775543,0.13017264008522034,0.37317565083503723,-0.5302028059959412},{-0.45340195298194885,0.47018393874168396,-0.5148932337760925,0.2360733300447464,-0.49372589588165283,-0.3941400349140167,0.04209498316049576,-0.24129080772399902},{-0.025365835055708885,-0.006476103328168392,0.006109745241701603,-0.4774543046951294,-0.11162762343883514,0.1495276689529419,0.058700550347566605,0.19450777769088745},{0.09743939340114594,0.29710644483566284,-0.05973271280527115,0.18559254705905914,-0.440368115901947,-0.429563969373703,-0.5231338739395142,0.33768588304519653},{0.1783948838710785,0.03834333270788193,0.2841534912586212,0.4639243483543396,0.2150658667087555,-0.2890896201133728,-0.24362000823020935,-0.24550749361515045},{-0.34856662154197693,-0.35839810967445374,-0.052248530089855194,0.20218050479888916,-0.5734314918518066,0.4230037331581116,-0.10776734352111816,-0.34920448064804077},{-0.1727495640516281,0.540520966053009,0.3487359881401062,0.16129115223884583,0.6297049522399902,0.5294683575630188,0.14060400426387787,-0.14710447192192078},{0.5206283330917358,-0.5083715915679932,-0.4877186417579651,-0.0012628101976588368,0.5179895162582397,-0.31371191143989563,0.10088246315717697,0.12445143610239029}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04105608910322189,0.00618542917072773,0.21536889672279358,0.0011416906490921974,0.013682844117283821,-0.17104989290237427,-0.004399705212563276,0.06993717700242996};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.02254319190979004,0.10455607622861862,-0.004370609764009714,0.01947527937591076,-0.05336516723036766,-0.010102192871272564,-0.02420753240585327,-0.008154917508363724};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    
        for (int i = 0; i < obst_structure[1][1]; i++) {
            obst_output_1[i] = 0;
            for (int j = 0; j < obst_structure[1][0]; j++) {
                obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
            }
            obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
            obstacle_embeds[i] = tanhf(obst_output_1[i]);
        }
        }

